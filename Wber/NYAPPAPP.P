/*NYAPPAPP.P*/
{APPARAT.I}

PROCEDURE btnok_UI :
   DEFINE INPUT-OUTPUT PARAMETER approwid AS ROWID NO-UNDO.
   DEFINE INPUT PARAMETER andra AS LOGICAL NO-UNDO.
   DEFINE INPUT PARAMETER ytvar AS CHARACTER NO-UNDO.
   DEFINE OUTPUT PARAMETER TABLE FOR apparattemp.
   EMPTY TEMP-TABLE apparattemp NO-ERROR. 
   DO TRANSACTION:
      IF andra = TRUE THEN DO:
         FIND APPARAT WHERE ROWID(APPARAT) = approwid EXCLUSIVE-LOCK NO-ERROR.     
         IF AVAILABLE APPARAT THEN DO:
            ASSIGN APPARAT.BENAMNING = ytvar.            
         END.
      END.
      ELSE DO:
         CREATE APPARAT.
         ASSIGN APPARAT.BENAMNING = ytvar.
         CREATE apparattemp.
         BUFFER-COPY APPARAT TO apparattemp.
         ASSIGN apparattemp.APROW = ROWID(APPARAT).
      END.  
   END.
   approwid = ROWID(APPARAT).
   RELEASE APPARAT NO-ERROR.
END PROCEDURE.
