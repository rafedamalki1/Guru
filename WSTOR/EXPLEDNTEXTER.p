/*EXPLEDNTEXTER.p */  
DEFINE VARIABLE nd1 AS INTEGER NO-UNDO.
DEFINE VARIABLE nd2 AS INTEGER NO-UNDO.
DEFINE VARIABLE nd3 AS INTEGER NO-UNDO.
DEFINE VARIABLE nd4 AS INTEGER NO-UNDO.
DEFINE VARIABLE txt1 AS CHARACTER NO-UNDO.
DEFINE VARIABLE txt2 AS CHARACTER NO-UNDO.
DEFINE VARIABLE langdvar1000 AS INTEGER NO-UNDO. /*vad är det som styr*/
DEFINE TEMP-TABLE natupptt NO-UNDO
FIELD N1 AS INTEGER
FIELD N2 AS INTEGER
FIELD N3 AS INTEGER
FIELD N4 AS INTEGER
INDEX N1234 N1 N2 N3 N4.
/*
nd3 = 28.   "Lastfrånskiljare med säkring"
heter bara "Lastfrånskiljare"
nd1 = 3.   
nd2 = 4.   
nd3 = 0.
nd4 = 0.
nd1 = 3.   
nd2 = 5.   
nd3 = 0.
nd4 = 0. 
nd1 = 3.   
nd2 = 3.   
nd3 = 0.
nd4 = 0.
nd1 = 3.   
nd2 = 6.   
nd3 = 0.
nd4 = 0.
ger omvända värde txt1 och txt2
LIKRIKTATSATION är fel stavat i db
Likriktarstation
*/
/*
ASSIGN 
nd1 = 2   
nd2 = 2   
nd3 = 3
nd4 = 0.     
/*EXPLEDN.P*/
RUN textkoll_UI (INPUT nd1,INPUT nd2,INPUT nd3,INPUT nd4, OUTPUT txt1, OUTPUT txt2).
MESSAGE txt1 SKIP txt2
VIEW-AS ALERT-BOX.
/*DARIN4.P*/
RUN kolltext_UI (OUTPUT nd1,OUTPUT nd2,OUTPUT nd3,OUTPUT nd4, INPUT txt1, INPUT txt2).
MESSAGE 
nd1 skip
nd2 skip
nd3 skip
nd4 skip
VIEW-AS ALERT-BOX.
*/
ASSIGN 
nd1 = 3  
nd2 = 7   
nd3 = 11
nd4 = 0.     
/*EXPLEDN.P*/
/*
RUN textkoll_UI (INPUT nd1,INPUT nd2,INPUT nd3,INPUT nd4, OUTPUT txt1, OUTPUT txt2).
MESSAGE txt1 SKIP txt2
VIEW-AS ALERT-BOX.
*/
RUN SNATkoll_UI.
FUNCTION FFinlasttabIN RETURNS INTEGER 
(INPUT ikod AS CHARACTER,INPUT ityp AS CHARACTER, INPUT sid AS INTEGER):
   FIND FIRST INLASTAB WHERE INLASTAB.INKOD = ikod AND INLASTAB.INKODTYP = ityp AND
   INLASTAB.INKODPOSCH = STRING(sid) USE-INDEX INKOD NO-LOCK NO-ERROR.
   IF AVAILABLE INLASTAB THEN DO:
      FIND FIRST SPANNINGSNIV WHERE SPANNINGSNIV.INKODID = INLASTAB.INKODID
         NO-LOCK NO-ERROR.
      IF AVAILABLE SPANNINGSNIV THEN RETURN SPANNINGSNIV.SPANID.
      ELSE RETURN sid.
   END.   
   ELSE RETURN sid.   
   
END FUNCTION.            

FUNCTION FLinlasttabFF RETURNS INTEGER 
  (INPUT tabnamn AS CHARACTER, INPUT sid AS INTEGER):
   IF tabnamn = "SEKTIONERING" THEN DO:  
      FIND FIRST INLASTAB WHERE INLASTAB.INKOD = "F" AND INLASTAB.INKODTYP = "1" AND
      INLASTAB.INKODPOSCH = STRING(sid) USE-INDEX INKOD
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      FIND FIRST SEKTIONERING WHERE SEKTIONERING.INKODID = INLASTAB.INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE SEKTIONERING THEN RETURN sid.
      RETURN INTEGER(SEKTIONERING.SEKTIONERID).
   END.
   IF tabnamn = "RELAINDIKERING" THEN DO: 
      FIND FIRST INLASTAB WHERE INLASTAB.INKOD = "G" AND INLASTAB.INKODTYP = "2" AND
      INLASTAB.INKODPOSCH = STRING(sid) USE-INDEX INKOD
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      FIND FIRST RELAINDIKERING WHERE RELAINDIKERING.INKODID = INLASTAB.INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE RELAINDIKERING THEN RETURN sid.
      RETURN RELAINDIKERING.RELINID.
   END.        
   IF tabnamn = "FELORSAK" THEN DO:
      FIND FIRST INLASTAB WHERE INLASTAB.INKOD = "S" AND 
      INLASTAB.INKODPOSCH = STRING(sid) USE-INDEX INKOD
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      FIND FIRST FELORSAK WHERE FELORSAK.INKODID = INLASTAB.INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE FELORSAK THEN RETURN sid.
      RETURN FELORSAK.FELOID.  
   END.   
  
   IF tabnamn = "BRYTORGAN" THEN DO:  
      FIND FIRST INLASTAB WHERE INLASTAB.INKOD = "E" AND INLASTAB.INKODTYP = "1" AND
      INLASTAB.INKODPOSCH = STRING(sid) USE-INDEX INKOD
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      FIND FIRST BRYTORGAN WHERE BRYTORGAN.INKODID = INLASTAB.INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE BRYTORGAN THEN RETURN sid.
      RETURN  BRYTORGAN.BRYTOID.
   END.  
   IF tabnamn = "STORDRIFTOMR" THEN DO:  
      FIND FIRST INLASTAB WHERE INLASTAB.INKOD = "N" AND INLASTAB.INKODTYP = "1" AND
      INLASTAB.INKODPOSCH = STRING(sid) USE-INDEX INKOD
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      FIND FIRST STORDRIFTOMR WHERE STORDRIFTOMR.INKODID = INLASTAB.INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE STORDRIFTOMR THEN RETURN sid.
      RETURN  STORDRIFTOMR.STDRIFTID.
   END. 
   IF tabnamn = "NATTYP" THEN DO:  
      FIND FIRST INLASTAB WHERE INLASTAB.INKOD = "Q" AND INLASTAB.INKODTYP = "1" AND
      INLASTAB.INKODPOSCH = STRING(sid) USE-INDEX INKOD
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      FIND FIRST NATTYP WHERE NATTYP.INKODID = INLASTAB.INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE NATTYP THEN RETURN sid.
      RETURN  INTEGER(NATTYP.NATTYPID).
   END. 
   IF tabnamn = "NATSTRUKTUR1" THEN DO:  
      FIND FIRST INLASTAB WHERE INLASTAB.INKOD = "P" AND INLASTAB.INKODTYP = "1" AND
      INLASTAB.INKODPOSCH = STRING(sid) USE-INDEX INKOD
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      FIND FIRST NATSTRUKTUR WHERE NATSTRUKTUR.INKODID = INLASTAB.INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE NATSTRUKTUR THEN RETURN sid.
      RETURN  NATSTRUKTUR.STRUKID.
   END.
   IF tabnamn = "NATSTRUKTUR2" THEN DO:  
      FIND FIRST INLASTAB WHERE INLASTAB.INKOD = "P" AND INLASTAB.INKODTYP = "2" AND
      INLASTAB.INKODPOSCH = STRING(sid) USE-INDEX INKOD
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      FIND FIRST NATSTRUKTUR WHERE NATSTRUKTUR.INKODID = INLASTAB.INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE NATSTRUKTUR THEN RETURN sid.
      RETURN  NATSTRUKTUR.STRUKID.
   END.  
   IF tabnamn = "ANLAGGNINGSDEL" THEN DO:  
      
      FIND FIRST INLASTAB WHERE INLASTAB.INKOD = "R" AND
      INLASTAB.INKODPOSCH = STRING(sid) USE-INDEX INKOD
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      FIND FIRST ANLAGGNINGSDEL WHERE ANLAGGNINGSDEL.INKODID = INLASTAB.INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE ANLAGGNINGSDEL THEN RETURN sid.
       IF ANLAGGNINGSDEL.ADELID >= 5 AND  ANLAGGNINGSDEL.ADELID <= 12 THEN RETURN 26.
      
      RETURN  ANLAGGNINGSDEL.ADELID.
   END.
   IF tabnamn = "UTLOSNINGSKYDD" THEN DO:
      FIND FIRST INLASTAB WHERE INLASTAB.INKOD = "G" AND INLASTAB.INKODTYP = "1" AND
      INLASTAB.INKODPOSCH = STRING(sid) USE-INDEX INKOD
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      FIND FIRST UTLOSNINGSKYDD WHERE UTLOSNINGSKYDD.INKODID = INLASTAB.INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE UTLOSNINGSKYDD THEN RETURN sid.
      RETURN  UTLOSNINGSKYDD.UTLOSID.
   END.
   
END FUNCTION.
PROCEDURE Kundantal_UI :
   FOR EACH KUNDSTOR WHERE EXCLUSIVE-LOCK NO-LOCK:
       IF KUNDSTOR.ANTALKUNDER = 0 THEN DO:
          KUNDSTOR.ANTALKUNDER = KUNDSTOR.ANTALLUFT + KUNDSTOR.ANTALBLAND + KUNDSTOR.ANTALKABEL.
       END.
   END.
   FOR EACH LEDNINGSDATA WHERE EXCLUSIVE-LOCK:
      IF LEDNINGSDATA.LANGD = 0 THEN DO:
         LEDNINGSDATA.LANGD = LEDNINGSDATA.LANGDLUFT + LEDNINGSDATA.LANGDBLAND + LEDNINGSDATA.LANGDKABEL.
      END.
   END.
   CREATE ANLAGGNINGSDEL.
   ASSIGN 
   ANLAGGNINGSDEL.ADELID = 26
   ANLAGGNINGSDEL.ATYPID = 2
   ANLAGGNINGSDEL.INKODID = "247"
   ANLAGGNINGSDEL.NAMN = "Nätstation".
   CREATE INLASTAB.
   ASSIGN 
   INLASTAB.INKODID = "247"
   INLASTAB.INKOD = "R"
   INLASTAB.NAMN = "Nätstation"
   INLASTAB.INLASTNR = 247
   INLASTAB.TABNAMN = "ANLAGGNINGSDEL"
   INLASTAB.INKODTYP = "4"
   INLASTAB.ORDNING = 0
   INLASTAB.INKODPOSCH = "50".
   
   FOR EACH STORNINGSTAB WHERE STORNINGSTAB.ADELID >= 5 AND  STORNINGSTAB.ADELID <= 12 EXCLUSIVE-LOCK:
      STORNINGSTAB.ADELID = 26.
   END.
   FIND FIRST ANLAGGNINGSDEL WHERE ANLAGGNINGSDEL.ADELID = 14 EXCLUSIVE-LOCK NO-ERROR.
   ANLAGGNINGSDEL.NAMN = "FRILEDNING, ISOLERAD BLL/BLX".
   FIND FIRST ANLAGGNINGSDEL WHERE ANLAGGNINGSDEL.ADELID = 15 EXCLUSIVE-LOCK NO-ERROR.
   ANLAGGNINGSDEL.NAMN = "HÄNGKABELLEDNING ALUS".  
   
   FIND FIRST STORTEXTER WHERE STORTEXTER.TID = 210 EXCLUSIVE-LOCK NO-ERROR.
   STORTEXTER.NAMN = "FRILEDNING, ISOLERAD BLL/BLX".
   FIND FIRST STORTEXTER WHERE STORTEXTER.TID = 211 EXCLUSIVE-LOCK NO-ERROR.
   STORTEXTER.NAMN = "HÄNGKABELLEDNING ALUS".
   
    CREATE STORNATUPPKOPP.
   ASSIGN
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 7 
      STORNATUPPKOPP.NATUPPLAGGID3 = 35  
      STORNATUPPKOPP.NATUPPLAGGID4 = 0
      STORNATUPPKOPP.TEXTKOMBID = 50  
      STORNATUPPKOPP.TEXTID1 = 193
      STORNATUPPKOPP.TEXTID2 = 193.   
   
END PROCEDURE.

PROCEDURE texter_UI :

   FOR EACH NATUPPLAGG1 WHERE NO-LOCK:
      CREATE STORTEXTER.
      STORTEXTER.TID = INTEGER(NATUPPLAGG1.INKODID).
      STORTEXTER.NAMN = NATUPPLAGG1.NAMN.   
   END.
   FOR EACH NATUPPLAGG2 WHERE NO-LOCK:
      CREATE STORTEXTER.
      STORTEXTER.TID = INTEGER(NATUPPLAGG2.INKODID).
      STORTEXTER.NAMN = NATUPPLAGG2.NAMN.   
   END.
   FOR EACH NATUPPLAGG3 WHERE NO-LOCK:
      CREATE STORTEXTER.
      STORTEXTER.TID = INTEGER(NATUPPLAGG3.INKODID).
      STORTEXTER.NAMN = NATUPPLAGG3.NAMN.   
   END.
   FOR EACH NATUPPLAGG4 WHERE NO-LOCK:
      CREATE STORTEXTER.
      STORTEXTER.TID = INTEGER(NATUPPLAGG4.INKODID).
      STORTEXTER.NAMN = NATUPPLAGG4.NAMN.   
   END.
END PROCEDURE.
DEFINE TEMP-TABLE stnattt NO-UNDO
FIELD TEXTID1 AS INTEGER
FIELD TEXTID2 AS INTEGER

FIELD t1 AS CHARACTER
FIELD t2 AS CHARACTER. 

PROCEDURE UPPKOLL_UI:
   CREATE STORNATUPPKOPP.
   ASSIGN
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 8 
      STORNATUPPKOPP.NATUPPLAGGID3 = 20  
      STORNATUPPKOPP.NATUPPLAGGID4 = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Effektbrytare -utomhus" NO-LOCK NO-ERROR.  
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.                                                                                               
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Effektbrytare" NO-LOCK NO-ERROR.   
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 12 
      STORNATUPPKOPP.NATUPPLAGGID3 = 27  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Lastfrånskiljare -utomhus" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Lastfrånskiljare" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 9 
      STORNATUPPKOPP.NATUPPLAGGID3 = 21  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
     
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Frånskiljare -inomhus" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Frånskiljare" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 10 
      STORNATUPPKOPP.NATUPPLAGGID3 = 23  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "-olje med exp.kärl" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Krafttransformator" NO-LOCK  NO-ERROR.
    
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 8 
      STORNATUPPKOPP.NATUPPLAGGID3 = 19  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Effektbrytare -inomhus" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Effektbrytare" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 12 
      STORNATUPPKOPP.NATUPPLAGGID3 = 26  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Lastfrånskiljare -inomhus" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Lastfrånskiljare" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 12 
      STORNATUPPKOPP.NATUPPLAGGID3 = 28  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Lastfr.sk. m. säkr. -inomhus" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Lastfrånskiljare med säkring" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 10 
      STORNATUPPKOPP.NATUPPLAGGID3 = 30  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "-olje sluten" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Krafttransformator" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 10 
      STORNATUPPKOPP.NATUPPLAGGID3 = 31  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "-torrisolerad luft" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Krafttransformator" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 11 
      STORNATUPPKOPP.NATUPPLAGGID3 = 24  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Kondensatorbatterier totalt" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Kondensatorbatterier" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 11 
      STORNATUPPKOPP.NATUPPLAGGID3 = 25  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "varav -PCB" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Kondensatorbatterier" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 2 
      STORNATUPPKOPP.NATUPPLAGGID3 = 3  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Kraftkabel i mark" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Markledning" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.M-KM = 1000.
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID.
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 2 
      STORNATUPPKOPP.NATUPPLAGGID3 = 4  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Varav PEX" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Markledning" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.M-KM = 1000.
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID.
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 4 
      STORNATUPPKOPP.NATUPPLAGGID3 = 0  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Fördelningsstation" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Station" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 1 
      STORNATUPPKOPP.NATUPPLAGGID3 = 1  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Friledning, oisolerad" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.

   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Luftledning" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.M-KM = 1000.
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 2 
      STORNATUPPKOPP.NATUPPLAGGID3 = 5  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Kraftkabel i vatten" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Markledning" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.M-KM = 1000.
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 5 
      STORNATUPPKOPP.NATUPPLAGGID3 = 0  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Kopplingsstation" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Station" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 7 
      STORNATUPPKOPP.NATUPPLAGGID3 = 13  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Stolpstation" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Nätstation" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 7 
      STORNATUPPKOPP.NATUPPLAGGID3 = 11  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Btg el stenstn. inomhusman." NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Nätstation" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 7 
      STORNATUPPKOPP.NATUPPLAGGID3 = 12  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Btg el stenstn. utomhusman." NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Nätstation" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 7 
      STORNATUPPKOPP.NATUPPLAGGID3 = 14  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Plåtstation" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Nätstation" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 7 
      STORNATUPPKOPP.NATUPPLAGGID3 = 15  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Satellitstation" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Nätstation" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 7 
      STORNATUPPKOPP.NATUPPLAGGID3 = 17  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Kapslad transformator" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Nätstation" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 7 
      STORNATUPPKOPP.NATUPPLAGGID3 = 18  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Inhyst station" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Nätstation" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID.    
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 7 
      STORNATUPPKOPP.NATUPPLAGGID3 = 34  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .      
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Annan stationstyp" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Nätstation" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID.   
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 1 
      STORNATUPPKOPP.NATUPPLAGGID3 = 7  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Hängkabelledning" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Luftledning" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.M-KM = 1000.
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 1 
      STORNATUPPKOPP.NATUPPLAGGID3 = 8  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Hängspiralkabelledning" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Luftledning" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.M-KM = 1000.
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID.    
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 1 
      STORNATUPPKOPP.NATUPPLAGGID3 = 33  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .      
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Säkrings- och apparatlåda" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Luftledning" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 1 
      STORNATUPPKOPP.NATUPPLAGGID3 = 35  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .      
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Annan ledning" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Luftledning" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 1 
      STORNATUPPKOPP.NATUPPLAGGID3 = 2  
      STORNATUPPKOPP.NATUPPLAGGID4   = 3 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Lastfrånskiljare" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "App. i luftledn. och stolpstn." NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID.
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 1 
      STORNATUPPKOPP.NATUPPLAGGID3 = 2  
      STORNATUPPKOPP.NATUPPLAGGID4   = 2 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Frånskiljare" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "App. i luftledn. och stolpstn." NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 9 
      STORNATUPPKOPP.NATUPPLAGGID3 = 22  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Frånskiljare -utomhus" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Frånskiljare" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 1 
      STORNATUPPKOPP.NATUPPLAGGID3 = 6  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Friledning, isolerad" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Luftledning" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.M-KM = 1000.
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 2 
      STORNATUPPKOPP.NATUPPLAGGID3 = 10  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Avgrenings-/Kabelskåp" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Markledning" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 3 
      STORNATUPPKOPP.NATUPPLAGGID3 = 0  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Regionstation" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Station" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 7 
      STORNATUPPKOPP.NATUPPLAGGID3 = 16  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Markstation" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Nätstation" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 12 
      STORNATUPPKOPP.NATUPPLAGGID3 = 29  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Lastfr.sk. m. säkr. -utomhus" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Lastfrånskiljare med säkring" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 1 
      STORNATUPPKOPP.NATUPPLAGGID3 = 2  
      STORNATUPPKOPP.NATUPPLAGGID4   = 1 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Effektbrytare" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "App. i luftledn. och stolpstn." NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 3  
      STORNATUPPKOPP.NATUPPLAGGID2 = 6 
      STORNATUPPKOPP.NATUPPLAGGID3 = 0  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Likriktarstation" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Station" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 4  
      STORNATUPPKOPP.NATUPPLAGGID2 = 10 
      STORNATUPPKOPP.NATUPPLAGGID3 = 32  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "-torrisolerad, solid" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Krafttransformator" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 1 
      STORNATUPPKOPP.NATUPPLAGGID3 = 2  
      STORNATUPPKOPP.NATUPPLAGGID4   = 4 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Kondensatorbatteri, serie" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "App. i luftledn. och stolpstn." NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 1 
      STORNATUPPKOPP.NATUPPLAGGID3 = 2  
      STORNATUPPKOPP.NATUPPLAGGID4   = 5 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Kondensatorbatteri, shunt" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "App. i luftledn. och stolpstn." NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID. 
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 2 
      STORNATUPPKOPP.NATUPPLAGGID3 = 9  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Avgrenings-/Kabelskåp" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Markledning" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID.  
   CREATE STORNATUPPKOPP. 
   ASSIGN 
      STORNATUPPKOPP.NATUPPLAGGID1 = 2  
      STORNATUPPKOPP.NATUPPLAGGID2 = 2 
      STORNATUPPKOPP.NATUPPLAGGID3 = 10  
      STORNATUPPKOPP.NATUPPLAGGID4   = 0 .      
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Säkrings- och apparatlåda" NO-LOCK NO-ERROR.
   STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.
   FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Markledning" NO-LOCK NO-ERROR.
   
   STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID.
END PROCEDURE.                

PROCEDURE lang_UI :
   DEFINE OUTPUT PARAMETER langdvar1000 AS INTEGER NO-UNDO.
  /*
   ASSIGN
      nat1 = 2
      nat2 = 2
      nat3 = 3
      nat4 = 0
      langdvar = TRUE.
      ASSIGN
      nat1 = 2
      nat2 = 2
      nat3 = 4
      nat4 = 0
      langdvar = TRUE.
       ASSIGN
      nat1 = 2
      nat2 = 1
      nat3 = 1
      nat4 = 0
      langdvar = TRUE.
      ASSIGN
      nat1 = 2
      nat2 = 2
      nat3 = 5
      nat4 = 0
      langdvar = TRUE.
      ASSIGN
      nat1 = 2
      nat2 = 1
      nat3 = 7
      nat4 = 0
      langdvar = TRUE.
      ASSIGN
      nat1 = 2
      nat2 = 1
      nat3 = 8
      nat4 = 0
      langdvar = TRUE.
      ASSIGN
      nat1 = 2
      nat2 = 1
      nat3 = 35
      nat4 = 0
      langdvar = TRUE.
      ASSIGN
      nat1 = 2
      nat2 = 1
      nat3 = 6
      nat4 = 0
      langdvar = TRUE.
      ASSIGN
      nat1 = 2
      nat2 = 2
      nat3 = 3
      nat4 = 0
      langdvar = TRUE.
   
   */
END PROCEDURE.
PROCEDURE kundkoll_UI :
   DEFINE BUFFER kbuff FOR KUNDSTOR.
   FOR EACH KUNDSTOR WHERE NO-LOCK:
      FOR EACH kbuff WHERE kbuff.DISTRIKTID = KUNDSTOR.DISTRIKTID AND kbuff.SPANID = KUNDSTOR.SPANID AND
      kbuff.ARTAL = KUNDSTOR.ARTAL    NO-LOCK:
         IF ROWID(KUNDSTOR) = ROWID(kbuff) THEN.
         ELSE DO:
            DISPLAY KUNDSTOR.DISTRIKTID KUNDSTOR.SPANID KUNDSTOR.ARTAL WITH FRAME CC DOWN.
         END.   
      END.
      
   END.
END PROCEDURE.

PROCEDURE LEDkoll_UI :
   DEFINE BUFFER lbuff FOR LEDNINGSDATA.
   FOR EACH LEDNINGSDATA WHERE NO-LOCK:
      FOR EACH lbuff WHERE lbuff.DISTRIKTID = LEDNINGSDATA.DISTRIKTID AND lbuff.SPANID = LEDNINGSDATA.SPANID AND
      lbuff.ARTAL = LEDNINGSDATA.ARTAL AND 
      lbuff.NATUPPLAGGID1 = LEDNINGSDATA.NATUPPLAGGID1 AND   
      lbuff.NATUPPLAGGID2 = LEDNINGSDATA.NATUPPLAGGID2 AND  
      lbuff.NATUPPLAGGID3 = LEDNINGSDATA.NATUPPLAGGID3 AND
      lbuff.NATUPPLAGGID4 = LEDNINGSDATA.NATUPPLAGGID4 
      NO-LOCK:
        
         IF ROWID(LEDNINGSDATA) = ROWID(lbuff) THEN.
         ELSE DO:
            DISPLAY LEDNINGSDATA.DISTRIKTID LEDNINGSDATA.SPANID LEDNINGSDATA.ARTAL WITH FRAME CC DOWN.
         END.   
      END.
      
   END.
END PROCEDURE.
PROCEDURE N_UI :
   DEFINE VARIABLE I AS INTEGER NO-UNDO.
   FOR EACH LEDNINGSDATA WHERE NO-LOCK:
      I = I + 1.
      IF 
      LEDNINGSDATA.NATUPPLAGGID1 = ? OR 
      LEDNINGSDATA.NATUPPLAGGID2 = ? OR
      LEDNINGSDATA.NATUPPLAGGID3 = ? OR
      LEDNINGSDATA.NATUPPLAGGID4 = ? THEN
      MESSAGE 
      LEDNINGSDATA.ARTAL
      LEDNINGSDATA.DISTRIKTID
      LEDNINGSDATA.INDATUM
      LEDNINGSDATA.NATUPPLAGGID1  
      LEDNINGSDATA.NATUPPLAGGID2 
      LEDNINGSDATA.NATUPPLAGGID3 
      LEDNINGSDATA.NATUPPLAGGID4 
      
      VIEW-AS ALERT-BOX.
      
      FIND FIRST natupptt WHERE 
      natupptt.N1 = LEDNINGSDATA.NATUPPLAGGID1 AND 
      natupptt.N2 = LEDNINGSDATA.NATUPPLAGGID2 AND
      natupptt.N3 = LEDNINGSDATA.NATUPPLAGGID3 AND
      natupptt.N4 = LEDNINGSDATA.NATUPPLAGGID4 
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE natupptt THEN DO:
         CREATE natupptt.
         ASSIGN
         natupptt.N1 = LEDNINGSDATA.NATUPPLAGGID1
         natupptt.N2 = LEDNINGSDATA.NATUPPLAGGID2 
         natupptt.N3 = LEDNINGSDATA.NATUPPLAGGID3 
         natupptt.N4 = LEDNINGSDATA.NATUPPLAGGID4. 
      END.
   END.
   output TO  "C:\protemp11\störning\led.txt".
   FOR EACH natupptt WHERE NO-LOCK:
      EXPORT natupptt.
   END.
   OUTPUT CLOSE. 
   MESSAGE I
   VIEW-AS ALERT-BOX.
END PROCEDURE.

PROCEDURE SNATkoll_UI :
   FOR EACH STORNATUPPKOPP WHERE exclusive-LOCK:
      CREATE stnattt.
      BUFFER-COPY STORNATUPPKOPP TO stnattt.
      FIND FIRST STORTEXTER WHERE STORTEXTER.TID = STORNATUPPKOPP.TEXTID1 NO-LOCK NO-ERROR.  
      stnattt.t1 = STORTEXTER.NAMN.
      FIND FIRST STORTEXTER WHERE STORTEXTER.TID = STORNATUPPKOPP.TEXTID2 NO-LOCK NO-ERROR.  
      stnattt.t2 = STORTEXTER.NAMN. 
   END.
   FOR EACH stnattt WHERE NO-LOCK BY t1:
      FIND FIRST STORNATUPPKOPP WHERE STORNATUPPKOPP.TEXTID1 = stnattt.TEXTID1 AND 
      STORNATUPPKOPP.TEXTID2 = stnattt.TEXTID2
      EXCLUSIVE-LOCK NO-ERROR.
      DISPLAY stnattt.t1 stnattt.t2 WITH FRAME cc.
      UPDATE STORNATUPPKOPP.TEXTKOMBID WITH FRAME cc.
   END.
   
    /*
   STORNATUPPKOPP.TEXTID1,
   STORNATUPPKOPP.TEXTID2,
   STORNATUPPKOPP.M-KM
   */
END PROCEDURE.

PROCEDURE kolltext_UI:
   DEFINE OUTPUT  PARAMETER nd1in AS INTEGER NO-UNDO.
   DEFINE OUTPUT  PARAMETER nd2in AS INTEGER NO-UNDO.
   DEFINE OUTPUT  PARAMETER nd3in AS INTEGER NO-UNDO.
   DEFINE OUTPUT  PARAMETER nd4in AS INTEGER NO-UNDO.
   DEFINE INPUT   PARAMETER txt1in AS CHARACTER NO-UNDO.
   DEFINE INPUT   PARAMETER txt2in AS CHARACTER NO-UNDO.
   
   FIND FIRST NATUPPLAGG2  WHERE NATUPPLAGG2.NAMN = txt2in NO-LOCK NO-ERROR.
   IF AVAILABLE NATUPPLAGG2 THEN DO:
      ASSIGN
      nd1in = NATUPPLAGG2.NATUPPLAGGID1
      nd2in = NATUPPLAGG2.NATUPPLAGGID2.
   END.   
   ELSE DO:
      FIND FIRST NATUPPLAGG1  WHERE NATUPPLAGG1.NAMN = txt2in NO-LOCK NO-ERROR.
      IF AVAILABLE NATUPPLAGG1 THEN DO:
         nd1in = NATUPPLAGG1.NATUPPLAGGID1.
         FIND FIRST NATUPPLAGG2  WHERE NATUPPLAGG2.NAMN = txt1in NO-LOCK NO-ERROR.
         IF AVAILABLE NATUPPLAGG2 THEN DO:
            ASSIGN
            nd2in =  NATUPPLAGG2.NATUPPLAGGID2.
         END.   
      END.   
   END.  
   IF nd1in = 0 AND nd2in = 0 AND nd2in = 0 AND nd3in = 0 THEN.
     
   IF nd3in = 0 AND nd4in = 0 THEN DO:
      FIND FIRST NATUPPLAGG4  WHERE NATUPPLAGG4.NAMN = txt1in NO-LOCK NO-ERROR.
      IF AVAILABLE NATUPPLAGG4 THEN DO:
         nd4in = NATUPPLAGG4.NATUPPLAGGID4.
         nd3in = NATUPPLAGG4.NATUPPLAGGID3.
      END.   
   END.
   IF nd1in = 0 AND nd2in = 0 THEN DO:
      FIND FIRST NATUPPLAGG3  WHERE NATUPPLAGG3.NAMN = txt2in NO-LOCK NO-ERROR.
      IF AVAILABLE NATUPPLAGG3 THEN nd2in = NATUPPLAGG3.NATUPPLAGGID2.
      FIND FIRST NATUPPLAGG2  WHERE NATUPPLAGG2.NATUPPLAGGID2 = nd2in NO-LOCK NO-ERROR.
      IF AVAILABLE NATUPPLAGG2 THEN DO:
         ASSIGN
         nd1in =  NATUPPLAGG2.NATUPPLAGGID1.
      END.      
   END.   
   
   
END PROCEDURE.
PROCEDURE textkoll_UI:
   DEFINE INPUT  PARAMETER nd1in AS INTEGER NO-UNDO.
   DEFINE INPUT  PARAMETER nd2in AS INTEGER NO-UNDO.
   DEFINE INPUT  PARAMETER nd3in AS INTEGER NO-UNDO.
   DEFINE INPUT  PARAMETER nd4in AS INTEGER NO-UNDO.
   DEFINE OUTPUT PARAMETER txt1in AS CHARACTER NO-UNDO.
   DEFINE OUTPUT PARAMETER txt2in AS CHARACTER NO-UNDO.
   
   langdvar1000 = 1.
   FIND FIRST NATUPPLAGG2  WHERE NATUPPLAGG2.NATUPPLAGGID1 = nd1in AND NATUPPLAGG2.NATUPPLAGGID2 = nd2in  NO-LOCK NO-ERROR.
   IF AVAILABLE NATUPPLAGG2 THEN txt2in = NATUPPLAGG2.NAMN.
   FIND FIRST NATUPPLAGG3  WHERE NATUPPLAGG3.NATUPPLAGGID2 = nd2in AND NATUPPLAGG3.NATUPPLAGGID3 = nd3in  NO-LOCK NO-ERROR.
   IF AVAILABLE NATUPPLAGG3 THEN txt1in = NATUPPLAGG3.NAMN.
   IF nd3in = 0 AND nd4in = 0 THEN DO:
      txt1in = txt2in.
      FIND FIRST NATUPPLAGG1  WHERE NATUPPLAGG1.NATUPPLAGGID1 = nd1in NO-LOCK NO-ERROR.
      IF AVAILABLE NATUPPLAGG1 THEN txt2in = NATUPPLAGG1.NAMN.
      RETURN.    
   END.   
   IF nd4in = 0 THEN RETURN.
  
   FIND FIRST NATUPPLAGG4  WHERE NATUPPLAGG4.NATUPPLAGGID4 = nd4in NO-LOCK NO-ERROR.
   IF AVAILABLE NATUPPLAGG4 THEN txt1in = NATUPPLAGG4.NAMN.
   FIND FIRST NATUPPLAGG3  WHERE NATUPPLAGG3.NATUPPLAGGID2 = nd2in AND NATUPPLAGG3.NATUPPLAGGID3 = nd3in  NO-LOCK NO-ERROR.
   IF AVAILABLE NATUPPLAGG3 THEN txt2in = NATUPPLAGG3.NAMN.
END PROCEDURE.                
