&ANALYZE-SUSPEND _VERSION-NUMBER UIB_v8r12 GUI
&ANALYZE-RESUME
&Scoped-define WINDOW-NAME CURRENT-WINDOW
&Scoped-define FRAME-NAME DIALOG-1
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CUSTOM _DEFINITIONS DIALOG-1 
/*------------------------------------------------------------------------

  File: 

  Description: 

  Input Parameters:
      <none>

  Output Parameters:
      <none>

  Author: 

  Created: 95/09/28 -  1:51 pm

------------------------------------------------------------------------*/
/*          This .W file was created with the Progress UIB.             */
/*----------------------------------------------------------------------*/

/* ***************************  Definitions  ************************** */

/* Parameters Definitions ---                                           */

/* Local Variable Definitions ---                                       */
{ALLDEF.I}
DEFINE SHARED VARIABLE regvnr AS INTEGER FORMAT "999" NO-UNDO.
DEFINE SHARED VARIABLE regdagnamn AS CHARACTER FORMAT "X(3)" NO-UNDO.
DEFINE SHARED VARIABLE regdatum AS DATE NO-UNDO.
DEFINE SHARED VARIABLE musz AS LOGICAL NO-UNDO.
DEFINE VARIABLE indate AS DATE NO-UNDO.
DEFINE VARIABLE mregvnr AS INTEGER NO-UNDO.
DEFINE VARIABLE status-ok AS LOGICAL NO-UNDO.
DEFINE VARIABLE ye AS INTEGER FORMAT "9999" NO-UNDO.
DEFINE VARIABLE man AS INTEGER FORMAT "99" NO-UNDO.
DEFINE VARIABLE maxdagnr AS INTEGER FORMAT "99" NO-UNDO.
DEFINE VARIABLE forstaregvnr AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE forstaregdatum AS DATE NO-UNDO.
DEFINE VARIABLE andraregvnr AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE regvnr1 AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE regvnr2 AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE vnr1 AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE vnr2 AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE antal AS INTEGER FORMAT "9" NO-UNDO.
DEFINE VARIABLE regdatum2 AS DATE NO-UNDO.
DEFINE VARIABLE nyladdning AS LOGICAL NO-UNDO.
DEFINE VARIABLE vecknumm AS INTEGER FORMAT "999" NO-UNDO. 
DEFINE VARIABLE vnr4 AS INTEGER NO-UNDO.  
DEFINE VARIABLE regdatumspar AS DATE NO-UNDO.          
DEFINE VARIABLE regvnrspar AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE skillnad AS INTEGER FORMAT "99" NO-UNDO.
DEFINE VARIABLE tal AS INTEGER FORMAT "9" NO-UNDO.
DEFINE VARIABLE datumenh AS HANDLE NO-UNDO EXTENT 37.
DEFINE VARIABLE dagraknare AS INTEGER NO-UNDO.
&Scoped-define NEW
/*
DEFINE SHARED VARIABLE klocka LIKE TIDREGITAB.START NO-UNDO.
*/

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-PREPROCESSOR-BLOCK 

/* ********************  Preprocessor Definitions  ******************** */

&Scoped-define PROCEDURE-TYPE DIALOG-BOX
&Scoped-define DB-AWARE no

/* Name of designated FRAME-NAME and/or first browse and/or first query */
&Scoped-define FRAME-NAME DIALOG-1

/* Standard List Definitions                                            */
&Scoped-Define ENABLED-OBJECTS CMB_AR CMB_MANAD btn_back-7 btn_over-7 ~
FILL-IN-V-1 FILL-IN-1 FILL-IN-2 FILL-IN-3 FILL-IN-4 FILL-IN-5 FILL-IN-6 ~
FILL-IN-7 FILL-IN-V-2 FILL-IN-8 FILL-IN-9 FILL-IN-10 FILL-IN-11 FILL-IN-12 ~
FILL-IN-13 FILL-IN-14 FILL-IN-V-3 FILL-IN-15 FILL-IN-16 FILL-IN-17 ~
FILL-IN-18 FILL-IN-19 FILL-IN-20 FILL-IN-21 FILL-IN-V-4 FILL-IN-22 ~
FILL-IN-23 FILL-IN-24 FILL-IN-25 FILL-IN-26 FILL-IN-27 FILL-IN-28 ~
FILL-IN-V-5 FILL-IN-29 FILL-IN-30 FILL-IN-31 FILL-IN-32 FILL-IN-33 ~
FILL-IN-34 FILL-IN-35 FILL-IN-V-6 FILL-IN-36 FILL-IN-37 
&Scoped-Define DISPLAYED-OBJECTS CMB_AR CMB_MANAD FILL-IN-V-1 FILL-IN-1 ~
FILL-IN-2 FILL-IN-3 FILL-IN-4 FILL-IN-5 FILL-IN-6 FILL-IN-7 FILL-IN-V-2 ~
FILL-IN-8 FILL-IN-9 FILL-IN-10 FILL-IN-11 FILL-IN-12 FILL-IN-13 FILL-IN-14 ~
FILL-IN-V-3 FILL-IN-15 FILL-IN-16 FILL-IN-17 FILL-IN-18 FILL-IN-19 ~
FILL-IN-20 FILL-IN-21 FILL-IN-V-4 FILL-IN-22 FILL-IN-23 FILL-IN-24 ~
FILL-IN-25 FILL-IN-26 FILL-IN-27 FILL-IN-28 FILL-IN-V-5 FILL-IN-29 ~
FILL-IN-30 FILL-IN-31 FILL-IN-32 FILL-IN-33 FILL-IN-34 FILL-IN-35 ~
FILL-IN-V-6 FILL-IN-36 FILL-IN-37 

/* Custom List Definitions                                              */
/* List-1,List-2,List-3,List-4,List-5,List-6                            */

/* _UIB-PREPROCESSOR-BLOCK-END */
&ANALYZE-RESUME



/* ***********************  Control Definitions  ********************** */

/* Define a dialog box                                                  */

/* Definitions of the field level widgets                               */
DEFINE BUTTON btn_back-7 
     IMAGE-UP FILE "BILDER\prev-u":U
     LABEL "":L 
     SIZE 4 BY 1.21.

DEFINE BUTTON btn_over-7 
     IMAGE-UP FILE "BILDER\next-u":U
     LABEL "":L 
     SIZE 4 BY 1.21.

DEFINE VARIABLE CMB_AR AS INTEGER FORMAT "9999":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 12.5 BY 1
     FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE CMB_MANAD AS CHARACTER FORMAT "X(9)":U INITIAL "januari" 
     VIEW-AS COMBO-BOX INNER-LINES 12
     LIST-ITEMS "januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december" 
     DROP-DOWN-LIST
     SIZE 12.5 BY 1
     FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-1 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-10 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-11 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-12 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-13 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-14 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-15 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-16 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-17 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-18 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-19 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-2 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-20 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-21 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-22 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-23 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-24 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-25 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15  NO-UNDO.

DEFINE VARIABLE FILL-IN-26 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-27 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-28 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-29 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-3 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-30 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-31 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-32 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-33 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-34 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-35 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-36 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-37 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-4 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-5 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-6 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-7 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-8 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-9 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-V-1 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-V-2 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-V-3 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-V-4 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-V-5 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-V-6 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3.5 BY 1 NO-UNDO.


/* ************************  Frame Definitions  *********************** */

DEFINE FRAME DIALOG-1
     CMB_AR AT ROW 1.25 COL 3.5 NO-LABEL WIDGET-ID 10
     CMB_MANAD AT ROW 1.25 COL 15.5 COLON-ALIGNED NO-LABEL WIDGET-ID 12
     btn_back-7 AT ROW 2.33 COL 3.5 WIDGET-ID 6
     btn_over-7 AT ROW 2.33 COL 26 WIDGET-ID 8
     FILL-IN-V-1 AT ROW 5.08 COL 5.5 NO-LABEL WIDGET-ID 88
     FILL-IN-1 AT ROW 5.08 COL 11.38 NO-LABEL WIDGET-ID 14
     FILL-IN-2 AT ROW 5.08 COL 13.38 COLON-ALIGNED NO-LABEL WIDGET-ID 36
     FILL-IN-3 AT ROW 5.08 COL 17.38 COLON-ALIGNED NO-LABEL WIDGET-ID 58
     FILL-IN-4 AT ROW 5.08 COL 21.38 COLON-ALIGNED NO-LABEL WIDGET-ID 76
     FILL-IN-5 AT ROW 5.08 COL 25.38 COLON-ALIGNED NO-LABEL WIDGET-ID 78
     FILL-IN-6 AT ROW 5.08 COL 29.38 COLON-ALIGNED NO-LABEL WIDGET-ID 80
     FILL-IN-7 AT ROW 5.08 COL 33.38 COLON-ALIGNED NO-LABEL WIDGET-ID 82
     FILL-IN-V-2 AT ROW 6.58 COL 5.5 NO-LABEL WIDGET-ID 90
     FILL-IN-8 AT ROW 6.58 COL 11.38 NO-LABEL WIDGET-ID 84
     FILL-IN-9 AT ROW 6.58 COL 13.38 COLON-ALIGNED NO-LABEL WIDGET-ID 86
     FILL-IN-10 AT ROW 6.58 COL 17.38 COLON-ALIGNED NO-LABEL WIDGET-ID 16
     FILL-IN-11 AT ROW 6.58 COL 21.38 COLON-ALIGNED NO-LABEL WIDGET-ID 18
     FILL-IN-12 AT ROW 6.58 COL 25.38 COLON-ALIGNED NO-LABEL WIDGET-ID 20
     FILL-IN-13 AT ROW 6.58 COL 29.38 COLON-ALIGNED NO-LABEL WIDGET-ID 22
     FILL-IN-14 AT ROW 6.58 COL 33.38 COLON-ALIGNED NO-LABEL WIDGET-ID 24
     FILL-IN-V-3 AT ROW 8.08 COL 5.5 NO-LABEL WIDGET-ID 92
     FILL-IN-15 AT ROW 8.08 COL 11.38 NO-LABEL WIDGET-ID 26
     FILL-IN-16 AT ROW 8.08 COL 13.38 COLON-ALIGNED NO-LABEL WIDGET-ID 28
     FILL-IN-17 AT ROW 8.08 COL 17.38 COLON-ALIGNED NO-LABEL WIDGET-ID 30
     FILL-IN-18 AT ROW 8.08 COL 21.38 COLON-ALIGNED NO-LABEL WIDGET-ID 32
     FILL-IN-19 AT ROW 8.08 COL 25.38 COLON-ALIGNED NO-LABEL WIDGET-ID 34
     FILL-IN-20 AT ROW 8.08 COL 29.38 COLON-ALIGNED NO-LABEL WIDGET-ID 38
     FILL-IN-21 AT ROW 8.08 COL 33.38 COLON-ALIGNED NO-LABEL WIDGET-ID 40
     FILL-IN-V-4 AT ROW 9.58 COL 5.5 NO-LABEL WIDGET-ID 94
     FILL-IN-22 AT ROW 9.58 COL 11.38 NO-LABEL WIDGET-ID 42
     FILL-IN-23 AT ROW 9.58 COL 13.38 COLON-ALIGNED NO-LABEL WIDGET-ID 44
     FILL-IN-24 AT ROW 9.58 COL 17.38 COLON-ALIGNED NO-LABEL WIDGET-ID 46
     FILL-IN-25 AT ROW 9.58 COL 21.38 COLON-ALIGNED NO-LABEL WIDGET-ID 48
     FILL-IN-26 AT ROW 9.58 COL 25.38 COLON-ALIGNED NO-LABEL WIDGET-ID 50
     FILL-IN-27 AT ROW 9.58 COL 29.38 COLON-ALIGNED NO-LABEL WIDGET-ID 52
     FILL-IN-28 AT ROW 9.58 COL 33.38 COLON-ALIGNED NO-LABEL WIDGET-ID 54
     FILL-IN-V-5 AT ROW 11.08 COL 5.5 NO-LABEL WIDGET-ID 96
     FILL-IN-29 AT ROW 11.08 COL 11.38 NO-LABEL WIDGET-ID 56
     FILL-IN-30 AT ROW 11.08 COL 13.38 COLON-ALIGNED NO-LABEL WIDGET-ID 60
     FILL-IN-31 AT ROW 11.08 COL 17.38 COLON-ALIGNED NO-LABEL WIDGET-ID 62
     FILL-IN-32 AT ROW 11.08 COL 21.38 COLON-ALIGNED NO-LABEL WIDGET-ID 64
     FILL-IN-33 AT ROW 11.08 COL 25.38 COLON-ALIGNED NO-LABEL WIDGET-ID 66
     FILL-IN-34 AT ROW 11.08 COL 29.38 COLON-ALIGNED NO-LABEL WIDGET-ID 68
     FILL-IN-35 AT ROW 11.08 COL 33.38 COLON-ALIGNED NO-LABEL WIDGET-ID 70
     FILL-IN-V-6 AT ROW 12.58 COL 5.5 NO-LABEL WIDGET-ID 98
     FILL-IN-36 AT ROW 12.58 COL 11.38 NO-LABEL WIDGET-ID 72
     FILL-IN-37 AT ROW 12.58 COL 13.38 COLON-ALIGNED NO-LABEL WIDGET-ID 74
    WITH VIEW-AS DIALOG-BOX KEEP-TAB-ORDER 
         SIDE-LABELS NO-UNDERLINE THREE-D  SCROLLABLE .

/* DEFINE FRAME statement is approaching 4K Bytes.  Breaking it up   */
DEFINE FRAME DIALOG-1
     "Vnr   M   T   O   T   F   L   S" VIEW-AS TEXT
          SIZE 33.5 BY 1 AT ROW 3.75 COL 5.88 WIDGET-ID 100
          BGCOLOR 15 FGCOLOR 0 FONT 24
     SPACE(1.74) SKIP(11.57)
    WITH VIEW-AS DIALOG-BOX KEEP-TAB-ORDER 
         SIDE-LABELS NO-UNDERLINE THREE-D  SCROLLABLE 
         TITLE "Almanacka".


/* *********************** Procedure Settings ************************ */

&ANALYZE-SUSPEND _PROCEDURE-SETTINGS
/* Settings for THIS-PROCEDURE
   Type: DIALOG-BOX
 */
&ANALYZE-RESUME _END-PROCEDURE-SETTINGS



/* ***********  Runtime Attributes and AppBuilder Settings  *********** */

&ANALYZE-SUSPEND _RUN-TIME-ATTRIBUTES
/* SETTINGS FOR DIALOG-BOX DIALOG-1
   NOT-VISIBLE FRAME-NAME                                               */
ASSIGN 
       FRAME DIALOG-1:SCROLLABLE       = FALSE
       FRAME DIALOG-1:HIDDEN           = TRUE.

/* SETTINGS FOR COMBO-BOX CMB_AR IN FRAME DIALOG-1
   ALIGN-L                                                              */
/* SETTINGS FOR FILL-IN FILL-IN-1 IN FRAME DIALOG-1
   ALIGN-L                                                              */
ASSIGN 
       FILL-IN-1:HIDDEN IN FRAME DIALOG-1           = TRUE.

/* SETTINGS FOR FILL-IN FILL-IN-15 IN FRAME DIALOG-1
   ALIGN-L                                                              */
ASSIGN 
       FILL-IN-2:HIDDEN IN FRAME DIALOG-1           = TRUE.

/* SETTINGS FOR FILL-IN FILL-IN-22 IN FRAME DIALOG-1
   ALIGN-L                                                              */
/* SETTINGS FOR FILL-IN FILL-IN-29 IN FRAME DIALOG-1
   ALIGN-L                                                              */
ASSIGN 
       FILL-IN-29:HIDDEN IN FRAME DIALOG-1           = TRUE.

ASSIGN 
       FILL-IN-3:HIDDEN IN FRAME DIALOG-1           = TRUE.

ASSIGN 
       FILL-IN-30:HIDDEN IN FRAME DIALOG-1           = TRUE.

ASSIGN 
       FILL-IN-31:HIDDEN IN FRAME DIALOG-1           = TRUE.

ASSIGN 
       FILL-IN-32:HIDDEN IN FRAME DIALOG-1           = TRUE.

ASSIGN 
       FILL-IN-33:HIDDEN IN FRAME DIALOG-1           = TRUE.

ASSIGN 
       FILL-IN-34:HIDDEN IN FRAME DIALOG-1           = TRUE.

ASSIGN 
       FILL-IN-35:HIDDEN IN FRAME DIALOG-1           = TRUE.

/* SETTINGS FOR FILL-IN FILL-IN-36 IN FRAME DIALOG-1
   ALIGN-L                                                              */
ASSIGN 
       FILL-IN-36:HIDDEN IN FRAME DIALOG-1           = TRUE.

ASSIGN 
       FILL-IN-37:HIDDEN IN FRAME DIALOG-1           = TRUE.

ASSIGN 
       FILL-IN-4:HIDDEN IN FRAME DIALOG-1           = TRUE.

ASSIGN 
       FILL-IN-5:HIDDEN IN FRAME DIALOG-1           = TRUE.

ASSIGN 
       FILL-IN-6:HIDDEN IN FRAME DIALOG-1           = TRUE.

/* SETTINGS FOR FILL-IN FILL-IN-8 IN FRAME DIALOG-1
   ALIGN-L                                                              */
/* SETTINGS FOR FILL-IN FILL-IN-V-1 IN FRAME DIALOG-1
   ALIGN-L                                                              */
/* SETTINGS FOR FILL-IN FILL-IN-V-2 IN FRAME DIALOG-1
   ALIGN-L                                                              */
/* SETTINGS FOR FILL-IN FILL-IN-V-3 IN FRAME DIALOG-1
   ALIGN-L                                                              */
/* SETTINGS FOR FILL-IN FILL-IN-V-4 IN FRAME DIALOG-1
   ALIGN-L                                                              */
/* SETTINGS FOR FILL-IN FILL-IN-V-5 IN FRAME DIALOG-1
   ALIGN-L                                                              */
/* SETTINGS FOR FILL-IN FILL-IN-V-6 IN FRAME DIALOG-1
   ALIGN-L                                                              */
/* _RUN-TIME-ATTRIBUTES-END */
&ANALYZE-RESUME

 



/* ************************  Control Triggers  ************************ */

&Scoped-define SELF-NAME DIALOG-1
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL DIALOG-1 DIALOG-1
ON ENDKEY OF FRAME DIALOG-1 /* Almanacka */
DO:
   RETURN.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL DIALOG-1 DIALOG-1
ON WINDOW-CLOSE OF FRAME DIALOG-1 /* Almanacka */
DO:
   RETURN.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME btn_back-7
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL btn_back-7 DIALOG-1
ON CHOOSE OF btn_back-7 IN FRAME DIALOG-1
DO:
   IF man = 01 THEN DO:
      CMB_AR = CMB_AR - 1.
      man = 12.
   END.
   ELSE man = man - 1.
   IF man = 01 THEN CMB_MANAD = STRING("januari"). 
   ELSE IF man = 02 THEN CMB_MANAD = STRING("februari").
   ELSE IF man = 03 THEN CMB_MANAD = STRING("mars").
   ELSE IF man = 04 THEN CMB_MANAD = STRING("april").
   ELSE IF man = 05 THEN CMB_MANAD = STRING("maj").
   ELSE IF man = 06 THEN CMB_MANAD = STRING("juni").
   ELSE IF man = 07 THEN CMB_MANAD = STRING("juli").
   ELSE IF man = 08 THEN CMB_MANAD = STRING("augusti").
   ELSE IF man = 09 THEN CMB_MANAD = STRING("september").
   ELSE IF man = 10 THEN CMB_MANAD = STRING("oktober").
   ELSE IF man = 11 THEN CMB_MANAD = STRING("november").
   ELSE IF man = 12 THEN CMB_MANAD = STRING("december").   
   DISP CMB_AR CMB_MANAD WITH FRAME {&FRAME-NAME}. 
   APPLY "VALUE-CHANGED" TO CMB_MANAD.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME btn_over-7
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL btn_over-7 DIALOG-1
ON CHOOSE OF btn_over-7 IN FRAME DIALOG-1
DO:
   IF man = 12 THEN DO:
      CMB_AR = CMB_AR + 1.
      man = 01.
   END.
   ELSE man = man + 1.
   IF man = 01 THEN CMB_MANAD = STRING("januari"). 
   ELSE IF man = 02 THEN CMB_MANAD = STRING("februari").
   ELSE IF man = 03 THEN CMB_MANAD = STRING("mars").
   ELSE IF man = 04 THEN CMB_MANAD = STRING("april").
   ELSE IF man = 05 THEN CMB_MANAD = STRING("maj").
   ELSE IF man = 06 THEN CMB_MANAD = STRING("juni").
   ELSE IF man = 07 THEN CMB_MANAD = STRING("juli").
   ELSE IF man = 08 THEN CMB_MANAD = STRING("augusti").
   ELSE IF man = 09 THEN CMB_MANAD = STRING("september").
   ELSE IF man = 10 THEN CMB_MANAD = STRING("oktober").
   ELSE IF man = 11 THEN CMB_MANAD = STRING("november").
   ELSE IF man = 12 THEN CMB_MANAD = STRING("december").   
   DISP CMB_AR CMB_MANAD WITH FRAME {&FRAME-NAME}. 
   APPLY "VALUE-CHANGED" TO CMB_MANAD.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_AR
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_AR DIALOG-1
ON LEAVE OF CMB_AR IN FRAME DIALOG-1
DO:
   CMB_AR = INPUT CMB_AR.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_AR DIALOG-1
ON VALUE-CHANGED OF CMB_AR IN FRAME DIALOG-1
DO:
   CMB_AR = INPUT CMB_AR.
   RUN laddadag_UI. /*LADDAR DAGAR. I FILL-IN-FÄLT*/
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_MANAD
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_MANAD DIALOG-1
ON LEAVE OF CMB_MANAD IN FRAME DIALOG-1
DO:
   CMB_MANAD = INPUT CMB_MANAD.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_MANAD DIALOG-1
ON VALUE-CHANGED OF CMB_MANAD IN FRAME DIALOG-1
DO:
   CMB_MANAD = INPUT CMB_MANAD.
   RUN laddadag_UI. /*LADDAR DAGAR I FILL-IN-FÄLT*/
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-1
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-1 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-1 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[1]:SCREEN-VALUE).
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-10
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-10 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-10 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[10]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-11
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-11 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-11 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[11]:SCREEN-VALUE).
     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-12
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-12 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-12 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[12]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-13
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-13 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-13 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[13]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-14
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-14 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-14 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[14]:SCREEN-VALUE).
     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-15
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-15 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-15 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[15]:SCREEN-VALUE).
     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-16
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-16 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-16 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[16]:SCREEN-VALUE).
     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-17
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-17 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-17 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[17]:SCREEN-VALUE).
   
     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-18
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-18 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-18 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[18]:SCREEN-VALUE).
     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-19
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-19 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-19 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[19]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-2
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-2 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-2 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[2]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-20
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-20 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-20 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[20]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-21
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-21 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-21 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[21]:SCREEN-VALUE).
     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-22
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-22 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-22 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[22]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-23
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-23 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-23 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[23]:SCREEN-VALUE).
     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-24
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-24 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-24 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[24]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-25
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-25 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-25 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[25]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-26
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-26 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-26 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[26]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-27
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-27 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-27 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[27]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-28
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-28 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-28 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[28]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-29
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-29 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-29 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[29]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-3
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-3 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-3 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[3]:SCREEN-VALUE).
     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-30
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-30 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-30 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[30]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-31
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-31 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-31 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[31]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-32
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-32 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-32 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[32]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-33
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-33 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-33 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[33]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-34
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-34 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-34 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[34]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-35
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-35 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-35 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[35]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-36
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-36 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-36 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[36]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-37
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-37 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-37 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[37]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-4
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-4 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-4 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[4]:SCREEN-VALUE). 
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-5
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-5 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-5 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[5]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-6
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-6 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-6 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[6]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-7
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-7 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-7 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[7]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-8
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-8 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-8 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[8]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-9
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-9 DIALOG-1
ON MOUSE-SELECT-CLICK OF FILL-IN-9 IN FRAME DIALOG-1
DO:
   RUN Klar_UI (datumenh[9]:SCREEN-VALUE).  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&UNDEFINE SELF-NAME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CUSTOM _MAIN-BLOCK DIALOG-1 


/* ***************************  Main Block  *************************** */

/* Parent the dialog-box to the ACTIVE-WINDOW, if there is no parent.   */
IF VALID-HANDLE(ACTIVE-WINDOW) AND FRAME {&FRAME-NAME}:PARENT eq ?
THEN FRAME {&FRAME-NAME}:PARENT = ACTIVE-WINDOW.

/* Add Trigger to equate WINDOW-CLOSE to END-ERROR                      */
ON WINDOW-CLOSE OF FRAME {&FRAME-NAME} APPLY "END-ERROR":U TO SELF.

/* Now enable the interface and wait for the exit condition.            */
/* (NOTE: handle ERROR and END-KEY so cleanup code will always fire.    */
MAIN-BLOCK:
DO ON ERROR   UNDO MAIN-BLOCK, LEAVE MAIN-BLOCK
   ON END-KEY UNDO MAIN-BLOCK, LEAVE MAIN-BLOCK:
   {DIA_M_START.I}
   RUN daghandle_UI (INPUT FILL-IN-1:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-2:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-3:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-4:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-5:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-6:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-7:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-8:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-9:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-10:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-11:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-12:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-13:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-14:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-15:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-16:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-17:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-18:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-19:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-20:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-21:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-22:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-23:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-24:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-25:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-26:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-27:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-28:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-29:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-30:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-31:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-32:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-33:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-34:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-35:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-36:HANDLE).
   RUN daghandle_UI (INPUT FILL-IN-37:HANDLE).
   
   
   
   ASSIGN   
   forstaregdatum = regdatum.
   ASSIGN  /*LADDAR ÅR I CMB_AR*/
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum) - 3,"9999"))  
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum) - 2,"9999"))
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum) - 1,"9999"))
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum),"9999"))
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum) + 1,"9999"))
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum) + 2,"9999"))
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum) + 3,"9999")).
   ASSIGN
   status-ok = CMB_AR:DELETE("0")
   CMB_AR:SCREEN-VALUE = STRING(YEAR(regdatum),"9999")
   CMB_AR = INPUT CMB_AR.
   RUN manad_UI. /*LADDAR MÅNADER I CMB_MANAD*/
   RUN enable_UI.
   RUN laddadag_UI. /*LADDAR DAGAR I FILL-IN-FÄLT*/       

   {DIA_M_SLUT.I}
   WAIT-FOR GO OF FRAME {&FRAME-NAME}.
END.
RUN disable_UI.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


/* **********************  Internal Procedures  *********************** */

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE dagar_UI DIALOG-1 
PROCEDURE dagar_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   /*vilken dag är den första i månaden*/
   
   DEFINE VARIABLE datumnr AS INTEGER NO-UNDO.
   dagraknare = 0.
   REPEAT:
      dagraknare = dagraknare + 1.
      IF dagraknare > 7 THEN LEAVE.
      datumenh[dagraknare]:HIDDEN = TRUE.
   END.
   IF regdagnamn = "MÅN" THEN DO:
      dagraknare = 0.
      REPEAT:
         dagraknare = dagraknare + 1.
         IF dagraknare > 7 THEN LEAVE.
         datumenh[dagraknare]:HIDDEN = FALSE.
      END.
   END.      
   ELSE IF regdagnamn = "TIS" THEN DO:
      dagraknare = 1.
      REPEAT:
         dagraknare = dagraknare + 1.
         IF dagraknare > 7 THEN LEAVE.
         datumenh[dagraknare]:HIDDEN = FALSE.
      END.
   END.      
   ELSE IF regdagnamn = "ONS" THEN DO:
      dagraknare = 2.
      REPEAT:
         dagraknare = dagraknare + 1.
         IF dagraknare > 7 THEN LEAVE.
         datumenh[dagraknare]:HIDDEN = FALSE.
      END.
   END.      
   ELSE IF regdagnamn = "TOR" THEN DO:
      dagraknare = 3.
      REPEAT:
         dagraknare = dagraknare + 1.
         IF dagraknare > 7 THEN LEAVE.
         datumenh[dagraknare]:HIDDEN = FALSE.
      END.
   END.      
   ELSE IF regdagnamn = "FRE" THEN DO:
      dagraknare = 4.
      REPEAT:
         dagraknare = dagraknare + 1.
         IF dagraknare > 7 THEN LEAVE.
         datumenh[dagraknare]:HIDDEN = FALSE.
      END.
   END.      
   ELSE IF regdagnamn = "LÖR" THEN DO:
      dagraknare = 5.
      REPEAT:
         dagraknare = dagraknare + 1.
         IF dagraknare > 7 THEN LEAVE.
         datumenh[dagraknare]:HIDDEN = FALSE.
      END.
   END.  
   ELSE IF regdagnamn = "SÖN" THEN DO:
      dagraknare = 6.
      REPEAT:
         dagraknare = dagraknare + 1.
         IF dagraknare > 7 THEN LEAVE.
         datumenh[dagraknare]:HIDDEN = FALSE.
      END.
   END.  
   datumenh[29]:HIDDEN = TRUE.
   datumenh[30]:HIDDEN = TRUE.
   datumenh[31]:HIDDEN = TRUE. 
   datumenh[32]:HIDDEN = TRUE.
   datumenh[33]:HIDDEN = TRUE.
   datumenh[34]:HIDDEN = TRUE. 
   datumenh[35]:HIDDEN = TRUE.
   datumenh[36]:HIDDEN = TRUE.
   datumenh[37]:HIDDEN = TRUE. 
  
   datumnr = 1.   
   dagraknare = 0.
   REPEAT:
      dagraknare = dagraknare + 1.
      IF datumnr > maxdagnr THEN LEAVE.
      IF dagraknare < 8 AND datumenh[dagraknare]:HIDDEN = FALSE THEN datumenh[dagraknare]:SCREEN-VALUE = STRING(datumnr).  
      ELSE IF dagraknare > 7 THEN DO:
         datumenh[dagraknare]:HIDDEN = FALSE.
         datumenh[dagraknare]:SCREEN-VALUE = STRING(datumnr).
      END. 
      datumnr = datumnr + 1.
   END.
   
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE daghandle_UI DIALOG-1 
PROCEDURE daghandle_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE INPUT  PARAMETER dh AS HANDLE NO-UNDO.
   dagraknare = dagraknare + 1.
   ASSIGN 
   datumenh[dagraknare] = dh.
   
  
   
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE disable_UI DIALOG-1  _DEFAULT-DISABLE
PROCEDURE disable_UI :
/*------------------------------------------------------------------------------
  Purpose:     DISABLE the User Interface
  Parameters:  <none>
  Notes:       Here we clean-up the user-interface by deleting
               dynamic widgets we have created and/or hide 
               frames.  This procedure is usually called when
               we are ready to "clean-up" after running.
------------------------------------------------------------------------------*/
  /* Hide all frames. */
  HIDE FRAME DIALOG-1.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE enable_UI DIALOG-1  _DEFAULT-ENABLE
PROCEDURE enable_UI :
/*------------------------------------------------------------------------------
  Purpose:     ENABLE the User Interface
  Parameters:  <none>
  Notes:       Here we display/view/enable the widgets in the
               user-interface.  In addition, OPEN all queries
               associated with each FRAME and BROWSE.
               These statements here are based on the "Other 
               Settings" section of the widget Property Sheets.
------------------------------------------------------------------------------*/
  DISPLAY CMB_AR CMB_MANAD FILL-IN-V-1 FILL-IN-1 FILL-IN-2 FILL-IN-3 FILL-IN-4 
          FILL-IN-5 FILL-IN-6 FILL-IN-7 FILL-IN-V-2 FILL-IN-8 FILL-IN-9 
          FILL-IN-10 FILL-IN-11 FILL-IN-12 FILL-IN-13 FILL-IN-14 FILL-IN-V-3 
          FILL-IN-15 FILL-IN-16 FILL-IN-17 FILL-IN-18 FILL-IN-19 FILL-IN-20 
          FILL-IN-21 FILL-IN-V-4 FILL-IN-22 FILL-IN-23 FILL-IN-24 FILL-IN-25 
          FILL-IN-26 FILL-IN-27 FILL-IN-28 FILL-IN-V-5 FILL-IN-29 FILL-IN-30 
          FILL-IN-31 FILL-IN-32 FILL-IN-33 FILL-IN-34 FILL-IN-35 FILL-IN-V-6 
          FILL-IN-36 FILL-IN-37 
      WITH FRAME DIALOG-1.
  ENABLE CMB_AR CMB_MANAD btn_back-7 btn_over-7 FILL-IN-V-1 FILL-IN-1 FILL-IN-2 
         FILL-IN-3 FILL-IN-4 FILL-IN-5 FILL-IN-6 FILL-IN-7 FILL-IN-V-2 
         FILL-IN-8 FILL-IN-9 FILL-IN-10 FILL-IN-11 FILL-IN-12 FILL-IN-13 
         FILL-IN-14 FILL-IN-V-3 FILL-IN-15 FILL-IN-16 FILL-IN-17 FILL-IN-18 
         FILL-IN-19 FILL-IN-20 FILL-IN-21 FILL-IN-V-4 FILL-IN-22 FILL-IN-23 
         FILL-IN-24 FILL-IN-25 FILL-IN-26 FILL-IN-27 FILL-IN-28 FILL-IN-V-5 
         FILL-IN-29 FILL-IN-30 FILL-IN-31 FILL-IN-32 FILL-IN-33 FILL-IN-34 
         FILL-IN-35 FILL-IN-V-6 FILL-IN-36 FILL-IN-37 
      WITH FRAME DIALOG-1.
  {&OPEN-BROWSERS-IN-QUERY-DIALOG-1}
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE fre_UI DIALOG-1 
PROCEDURE fre_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE Klar_UI DIALOG-1 
PROCEDURE Klar_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE INPUT PARAMETER  dnr AS CHARACTER NO-UNDO.
   
   Guru.GlobalaVariabler:regdatum = DATE(man,INTEGER(dnr),ye).
   APPLY "WINDOW-CLOSE" TO THIS-PROCEDURE.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE laddadag_UI DIALOG-1 
PROCEDURE laddadag_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   ASSIGN
   nyladdning = TRUE  
   ye = CMB_AR.
   IF CMB_MANAD = STRING("januari") THEN DO:
      man = 01.
   END.
   ELSE IF CMB_MANAD = STRING("februari")THEN DO:
      man = 02.
   END.
   ELSE IF CMB_MANAD = STRING("mars")THEN DO:
      man = 03.
   END.
   ELSE IF CMB_MANAD = STRING("april")THEN DO:
      man = 04.
   END.
   ELSE IF CMB_MANAD = STRING("maj")THEN DO:
      man = 05.
   END.
   ELSE IF CMB_MANAD = STRING("juni")THEN DO:
      man = 06.
   END.
   ELSE IF CMB_MANAD = STRING("juli")THEN DO:
      man = 07.
   END.
   ELSE IF CMB_MANAD = STRING("augusti")THEN DO:
      man = 08.
   END.
   ELSE IF CMB_MANAD = STRING("september")THEN DO:
      man = 09.
   END.
   ELSE IF CMB_MANAD = STRING("oktober")THEN DO:
      man = 10.
   END.
   ELSE IF CMB_MANAD = STRING("november")THEN DO:
      man = 11.
   END.
   ELSE IF CMB_MANAD = STRING("december")THEN DO:
      man = 12.
   END.
   regdatum = DATE(man,01,ye).
   RUN REGDAG.P.
   IF CMB_MANAD = STRING("januari") OR CMB_MANAD = STRING("mars") OR 
      CMB_MANAD = STRING("maj") OR CMB_MANAD = STRING("juli") OR 
      CMB_MANAD = STRING("augusti") OR CMB_MANAD = STRING("oktober") OR 
      CMB_MANAD = STRING("december") THEN DO:
      maxdagnr = 31. 
   END.   
   ELSE IF CMB_MANAD = STRING("februari") THEN DO:
      regdatum2 = regdatum + 28.
      IF (SUBSTRING(STRING(regdatum2,"999999"),3,2)) = "02" THEN DO:
         maxdagnr = 29.
      END.   
      ELSE DO:
         maxdagnr = 28.
      END.   
   END.           
   ELSE DO:
      maxdagnr = 30.
   END.
   
   RUN dagar_UI.  
   
   indate = regdatum.
   RUN vnr_UI.
   FILL-IN-V-1 = mregvnr.
   indate = indate + 7.
   RUN vnr_UI.
   FILL-IN-V-2 = mregvnr.
   indate = indate + 7.
   RUN vnr_UI.
   FILL-IN-V-3 = mregvnr.
   indate = indate + 7.
   RUN vnr_UI.
   FILL-IN-V-4 = mregvnr.
   indate = indate + 7.
   RUN vnr_UI.
   FILL-IN-V-5 = mregvnr.
   indate = indate + 7.
   RUN vnr_UI.
   FILL-IN-V-6 = mregvnr.
   
   DISPLAY FILL-IN-V-1  
          FILL-IN-V-2 FILL-IN-V-3 
          FILL-IN-V-4 FILL-IN-V-5 FILL-IN-V-6    
      WITH FRAME DIALOG-1.   
   IF FILL-IN-36:HIDDEN = TRUE THEN FILL-IN-V-6:HIDDEN = TRUE.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE lor_UI DIALOG-1 
PROCEDURE lor_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
     
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE manad_UI DIALOG-1 
PROCEDURE manad_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   IF MONTH(regdatum) = 01 THEN DO:
      CMB_MANAD:SCREEN-VALUE IN FRAME {&FRAME-NAME} = STRING("januari").
   END.   
   ELSE IF MONTH(regdatum) = 02 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("februari").
   END.  
   ELSE IF MONTH(regdatum) = 03 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("mars").
   END.
   ELSE IF MONTH(regdatum) = 04 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("april").
   END.  
   ELSE IF MONTH(regdatum) = 05 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("maj").
   END.
   ELSE IF MONTH(regdatum) = 06 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("juni").
   END.  
   ELSE IF MONTH(regdatum) = 07 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("juli").
   END.
   ELSE IF MONTH(regdatum) = 08 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("augusti").
   END.  
   ELSE IF MONTH(regdatum) = 09 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("september").
   END.
   ELSE IF MONTH(regdatum) = 10 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("oktober").
   END.  
   ELSE IF MONTH(regdatum) = 11 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("november").
   END.
   ELSE IF MONTH(regdatum) = 12 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("december").
   END.       
   CMB_MANAD = INPUT CMB_MANAD. 
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE man_UI DIALOG-1 
PROCEDURE man_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE ons_UI DIALOG-1 
PROCEDURE ons_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE son_UI DIALOG-1 
PROCEDURE son_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
       
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE tis_UI DIALOG-1 
PROCEDURE tis_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE tor_UI DIALOG-1 
PROCEDURE tor_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
      
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE vnr_UI DIALOG-1 
PROCEDURE vnr_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE VARIABLE yr AS INTEGER NO-UNDO.
   DEFINE VARIABLE wn AS INTEGER NO-UNDO.
   DEFINE VARIABLE d1 AS INTEGER NO-UNDO.
   DEFINE VARIABLE dat1 AS DATE NO-UNDO.
   DEFINE VARIABLE yyyyww AS INTEGER NO-UNDO FORMAT "999999".
      
      
   ASSIGN
   yr   = YEAR(indate)
   d1   = WEEKDAY(DATE( 1 , 1 , yr))
   dat1 = (IF d1 LE 5 THEN DATE(1,  3, yr) - d1 
          ELSE DATE(1, 10, yr) - d1 )
   wn   = TRUNCATE((indate - dat1 + 7) / 7 , 0)
   yyyyww = yr * 100 + wn.
   
   IF wn < 1 THEN       /* Week 52 or 53 previous year ? */
   ASSIGN
   yr     = yr - 1
   d1     = WEEKDAY(DATE( 1 , 1 , yr))
   dat1   = (IF d1 LE 5 THEN DATE(1,  3, yr) - d1 ELSE
               DATE(1, 10, yr) - d1 )
   wn     = TRUNCATE((indate - dat1 + 7) / 7 , 0)
   yyyyww = yr * 100 + wn.
   ELSE IF wn > 52 THEN  /* Week 53 this year or week 1 next year ? */
   ASSIGN
   yr     = yr + 1
   d1     = WEEKDAY(DATE( 1 , 1 , yr))
   yyyyww = IF d1 EQ 6 OR d1 EQ 7 OR d1 EQ 1
          THEN (yr - 1) * 100 + 53 ELSE yr * 100 + 1.
   mregvnr = INTEGER(SUBSTRING(STRING(yyyyww,"999999"),5,2)).
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

