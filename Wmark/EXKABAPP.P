/*EXKABAPP.P*/

   DEFINE INPUT PARAMETER valvardnr AS INTEGER NO-UNDO.
   DEFINE INPUT PARAMETER fbeteck AS CHARACTER NO-UNDO.
   DEFINE OUTPUT PARAMETER omravd AS INTEGER NO-UNDO.
   DEFINE OUTPUT PARAMETER aovar AS CHARACTER NO-UNDO.
   DEFINE OUTPUT PARAMETER delnrvar AS INTEGER NO-UNDO.
   DEFINE OUTPUT PARAMETER ortvar AS CHARACTER NO-UNDO.   
   DEFINE OUTPUT PARAMETER fkommun AS CHARACTER NO-UNDO.   
   DEFINE OUTPUT PARAMETER fvaker AS CHARACTER NO-UNDO.   
   ASSIGN
   omravd = 0
   aovar = ?
   delnrvar = ?
   ortvar = "".

   FIND FIRST VARDERING WHERE VARDERING.VARDNR = valvardnr NO-LOCK NO-ERROR.
   IF AVAILABLE VARDERING THEN DO:
      FIND FIRST OMRADETAB WHERE OMRADETAB.OMRADE = VARDERING.OMRADE NO-LOCK NO-ERROR.      
      IF AVAILABLE OMRADETAB THEN DO:
         omravd = OMRADETAB.AVDELNINGNR.
      END.
   END.
   FIND FIRST AOVARD WHERE AOVARD.VARDNR = valvardnr USE-INDEX VARDNR NO-LOCK NO-ERROR.
   IF AVAILABLE AOVARD THEN DO:
      ASSIGN aovar = AOVARD.AONR
      delnrvar = AOVARD.DELNR.
      FIND FIRST AONRTAB WHERE AONRTAB.AONR = AOVARD.AONR AND
      AONRTAB.DELNR = AOVARD.DELNR NO-LOCK NO-ERROR.
      IF AVAILABLE AONRTAB  THEN DO:
         ortvar = AONRTAB.ORT.
      END.
   END.
   FIND FIRST FASTIGHET WHERE FASTIGHET.BETECKNING = fbeteck NO-LOCK NO-ERROR.
   IF AVAILABLE FASTIGHET THEN DO:   
      fkommun = FASTIGHET.KOMMUN.
      fvaker = FASTIGHET.VAKER.
   END.

   

   
