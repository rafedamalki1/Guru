/*
     Filename: TIDLAGAPP.P
      Created: 03.09.0001 09:26ELPAO     
     Modified: 
*/               
                     

DEFINE TEMP-TABLE tidslagtemp NO-UNDO
   FIELD AKTIVITET1  AS CHARACTER 
   FIELD AKTIVITET2  AS CHARACTER 
   FIELD DATUM1      AS DATE       FORMAT "99/99/99" INITIAL ?
   FIELD DATUM2      AS DATE       FORMAT "99/99/99" INITIAL ?
   FIELD TIDLAGE     AS CHARACTER 
   FIELD IDTIDLAG    AS CHARACTER 
   FIELD AUTOMATISKT AS LOGICAL    FORMAT "Auto/Man" INITIAL FALSE
   INDEX IDTIDLAGE IS PRIMARY IDTIDLAG TIDLAGE
   INDEX TIDLAGE TIDLAGE IDTIDLAG.
                                      
                                      
PROCEDURE nytidlag_UI:
   DEFINE INPUT PARAMETER idtidlag AS CHARACTER NO-UNDO.
   DEFINE INPUT PARAMETER TABLE FOR tidslagtemp.
   
   FIND FIRST TIDSLAGEN WHERE TIDSLAGEN.IDTIDLAG = idtidlag NO-LOCK NO-ERROR.
   IF NOT AVAILABLE TIDSLAGEN THEN DO:
      FIND FIRST tidslagtemp WHERE tidslagtemp.IDTIDLAG = idtidlag NO-LOCK NO-ERROR.
      IF AVAILABLE tidslagtemp THEN DO:
         CREATE TIDSLAGEN.
         BUFFER-COPY tidslagtemp TO TIDSLAGEN.
      END.
   END.
   IF AVAILABLE TIDSLAGEN THEN RELEASE TIDSLAGEN.
END PROCEDURE.

PROCEDURE andratidlag_UI:
   DEFINE INPUT PARAMETER idtidlag AS CHARACTER NO-UNDO.
   DEFINE INPUT PARAMETER TABLE FOR tidslagtemp.

   DO TRANSACTION:
      FIND FIRST TIDSLAGEN WHERE TIDSLAGEN.IDTIDLAG = idtidlag EXCLUSIVE-LOCK NO-ERROR.
      IF AVAILABLE TIDSLAGEN THEN DO:
         FIND FIRST tidslagtemp WHERE tidslagtemp.IDTIDLAG = idtidlag NO-LOCK NO-ERROR.
         IF AVAILABLE tidslagtemp THEN DO:
            ASSIGN
            TIDSLAGEN.TIDLAGE = tidslagtemp.TIDLAGE
            TIDSLAGEN.AKTIVITET1 = tidslagtemp.AKTIVITET1
            TIDSLAGEN.AKTIVITET2 = tidslagtemp.AKTIVITET2.
         END.
      END.
   END.
   IF AVAILABLE TIDSLAGEN THEN RELEASE TIDSLAGEN.

END PROCEDURE.

PROCEDURE taborttidlag_UI:
   DEFINE INPUT PARAMETER idtidlag AS CHARACTER NO-UNDO.

   DO TRANSACTION:
      FIND FIRST TIDSLAGEN WHERE TIDSLAGEN.IDTIDLAG = idtidlag EXCLUSIVE-LOCK NO-ERROR.
      IF AVAILABLE TIDSLAGEN THEN DO:
         DELETE TIDSLAGEN.
      END.
   END.
END PROCEDURE.
