DEFINE NEW SHARED TEMP-TABLE tabnamn NO-UNDO
   FIELD NAMN AS CHARACTER
   INDEX NAMN IS PRIMARY NAMN.
DEFINE VARIABLE qh AS HANDLE NO-UNDO.
DEFINE VARIABLE bh AS HANDLE NO-UNDO.
DEFINE VARIABLE falth AS HANDLE NO-UNDO.
DEFINE VARIABLE tabvar AS CHARACTER NO-UNDO.
DEFINE VARIABLE kommando AS CHARACTER NO-UNDO.
DEFINE VARIABLE felkod AS CHARACTER NO-UNDO.
DEFINE VARIABLE  FILL-IN-DBNAMN AS CHARACTER NO-UNDO.
kommando = "-db sports2000 -s 63 -1".
CONNECT VALUE(kommando) NO-ERROR.
FILL-IN-DBNAMN = "sports2000".
tabvar = FILL-IN-DBNAMN + "._file".
kommando = "FOR EACH " + tabvar + " WHERE " + tabvar + "._FROZEN = FALSE NO-LOCK".
CREATE BUFFER bh FOR TABLE tabvar.
CREATE QUERY qh.
qh:SET-BUFFERS(bh).
qh:QUERY-PREPARE(kommando).   
qh:QUERY-OPEN().
qh:GET-FIRST(NO-LOCK).
DO WHILE bh:AVAILABLE:
   falth = bh:BUFFER-FIELD("_FILE-NAME").
   CREATE tabnamn.
   ASSIGN
   tabnamn.NAMN = falth:BUFFER-VALUE.
   qh:GET-NEXT(NO-LOCK).        
END.
kommando = "-db sports -s 63 -1".
CONNECT VALUE(kommando) NO-ERROR.
FOR EACH tabnamn NO-LOCK:      
   RUN xNYSINGELDB.P (INPUT FILL-IN-DBNAMN,INPUT tabnamn.NAMN,OUTPUT felkod).
END.
