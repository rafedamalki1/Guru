/*INVGAPP.P*/
&Scoped-define NEW NEW
&Scoped-define SHARED SHARED
{GLOBVAR2DEL1.I}

&Scoped-define NEW
&Scoped-define SHARED 

{ANVTEMPS.I}
DEFINE VARIABLE datvar AS DATE NO-UNDO.

DEFINE TEMP-TABLE dat_tab
   FIELD IBDATUM AS DATE.

FIND FIRST FORETAG NO-LOCK NO-ERROR.
ASSIGN Guru.Konstanter:globforetag = FORETAG.FORETAG.
{FORESTYR.I}
{DYNHMT.I}
PROCEDURE dattabhmt_UI :
   DEFINE INPUT PARAMETER vald_depa AS INTEGER NO-UNDO.
   DEFINE INPUT PARAMETER globforetag AS CHARACTER NO-UNDO.
   DEFINE OUTPUT PARAMETER TABLE FOR dat_tab.

   EMPTY TEMP-TABLE dat_tab NO-ERROR.    
   datvar = 01/01/90.  
   OPEN QUERY balans FOR EACH MTRLDEP WHERE MTRLDEP.DEPNR = vald_depa AND 
   MTRLDEP.IBDATUM NE ? BY MTRLDEP.IBDATUM.
   GET FIRST balans NO-LOCK.   
   DO WHILE AVAILABLE(MTRLDEP):
      IF MTRLDEP.IBDATUM NE datvar THEN DO:  
         CREATE dat_tab. 
         ASSIGN
         dat_tab.IBDATUM = MTRLDEP.IBDATUM
         datvar = MTRLDEP.IBDATUM.
      END.   
      GET NEXT balans NO-LOCK.      
   END. 
END PROCEDURE.         

       
