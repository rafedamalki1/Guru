DEFINE INPUT PARAMETER aonrrec AS RECID.
DEFINE INPUT PARAMETER globforetag LIKE FORETAG.FORETAG.
DEFINE VARIABLE mappvar AS CHARACTER NO-UNDO.
DEFINE VARIABLE tlagen AS CHARACTER FORMAT "x(256)" NO-UNDO.

FIND FIRST AONRTAB WHERE RECID(AONRTAB) = aonrrec NO-LOCK NO-ERROR.
IF globforetag = "ELPA" THEN DO:
   mappvar = "\\NTSERVER2\DELAD\NY MAPP\DOKUMENT\" + AONRTAB.AONR + "000".            
END.
ELSE IF LDBNAME(1) = "GRANNORD" THEN DO:
   mappvar = "\\DOKUGRAN\DOKUMENT\NÄT (N)\GURU\DOKUMENT\GRAN\" + AONRTAB.AONR + STRING(AONRTAB.DELNR) + "\".         
END.
ELSE IF (globforetag = "GRAN" AND LDBNAME(1) = "UTBI") THEN DO:
   mappvar = "\\DOKUGRAN\DOKUMENT\NÄT (N)\GURU\DOKUMENT\GRANUTBI\" + AONRTAB.AONR + STRING(AONRTAB.DELNR) + "\".         
END.
ELSE IF LDBNAME(1) = "GRANIT" THEN DO:
   mappvar = "\\DOKUGRAN\DOKUMENT\NÄT (N)\GURU\DOKUMENT\GRANIT\" + AONRTAB.AONR + STRING(AONRTAB.DELNR) + "\".         
END.
ELSE IF LDBNAME(1) = "GRANADM9" THEN DO:
   mappvar = "\\DOKUGRAN\DOKUMENT\NÄT (N)\GURU\DOKUMENT\GRANADM\" + AONRTAB.AONR + STRING(AONRTAB.DELNR) + "\".         
END.
ELSE IF LDBNAME(1) = "GRANSOL" THEN DO:
   mappvar = "\\DOKUGRAN\DOKUMENT\NÄT (N)\GURU\DOKUMENT\GRANSOL\" + AONRTAB.AONR + STRING(AONRTAB.DELNR) + "\".         
END.            
ELSE DO:
   mappvar = SESSION:TEMP-DIRECTORY.
END.    

mappvar = mappvar + "fasttrack.txt".


OUTPUT TO mappvar.


FIND FIRST AONRTIDLAGE WHERE AONRTIDLAGE.AONR = AONRTAB.AONR  AND
AONRTIDLAGE.DELNR = AONRTAB.DELNR AND AONRTIDLAGE.idtidlag = "beredning" NO-LOCK NO-ERROR.
FIND TIDSLAGEN WHERE TIDSLAGEN.IDTIDLAG = "beredning" NO-LOCK NO-ERROR.
/*FIND AONRTAB WHERE AONRTAB.AONR = AONRTIDLAGE.AONR AND
AONRTAB.DELNR = AONRTIDLAG.DELNR NO-LOCK NO-ERROR.*/


tlagen =  AONRTIDLAG.AONR + CHR(9) + SUBSTRING(AONRTAB.ORT,1,40) + CHR(9) +
TIDSLAGEN.TIDLAGE + " " + TIDSLAGEN.AKTIVITET1 + CHR(9) 
 + STRING(AONRTIDLAGE.DATUM1,"9999-99-99").

PUT  tlagen.
