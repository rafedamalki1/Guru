/*EXTRADATSPECT.P används inte */
{EXTRADATA.I}
DEFINE INPUT PARAMETER vart AS INTEGER NO-UNDO.
DEFINE INPUT-OUTPUT PARAMETER TABLE FOR inextradatatemp.
IF vart = 1 THEN DO:
   FOR EACH inextradatatemp NO-LOCK.
      FIND FIRST FAKTFRIA WHERE FAKTFRIA.TYP = "FAKT" + STRING(inextradatatemp.HUVUDINT) NO-LOCK NO-ERROR.
      IF AVAILABLE FAKTFRIA THEN DO:
         RUN spara_UI.        
         NEXT.
      END.
      FIND FIRST FAKTFRIAKRED WHERE FAKTFRIAKRED.TYP = "FAKT" + STRING(inextradatatemp.HUVUDINT) NO-LOCK NO-ERROR.
      IF AVAILABLE FAKTFRIAKRED THEN DO:
         RUN spara_UI.         
         NEXT.
      END.     
      RUN bort_UI.
   END.     
END.
PROCEDURE bort_UI:
   FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND  
   EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH  AND
   EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT
   EXCLUSIVE-LOCK NO-ERROR.
   IF AVAILABLE EXTRADATA THEN DO:
      DELETE EXTRADATA.
      DELETE inextradatatemp.
   END.
END PROCEDURE.
PROCEDURE spara_UI:
   FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND  
   EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH  AND
   EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT
   EXCLUSIVE-LOCK NO-ERROR.
   IF AVAILABLE EXTRADATA THEN DO:
      BUFFER-COPY inextradatatemp TO EXTRADATA.
   END.
END PROCEDURE.
