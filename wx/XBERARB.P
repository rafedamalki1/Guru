OPEN QUERY AQ for each aonrtab NO-LOCK.
GET FIRST AQ NO-LOCK.
DO WHILE AVAILABLE AONRTAB:
   FIND FIRST BEREDAONR WHERE BEREDAONR.PERSONALKOD = aonrtab.BEREDARE 
   USE-INDEX PERSONALKOD NO-LOCK NO-ERROR.   
   IF NOT AVAILABLE BEREDAONR THEN DO TRANSACTION:      
      FIND FIRST PERSONALTAB WHERE PERSONALTAB.PERSONALKOD = aonrtab.BEREDARE 
      USE-INDEX PERSONALKOD NO-LOCK NO-ERROR.
      IF AVAILABLE PERSONALTAB THEN DO:
      CREATE BEREDAONR.
      ASSIGN BEREDAONR.PERSONALKOD = PERSONALTAB.PERSONALKOD
      BEREDAONR.FORNAMN = PERSONALTAB.FORNAMN
      BEREDAONR.EFTERNAMN = PERSONALTAB.EFTERNAMN.
      END.
      /*ELSE MESSAGE aonrtab.BEREDARE aonrtab.AONR VIEW-AS ALERT-BOX.          */
   END.
   FIND FIRST ANSVAONR WHERE ANSVAONR.PERSONALKOD = aonrtab.ARBANSVARIG 
   USE-INDEX PERSONALKOD NO-LOCK NO-ERROR.   
   IF NOT AVAILABLE ANSVAONR THEN DO TRANSACTION:    
      FIND FIRST PERSONALTAB WHERE PERSONALTAB.PERSONALKOD = aonrtab.ARBANSVARIG 
      USE-INDEX PERSONALKOD NO-LOCK NO-ERROR.
      IF AVAILABLE PERSONALTAB THEN DO:
      CREATE ANSVAONR.
      ASSIGN ANSVAONR.PERSONALKOD = PERSONALTAB.PERSONALKOD
      ANSVAONR.FORNAMN = PERSONALTAB.FORNAMN
      ANSVAONR.EFTERNAMN = PERSONALTAB.EFTERNAMN.  
      END.
/*      ELSE MESSAGE aonrtab.ARBANSVARIG aonrtab.AONR VIEW-AS ALERT-BOX.            */
   END.
   GET NEXT AQ NO-LOCK.
end. 
