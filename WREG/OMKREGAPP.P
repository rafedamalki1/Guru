/*
     Filename: OMKREGAPP.P
      Created: 2003.10.03 08:59ELPAO     
     Modified: 
*/

&SCOPED-DEFINE NEW
&SCOPED-DEFINE SHARED
{OMKOSTNADTEMP.I}

/************************************** OMKREG.W *********************************/              
              
PROCEDURE laddaomkreg_UI:
   DEFINE OUTPUT PARAMETER TABLE FOR omkostnadtemp.

   OPEN QUERY oq FOR EACH OMRADETAB WHERE OMRADETAB.ELVOMRKOD = 0 NO-LOCK, 
      EACH OMKOSTNADTAB WHERE OMKOSTNADTAB.OMRADE = OMRADETAB.OMRADE NO-LOCK 
      BY OMKOSTNADTAB.OMRADE BY OMKOSTNADTAB.ANSTALL.
   GET FIRST oq NO-LOCK.
   DO WHILE AVAILABLE OMKOSTNADTAB.
      CREATE omkostnadtemp.
      BUFFER-COPY OMKOSTNADTAB TO omkostnadtemp.
      omkostnadtemp.NAMN = OMRADETAB.NAMN.
      GET NEXT oq NO-LOCK.
   END.
END PROCEDURE.

PROCEDURE sparaomkreg_UI:
   DEFINE INPUT PARAMETER TABLE FOR omkostnadtemp.

   FOR EACH omkostnadtemp:
      DO TRANSACTION:
         FIND FIRST OMKOSTNADTAB WHERE OMKOSTNADTAB.OMRADE = omkostnadtemp.OMRADE AND
            OMKOSTNADTAB.ANSTALL = omkostnadtemp.ANSTALL EXCLUSIVE-LOCK NO-ERROR.
         IF AVAILABLE OMKOSTNADTAB THEN DO:
            BUFFER-COPY omkostnadtemp TO OMKOSTNADTAB.
         END.
      END.      
   END.
   IF AVAILABLE OMKOSTNADTAB THEN RELEASE OMKOSTNADTAB.
END PROCEDURE.
