/*UTOVUTAPP.P*/
{STARTFORAPP.I}
&Scoped-define NEW    
&Scoped-define SHARED 
{FLEXTAB.I}
/*&Scoped-define NEW NEW
&Scoped-define SHARED SHARED
{GLOBVAR2DEL1.I}*/

PROCEDURE hmtutreg_UI:   
   DEFINE INPUT PARAMETER vem AS CHARACTER NO-UNDO.   
   DEFINE OUTPUT PARAMETER TABLE FOR flextemp.         
   EMPTY TEMP-TABLE flextemp NO-ERROR.    
      
   OPEN QUERY fq FOR EACH FLEXTID WHERE 
   FLEXTID.PERSONALKOD = vem AND
   /*FLEXTID.DATUM = regdatum AND*/ FLEXTID.KNAPP = "Ut" AND FLEXTID.KORD = 01/01/1997 AND FLEXTID.DATUM GE 01/01/2006 USE-INDEX FLEX NO-LOCK.    
   GET FIRST fq NO-LOCK.
   DO WHILE AVAILABLE(FLEXTID):
      IF FLEXTID.AUTO = "PERI" THEN .
      ELSE DO:      
         CREATE flextemp.
         BUFFER-COPY FLEXTID TO flextemp.
         flextemp.FREC = RECID(FLEXTID).
         Guru.GlobalaVariabler:GDPRvem = Guru.GlobalaVariabler:GDPRvem + "," + FLEXTID.PERSONALKOD.
   
      END.
      GET NEXT fq NO-LOCK.
   END. 
   {GDPRLOGGCLIENT.I}  
 END PROCEDURE.

/* PROCEDURE flexkoll_UI:   
   DEFINE INPUT PARAMETER vem AS CHARACTER NO-UNDO.   
   DEFINE OUTPUT PARAMETER TABLE FOR felmeddtemp. 
   EMPTY TEMP-TABLE felmeddtemp NO-ERROR.    
   FIND FIRST PERSONALTAB WHERE PERSONALTAB.PERSONALKOD = vem USE-INDEX PERSONALKOD NO-LOCK NO-ERROR.
   IF AVAILABLE PERSONALTAB THEN DO:
      FIND FIRST FLEXDAG WHERE FLEXDAG.PERSONALKOD = PERSONALTAB.PERSONALKOD AND 
      FLEXDAG.KORD = 01/01/1997 AND FLEXDAG.FELOK = FALSE AND FLEXDAG.KONTROLL = "KONTROLL" AND 
      FLEXDAG.DATUM < TODAY USE-INDEX FLEX NO-LOCK NO-ERROR.        
      IF AVAILABLE FLEXDAG THEN DO:       
          CREATE felmeddtemp.  
          ASSIGN               
          felmeddtemp.FELMEDD = "Du saknar en eller flera stämplingar! Var god kontrollera och åtgärda.".                        
      END.
   END.
   
 END PROCEDURE.*/






