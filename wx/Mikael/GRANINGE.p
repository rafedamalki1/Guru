
DEFINE VARIABLE aonrvar AS CHARACTER NO-UNDO.
DEFINE VARIABLE delnrvar AS INTEGER NO-UNDO.

REPEAT:
   UPDATE aonrvar delnrvar WITH FRAME cc.
   IF aonrvar = "x" THEN LEAVE.
   DO TRANSACTION:
      FIND FIRST AONRTAB WHERE AONRTAB.AONR = aonrvar AND AONRTAB.DELNR = delnrvar
      EXCLUSIVE-LOCK NO-ERROR.
      IF AVAILABLE AONRTAB THEN DO:
         ASSIGN 
         AONRTAB.OMRADE = "76".
         OPEN QUERY aq FOR EACH AONRKONTKOD WHERE 
         AONRKONTKOD.AONR = AONRTAB.AONR  AND AONRKONTKOD.DELNR = AONRTAB.DELNR
         NO-LOCK.
         GET FIRST aq NO-LOCK.
         DO WHILE AVAILABLE(AONRKONTKOD):
            GET CURRENT aq EXCLUSIVE-LOCK.
            ASSIGN 
            AONRKONTKOD.K1 = "076".
            GET NEXT aq NO-LOCK.
         END.
      END.
   END.
END.
