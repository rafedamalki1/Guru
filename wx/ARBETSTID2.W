&ANALYZE-SUSPEND _VERSION-NUMBER UIB_v9r12 GUI
&ANALYZE-RESUME
/* Connected Databases 
          temp-db          PROGRESS
*/
&Scoped-define WINDOW-NAME C-Win





&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CUSTOM _DEFINITIONS C-Win 
/*------------------------------------------------------------------------

  File: 

  Description: 

  Input Parameters:
      <none>

  Output Parameters:
      <none>

  Author: 

  Created: 

------------------------------------------------------------------------*/
/*          This .W file was created with the Progress AppBuilder.      */
/*----------------------------------------------------------------------*/

/* Create an unnamed pool to store all the widgets created 
     by this procedure. This is a good default which assures
     that this procedure's triggers and internal procedures 
     will execute in this procedure's storage, and that proper
     cleanup will occur on deletion of the procedure. */

CREATE WIDGET-POOL.

/* ***************************  Definitions  ************************** */

/* Parameters Definitions ---                                           */
DEFINE INPUT PARAMETER perskod AS CHARACTER NO-UNDO.
/* Local Variable Definitions ---                                       */
{ALLDEF.I}
{GLOBVAR2DEL1.I}
/*{EGENBEN.I}*/
&Scoped-define NEW 
&Scoped-define SHARED SHARED
{REGVAR.I}
{PHMT.I}
{OMRTEMPW.I}
&Scoped-define NEW
&Scoped-define SHARED
{RHMT.I}
{VHMT.I}
{DHMT.I}
{KLOCKBER.I}
DEFINE NEW SHARED VARIABLE arbproch AS HANDLE NO-UNDO. /* ARBETSTIDAPP.P */
DEFINE NEW SHARED VARIABLE musz AS LOGICAL NO-UNDO.
DEFINE VARIABLE vecnr AS INTEGER NO-UNDO.
DEFINE VARIABLE pkod AS CHARACTER NO-UNDO.
DEFINE VARIABLE tmpdate AS DATE FORMAT "99/99/9999" NO-UNDO.
DEFINE VARIABLE arregvnr AS INTEGER NO-UNDO.
DEFINE VARIABLE varslutdat AS DATE FORMAT "99/99/9999" NO-UNDO.
DEFINE VARIABLE varschema AS INTEGER FORMAT ">99" NO-UNDO.
DEFINE VARIABLE valdarec AS RECID NO-UNDO.
DEFINE VARIABLE rulid AS INTEGER FORMAT "x(99)" NO-UNDO.
DEFINE VARIABLE mittdatum AS DATE NO-UNDO.
DEFINE VARIABLE fragval AS LOGICAL NO-UNDO.
DEFINE VARIABLE sparfrag AS LOGICAL NO-UNDO.
DEFINE VARIABLE felmedd AS CHARACTER NO-UNDO.
DEFINE VARIABLE gamlapkod AS CHARACTER NO-UNDO.
DEFINE VARIABLE str AS CHARACTER FORMAT "X(80)" NO-UNDO.
DEFINE VARIABLE rullvrec  AS RECID NO-UNDO.
DEFINE VARIABLE rullscrec  AS RECID NO-UNDO.
{TIDUTTTNEW.I} 
DEFINE TEMP-TABLE extraperstemp NO-UNDO
   FIELD PERSONALKOD AS CHARACTER
   FIELD VECKOSCHEMA AS INTEGER
   FIELD FELMEDD AS CHARACTER
   INDEX PKOD IS PRIMARY PERSONALKOD.

DEFINE TEMP-TABLE dagtemp NO-UNDO
   FIELD DAG AS INTEGER
   FIELD VEC AS INTEGER
   FIELD DAGCMB AS HANDLE
   FIELD BORJFALT AS HANDLE
   FIELD SLUTFALT AS HANDLE
   FIELD TIMFALT AS HANDLE
   INDEX DAG IS PRIMARY DAG.
                            
DEFINE TEMP-TABLE vectemp NO-UNDO
   FIELD VEC AS INTEGER
   FIELD VECFALT AS HANDLE
   FIELD SCHCMB AS HANDLE
   FIELD TOTFALT AS HANDLE
   INDEX VEC IS PRIMARY VEC.

DEFINE TEMP-TABLE vecdagtemp NO-UNDO
   FIELD VEC AS INTEGER
   FIELD ARVNR AS INTEGER
   FIELD VNR AS INTEGER
   FIELD VECSCH AS INTEGER
   FIELD DAGLOG AS LOGICAL
   FIELD DAGSCH AS INTEGER EXTENT 7
   INDEX VEC IS PRIMARY VEC.

DEFINE TEMP-TABLE vperstid NO-UNDO
   FIELD PERSONALKOD AS CHARACTER
   FIELD DAG AS CHARACTER
   FIELD VECKA AS INTEGER
   FIELD DATUM AS DATE
   FIELD REGSTART AS DECIMAL
   FIELD REGSLUT  AS DECIMAL
   FIELD REGTOTALT AS DECIMAL
   FIELD FRUSTART  AS DECIMAL
   FIELD FRUSLUT   AS DECIMAL
   FIELD KAFFESTART AS DECIMAL
   FIELD KAFFESLUT  AS DECIMAL
   FIELD LUNCHSTART AS DECIMAL
   FIELD LUNCHSLUT  AS DECIMAL
   INDEX PKOD PERSONALKOD DATUM.
DEFINE BUFFER arbma FOR arbtidtemp.
DEFINE BUFFER arbti FOR arbtidtemp.
DEFINE BUFFER arbon FOR arbtidtemp.
DEFINE BUFFER arbto FOR arbtidtemp.
DEFINE BUFFER arbfr FOR arbtidtemp.
DEFINE BUFFER arblo FOR arbtidtemp.
DEFINE BUFFER arbso FOR arbtidtemp.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-PREPROCESSOR-BLOCK 

/* ********************  Preprocessor Definitions  ******************** */

&Scoped-define PROCEDURE-TYPE Window
&Scoped-define DB-AWARE no

/* Name of designated FRAME-NAME and/or first browse and/or first query */
&Scoped-define FRAME-NAME DEFAULT-FRAME
&Scoped-define BROWSE-NAME BRW_ORD

/* Internal Tables (found by Frame, Query & Browse Queries)             */
&Scoped-define INTERNAL-TABLES valperstemp rullperstemp rullvectemp

/* Definitions for BROWSE BRW_ORD                                       */
&Scoped-define FIELDS-IN-QUERY-BRW_ORD valperstemp.PERSONALKOD ~
valperstemp.VECKOSCHEMA valperstemp.FORNAMN valperstemp.EFTERNAMN 
&Scoped-define ENABLED-FIELDS-IN-QUERY-BRW_ORD 
&Scoped-define QUERY-STRING-BRW_ORD FOR EACH valperstemp NO-LOCK
&Scoped-define OPEN-QUERY-BRW_ORD OPEN QUERY BRW_ORD FOR EACH valperstemp NO-LOCK.
&Scoped-define TABLES-IN-QUERY-BRW_ORD valperstemp
&Scoped-define FIRST-TABLE-IN-QUERY-BRW_ORD valperstemp


/* Definitions for BROWSE BRW_RULLPERS                                  */
&Scoped-define FIELDS-IN-QUERY-BRW_RULLPERS rullperstemp.PERSONALKOD ~
rullperstemp.RULLID rullperstemp.ORDNING rullperstemp.STARTDATUM ~
rullperstemp.SLUTDATUM rullperstemp.ANVANDARE rullperstemp.ANDDATUM 
&Scoped-define ENABLED-FIELDS-IN-QUERY-BRW_RULLPERS 
&Scoped-define QUERY-STRING-BRW_RULLPERS FOR EACH rullperstemp NO-LOCK
&Scoped-define OPEN-QUERY-BRW_RULLPERS OPEN QUERY BRW_RULLPERS FOR EACH rullperstemp NO-LOCK.
&Scoped-define TABLES-IN-QUERY-BRW_RULLPERS rullperstemp
&Scoped-define FIRST-TABLE-IN-QUERY-BRW_RULLPERS rullperstemp


/* Definitions for BROWSE BRW_RULLVEC                                   */
&Scoped-define FIELDS-IN-QUERY-BRW_RULLVEC rullvectemp.ORDNING ~
rullvectemp.VECKOSCHEMA 
&Scoped-define ENABLED-FIELDS-IN-QUERY-BRW_RULLVEC 
&Scoped-define QUERY-STRING-BRW_RULLVEC FOR EACH rullvectemp NO-LOCK
&Scoped-define OPEN-QUERY-BRW_RULLVEC OPEN QUERY BRW_RULLVEC FOR EACH rullvectemp NO-LOCK.
&Scoped-define TABLES-IN-QUERY-BRW_RULLVEC rullvectemp
&Scoped-define FIRST-TABLE-IN-QUERY-BRW_RULLVEC rullvectemp


/* Definitions for FRAME DEFAULT-FRAME                                  */

/* Standard List Definitions                                            */
&Scoped-Define ENABLED-OBJECTS RECT-21 RECT-47 RECT-48 RAD_VAL CMB_RUL ~
CMB_VEC CMB_ORD BTN_STARTVF BTN_SLUTVF BTN_SKAPA FILL-IN_STARTVNR ~
FILL-IN_SLUTVNR BTN_AKTVEC BTN_CLEAR BTN_STARTVB BTN_SLUTVB BRW_ORD ~
BRW_RULLPERS BRW_RULLVEC BTN_VRULL BTN_VASCH FILL-IN_SFORNAMN ~
FILL-IN_SPERSONALKOD FILL-IN_SEFTERNAMN BTN_BORT BTN_AVB FILL-IN-RUBR1 ~
FILL-IN-VALDA FILL-IN_FORNAMN FILL-IN_TEXT FILL-IN_EFTERNAMN FILL-IN_OMRADE 
&Scoped-Define DISPLAYED-OBJECTS RAD_VAL CMB_VEC FILL-IN_STARTVNR ~
FILL-IN_SLUTVNR FILL-IN_SFORNAMN FILL-IN_SPERSONALKOD FILL-IN_SEFTERNAMN ~
FILL-IN-RUBR1 FILL-IN-VALDA FILL-IN_PERSON FILL-IN_FORNAMN FILL-IN_TEXT ~
FILL-IN_EFTERNAMN FILL-IN_OMRADE 

/* Custom List Definitions                                              */
/* List-1,List-2,List-3,List-4,List-5,List-6                            */

/* _UIB-PREPROCESSOR-BLOCK-END */
&ANALYZE-RESUME



/* ***********************  Control Definitions  ********************** */

/* Define the widget handle for the window                              */
DEFINE VAR C-Win AS WIDGET-HANDLE NO-UNDO.

/* Definitions of the field level widgets                               */
DEFINE BUTTON BTN_AKTVEC 
     LABEL "?" 
     SIZE 2.5 BY .75 TOOLTIP "Ger aktuell startvecka.".

DEFINE BUTTON BTN_AVB 
     LABEL "Avsluta" 
     SIZE 14 BY 1.

DEFINE BUTTON BTN_BORT 
     LABEL "Ta bort" 
     SIZE 12 BY 1.

DEFINE BUTTON BTN_CLEAR 
     LABEL "?" 
     SIZE 2.5 BY .75 TOOLTIP "Om det inte finns något slutdatum.".

DEFINE BUTTON BTN_SKAPA 
     LABEL "Koppla" 
     SIZE 12 BY 1.

DEFINE BUTTON BTN_SLUTVB 
     LABEL "-" 
     SIZE 2.5 BY .75.

DEFINE BUTTON BTN_SLUTVF 
     LABEL "+" 
     SIZE 2.5 BY .75.

DEFINE BUTTON BTN_STARTVB 
     LABEL "-" 
     SIZE 2.5 BY .75.

DEFINE BUTTON BTN_STARTVF 
     LABEL "+" 
     SIZE 2.5 BY .75.

DEFINE BUTTON BTN_VASCH 
     LABEL "Visa veckoscheman" 
     SIZE 14 BY 1.

DEFINE BUTTON BTN_VRULL 
     LABEL "Visa rullscheman" 
     SIZE 14 BY 1.

DEFINE VARIABLE CMB_ORD AS INTEGER FORMAT "99":U INITIAL 0 
     LABEL "Ordning" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_RUL AS INTEGER FORMAT "99":U INITIAL 0 
     LABEL "Rullschema" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_VEC AS INTEGER FORMAT ">99":U INITIAL 0 
     LABEL "Veckoschema" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6 BY 1
     FGCOLOR 12  NO-UNDO.

DEFINE VARIABLE FILL-IN-RUBR1 AS CHARACTER FORMAT "X(256)":U INITIAL "Koppla veckoschema angiven vecka och framåt" 
      VIEW-AS TEXT 
     SIZE 49 BY .63
     FGCOLOR 12  NO-UNDO.

DEFINE VARIABLE FILL-IN-VALDA AS INTEGER FORMAT ">>>9":U INITIAL 0 
     LABEL "Antal markerade" 
      VIEW-AS TEXT 
     SIZE 4.5 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN_EFTERNAMN AS CHARACTER FORMAT "X(256)":U 
     LABEL "Efternamn" 
      VIEW-AS TEXT 
     SIZE 20 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN_FORNAMN AS CHARACTER FORMAT "X(256)":U 
     LABEL "Förnamn" 
      VIEW-AS TEXT 
     SIZE 20 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN_OMRADE AS CHARACTER FORMAT "X(256)":U 
     LABEL "Område" 
      VIEW-AS TEXT 
     SIZE 20 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN_PERSON AS CHARACTER FORMAT "X(5)":U 
     LABEL "Enhet/Sign" 
      VIEW-AS TEXT 
     SIZE 6 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN_SEFTERNAMN AS CHARACTER FORMAT "x(25)" 
     LABEL "Efternamn" 
     VIEW-AS FILL-IN 
     SIZE 19.75 BY .83.

DEFINE VARIABLE FILL-IN_SFORNAMN AS CHARACTER FORMAT "x(15)" 
     LABEL "Förnamn" 
     VIEW-AS FILL-IN 
     SIZE 19.75 BY .83.

DEFINE VARIABLE FILL-IN_SLUTVNR AS INTEGER FORMAT "999":U INITIAL 0 
     LABEL "Slutvecka" 
     VIEW-AS FILL-IN 
     SIZE 4.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN_SPERSONALKOD AS CHARACTER FORMAT "x(5)" 
     LABEL "Enhet" 
     VIEW-AS FILL-IN 
     SIZE 6 BY .83.

DEFINE VARIABLE FILL-IN_STARTVNR AS INTEGER FORMAT "999":U INITIAL 0 
     LABEL "Startvecka" 
     VIEW-AS FILL-IN 
     SIZE 4.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN_TEXT AS CHARACTER FORMAT "X(256)":U 
     LABEL "Benämning" 
      VIEW-AS TEXT 
     SIZE 16.63 BY .63 NO-UNDO.

DEFINE VARIABLE RAD_VAL AS INTEGER 
     VIEW-AS RADIO-SET HORIZONTAL
     RADIO-BUTTONS 
          "Ordinarie schema", 1,
"Rullande schema", 2,
"Visning arbetstider", 3
     SIZE 67 BY .71 NO-UNDO.

DEFINE RECTANGLE RECT-21
     EDGE-PIXELS 2 GRAPHIC-EDGE  NO-FILL   
     SIZE 44.5 BY 2.42
     BGCOLOR 8 .

DEFINE RECTANGLE RECT-47
     EDGE-PIXELS 2 GRAPHIC-EDGE  NO-FILL   
     SIZE 34.5 BY 4.75.

DEFINE RECTANGLE RECT-48
     EDGE-PIXELS 2 GRAPHIC-EDGE  NO-FILL   
     SIZE 70 BY 4.75.

DEFINE BUTTON BTN_NER-3 
     IMAGE-UP FILE "BILDER\pilner.bmp":U
     LABEL "" 
     SIZE 4.5 BY 1.63.

DEFINE BUTTON BTN_UPP-3 
     IMAGE-UP FILE "BILDER\pilupp.bmp":U
     LABEL "" 
     SIZE 4.5 BY 1.63.

DEFINE VARIABLE FILL-IN-BOR1V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Börjar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR1V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Börjar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR1V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Börjar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR2V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR2V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR2V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR3V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR3V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR3V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR4V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR4V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR4V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR5V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR5V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR5V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR6V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR6V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR6V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR7V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR7V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR7V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU1V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Slutar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU1V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Slutar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU1V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Slutar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU2V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU2V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU2V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU3V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU3V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU3V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU4V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU4V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU4V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU5V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU5V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU5V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU6V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU6V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU6V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU7V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU7V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU7V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM1V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Tim/Dag" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM1V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Tim/Dag" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM1V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Tim/Dag" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM2V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM2V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM2V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM3V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM3V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM3V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM4V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM4V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM4V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM5V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM5V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM5V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM6V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM6V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM6V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM7V1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM7V2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM7V3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TOTV1A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-TOTV2A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-TOTV3A AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-VNR1A AS INTEGER FORMAT "999":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-VNR2A AS INTEGER FORMAT "999":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-VNR3A AS INTEGER FORMAT "999":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4 BY .63 NO-UNDO.

DEFINE BUTTON BTN_NER-2 
     IMAGE-UP FILE "BILDER\pilner.bmp":U
     LABEL "" 
     SIZE 4.5 BY 1.63.

DEFINE BUTTON BTN_UPP-2 
     IMAGE-UP FILE "BILDER\pilupp.bmp":U
     LABEL "" 
     SIZE 4.5 BY 1.63.

DEFINE VARIABLE CMB_D1V1 AS INTEGER FORMAT ">99":U INITIAL 0 
     LABEL "Dagschema" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D1V2 AS INTEGER FORMAT ">99":U INITIAL 0 
     LABEL "Dagschema" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D1V3 AS INTEGER FORMAT ">99":U INITIAL 0 
     LABEL "Dagschema" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D2V1 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D2V2 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D2V3 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D3V1 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D3V2 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D3V3 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D4V1 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D4V2 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D4V3 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D5V1 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D5V2 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D5V3 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D6V1 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D6V2 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D6V3 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D7V1 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D7V2 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_D7V3 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE CMB_VNR1 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 12  NO-UNDO.

DEFINE VARIABLE CMB_VNR2 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 12  NO-UNDO.

DEFINE VARIABLE CMB_VNR3 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.13 BY 1
     FGCOLOR 12  NO-UNDO.

DEFINE VARIABLE FILL-IN-2 AS CHARACTER FORMAT "X(256)":U INITIAL "Byte tillfälligt" 
      VIEW-AS TEXT 
     SIZE 17 BY .63
     FGCOLOR 12  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR1V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Börjar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR1V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Börjar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR1V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Börjar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR2V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR2V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR2V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR3V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR3V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR3V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR4V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR4V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR4V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR5V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR5V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR5V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR6V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR6V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR6V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR7V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR7V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-BOR7V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-RUBR3 AS CHARACTER FORMAT "X(256)":U INITIAL "veckoschema/dagschema" 
      VIEW-AS TEXT 
     SIZE 21.5 BY .63
     FGCOLOR 12  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU1V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Slutar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU1V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Slutar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU1V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Slutar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU2V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU2V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU2V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU3V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU3V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU3V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU4V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU4V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU4V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU5V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU5V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU5V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU6V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU6V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU6V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU7V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU7V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU7V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM1V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Tim/Dag" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM1V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Tim/Dag" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM1V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Tim/Dag" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM2V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM2V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM2V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM3V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM3V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM3V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM4V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM4V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM4V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM5V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM5V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM5V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM6V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM6V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM6V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM7V1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM7V2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM7V3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TOTV1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-TOTV2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-TOTV3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-VNR1 AS INTEGER FORMAT "999":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-VNR2 AS INTEGER FORMAT "999":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-VNR3 AS INTEGER FORMAT "999":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-AB1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Arbetets början" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-AB2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-AB3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-AB4 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-AB5 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-AB6 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-AB7 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 1  NO-UNDO.

DEFINE VARIABLE FILL-IN-AS1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Arbetets slut" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-AS2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-AS3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-AS4 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-AS5 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-AS6 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-AS7 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 3  NO-UNDO.

DEFINE VARIABLE FILL-IN-D1 AS INTEGER FORMAT ">99":U INITIAL 0 
     LABEL "Dagschema" 
      VIEW-AS TEXT 
     SIZE 4.5 BY .63
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE FILL-IN-D2 AS INTEGER FORMAT ">99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4.5 BY .63
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE FILL-IN-D3 AS INTEGER FORMAT ">99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4.5 BY .63
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE FILL-IN-D4 AS INTEGER FORMAT ">99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4 BY .63
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE FILL-IN-D5 AS INTEGER FORMAT ">99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4.5 BY .63
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE FILL-IN-D6 AS INTEGER FORMAT ">99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4.5 BY .63
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE FILL-IN-D7 AS INTEGER FORMAT ">99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4.5 BY .63
     FGCOLOR 5  NO-UNDO.

DEFINE VARIABLE FILL-IN-FB1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Frukost börjar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FB2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FB3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FB4 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FB5 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FB6 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FB7 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FS1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Frukost slutar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FS2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FS3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FS4 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FS5 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FS6 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-FS7 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KB1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Kafferast börjar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KB2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KB3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KB4 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KB5 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KB6 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KB7 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KS1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Kafferast slutar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KS2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KS3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KS4 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KS5 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KS6 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-KS7 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LB1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Lunch börjar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LB2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LB3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LB4 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LB5 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LB6 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LB7 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LS1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Lunch slutar" 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LS2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LS3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LS4 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LS5 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LS6 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-LS7 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Tim/Dag" 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM4 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM5 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM6 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM7 AS DECIMAL FORMAT "99.99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 7 BY .63
     FGCOLOR 4  NO-UNDO.

DEFINE VARIABLE FILL-IN-VECO1 AS INTEGER FORMAT ">99":U INITIAL 0 
      VIEW-AS TEXT 
     SIZE 4.5 BY .63
     FGCOLOR 12  NO-UNDO.

/* Query definitions                                                    */
&ANALYZE-SUSPEND
DEFINE QUERY BRW_ORD FOR 
      valperstemp SCROLLING.

DEFINE QUERY BRW_RULLPERS FOR 
      rullperstemp SCROLLING.

DEFINE QUERY BRW_RULLVEC FOR 
      rullvectemp SCROLLING.
&ANALYZE-RESUME

/* Browse definitions                                                   */
DEFINE BROWSE BRW_ORD
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _DISPLAY-FIELDS BRW_ORD C-Win _STRUCTURED
  QUERY BRW_ORD NO-LOCK DISPLAY
      valperstemp.PERSONALKOD COLUMN-LABEL "Enhet/!Sign" FORMAT "x(5)":U
            WIDTH 7
      valperstemp.VECKOSCHEMA COLUMN-LABEL "Vecko-!schema" FORMAT ">99":U
      valperstemp.FORNAMN COLUMN-LABEL "Förnamn" FORMAT "x(256)":U
            WIDTH 12.5
      valperstemp.EFTERNAMN COLUMN-LABEL "Efternamn" FORMAT "x(256)":U
            WIDTH 19
/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME
    WITH NO-ROW-MARKERS NO-COLUMN-SCROLLING MULTIPLE SIZE 44.5 BY 8
         TITLE "Personal".

DEFINE BROWSE BRW_RULLPERS
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _DISPLAY-FIELDS BRW_RULLPERS C-Win _STRUCTURED
  QUERY BRW_RULLPERS NO-LOCK DISPLAY
      rullperstemp.PERSONALKOD COLUMN-LABEL "Enhet/!Sign" FORMAT "X(5)":U
            WIDTH 7
      rullperstemp.RULLID COLUMN-LABEL "Rull-!schema" FORMAT "99":U
      rullperstemp.ORDNING COLUMN-LABEL "Ordning" FORMAT "99":U
      rullperstemp.STARTDATUM COLUMN-LABEL "Startdatum" FORMAT "9999/99/99":U
      rullperstemp.SLUTDATUM COLUMN-LABEL "Slutdatum" FORMAT "9999/99/99":U
      rullperstemp.ANVANDARE COLUMN-LABEL "Ändrad av" FORMAT "X(8)":U
      rullperstemp.ANDDATUM COLUMN-LABEL "Datum" FORMAT "99/99/99":U
/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME
    WITH NO-ROW-MARKERS NO-COLUMN-SCROLLING MULTIPLE SIZE 45.25 BY 8
         TITLE "Kopplade rullande schema".

DEFINE BROWSE BRW_RULLVEC
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _DISPLAY-FIELDS BRW_RULLVEC C-Win _STRUCTURED
  QUERY BRW_RULLVEC NO-LOCK DISPLAY
      rullvectemp.ORDNING COLUMN-LABEL "Ordning" FORMAT "99":U
      rullvectemp.VECKOSCHEMA COLUMN-LABEL "Veckoschema" FORMAT ">99":U
/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME
    WITH NO-ROW-MARKERS NO-COLUMN-SCROLLING SIZE 18.5 BY 8
         TITLE "Rullande schema".


/* ************************  Frame Definitions  *********************** */

DEFINE FRAME DEFAULT-FRAME
     RAD_VAL AT ROW 2.21 COL 37.5 NO-LABEL
     CMB_RUL AT ROW 3 COL 48.5 COLON-ALIGNED
     CMB_VEC AT ROW 3 COL 48.5 COLON-ALIGNED
     CMB_ORD AT ROW 3 COL 58
     BTN_STARTVF AT ROW 4 COL 55.63
     BTN_SLUTVF AT ROW 4 COL 79
     BTN_SKAPA AT ROW 4 COL 92.25
     FILL-IN_STARTVNR AT ROW 4.29 COL 48.5 COLON-ALIGNED
     FILL-IN_SLUTVNR AT ROW 4.29 COL 71.5 COLON-ALIGNED
     BTN_AKTVEC AT ROW 4.38 COL 58.5
     BTN_CLEAR AT ROW 4.38 COL 81.88
     BTN_STARTVB AT ROW 4.88 COL 55.63
     BTN_SLUTVB AT ROW 4.88 COL 79
     BRW_ORD AT ROW 18.17 COL 1.5
     BRW_RULLPERS AT ROW 18.17 COL 46.5
     BRW_RULLVEC AT ROW 18.17 COL 92.25
     BTN_VRULL AT ROW 18.75 COL 111.5
     BTN_VASCH AT ROW 20.75 COL 111.5
     FILL-IN_SFORNAMN AT ROW 26.58 COL 23.88 COLON-ALIGNED
     FILL-IN_SPERSONALKOD AT ROW 27.58 COL 7 COLON-ALIGNED
     FILL-IN_SEFTERNAMN AT ROW 27.58 COL 23.88 COLON-ALIGNED
     BTN_BORT AT ROW 27.67 COL 69.13
     BTN_AVB AT ROW 27.67 COL 111.5
     FILL-IN-RUBR1 AT ROW 1.25 COL 37.5 COLON-ALIGNED NO-LABEL
     FILL-IN-VALDA AT ROW 1.5 COL 28.13 COLON-ALIGNED
     FILL-IN_PERSON AT ROW 1.54 COL 11.63 COLON-ALIGNED
     FILL-IN_FORNAMN AT ROW 2.5 COL 11.63 COLON-ALIGNED
     FILL-IN_TEXT AT ROW 3.17 COL 86.13 COLON-ALIGNED
     FILL-IN_EFTERNAMN AT ROW 3.46 COL 11.63 COLON-ALIGNED
     FILL-IN_OMRADE AT ROW 4.42 COL 11.63 COLON-ALIGNED
     "Sök på:" VIEW-AS TEXT
          SIZE 9.88 BY .83 AT ROW 26.5 COL 3.13
     RECT-21 AT ROW 26.25 COL 1.5
     RECT-47 AT ROW 1 COL 1
     RECT-48 AT ROW 1 COL 35.5
    WITH 1 DOWN NO-BOX KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1 ROW 1
         SIZE 124.88 BY 27.92.

DEFINE FRAME FRAME-ARB
     BTN_UPP-3 AT ROW 4.63 COL 102.25 WIDGET-ID 12
     BTN_NER-3 AT ROW 8.63 COL 102.25 WIDGET-ID 10
     FILL-IN-TOTV1A AT ROW 3.04 COL 89.5 COLON-ALIGNED NO-LABEL WIDGET-ID 2
     FILL-IN-VNR1A AT ROW 3.13 COL 4 NO-LABEL
     FILL-IN-BOR1V1A AT ROW 3.17 COL 28.13 COLON-ALIGNED
     FILL-IN-BOR2V1A AT ROW 3.17 COL 37.13 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR3V1A AT ROW 3.17 COL 46.13 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR4V1A AT ROW 3.17 COL 55.13 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR5V1A AT ROW 3.17 COL 64.13 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR6V1A AT ROW 3.17 COL 73.13 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR7V1A AT ROW 3.17 COL 82.13 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU1V1A AT ROW 3.88 COL 28.13 COLON-ALIGNED
     FILL-IN-SLU2V1A AT ROW 3.88 COL 37.13 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU3V1A AT ROW 3.88 COL 46.13 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU4V1A AT ROW 3.88 COL 55.13 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU5V1A AT ROW 3.88 COL 64.13 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU6V1A AT ROW 3.88 COL 73.13 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU7V1A AT ROW 3.88 COL 82.13 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM1V1A AT ROW 4.58 COL 28.13 COLON-ALIGNED
     FILL-IN-TIM2V1A AT ROW 4.58 COL 37.13 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM3V1A AT ROW 4.58 COL 46.13 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM4V1A AT ROW 4.58 COL 55.13 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM5V1A AT ROW 4.58 COL 64.13 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM6V1A AT ROW 4.58 COL 73.13 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM7V1A AT ROW 4.58 COL 82.13 COLON-ALIGNED NO-LABEL
     FILL-IN-TOTV2A AT ROW 6.75 COL 89.63 COLON-ALIGNED NO-LABEL WIDGET-ID 4
     FILL-IN-VNR2A AT ROW 6.79 COL 4.25 NO-LABEL
     FILL-IN-BOR1V2A AT ROW 6.88 COL 28.25 COLON-ALIGNED
     FILL-IN-BOR2V2A AT ROW 6.88 COL 37.25 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR3V2A AT ROW 6.88 COL 46.25 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR4V2A AT ROW 6.88 COL 55.25 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR5V2A AT ROW 6.88 COL 64.25 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR6V2A AT ROW 6.88 COL 73.25 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR7V2A AT ROW 6.88 COL 82.25 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU1V2A AT ROW 7.58 COL 28.25 COLON-ALIGNED
     FILL-IN-SLU2V2A AT ROW 7.58 COL 37.25 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU3V2A AT ROW 7.58 COL 46.25 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU4V2A AT ROW 7.58 COL 55.25 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU5V2A AT ROW 7.58 COL 64.25 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU6V2A AT ROW 7.58 COL 73.25 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU7V2A AT ROW 7.58 COL 82.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM1V2A AT ROW 8.29 COL 28.25 COLON-ALIGNED
     FILL-IN-TIM2V2A AT ROW 8.29 COL 37.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM3V2A AT ROW 8.29 COL 46.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM4V2A AT ROW 8.29 COL 55.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM5V2A AT ROW 8.29 COL 64.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM6V2A AT ROW 8.29 COL 73.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM7V2A AT ROW 8.29 COL 82.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TOTV3A AT ROW 10.46 COL 89.38 COLON-ALIGNED NO-LABEL WIDGET-ID 6
     FILL-IN-VNR3A AT ROW 10.54 COL 4 NO-LABEL
     FILL-IN-BOR1V3A AT ROW 10.54 COL 28 COLON-ALIGNED
    WITH 1 DOWN NO-BOX KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1 ROW 6
         SIZE 120.5 BY 12.

/* DEFINE FRAME statement is approaching 4K Bytes.  Breaking it up   */
DEFINE FRAME FRAME-ARB
     FILL-IN-BOR2V3A AT ROW 10.54 COL 37 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR3V3A AT ROW 10.54 COL 46 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR4V3A AT ROW 10.54 COL 55 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR5V3A AT ROW 10.54 COL 64 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR6V3A AT ROW 10.54 COL 73 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR7V3A AT ROW 10.54 COL 82 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU1V3A AT ROW 11.25 COL 28 COLON-ALIGNED
     FILL-IN-SLU2V3A AT ROW 11.25 COL 37 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU3V3A AT ROW 11.25 COL 46 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU4V3A AT ROW 11.25 COL 55 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU5V3A AT ROW 11.25 COL 64 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU6V3A AT ROW 11.25 COL 73 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU7V3A AT ROW 11.25 COL 82 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM1V3A AT ROW 12 COL 28 COLON-ALIGNED
     FILL-IN-TIM2V3A AT ROW 12 COL 37 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM3V3A AT ROW 12 COL 46 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM4V3A AT ROW 12 COL 55 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM5V3A AT ROW 12 COL 64 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM6V3A AT ROW 12 COL 73 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM7V3A AT ROW 12 COL 82 COLON-ALIGNED NO-LABEL
     "Lördag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.17 COL 75.13
     "Fredag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.17 COL 66.13
     "Onsdag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.17 COL 48
     "Tisdag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.17 COL 39.13
     "Veckonummer" VIEW-AS TEXT
          SIZE 11 BY .63 AT ROW 1.17 COL 1.5
     "Måndag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.17 COL 30.13
     "Söndag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.17 COL 84.13
     "Tim/vecka" VIEW-AS TEXT
          SIZE 9 BY .63 AT ROW 1.08 COL 90.75 WIDGET-ID 8
     "Torsdag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.17 COL 57.13
     "Veckoschema" VIEW-AS TEXT
          SIZE 11.38 BY .63 AT ROW 1.17 COL 13.13
    WITH 1 DOWN NO-BOX KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1 ROW 6
         SIZE 120.5 BY 12.

DEFINE FRAME FRAME-ORG
     CMB_D1V1 AT ROW 2.04 COL 26.38 COLON-ALIGNED
     CMB_D2V1 AT ROW 2.04 COL 35.38 COLON-ALIGNED NO-LABEL
     CMB_D3V1 AT ROW 2.04 COL 44.38 COLON-ALIGNED NO-LABEL
     CMB_D4V1 AT ROW 2.04 COL 53.38 COLON-ALIGNED NO-LABEL
     CMB_D5V1 AT ROW 2.04 COL 62.38 COLON-ALIGNED NO-LABEL
     CMB_D6V1 AT ROW 2.04 COL 71.38 COLON-ALIGNED NO-LABEL
     CMB_D7V1 AT ROW 2.04 COL 80.38 COLON-ALIGNED NO-LABEL
     CMB_VNR1 AT ROW 3.13 COL 10.38 COLON-ALIGNED NO-LABEL
     BTN_UPP-2 AT ROW 4.63 COL 102.25
     CMB_D1V2 AT ROW 5.75 COL 26.38 COLON-ALIGNED
     CMB_D2V2 AT ROW 5.75 COL 35.38 COLON-ALIGNED NO-LABEL
     CMB_D3V2 AT ROW 5.75 COL 44.38 COLON-ALIGNED NO-LABEL
     CMB_D4V2 AT ROW 5.75 COL 53.38 COLON-ALIGNED NO-LABEL
     CMB_D5V2 AT ROW 5.75 COL 62.38 COLON-ALIGNED NO-LABEL
     CMB_D6V2 AT ROW 5.75 COL 71.38 COLON-ALIGNED NO-LABEL
     CMB_D7V2 AT ROW 5.75 COL 80.38 COLON-ALIGNED NO-LABEL
     CMB_VNR2 AT ROW 6.79 COL 10.63 COLON-ALIGNED NO-LABEL
     BTN_NER-2 AT ROW 8.63 COL 102.25
     CMB_D1V3 AT ROW 9.46 COL 26.38 COLON-ALIGNED
     CMB_D2V3 AT ROW 9.46 COL 35.38 COLON-ALIGNED NO-LABEL
     CMB_D3V3 AT ROW 9.46 COL 44.38 COLON-ALIGNED NO-LABEL
     CMB_D4V3 AT ROW 9.46 COL 53.38 COLON-ALIGNED NO-LABEL
     CMB_D5V3 AT ROW 9.46 COL 62.38 COLON-ALIGNED NO-LABEL
     CMB_D6V3 AT ROW 9.46 COL 71.38 COLON-ALIGNED NO-LABEL
     CMB_D7V3 AT ROW 9.46 COL 80.38 COLON-ALIGNED NO-LABEL
     CMB_VNR3 AT ROW 10.54 COL 10.38 COLON-ALIGNED NO-LABEL
     FILL-IN-2 AT ROW 1.17 COL 97.75 COLON-ALIGNED NO-LABEL
     FILL-IN-TOTV1 AT ROW 2.04 COL 88.75 COLON-ALIGNED NO-LABEL
     FILL-IN-RUBR3 AT ROW 2.08 COL 97.75 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR1V1 AT ROW 3.08 COL 26.38 COLON-ALIGNED
     FILL-IN-BOR2V1 AT ROW 3.08 COL 35.38 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR3V1 AT ROW 3.08 COL 44.38 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR4V1 AT ROW 3.08 COL 53.38 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR5V1 AT ROW 3.08 COL 62.38 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR6V1 AT ROW 3.08 COL 71.38 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR7V1 AT ROW 3.08 COL 80.38 COLON-ALIGNED NO-LABEL
     FILL-IN-VNR1 AT ROW 3.13 COL 4 NO-LABEL
     FILL-IN-SLU1V1 AT ROW 3.79 COL 26.38 COLON-ALIGNED
     FILL-IN-SLU2V1 AT ROW 3.79 COL 35.38 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU3V1 AT ROW 3.79 COL 44.38 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU4V1 AT ROW 3.79 COL 53.38 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU5V1 AT ROW 3.79 COL 62.38 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU6V1 AT ROW 3.79 COL 71.38 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU7V1 AT ROW 3.79 COL 80.38 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM1V1 AT ROW 4.5 COL 26.38 COLON-ALIGNED
     FILL-IN-TIM2V1 AT ROW 4.5 COL 35.38 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM3V1 AT ROW 4.5 COL 44.38 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM4V1 AT ROW 4.5 COL 53.38 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM5V1 AT ROW 4.5 COL 62.38 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM6V1 AT ROW 4.5 COL 71.38 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM7V1 AT ROW 4.5 COL 80.38 COLON-ALIGNED NO-LABEL
     FILL-IN-TOTV2 AT ROW 5.75 COL 88.88 COLON-ALIGNED NO-LABEL
     FILL-IN-VNR2 AT ROW 6.79 COL 4.25 NO-LABEL
     FILL-IN-BOR1V2 AT ROW 6.79 COL 26.5 COLON-ALIGNED
     FILL-IN-BOR2V2 AT ROW 6.79 COL 35.5 COLON-ALIGNED NO-LABEL
    WITH 1 DOWN NO-BOX KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1 ROW 6
         SIZE 120.5 BY 12.

/* DEFINE FRAME statement is approaching 4K Bytes.  Breaking it up   */
DEFINE FRAME FRAME-ORG
     FILL-IN-BOR3V2 AT ROW 6.79 COL 44.5 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR4V2 AT ROW 6.79 COL 53.5 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR5V2 AT ROW 6.79 COL 62.5 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR6V2 AT ROW 6.79 COL 71.5 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR7V2 AT ROW 6.79 COL 80.5 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU1V2 AT ROW 7.5 COL 26.5 COLON-ALIGNED
     FILL-IN-SLU2V2 AT ROW 7.5 COL 35.5 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU3V2 AT ROW 7.5 COL 44.5 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU4V2 AT ROW 7.5 COL 53.5 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU5V2 AT ROW 7.5 COL 62.5 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU6V2 AT ROW 7.5 COL 71.5 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU7V2 AT ROW 7.5 COL 80.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM1V2 AT ROW 8.21 COL 26.5 COLON-ALIGNED
     FILL-IN-TIM2V2 AT ROW 8.21 COL 35.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM3V2 AT ROW 8.21 COL 44.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM4V2 AT ROW 8.21 COL 53.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM5V2 AT ROW 8.21 COL 62.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM6V2 AT ROW 8.21 COL 71.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM7V2 AT ROW 8.21 COL 80.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TOTV3 AT ROW 9.46 COL 88.63 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR1V3 AT ROW 10.46 COL 26.25 COLON-ALIGNED
     FILL-IN-BOR2V3 AT ROW 10.46 COL 35.25 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR3V3 AT ROW 10.46 COL 44.25 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR4V3 AT ROW 10.46 COL 53.25 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR5V3 AT ROW 10.46 COL 62.25 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR6V3 AT ROW 10.46 COL 71.25 COLON-ALIGNED NO-LABEL
     FILL-IN-BOR7V3 AT ROW 10.46 COL 80.25 COLON-ALIGNED NO-LABEL
     FILL-IN-VNR3 AT ROW 10.54 COL 4 NO-LABEL
     FILL-IN-SLU1V3 AT ROW 11.17 COL 26.25 COLON-ALIGNED
     FILL-IN-SLU2V3 AT ROW 11.17 COL 35.25 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU3V3 AT ROW 11.17 COL 44.25 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU4V3 AT ROW 11.17 COL 53.25 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU5V3 AT ROW 11.17 COL 62.25 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU6V3 AT ROW 11.17 COL 71.25 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU7V3 AT ROW 11.17 COL 80.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM1V3 AT ROW 11.92 COL 26.25 COLON-ALIGNED
     FILL-IN-TIM2V3 AT ROW 11.92 COL 35.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM3V3 AT ROW 11.92 COL 44.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM4V3 AT ROW 11.92 COL 53.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM5V3 AT ROW 11.92 COL 62.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM6V3 AT ROW 11.92 COL 71.25 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM7V3 AT ROW 11.92 COL 80.25 COLON-ALIGNED NO-LABEL
     "Tim/vecka" VIEW-AS TEXT
          SIZE 9 BY .63 AT ROW 1.08 COL 90.75
     "Tisdag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.08 COL 37.38
     "Lördag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.08 COL 73.38
     "Onsdag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.08 COL 46.25
     "Veckoschema" VIEW-AS TEXT
          SIZE 11.38 BY .63 AT ROW 1.17 COL 12.38
    WITH 1 DOWN NO-BOX KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1 ROW 6
         SIZE 120.5 BY 12.

/* DEFINE FRAME statement is approaching 4K Bytes.  Breaking it up   */
DEFINE FRAME FRAME-ORG
     "Fredag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.08 COL 64.38
     "Måndag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.08 COL 28.38
     "Veckonummer" VIEW-AS TEXT
          SIZE 10.5 BY .63 AT ROW 1.17 COL 1.5
     "Söndag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.08 COL 82.38
     "Torsdag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.08 COL 55.38
    WITH 1 DOWN NO-BOX KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1 ROW 6
         SIZE 120.5 BY 12.

DEFINE FRAME FRAME-VISA
     FILL-IN-D1 AT ROW 2.54 COL 19 COLON-ALIGNED
     FILL-IN-D2 AT ROW 2.54 COL 29.38 COLON-ALIGNED NO-LABEL
     FILL-IN-D3 AT ROW 2.54 COL 39.75 COLON-ALIGNED NO-LABEL
     FILL-IN-D4 AT ROW 2.54 COL 50.13 COLON-ALIGNED NO-LABEL
     FILL-IN-D5 AT ROW 2.54 COL 60.5 COLON-ALIGNED NO-LABEL
     FILL-IN-D6 AT ROW 2.54 COL 70.88 COLON-ALIGNED NO-LABEL
     FILL-IN-D7 AT ROW 2.54 COL 81 COLON-ALIGNED NO-LABEL
     FILL-IN-AB1 AT ROW 3.42 COL 19 COLON-ALIGNED
     FILL-IN-AB2 AT ROW 3.42 COL 29.38 COLON-ALIGNED NO-LABEL
     FILL-IN-AB3 AT ROW 3.42 COL 39.75 COLON-ALIGNED NO-LABEL
     FILL-IN-AB4 AT ROW 3.42 COL 50.13 COLON-ALIGNED NO-LABEL
     FILL-IN-AB5 AT ROW 3.42 COL 60.5 COLON-ALIGNED NO-LABEL
     FILL-IN-AB6 AT ROW 3.42 COL 70.88 COLON-ALIGNED NO-LABEL
     FILL-IN-AB7 AT ROW 3.42 COL 81 COLON-ALIGNED NO-LABEL
     FILL-IN-FB1 AT ROW 4.63 COL 19 COLON-ALIGNED
     FILL-IN-FB2 AT ROW 4.63 COL 29.38 COLON-ALIGNED NO-LABEL
     FILL-IN-FB3 AT ROW 4.63 COL 39.75 COLON-ALIGNED NO-LABEL
     FILL-IN-FB4 AT ROW 4.63 COL 50.13 COLON-ALIGNED NO-LABEL
     FILL-IN-FB5 AT ROW 4.63 COL 60.5 COLON-ALIGNED NO-LABEL
     FILL-IN-FB6 AT ROW 4.63 COL 70.88 COLON-ALIGNED NO-LABEL
     FILL-IN-FB7 AT ROW 4.63 COL 81 COLON-ALIGNED NO-LABEL
     FILL-IN-FS1 AT ROW 5.42 COL 19 COLON-ALIGNED
     FILL-IN-FS2 AT ROW 5.42 COL 29.38 COLON-ALIGNED NO-LABEL
     FILL-IN-FS3 AT ROW 5.42 COL 39.75 COLON-ALIGNED NO-LABEL
     FILL-IN-FS4 AT ROW 5.42 COL 50.13 COLON-ALIGNED NO-LABEL
     FILL-IN-FS5 AT ROW 5.42 COL 60.5 COLON-ALIGNED NO-LABEL
     FILL-IN-FS6 AT ROW 5.42 COL 70.88 COLON-ALIGNED NO-LABEL
     FILL-IN-FS7 AT ROW 5.42 COL 81 COLON-ALIGNED NO-LABEL
     FILL-IN-LB1 AT ROW 6.67 COL 19 COLON-ALIGNED
     FILL-IN-LB2 AT ROW 6.67 COL 29.38 COLON-ALIGNED NO-LABEL
     FILL-IN-LB3 AT ROW 6.67 COL 39.75 COLON-ALIGNED NO-LABEL
     FILL-IN-LB4 AT ROW 6.67 COL 50.13 COLON-ALIGNED NO-LABEL
     FILL-IN-LB5 AT ROW 6.67 COL 60.5 COLON-ALIGNED NO-LABEL
     FILL-IN-LB6 AT ROW 6.67 COL 70.88 COLON-ALIGNED NO-LABEL
     FILL-IN-LB7 AT ROW 6.67 COL 81 COLON-ALIGNED NO-LABEL
     FILL-IN-LS1 AT ROW 7.46 COL 19 COLON-ALIGNED
     FILL-IN-LS2 AT ROW 7.46 COL 29.38 COLON-ALIGNED NO-LABEL
     FILL-IN-LS3 AT ROW 7.46 COL 39.75 COLON-ALIGNED NO-LABEL
     FILL-IN-LS4 AT ROW 7.46 COL 50.13 COLON-ALIGNED NO-LABEL
     FILL-IN-LS5 AT ROW 7.46 COL 60.5 COLON-ALIGNED NO-LABEL
     FILL-IN-LS6 AT ROW 7.46 COL 70.88 COLON-ALIGNED NO-LABEL
     FILL-IN-LS7 AT ROW 7.46 COL 81 COLON-ALIGNED NO-LABEL
     FILL-IN-TOTV1 AT ROW 7.63 COL 92.25 COLON-ALIGNED NO-LABEL FORMAT "99.99":U
           VIEW-AS TEXT 
          SIZE 7 BY .63
     FILL-IN-VECO1 AT ROW 7.63 COL 105.5 COLON-ALIGNED NO-LABEL
     FILL-IN-KB1 AT ROW 8.71 COL 19 COLON-ALIGNED
     FILL-IN-KB2 AT ROW 8.71 COL 29.38 COLON-ALIGNED NO-LABEL
     FILL-IN-KB3 AT ROW 8.71 COL 39.75 COLON-ALIGNED NO-LABEL
     FILL-IN-KB4 AT ROW 8.71 COL 50.13 COLON-ALIGNED NO-LABEL
     FILL-IN-KB5 AT ROW 8.71 COL 60.5 COLON-ALIGNED NO-LABEL
     FILL-IN-KB6 AT ROW 8.71 COL 70.88 COLON-ALIGNED NO-LABEL
     FILL-IN-KB7 AT ROW 8.71 COL 81 COLON-ALIGNED NO-LABEL
     FILL-IN-KS1 AT ROW 9.5 COL 19 COLON-ALIGNED
     FILL-IN-KS2 AT ROW 9.5 COL 29.38 COLON-ALIGNED NO-LABEL
    WITH 1 DOWN NO-BOX KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1 ROW 6
         SIZE 120.5 BY 12.

/* DEFINE FRAME statement is approaching 4K Bytes.  Breaking it up   */
DEFINE FRAME FRAME-VISA
     FILL-IN-KS3 AT ROW 9.5 COL 39.75 COLON-ALIGNED NO-LABEL
     FILL-IN-KS4 AT ROW 9.5 COL 50.13 COLON-ALIGNED NO-LABEL
     FILL-IN-KS5 AT ROW 9.5 COL 60.5 COLON-ALIGNED NO-LABEL
     FILL-IN-KS6 AT ROW 9.5 COL 70.88 COLON-ALIGNED NO-LABEL
     FILL-IN-KS7 AT ROW 9.5 COL 81 COLON-ALIGNED NO-LABEL
     FILL-IN-AS1 AT ROW 10.71 COL 19 COLON-ALIGNED
     FILL-IN-AS2 AT ROW 10.71 COL 29.38 COLON-ALIGNED NO-LABEL
     FILL-IN-AS3 AT ROW 10.71 COL 39.75 COLON-ALIGNED NO-LABEL
     FILL-IN-AS4 AT ROW 10.71 COL 50.13 COLON-ALIGNED NO-LABEL
     FILL-IN-AS5 AT ROW 10.71 COL 60.5 COLON-ALIGNED NO-LABEL
     FILL-IN-AS6 AT ROW 10.71 COL 70.88 COLON-ALIGNED NO-LABEL
     FILL-IN-AS7 AT ROW 10.71 COL 81 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM1 AT ROW 11.67 COL 19 COLON-ALIGNED
     FILL-IN-TIM2 AT ROW 11.67 COL 29.38 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM3 AT ROW 11.67 COL 39.75 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM4 AT ROW 11.67 COL 50.13 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM5 AT ROW 11.67 COL 60.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM6 AT ROW 11.67 COL 70.88 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM7 AT ROW 11.67 COL 81 COLON-ALIGNED NO-LABEL
     "Lördag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.5 COL 72.88
     "Fredag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.5 COL 62.5
     "Tim/vecka" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 6.46 COL 93.75
     "Veckoschema" VIEW-AS TEXT
          SIZE 11.5 BY .63 AT ROW 6.46 COL 104
     "Tisdag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.5 COL 31.38
     "Söndag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.5 COL 83
     "Torsdag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.5 COL 52.13
     "Onsdag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.5 COL 41.75
     "Måndag" VIEW-AS TEXT
          SIZE 8 BY .63 AT ROW 1.5 COL 21
    WITH 1 DOWN NO-BOX KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1 ROW 6
         SIZE 120.5 BY 12.


/* *********************** Procedure Settings ************************ */

&ANALYZE-SUSPEND _PROCEDURE-SETTINGS
/* Settings for THIS-PROCEDURE
   Type: Window
   Allow: Basic,Browse,DB-Fields,Window,Query
   Temp-Tables and Buffers:
      TABLE: rullperstemp T "?" NO-UNDO temp-db rullperstemp
      TABLE: rullvectemp T "?" NO-UNDO temp-db rullvectemp
      TABLE: valperstemp T "?" NO-UNDO temp-db valperstemp
   END-TABLES.
 */
&ANALYZE-RESUME _END-PROCEDURE-SETTINGS

/* *************************  Create Window  ************************** */

&ANALYZE-SUSPEND _CREATE-WINDOW
IF SESSION:DISPLAY-TYPE = "GUI":U THEN
  CREATE WINDOW C-Win ASSIGN
         HIDDEN             = YES
         TITLE              = "Arbetstid"
         HEIGHT             = 27.88
         WIDTH              = 125
         MAX-HEIGHT         = 28.75
         MAX-WIDTH          = 125
         VIRTUAL-HEIGHT     = 28.75
         VIRTUAL-WIDTH      = 125
         RESIZE             = no
         SCROLL-BARS        = no
         STATUS-AREA        = no
         BGCOLOR            = ?
         FGCOLOR            = ?
         KEEP-FRAME-Z-ORDER = yes
         THREE-D            = yes
         MESSAGE-AREA       = no
         SENSITIVE          = yes.
ELSE {&WINDOW-NAME} = CURRENT-WINDOW.
/* END WINDOW DEFINITION                                                */
&ANALYZE-RESUME



/* ***********  Runtime Attributes and AppBuilder Settings  *********** */

&ANALYZE-SUSPEND _RUN-TIME-ATTRIBUTES
/* SETTINGS FOR WINDOW C-Win
  NOT-VISIBLE,,RUN-PERSISTENT                                           */
/* REPARENT FRAME */
ASSIGN FRAME FRAME-ARB:FRAME = FRAME DEFAULT-FRAME:HANDLE
       FRAME FRAME-ORG:FRAME = FRAME DEFAULT-FRAME:HANDLE
       FRAME FRAME-VISA:FRAME = FRAME DEFAULT-FRAME:HANDLE.

/* SETTINGS FOR FRAME DEFAULT-FRAME
   FRAME-NAME                                                           */
/* BROWSE-TAB BRW_ORD FRAME-VISA DEFAULT-FRAME */
/* BROWSE-TAB BRW_RULLPERS BRW_ORD DEFAULT-FRAME */
/* BROWSE-TAB BRW_RULLVEC BRW_RULLPERS DEFAULT-FRAME */
ASSIGN 
       BRW_ORD:ALLOW-COLUMN-SEARCHING IN FRAME DEFAULT-FRAME = TRUE
       BRW_ORD:COLUMN-RESIZABLE IN FRAME DEFAULT-FRAME       = TRUE.

ASSIGN 
       BRW_RULLPERS:ALLOW-COLUMN-SEARCHING IN FRAME DEFAULT-FRAME = TRUE
       BRW_RULLPERS:COLUMN-RESIZABLE IN FRAME DEFAULT-FRAME       = TRUE.

ASSIGN 
       BRW_RULLVEC:ALLOW-COLUMN-SEARCHING IN FRAME DEFAULT-FRAME = TRUE
       BRW_RULLVEC:COLUMN-RESIZABLE IN FRAME DEFAULT-FRAME       = TRUE.

/* SETTINGS FOR COMBO-BOX CMB_ORD IN FRAME DEFAULT-FRAME
   NO-DISPLAY ALIGN-L                                                   */
/* SETTINGS FOR COMBO-BOX CMB_RUL IN FRAME DEFAULT-FRAME
   NO-DISPLAY                                                           */
ASSIGN 
       FILL-IN-VALDA:HIDDEN IN FRAME DEFAULT-FRAME           = TRUE.

ASSIGN 
       FILL-IN_EFTERNAMN:READ-ONLY IN FRAME DEFAULT-FRAME        = TRUE.

ASSIGN 
       FILL-IN_FORNAMN:READ-ONLY IN FRAME DEFAULT-FRAME        = TRUE.

ASSIGN 
       FILL-IN_OMRADE:READ-ONLY IN FRAME DEFAULT-FRAME        = TRUE.

/* SETTINGS FOR FILL-IN FILL-IN_PERSON IN FRAME DEFAULT-FRAME
   NO-ENABLE                                                            */
ASSIGN 
       FILL-IN_PERSON:READ-ONLY IN FRAME DEFAULT-FRAME        = TRUE.

/* SETTINGS FOR FRAME FRAME-ARB
                                                                        */
ASSIGN 
       FILL-IN-BOR5V1A:HIDDEN IN FRAME FRAME-ARB           = TRUE.

ASSIGN 
       FILL-IN-BOR5V2A:HIDDEN IN FRAME FRAME-ARB           = TRUE.

ASSIGN 
       FILL-IN-BOR5V3A:HIDDEN IN FRAME FRAME-ARB           = TRUE.

/* SETTINGS FOR FILL-IN FILL-IN-VNR1A IN FRAME FRAME-ARB
   ALIGN-L                                                              */
/* SETTINGS FOR FILL-IN FILL-IN-VNR2A IN FRAME FRAME-ARB
   ALIGN-L                                                              */
/* SETTINGS FOR FILL-IN FILL-IN-VNR3A IN FRAME FRAME-ARB
   ALIGN-L                                                              */
/* SETTINGS FOR FRAME FRAME-ORG
                                                                        */
ASSIGN 
       FILL-IN-BOR5V1:HIDDEN IN FRAME FRAME-ORG           = TRUE.

ASSIGN 
       FILL-IN-BOR5V2:HIDDEN IN FRAME FRAME-ORG           = TRUE.

ASSIGN 
       FILL-IN-BOR5V3:HIDDEN IN FRAME FRAME-ORG           = TRUE.

/* SETTINGS FOR FILL-IN FILL-IN-VNR1 IN FRAME FRAME-ORG
   ALIGN-L                                                              */
/* SETTINGS FOR FILL-IN FILL-IN-VNR2 IN FRAME FRAME-ORG
   ALIGN-L                                                              */
/* SETTINGS FOR FILL-IN FILL-IN-VNR3 IN FRAME FRAME-ORG
   ALIGN-L                                                              */
/* SETTINGS FOR FRAME FRAME-VISA
                                                                        */
IF SESSION:DISPLAY-TYPE = "GUI":U AND VALID-HANDLE(C-Win)
THEN C-Win:HIDDEN = yes.

/* _RUN-TIME-ATTRIBUTES-END */
&ANALYZE-RESUME


/* Setting information for Queries and Browse Widgets fields            */

&ANALYZE-SUSPEND _QUERY-BLOCK BROWSE BRW_ORD
/* Query rebuild information for BROWSE BRW_ORD
     _TblList          = "Temp-Tables.valperstemp"
     _Options          = "NO-LOCK"
     _FldNameList[1]   > Temp-Tables.valperstemp.PERSONALKOD
"valperstemp.PERSONALKOD" "Enhet/!Sign" ? "character" ? ? ? ? ? ? no ? no no "7" yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _FldNameList[2]   > Temp-Tables.valperstemp.VECKOSCHEMA
"valperstemp.VECKOSCHEMA" "Vecko-!schema" ">99" "integer" ? ? ? ? ? ? no ? no no ? yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _FldNameList[3]   > Temp-Tables.valperstemp.FORNAMN
"valperstemp.FORNAMN" "Förnamn" "x(256)" "character" ? ? ? ? ? ? no ? no no "12.5" yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _FldNameList[4]   > Temp-Tables.valperstemp.EFTERNAMN
"valperstemp.EFTERNAMN" "Efternamn" "x(256)" "character" ? ? ? ? ? ? no ? no no "19" yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _Query            is NOT OPENED
*/  /* BROWSE BRW_ORD */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _QUERY-BLOCK BROWSE BRW_RULLPERS
/* Query rebuild information for BROWSE BRW_RULLPERS
     _TblList          = "Temp-Tables.rullperstemp"
     _Options          = "NO-LOCK "
     _FldNameList[1]   > Temp-Tables.rullperstemp.PERSONALKOD
"rullperstemp.PERSONALKOD" "Enhet/!Sign" ? "character" ? ? ? ? ? ? no ? no no "7" yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _FldNameList[2]   > Temp-Tables.rullperstemp.RULLID
"rullperstemp.RULLID" "Rull-!schema" ? "integer" ? ? ? ? ? ? no ? no no ? yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _FldNameList[3]   > Temp-Tables.rullperstemp.ORDNING
"rullperstemp.ORDNING" "Ordning" ? "integer" ? ? ? ? ? ? no ? no no ? yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _FldNameList[4]   > Temp-Tables.rullperstemp.STARTDATUM
"rullperstemp.STARTDATUM" "Startdatum" "9999/99/99" "date" ? ? ? ? ? ? no ? no no ? yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _FldNameList[5]   > Temp-Tables.rullperstemp.SLUTDATUM
"rullperstemp.SLUTDATUM" "Slutdatum" "9999/99/99" "date" ? ? ? ? ? ? no ? no no ? yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _FldNameList[6]   > Temp-Tables.rullperstemp.ANVANDARE
"rullperstemp.ANVANDARE" "Ändrad av" ? "character" ? ? ? ? ? ? no ? no no ? yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _FldNameList[7]   > Temp-Tables.rullperstemp.ANDDATUM
"rullperstemp.ANDDATUM" "Datum" ? "date" ? ? ? ? ? ? no ? no no ? yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _Query            is NOT OPENED
*/  /* BROWSE BRW_RULLPERS */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _QUERY-BLOCK BROWSE BRW_RULLVEC
/* Query rebuild information for BROWSE BRW_RULLVEC
     _TblList          = "Temp-Tables.rullvectemp"
     _Options          = "NO-LOCK "
     _FldNameList[1]   > Temp-Tables.rullvectemp.ORDNING
"rullvectemp.ORDNING" "Ordning" ? "integer" ? ? ? ? ? ? no ? no no ? yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _FldNameList[2]   > Temp-Tables.rullvectemp.VECKOSCHEMA
"rullvectemp.VECKOSCHEMA" "Veckoschema" ">99" "integer" ? ? ? ? ? ? no ? no no ? yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _Query            is NOT OPENED
*/  /* BROWSE BRW_RULLVEC */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _QUERY-BLOCK FRAME FRAME-ARB
/* Query rebuild information for FRAME FRAME-ARB
     _Query            is NOT OPENED
*/  /* FRAME FRAME-ARB */
&ANALYZE-RESUME

 



/* ************************  Control Triggers  ************************ */

&Scoped-define SELF-NAME C-Win
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL C-Win C-Win
ON END-ERROR OF C-Win /* Arbetstid */
OR ENDKEY OF {&WINDOW-NAME} ANYWHERE DO:
  /* This case occurs when the user presses the "Esc" key.
     In a persistently run window, just ignore this.  If we did not, the
     application would exit. */
   APPLY "CLOSE":U TO THIS-PROCEDURE.
   IF THIS-PROCEDURE:PERSISTENT THEN RETURN NO-APPLY.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL C-Win C-Win
ON WINDOW-CLOSE OF C-Win /* Arbetstid */
DO:
  /* This event will close the window and terminate the procedure.  */
  APPLY "CLOSE":U TO THIS-PROCEDURE.
  RETURN NO-APPLY.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define BROWSE-NAME BRW_ORD
&Scoped-define SELF-NAME BRW_ORD
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BRW_ORD C-Win
ON VALUE-CHANGED OF BRW_ORD IN FRAME DEFAULT-FRAME /* Personal */
DO:
   gamlapkod = perskod.
   perskod = valperstemp.PERSONALKOD.
   IF RAD_VAL NE 3 THEN DO:     
      IF BRW_ORD:NUM-SELECTED-ROWS > 1 THEN DO:
         FILL-IN-VALDA = BRW_ORD:NUM-SELECTED-ROWS.
         DISPLAY FILL-IN-VALDA WITH FRAME DEFAULT-FRAME.
      END.
      ELSE FILL-IN-VALDA:HIDDEN IN FRAME DEFAULT-FRAME = TRUE.
      BRW_RULLPERS:DESELECT-FOCUSED-ROW() IN FRAME DEFAULT-FRAME NO-ERROR.
   END.
   IF RAD_VAL = 3 THEN DO:
      APPLY "VALUE-CHANGED" TO RAD_VAL.
   END.
   RUN laddapersdata_UI.
   IF RAD_VAL = 3 THEN DO:
      FRAME FRAME-ARB:HIDDEN = FALSE.
      FRAME FRAME-ARB:MOVE-TO-TOP().
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define BROWSE-NAME BRW_RULLPERS
&Scoped-define SELF-NAME BRW_RULLPERS
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BRW_RULLPERS C-Win
ON LEAVE OF BRW_RULLPERS IN FRAME DEFAULT-FRAME /* Kopplade rullande schema */
DO:
   FRAME FRAME-ORG:HIDDEN = FALSE.
   FRAME FRAME-VISA:HIDDEN = TRUE.
   FRAME FRAME-ORG:MOVE-TO-TOP().
   IF RAD_VAL = 3 THEN DO:
      FRAME FRAME-ARB:HIDDEN = FALSE.
      FRAME FRAME-ARB:MOVE-TO-TOP().
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BRW_RULLPERS C-Win
ON VALUE-CHANGED OF BRW_RULLPERS IN FRAME DEFAULT-FRAME /* Kopplade rullande schema */
DO:
   IF AVAILABLE rullperstemp THEN DO:                           
      
      DO WHILE CMB_ORD:DELETE(1) = TRUE: 
      END.
      FOR EACH rullvectemp WHERE rullvectemp.RULLID = rullperstemp.RULLID:
        CMB_ORD:ADD-LAST(STRING(rullvectemp.ORDNING,"99")) IN FRAME DEFAULT-FRAME. 
      END.

      RUN rullperschange_UI.
      mittdatum = rullperstemp.STARTDATUM.
      RUN laddavec_UI (INPUT mittdatum).
      ASSIGN
      CMB_RUL = rullperstemp.RULLID
      CMB_ORD = rullperstemp.ORDNING.       
      IF RAD_VAL = 2 THEN DO: 
         IF AVAILABLE rullperstemp THEN DO:
            CMB_RUL:SCREEN-VALUE = STRING(rullperstemp.RULLID).
            CMB_ORD:SCREEN-VALUE = STRING(rullperstemp.ORDNING).
            DISPLAY CMB_RUL CMB_ORD WITH FRAME DEFAULT-FRAME.
            FIND FIRST rullschtemp WHERE rullschtemp.RULLID = CMB_RUL NO-LOCK NO-ERROR.
            IF AVAILABLE rullschtemp THEN DO:
               FILL-IN_TEXT:SCREEN-VALUE = rullschtemp.BENAMNING.      
            END.
         END.
      END.
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define BROWSE-NAME BRW_RULLVEC
&Scoped-define SELF-NAME BRW_RULLVEC
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BRW_RULLVEC C-Win
ON LEAVE OF BRW_RULLVEC IN FRAME DEFAULT-FRAME /* Rullande schema */
DO:
   FRAME FRAME-ORG:HIDDEN = FALSE.
   FRAME FRAME-VISA:HIDDEN = TRUE.
   FRAME FRAME-ORG:MOVE-TO-TOP().
   IF RAD_VAL = 3 THEN DO:
      FRAME FRAME-ARB:HIDDEN = FALSE.
      FRAME FRAME-ARB:MOVE-TO-TOP().
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BRW_RULLVEC C-Win
ON VALUE-CHANGED OF BRW_RULLVEC IN FRAME DEFAULT-FRAME /* Rullande schema */
DO:
   BRW_RULLVEC:SELECT-FOCUSED-ROW() IN FRAME DEFAULT-FRAME NO-ERROR.
   FRAME FRAME-ARB:HIDDEN = TRUE.
   FRAME FRAME-ORG:HIDDEN = TRUE.
   FRAME FRAME-VISA:HIDDEN = FALSE.
   FRAME FRAME-ORG:MOVE-TO-BOTTOM().
   IF AVAILABLE rullvectemp THEN DO:
      RUN uppdatvisa_UI (INPUT rullvectemp.veckoschema).
      CMB_ORD:SCREEN-VALUE = STRING(rullvectemp.ORDNING).
   END.   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME BTN_AKTVEC
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_AKTVEC C-Win
ON CHOOSE OF BTN_AKTVEC IN FRAME DEFAULT-FRAME /* ? */
DO:
   mittdatum = TODAY.
   RUN laddavec_UI (INPUT mittdatum).     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME BTN_AVB
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_AVB C-Win
ON CHOOSE OF BTN_AVB IN FRAME DEFAULT-FRAME /* Avsluta */
DO:
   APPLY "CLOSE":U TO THIS-PROCEDURE.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME BTN_BORT
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_BORT C-Win
ON CHOOSE OF BTN_BORT IN FRAME DEFAULT-FRAME /* Ta bort */
DO:
   BRW_RULLPERS:SELECT-FOCUSED-ROW() IN FRAME DEFAULT-FRAME NO-ERROR.
   IF AVAILABLE rullperstemp THEN DO:
      RUN bort_UI.
      BRW_RULLPERS:SELECT-FOCUSED-ROW() IN FRAME DEFAULT-FRAME NO-ERROR.
      IF AVAILABLE rullperstemp THEN APPLY "VALUE-CHANGED" TO BRW_RULLPERS.
      ELSE DO:
         IF RAD_VAL = 2 THEN DO:                                
         END.
         ELSE DO:         
            RUN setorgtitle_UI IN brwproc[3] (INPUT "Rullschema").         
            RUN setcolsortvar_UI IN brwproc[3] (INPUT " WHERE rullvectemp.RULLID = ''"). 
            RUN openbdynspec_UI IN brwproc[3].
            /*RUN openbdyn_UI IN brwproc[3] (INPUT " WHERE rullvectemp.RULLID = ''").*/      
         END.
      END.      
      APPLY "ENTRY" TO BRW_RULLVEC.
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME BTN_CLEAR
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_CLEAR C-Win
ON CHOOSE OF BTN_CLEAR IN FRAME DEFAULT-FRAME /* ? */
DO:
   ASSIGN FILL-IN_SLUTVNR = ?.
   DISPLAY FILL-IN_SLUTVNR WITH FRAME DEFAULT-FRAME.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME FRAME-ORG
&Scoped-define SELF-NAME BTN_NER-2
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_NER-2 C-Win
ON CHOOSE OF BTN_NER-2 IN FRAME FRAME-ORG
DO:
   mittdatum = mittdatum + 7.
   RUN laddavec_UI (INPUT mittdatum).     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME FRAME-ARB
&Scoped-define SELF-NAME BTN_NER-3
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_NER-3 C-Win
ON CHOOSE OF BTN_NER-3 IN FRAME FRAME-ARB
DO:
   mittdatum = mittdatum + 7.
   RUN laddavec_UI (INPUT mittdatum).    
   RUN visarb_UI.    
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME DEFAULT-FRAME
&Scoped-define SELF-NAME BTN_SKAPA
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_SKAPA C-Win
ON CHOOSE OF BTN_SKAPA IN FRAME DEFAULT-FRAME /* Koppla */
DO:
   RUN skapa_UI. 
   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME BTN_SLUTVB
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_SLUTVB C-Win
ON CHOOSE OF BTN_SLUTVB IN FRAME DEFAULT-FRAME /* - */
DO:
   DEFINE VARIABLE regdd AS CHARACTER NO-UNDO.
   ASSIGN
   FILL-IN_SLUTVNR = INPUT FILL-IN_SLUTVNR
   regdd = regdagnamn
   regdagnamn = "ONS"
   regvnr = FILL-IN_SLUTVNR.
   IF FILL-IN_SLUTVNR = ? THEN regvnr = INPUT FILL-IN_STARTVNR.
   RUN VECODAT.P.
   ASSIGN
   regdagnamn = regdd
   regdatum = regdatum - 7.   
   RUN REGVEC.P.
   FILL-IN_SLUTVNR = regvnr.
   DISPLAY FILL-IN_SLUTVNR WITH FRAME DEFAULT-FRAME.
   APPLY "MOUSE-SELECT-DBLCLICK" TO FILL-IN_SLUTVNR.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME BTN_SLUTVF
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_SLUTVF C-Win
ON CHOOSE OF BTN_SLUTVF IN FRAME DEFAULT-FRAME /* + */
DO:
   DEFINE VARIABLE regdd AS CHARACTER NO-UNDO.
   ASSIGN
   FILL-IN_SLUTVNR = INPUT FILL-IN_SLUTVNR
   regdd = regdagnamn
   regdagnamn = "ONS"
   regvnr = FILL-IN_SLUTVNR.
   IF FILL-IN_SLUTVNR = ? THEN regvnr = INPUT FILL-IN_STARTVNR.
   RUN VECODAT.P.
   ASSIGN
   regdagnamn = regdd
   regdatum = regdatum + 7.   
   RUN REGVEC.P.
   FILL-IN_SLUTVNR = regvnr.
   DISPLAY FILL-IN_SLUTVNR WITH FRAME DEFAULT-FRAME.
   APPLY "MOUSE-SELECT-DBLCLICK" TO FILL-IN_SLUTVNR.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME BTN_STARTVB
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_STARTVB C-Win
ON CHOOSE OF BTN_STARTVB IN FRAME DEFAULT-FRAME /* - */
DO:
   DEFINE VARIABLE regdd AS CHARACTER NO-UNDO.
   ASSIGN
   FILL-IN_STARTVNR = INPUT FILL-IN_STARTVNR
   regdd = regdagnamn
   regdagnamn = "ONS"
   regvnr = FILL-IN_STARTVNR.
   RUN VECODAT.P.
   ASSIGN
   regdagnamn = regdd
   regdatum = regdatum - 7.   
   RUN REGVEC.P.
   FILL-IN_STARTVNR = regvnr.
   DISPLAY FILL-IN_STARTVNR WITH FRAME DEFAULT-FRAME.
   APPLY "MOUSE-SELECT-DBLCLICK" TO FILL-IN_STARTVNR.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME BTN_STARTVF
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_STARTVF C-Win
ON CHOOSE OF BTN_STARTVF IN FRAME DEFAULT-FRAME /* + */
DO:
   DEFINE VARIABLE regdd AS CHARACTER NO-UNDO.
   ASSIGN
   FILL-IN_STARTVNR = INPUT FILL-IN_STARTVNR
   regdd = regdagnamn
   regdagnamn = "ONS"
   regvnr = FILL-IN_STARTVNR.
   RUN VECODAT.P.
   ASSIGN
   regdagnamn = regdd
   regdatum = regdatum + 7.   
   RUN REGVEC.P.
   FILL-IN_STARTVNR = regvnr.
   DISPLAY FILL-IN_STARTVNR WITH FRAME DEFAULT-FRAME.
   APPLY "MOUSE-SELECT-DBLCLICK" TO FILL-IN_STARTVNR.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME FRAME-ORG
&Scoped-define SELF-NAME BTN_UPP-2
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_UPP-2 C-Win
ON CHOOSE OF BTN_UPP-2 IN FRAME FRAME-ORG
DO:
   mittdatum = mittdatum - 7.
   RUN laddavec_UI (INPUT mittdatum).   

END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME FRAME-ARB
&Scoped-define SELF-NAME BTN_UPP-3
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_UPP-3 C-Win
ON CHOOSE OF BTN_UPP-3 IN FRAME FRAME-ARB
DO:
   mittdatum = mittdatum - 7.
   RUN laddavec_UI (INPUT mittdatum). 
   RUN visarb_UI.  

END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME DEFAULT-FRAME
&Scoped-define SELF-NAME BTN_VASCH
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_VASCH C-Win
ON CHOOSE OF BTN_VASCH IN FRAME DEFAULT-FRAME /* Visa veckoscheman */
DO:
   {muswait.i}
   
   /*ASSIGN    
   skrivut = FALSE.*/
   {AVBGOM.I}   
   RUN ut_UI.
   RUN VISASCH.W (INPUT 1, INPUT TABLE tidut).
   {AVBFRAM.I}
   {musarrow.i}   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME BTN_VRULL
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_VRULL C-Win
ON CHOOSE OF BTN_VRULL IN FRAME DEFAULT-FRAME /* Visa rullscheman */
DO:
   {muswait.i}
   
   /*ASSIGN    
   skrivut = FALSE.*/
   {AVBGOM.I}   
   ASSIGN
   rullvrec = RECID(rullvectemp)
   rullscrec = RECID(rullschtemp).
   RUN utrull_UI.
   RUN VISASCH.W (INPUT 2,INPUT TABLE tidut).
   FIND FIRST rullvectemp  WHERE RECID(rullvectemp) = rullvrec NO-LOCK NO-ERROR.
   FIND FIRST rullschtemp  WHERE RECID(rullschtemp) = rullscrec NO-LOCK NO-ERROR.
   {AVBFRAM.I}
   {musarrow.i}   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_ORD
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_ORD C-Win
ON LEAVE OF CMB_ORD IN FRAME DEFAULT-FRAME /* Ordning */
DO:
   FRAME FRAME-ORG:HIDDEN = FALSE.
   FRAME FRAME-VISA:HIDDEN = TRUE.
   FRAME FRAME-ORG:MOVE-TO-TOP().
   IF RAD_VAL = 3 THEN DO:
      FRAME FRAME-ARB:HIDDEN = FALSE.
      FRAME FRAME-ARB:MOVE-TO-TOP().
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_ORD C-Win
ON VALUE-CHANGED OF CMB_ORD IN FRAME DEFAULT-FRAME /* Ordning */
DO:
   ASSIGN
   CMB_ORD = INPUT CMB_ORD
   CMB_RUL = INPUT CMB_RUL.
   FIND FIRST rullvectemp WHERE rullvectemp.RULLID = CMB_RUL AND 
      rullvectemp.ORDNING = CMB_ORD NO-LOCK NO-ERROR.
   IF AVAILABLE rullvectemp THEN RUN selectbyrowid_UI IN brwproc[3] (INPUT ROWID(rullvectemp)).   
   FRAME FRAME-ORG:HIDDEN = TRUE.
   FRAME FRAME-VISA:HIDDEN = FALSE.
   FRAME FRAME-ORG:MOVE-TO-BOTTOM().   
   IF AVAILABLE rullvectemp THEN RUN uppdatvisa_UI (INPUT rullvectemp.veckoschema).
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_RUL
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_RUL C-Win
ON VALUE-CHANGED OF CMB_RUL IN FRAME DEFAULT-FRAME /* Rullschema */
DO:
   CMB_RUL = INPUT CMB_RUL.
   FIND FIRST rullschtemp WHERE rullschtemp.RULLID = CMB_RUL NO-LOCK NO-ERROR.
   IF AVAILABLE rullschtemp THEN DO:
      DO WHILE CMB_ORD:DELETE(1) = TRUE: END.
      FOR EACH rullvectemp WHERE rullvectemp.RULLID = CMB_RUL:
         CMB_ORD:ADD-LAST(STRING(rullvectemp.ORDNING,"99")) IN FRAME DEFAULT-FRAME. 
      END.
      FIND FIRST rullvectemp WHERE rullvectemp.RULLID = CMB_RUL NO-LOCK NO-ERROR.
      IF AVAILABLE rullvectemp THEN CMB_ORD:SCREEN-VALUE = STRING(rullvectemp.ORDNING).
      FILL-IN_TEXT:SCREEN-VALUE = rullschtemp.BENAMNING.      
      RUN setorgtitle_UI IN brwproc[3] (INPUT "Rullschema: " + STRING(rullvectemp.RULLID) + " " + rullschtemp.BENAMNING ).         
      RUN setcolsortvar_UI IN brwproc[3] (INPUT " WHERE rullvectemp.RULLID = '" + STRING(CMB_RUL) + "' "). 
      RUN openbdynspec_UI IN brwproc[3].
      /*
      RUN openbdyn_UI IN brwproc[3] (INPUT " WHERE rullvectemp.RULLID = '" + STRING(CMB_RUL) + "' ").
      */
   END.   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_VEC
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_VEC C-Win
ON LEAVE OF CMB_VEC IN FRAME DEFAULT-FRAME /* Veckoschema */
DO:
   FRAME FRAME-ORG:HIDDEN = FALSE.
   FRAME FRAME-VISA:HIDDEN = TRUE.
   FRAME FRAME-ORG:MOVE-TO-TOP().
   IF RAD_VAL = 3 THEN DO:
      FRAME FRAME-ARB:HIDDEN = FALSE.
      FRAME FRAME-ARB:MOVE-TO-TOP().
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_VEC C-Win
ON VALUE-CHANGED OF CMB_VEC IN FRAME DEFAULT-FRAME /* Veckoschema */
DO:
   CMB_VEC = INPUT CMB_VEC.
   FRAME FRAME-ORG:HIDDEN = TRUE.
   FRAME FRAME-VISA:HIDDEN = FALSE.
   FRAME FRAME-ORG:MOVE-TO-BOTTOM().
   RUN uppdatvisa_UI (INPUT CMB_VEC).
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_SLUTVNR
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_SLUTVNR C-Win
ON ANY-KEY OF FILL-IN_SLUTVNR IN FRAME DEFAULT-FRAME /* Slutvecka */
DO:
   {TRYCKS.I}
   IF KEYFUNCTION(LASTKEY) = ("RETURN") THEN DO:
      FILL-IN_SLUTVNR = INPUT FILL-IN_SLUTVNR.
      RUN veckokoll_UI (INPUT FILL-IN_SLUTVNR).
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_SLUTVNR C-Win
ON LEAVE OF FILL-IN_SLUTVNR IN FRAME DEFAULT-FRAME /* Slutvecka */
DO:
   FILL-IN_SLUTVNR = INPUT FILL-IN_SLUTVNR.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_SLUTVNR C-Win
ON MOUSE-MENU-CLICK OF FILL-IN_SLUTVNR IN FRAME DEFAULT-FRAME /* Slutvecka */
DO:
   ASSIGN
   FILL-IN_SLUTVNR = INPUT FILL-IN_SLUTVNR.
   IF FILL-IN_SLUTVNR = ? THEN DO:
      ASSIGN FILL-IN_SLUTVNR = INPUT FILL-IN_STARTVNR.
   END.
   ASSIGN
   regvnr = INPUT FILL-IN_SLUTVNR
   regdagnamn = "MÅN".
   RUN VECOKOLL.P.
   regvnr = FILL-IN_SLUTVNR.
   IF musz = TRUE THEN DO:
      musz = FALSE.
      RETURN NO-APPLY.
   END.
   RUN KALENDER.W.
   FILL-IN_SLUTVNR = regvnr.
   DISPLAY FILL-IN_SLUTVNR WITH FRAME DEFAULT-FRAME.
   RUN VECODAT.P.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_SLUTVNR C-Win
ON MOUSE-SELECT-DBLCLICK OF FILL-IN_SLUTVNR IN FRAME DEFAULT-FRAME /* Slutvecka */
DO:
   FILL-IN_SLUTVNR = INPUT FILL-IN_SLUTVNR.
   RUN veckokoll_UI (INPUT FILL-IN_SLUTVNR). 
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_STARTVNR
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_STARTVNR C-Win
ON ANY-KEY OF FILL-IN_STARTVNR IN FRAME DEFAULT-FRAME /* Startvecka */
DO:
   {TRYCKS.I}
   IF KEYFUNCTION(LASTKEY) = ("RETURN") THEN DO:
      FILL-IN_STARTVNR = INPUT FILL-IN_STARTVNR.
      RUN veckokoll_UI (INPUT FILL-IN_STARTVNR).
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_STARTVNR C-Win
ON LEAVE OF FILL-IN_STARTVNR IN FRAME DEFAULT-FRAME /* Startvecka */
DO:
   FILL-IN_STARTVNR = INPUT FILL-IN_STARTVNR.
   RUN veckokoll_UI (INPUT FILL-IN_STARTVNR).
   IF RAD_VAL = 3 THEN DO:
      APPLY "VALUE-CHANGED" TO RAD_VAL.
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_STARTVNR C-Win
ON MOUSE-MENU-CLICK OF FILL-IN_STARTVNR IN FRAME DEFAULT-FRAME /* Startvecka */
DO:
   ASSIGN
   FILL-IN_STARTVNR = INPUT FILL-IN_STARTVNR
   regvnr = INPUT FILL-IN_STARTVNR
   regdagnamn = "MÅN".
   RUN VECOKOLL.P.
   regvnr = FILL-IN_STARTVNR.
   IF musz = TRUE THEN DO:
      musz = FALSE.
      RETURN NO-APPLY.
   END.
   RUN KALENDER.W.
   FILL-IN_STARTVNR = regvnr.
   DISPLAY FILL-IN_STARTVNR WITH FRAME DEFAULT-FRAME.
   RUN VECODAT.P.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_STARTVNR C-Win
ON MOUSE-SELECT-DBLCLICK OF FILL-IN_STARTVNR IN FRAME DEFAULT-FRAME /* Startvecka */
DO:
   FILL-IN_STARTVNR = INPUT FILL-IN_STARTVNR.
   RUN veckokoll_UI (INPUT FILL-IN_STARTVNR). 
   IF RAD_VAL = 3 THEN DO:
      APPLY "VALUE-CHANGED" TO RAD_VAL.
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME RAD_VAL
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL RAD_VAL C-Win
ON VALUE-CHANGED OF RAD_VAL IN FRAME DEFAULT-FRAME
DO:
   RAD_VAL = INPUT RAD_VAL.
   RUN radvalchange_UI (INPUT RAD_VAL).

END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define BROWSE-NAME BRW_ORD
&UNDEFINE SELF-NAME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CUSTOM _MAIN-BLOCK C-Win 


/* ***************************  Main Block  *************************** */

/* Set CURRENT-WINDOW: this will parent dialog-boxes and frames.        */
ASSIGN CURRENT-WINDOW                = {&WINDOW-NAME} 
       THIS-PROCEDURE:CURRENT-WINDOW = {&WINDOW-NAME}.

/* The CLOSE event can be used from inside or outside the procedure to  */
/* terminate it.                                                        */
ON CLOSE OF THIS-PROCEDURE 
DO:
   IF VALID-HANDLE(arbproch) THEN DELETE PROCEDURE arbproch.
   {BORTBRWPROC.I}
   RUN disable_UI.
END.
   

/* Best default for GUI applications is...                              */
PAUSE 0 BEFORE-HIDE.

/* Now enable the interface and wait for the exit condition.            */
/* (NOTE: handle ERROR and END-KEY so cleanup code will always fire.    */
MAIN-BLOCK:
DO ON ERROR   UNDO MAIN-BLOCK, LEAVE MAIN-BLOCK
   ON END-KEY UNDO MAIN-BLOCK, LEAVE MAIN-BLOCK:
   {WIN_M_START.I}
   {ALLSTARTDYN.I}   
   CURRENT-WINDOW:TITLE = "Arbetstid".
   IF perskod = ? THEN DO: 
      FIND FIRST valperstemp NO-LOCK NO-ERROR.
      IF AVAILABLE valperstemp THEN perskod = valperstemp.PERSONALKOD.
   END.
   ELSE FIND FIRST valperstemp WHERE valperstemp.PERSONALKOD = perskod NO-LOCK NO-ERROR.
   RUN laddacmb_UI.
   FRAME FRAME-ORG:HIDDEN = FALSE.
   FRAME FRAME-ORG:MOVE-TO-TOP().
   ASSIGN
   RAD_VAL = 1
   mittdatum = TODAY.
   RUN enable_UI.   
   {FRMSIZEF.I}   /*
   BTN_VASCH:LABEL IN FRAME {&FRAME-NAME} = "Visa alla~nveckoscheman".
   RUN SetWindowLongA IN Guru.Konstanter:hpApi (BTN_VASCH:HWND IN FRAME {&FRAME-NAME},-16,1409294336,OUTPUT ReturnValue).
   RUN SendMessageA IN Guru.Konstanter:hpApi (BTN_VASCH:HWND IN FRAME {&FRAME-NAME},244,1409294336,1,OUTPUT ReturnValue).
   */
   FILL-IN-VALDA:HIDDEN IN FRAME DEFAULT-FRAME = TRUE.
   FIND FIRST rullschtemp NO-LOCK NO-ERROR.
   IF AVAILABLE rullschtemp THEN DO: 
      ASSIGN
      /*CMB_RUL:SCREEN-VALUE IN FRAME DEFAULT-FRAME = STRING(rullschtemp.RULLID)*/
      CMB_RUL = rullschtemp.RULLID.
      FILL-IN_TEXT:SCREEN-VALUE IN FRAME DEFAULT-FRAME = rullschtemp.BENAMNING.
      FILL-IN_SLUTVNR = ?.
      DISPLAY FILL-IN_SLUTVNR WITH FRAME {&FRAME-NAME}.      
   END.
   IF AVAILABLE rullschtemp THEN DO:
      DO WHILE CMB_ORD:DELETE(1) = TRUE:
      END.
      FOR EACH rullvectemp WHERE rullvectemp.RULLID = INTEGER(CMB_RUL:SCREEN-VALUE):
         CMB_ORD:ADD-LAST(STRING(rullvectemp.ORDNING,"99")) IN FRAME DEFAULT-FRAME. 
      END.
      FIND FIRST rullvectemp WHERE rullvectemp.RULLID = INTEGER(CMB_RUL:SCREEN-VALUE) NO-LOCK NO-ERROR.
      IF AVAILABLE rullvectemp THEN CMB_ORD = rullvectemp.ORDNING.
      /*IF AVAILABLE rullvectemp THEN CMB_ORD:SCREEN-VALUE = STRING(rullvectemp.ORDNING).*/
      FILL-IN_TEXT:SCREEN-VALUE = rullschtemp.BENAMNING.
   END.
   CMB_RUL:DELETE("00") IN FRAME DEFAULT-FRAME.
   CMB_VNR1:DELETE("00") IN FRAME FRAME-ORG.
   CMB_VNR2:DELETE("00") IN FRAME FRAME-ORG.
   CMB_VNR3:DELETE("00") IN FRAME FRAME-ORG.
   CMB_VEC:DELETE("00") IN FRAME DEFAULT-FRAME.
   RUN laddapersdata_UI.
   RUN radvalchange_UI (INPUT 1).
   FILL-IN_STARTVNR:SCREEN-VALUE IN FRAME DEFAULT-FRAME = FILL-IN-VNR2:SCREEN-VALUE IN FRAME FRAME-ORG.
   RUN openbdynspec_UI IN brwproc[1].
   FIND FIRST valperstemp WHERE valperstemp.PERSONALKOD = perskod NO-LOCK NO-ERROR.
   RUN selectbyrowid_UI IN brwproc[1] (INPUT ROWID(valperstemp)).
   BRW_RULLPERS:DESELECT-FOCUSED-ROW() IN FRAME DEFAULT-FRAME NO-ERROR.   
   FRAME FRAME-ARB:HIDDEN = TRUE.    
   {WIN_M_SLUT.I}      
   IF NOT THIS-PROCEDURE:PERSISTENT THEN
   WAIT-FOR CLOSE OF THIS-PROCEDURE.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


/* **********************  Internal Procedures  *********************** */

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE allstartbrw_UI C-Win 
PROCEDURE allstartbrw_UI :
/* -----------------------------------------------------------
  Purpose: Changing screen-value for combo-box CMB_OMR     
  Parameters:  Input = Screen-value for CMB_FOR
  Notes:       
-------------------------------------------------------------*/ 
   RUN DYNBRW.P PERSISTENT SET brwproc[1] 
      (INPUT BRW_ORD:HANDLE IN FRAME DEFAULT-FRAME).
   RUN DYNBRW.P PERSISTENT SET brwproc[2] 
      (INPUT BRW_RULLPERS:HANDLE IN FRAME DEFAULT-FRAME).
   RUN DYNBRW.P PERSISTENT SET brwproc[3]    
      (INPUT BRW_RULLVEC:HANDLE IN FRAME DEFAULT-FRAME).
   RUN addfillin_UI IN brwproc[1] 
      (INPUT FILL-IN_SFORNAMN:HANDLE IN FRAME DEFAULT-FRAME, INPUT "FORNAMN").
   RUN addfillin_UI IN brwproc[1] 
      (INPUT FILL-IN_SEFTERNAMN:HANDLE IN FRAME DEFAULT-FRAME, INPUT "EFTERNAMN").
   RUN addfillin_UI IN brwproc[1] 
      (INPUT FILL-IN_SPERSONALKOD:HANDLE IN FRAME DEFAULT-FRAME, INPUT "PERSONALKOD").
   RUN setcolindex_UI IN brwproc[2] (INPUT " STARTDATUM DESCENDING ").

   IF Guru.Konstanter:appcon THEN RUN ARBETSTIDAPP.P PERSISTENT SET arbproch ON Guru.Konstanter:apphand TRANSACTION DISTINCT.
   ELSE RUN ARBETSTIDAPP.P PERSISTENT SET arbproch.
   RUN laddatemp_UI IN arbproch 
     (OUTPUT TABLE arbtidtemp, OUTPUT TABLE veckoarbtemp, 
      OUTPUT TABLE rullvectemp, OUTPUT TABLE rullschtemp,
      OUTPUT TABLE rullperstemp).  
   EMPTY TEMP-TABLE rullperstemp NO-ERROR. 
   FOR EACH valperstemp:
      RUN laddarullptemp_UI IN arbproch (INPUT valperstemp.PERSONALKOD,OUTPUT TABLE rullperstemp APPEND).
   END.
   RUN mouseselclick_UI IN brwproc[3] (INPUT FALSE).
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE bort_UI C-Win 
PROCEDURE bort_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   MESSAGE "Vill du ta bort rullschema med startdatum(" rullperstemp.STARTDATUM 
      ") och slutdatum(" rullperstemp.SLUTDATUM ")?" VIEW-AS ALERT-BOX
   QUESTION BUTTONS YES-NO UPDATE fragval.
   IF fragval = TRUE THEN DO:
      RUN rullbort_UI IN arbproch (INPUT rullperstemp.PERSONALKOD, INPUT rullperstemp.STARTDATUM, 
                                   INPUT rullperstemp.SLUTDATUM).
      DELETE rullperstemp.
      RUN setcolsortvar_UI IN brwproc[2] (INPUT " WHERE rullperstemp.PERSONALKOD = '" + perskod + "' "). 
      RUN openbdynspec_UI IN brwproc[2].
      /*
      RUN openbdyn_UI IN brwproc[2] (INPUT " WHERE rullperstemp.PERSONALKOD = '" + perskod + "' ").
      */
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE dagfix_UI C-Win 
PROCEDURE dagfix_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE INPUT PARAMETER dagh AS HANDLE NO-UNDO.
   FIND FIRST dagtemp WHERE dagtemp.DAGCMB = dagh:HANDLE NO-LOCK NO-ERROR.
   IF AVAILABLE dagtemp THEN DO:
      FIND FIRST arbtidtemp WHERE arbtidtemp.ARBTIDKOD = INTEGER(dagtemp.DAGCMB:SCREEN-VALUE) NO-LOCK NO-ERROR.
      IF AVAILABLE arbtidtemp THEN DO:
         ASSIGN
         dagtemp.BORJFALT:SCREEN-VALUE = STRING(arbtidtemp.START)
         dagtemp.SLUTFALT:SCREEN-VALUE = STRING(arbtidtemp.SLUT)
         dagtemp.TIMFALT:SCREEN-VALUE = STRING(arbtidtemp.TOTDAGTID).
      END.      
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE disable_UI C-Win  _DEFAULT-DISABLE
PROCEDURE disable_UI :
/*------------------------------------------------------------------------------
  Purpose:     DISABLE the User Interface
  Parameters:  <none>
  Notes:       Here we clean-up the user-interface by deleting
               dynamic widgets we have created and/or hide 
               frames.  This procedure is usually called when
               we are ready to "clean-up" after running.
------------------------------------------------------------------------------*/
  /* Delete the WINDOW we created */
  IF SESSION:DISPLAY-TYPE = "GUI":U AND VALID-HANDLE(C-Win)
  THEN DELETE WIDGET C-Win.
  IF THIS-PROCEDURE:PERSISTENT THEN DELETE PROCEDURE THIS-PROCEDURE.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE enable_UI C-Win  _DEFAULT-ENABLE
PROCEDURE enable_UI :
/*------------------------------------------------------------------------------
  Purpose:     ENABLE the User Interface
  Parameters:  <none>
  Notes:       Here we display/view/enable the widgets in the
               user-interface.  In addition, OPEN all queries
               associated with each FRAME and BROWSE.
               These statements here are based on the "Other 
               Settings" section of the widget Property Sheets.
------------------------------------------------------------------------------*/
  DISPLAY RAD_VAL CMB_VEC FILL-IN_STARTVNR FILL-IN_SLUTVNR FILL-IN_SFORNAMN 
          FILL-IN_SPERSONALKOD FILL-IN_SEFTERNAMN FILL-IN-RUBR1 FILL-IN-VALDA 
          FILL-IN_PERSON FILL-IN_FORNAMN FILL-IN_TEXT FILL-IN_EFTERNAMN 
          FILL-IN_OMRADE 
      WITH FRAME DEFAULT-FRAME IN WINDOW C-Win.
  ENABLE RECT-21 RECT-47 RECT-48 RAD_VAL CMB_RUL CMB_VEC CMB_ORD BTN_STARTVF 
         BTN_SLUTVF BTN_SKAPA FILL-IN_STARTVNR FILL-IN_SLUTVNR BTN_AKTVEC 
         BTN_CLEAR BTN_STARTVB BTN_SLUTVB BRW_ORD BRW_RULLPERS BRW_RULLVEC 
         BTN_VRULL BTN_VASCH FILL-IN_SFORNAMN FILL-IN_SPERSONALKOD 
         FILL-IN_SEFTERNAMN BTN_BORT BTN_AVB FILL-IN-RUBR1 FILL-IN-VALDA 
         FILL-IN_FORNAMN FILL-IN_TEXT FILL-IN_EFTERNAMN FILL-IN_OMRADE 
      WITH FRAME DEFAULT-FRAME IN WINDOW C-Win.
  {&OPEN-BROWSERS-IN-QUERY-DEFAULT-FRAME}
  DISPLAY FILL-IN-TOTV1A FILL-IN-VNR1A FILL-IN-BOR1V1A FILL-IN-BOR2V1A 
          FILL-IN-BOR3V1A FILL-IN-BOR4V1A FILL-IN-BOR5V1A FILL-IN-BOR6V1A 
          FILL-IN-BOR7V1A FILL-IN-SLU1V1A FILL-IN-SLU2V1A FILL-IN-SLU3V1A 
          FILL-IN-SLU4V1A FILL-IN-SLU5V1A FILL-IN-SLU6V1A FILL-IN-SLU7V1A 
          FILL-IN-TIM1V1A FILL-IN-TIM2V1A FILL-IN-TIM3V1A FILL-IN-TIM4V1A 
          FILL-IN-TIM5V1A FILL-IN-TIM6V1A FILL-IN-TIM7V1A FILL-IN-TOTV2A 
          FILL-IN-VNR2A FILL-IN-BOR1V2A FILL-IN-BOR2V2A FILL-IN-BOR3V2A 
          FILL-IN-BOR4V2A FILL-IN-BOR5V2A FILL-IN-BOR6V2A FILL-IN-BOR7V2A 
          FILL-IN-SLU1V2A FILL-IN-SLU2V2A FILL-IN-SLU3V2A FILL-IN-SLU4V2A 
          FILL-IN-SLU5V2A FILL-IN-SLU6V2A FILL-IN-SLU7V2A FILL-IN-TIM1V2A 
          FILL-IN-TIM2V2A FILL-IN-TIM3V2A FILL-IN-TIM4V2A FILL-IN-TIM5V2A 
          FILL-IN-TIM6V2A FILL-IN-TIM7V2A FILL-IN-TOTV3A FILL-IN-VNR3A 
          FILL-IN-BOR1V3A FILL-IN-BOR2V3A FILL-IN-BOR3V3A FILL-IN-BOR4V3A 
          FILL-IN-BOR5V3A FILL-IN-BOR6V3A FILL-IN-BOR7V3A FILL-IN-SLU1V3A 
          FILL-IN-SLU2V3A FILL-IN-SLU3V3A FILL-IN-SLU4V3A FILL-IN-SLU5V3A 
          FILL-IN-SLU6V3A FILL-IN-SLU7V3A FILL-IN-TIM1V3A FILL-IN-TIM2V3A 
          FILL-IN-TIM3V3A FILL-IN-TIM4V3A FILL-IN-TIM5V3A FILL-IN-TIM6V3A 
          FILL-IN-TIM7V3A 
      WITH FRAME FRAME-ARB IN WINDOW C-Win.
  ENABLE BTN_UPP-3 BTN_NER-3 FILL-IN-TOTV1A FILL-IN-VNR1A FILL-IN-BOR1V1A 
         FILL-IN-BOR2V1A FILL-IN-BOR3V1A FILL-IN-BOR4V1A FILL-IN-BOR5V1A 
         FILL-IN-BOR6V1A FILL-IN-BOR7V1A FILL-IN-SLU1V1A FILL-IN-SLU2V1A 
         FILL-IN-SLU3V1A FILL-IN-SLU4V1A FILL-IN-SLU5V1A FILL-IN-SLU6V1A 
         FILL-IN-SLU7V1A FILL-IN-TIM1V1A FILL-IN-TIM2V1A FILL-IN-TIM3V1A 
         FILL-IN-TIM4V1A FILL-IN-TIM5V1A FILL-IN-TIM6V1A FILL-IN-TIM7V1A 
         FILL-IN-TOTV2A FILL-IN-VNR2A FILL-IN-BOR1V2A FILL-IN-BOR2V2A 
         FILL-IN-BOR3V2A FILL-IN-BOR4V2A FILL-IN-BOR5V2A FILL-IN-BOR6V2A 
         FILL-IN-BOR7V2A FILL-IN-SLU1V2A FILL-IN-SLU2V2A FILL-IN-SLU3V2A 
         FILL-IN-SLU4V2A FILL-IN-SLU5V2A FILL-IN-SLU6V2A FILL-IN-SLU7V2A 
         FILL-IN-TIM1V2A FILL-IN-TIM2V2A FILL-IN-TIM3V2A FILL-IN-TIM4V2A 
         FILL-IN-TIM5V2A FILL-IN-TIM6V2A FILL-IN-TIM7V2A FILL-IN-TOTV3A 
         FILL-IN-VNR3A FILL-IN-BOR1V3A FILL-IN-BOR2V3A FILL-IN-BOR3V3A 
         FILL-IN-BOR4V3A FILL-IN-BOR5V3A FILL-IN-BOR6V3A FILL-IN-BOR7V3A 
         FILL-IN-SLU1V3A FILL-IN-SLU2V3A FILL-IN-SLU3V3A FILL-IN-SLU4V3A 
         FILL-IN-SLU5V3A FILL-IN-SLU6V3A FILL-IN-SLU7V3A FILL-IN-TIM1V3A 
         FILL-IN-TIM2V3A FILL-IN-TIM3V3A FILL-IN-TIM4V3A FILL-IN-TIM5V3A 
         FILL-IN-TIM6V3A FILL-IN-TIM7V3A 
      WITH FRAME FRAME-ARB IN WINDOW C-Win.
  {&OPEN-BROWSERS-IN-QUERY-FRAME-ARB}
  DISPLAY CMB_D1V1 CMB_D2V1 CMB_D3V1 CMB_D4V1 CMB_D5V1 CMB_D6V1 CMB_D7V1 
          CMB_VNR1 CMB_D1V2 CMB_D2V2 CMB_D3V2 CMB_D4V2 CMB_D5V2 CMB_D6V2 
          CMB_D7V2 CMB_VNR2 CMB_D1V3 CMB_D2V3 CMB_D3V3 CMB_D4V3 CMB_D5V3 
          CMB_D6V3 CMB_D7V3 CMB_VNR3 FILL-IN-2 FILL-IN-TOTV1 FILL-IN-RUBR3 
          FILL-IN-BOR1V1 FILL-IN-BOR2V1 FILL-IN-BOR3V1 FILL-IN-BOR4V1 
          FILL-IN-BOR5V1 FILL-IN-BOR6V1 FILL-IN-BOR7V1 FILL-IN-VNR1 
          FILL-IN-SLU1V1 FILL-IN-SLU2V1 FILL-IN-SLU3V1 FILL-IN-SLU4V1 
          FILL-IN-SLU5V1 FILL-IN-SLU6V1 FILL-IN-SLU7V1 FILL-IN-TIM1V1 
          FILL-IN-TIM2V1 FILL-IN-TIM3V1 FILL-IN-TIM4V1 FILL-IN-TIM5V1 
          FILL-IN-TIM6V1 FILL-IN-TIM7V1 FILL-IN-TOTV2 FILL-IN-VNR2 
          FILL-IN-BOR1V2 FILL-IN-BOR2V2 FILL-IN-BOR3V2 FILL-IN-BOR4V2 
          FILL-IN-BOR5V2 FILL-IN-BOR6V2 FILL-IN-BOR7V2 FILL-IN-SLU1V2 
          FILL-IN-SLU2V2 FILL-IN-SLU3V2 FILL-IN-SLU4V2 FILL-IN-SLU5V2 
          FILL-IN-SLU6V2 FILL-IN-SLU7V2 FILL-IN-TIM1V2 FILL-IN-TIM2V2 
          FILL-IN-TIM3V2 FILL-IN-TIM4V2 FILL-IN-TIM5V2 FILL-IN-TIM6V2 
          FILL-IN-TIM7V2 FILL-IN-TOTV3 FILL-IN-BOR1V3 FILL-IN-BOR2V3 
          FILL-IN-BOR3V3 FILL-IN-BOR4V3 FILL-IN-BOR5V3 FILL-IN-BOR6V3 
          FILL-IN-BOR7V3 FILL-IN-VNR3 FILL-IN-SLU1V3 FILL-IN-SLU2V3 
          FILL-IN-SLU3V3 FILL-IN-SLU4V3 FILL-IN-SLU5V3 FILL-IN-SLU6V3 
          FILL-IN-SLU7V3 FILL-IN-TIM1V3 FILL-IN-TIM2V3 FILL-IN-TIM3V3 
          FILL-IN-TIM4V3 FILL-IN-TIM5V3 FILL-IN-TIM6V3 FILL-IN-TIM7V3 
      WITH FRAME FRAME-ORG IN WINDOW C-Win.
  ENABLE CMB_D1V1 CMB_D2V1 CMB_D3V1 CMB_D4V1 CMB_D5V1 CMB_D6V1 CMB_D7V1 
         CMB_VNR1 BTN_UPP-2 CMB_D1V2 CMB_D2V2 CMB_D3V2 CMB_D4V2 CMB_D5V2 
         CMB_D6V2 CMB_D7V2 CMB_VNR2 BTN_NER-2 CMB_D1V3 CMB_D2V3 CMB_D3V3 
         CMB_D4V3 CMB_D5V3 CMB_D6V3 CMB_D7V3 CMB_VNR3 FILL-IN-2 FILL-IN-TOTV1 
         FILL-IN-RUBR3 FILL-IN-BOR1V1 FILL-IN-BOR2V1 FILL-IN-BOR3V1 
         FILL-IN-BOR4V1 FILL-IN-BOR5V1 FILL-IN-BOR6V1 FILL-IN-BOR7V1 
         FILL-IN-VNR1 FILL-IN-SLU1V1 FILL-IN-SLU2V1 FILL-IN-SLU3V1 
         FILL-IN-SLU4V1 FILL-IN-SLU5V1 FILL-IN-SLU6V1 FILL-IN-SLU7V1 
         FILL-IN-TIM1V1 FILL-IN-TIM2V1 FILL-IN-TIM3V1 FILL-IN-TIM4V1 
         FILL-IN-TIM5V1 FILL-IN-TIM6V1 FILL-IN-TIM7V1 FILL-IN-TOTV2 
         FILL-IN-VNR2 FILL-IN-BOR1V2 FILL-IN-BOR2V2 FILL-IN-BOR3V2 
         FILL-IN-BOR4V2 FILL-IN-BOR5V2 FILL-IN-BOR6V2 FILL-IN-BOR7V2 
         FILL-IN-SLU1V2 FILL-IN-SLU2V2 FILL-IN-SLU3V2 FILL-IN-SLU4V2 
         FILL-IN-SLU5V2 FILL-IN-SLU6V2 FILL-IN-SLU7V2 FILL-IN-TIM1V2 
         FILL-IN-TIM2V2 FILL-IN-TIM3V2 FILL-IN-TIM4V2 FILL-IN-TIM5V2 
         FILL-IN-TIM6V2 FILL-IN-TIM7V2 FILL-IN-TOTV3 FILL-IN-BOR1V3 
         FILL-IN-BOR2V3 FILL-IN-BOR3V3 FILL-IN-BOR4V3 FILL-IN-BOR5V3 
         FILL-IN-BOR6V3 FILL-IN-BOR7V3 FILL-IN-VNR3 FILL-IN-SLU1V3 
         FILL-IN-SLU2V3 FILL-IN-SLU3V3 FILL-IN-SLU4V3 FILL-IN-SLU5V3 
         FILL-IN-SLU6V3 FILL-IN-SLU7V3 FILL-IN-TIM1V3 FILL-IN-TIM2V3 
         FILL-IN-TIM3V3 FILL-IN-TIM4V3 FILL-IN-TIM5V3 FILL-IN-TIM6V3 
         FILL-IN-TIM7V3 
      WITH FRAME FRAME-ORG IN WINDOW C-Win.
  {&OPEN-BROWSERS-IN-QUERY-FRAME-ORG}
  DISPLAY FILL-IN-D1 FILL-IN-D2 FILL-IN-D3 FILL-IN-D4 FILL-IN-D5 FILL-IN-D6 
          FILL-IN-D7 FILL-IN-AB1 FILL-IN-AB2 FILL-IN-AB3 FILL-IN-AB4 FILL-IN-AB5 
          FILL-IN-AB6 FILL-IN-AB7 FILL-IN-FB1 FILL-IN-FB2 FILL-IN-FB3 
          FILL-IN-FB4 FILL-IN-FB5 FILL-IN-FB6 FILL-IN-FB7 FILL-IN-FS1 
          FILL-IN-FS2 FILL-IN-FS3 FILL-IN-FS4 FILL-IN-FS5 FILL-IN-FS6 
          FILL-IN-FS7 FILL-IN-LB1 FILL-IN-LB2 FILL-IN-LB3 FILL-IN-LB4 
          FILL-IN-LB5 FILL-IN-LB6 FILL-IN-LB7 FILL-IN-LS1 FILL-IN-LS2 
          FILL-IN-LS3 FILL-IN-LS4 FILL-IN-LS5 FILL-IN-LS6 FILL-IN-LS7 
          FILL-IN-TOTV1 FILL-IN-VECO1 FILL-IN-KB1 FILL-IN-KB2 FILL-IN-KB3 
          FILL-IN-KB4 FILL-IN-KB5 FILL-IN-KB6 FILL-IN-KB7 FILL-IN-KS1 
          FILL-IN-KS2 FILL-IN-KS3 FILL-IN-KS4 FILL-IN-KS5 FILL-IN-KS6 
          FILL-IN-KS7 FILL-IN-AS1 FILL-IN-AS2 FILL-IN-AS3 FILL-IN-AS4 
          FILL-IN-AS5 FILL-IN-AS6 FILL-IN-AS7 FILL-IN-TIM1 FILL-IN-TIM2 
          FILL-IN-TIM3 FILL-IN-TIM4 FILL-IN-TIM5 FILL-IN-TIM6 FILL-IN-TIM7 
      WITH FRAME FRAME-VISA IN WINDOW C-Win.
  ENABLE FILL-IN-D1 FILL-IN-D2 FILL-IN-D3 FILL-IN-D4 FILL-IN-D5 FILL-IN-D6 
         FILL-IN-D7 FILL-IN-AB1 FILL-IN-AB2 FILL-IN-AB3 FILL-IN-AB4 FILL-IN-AB5 
         FILL-IN-AB6 FILL-IN-AB7 FILL-IN-FB1 FILL-IN-FB2 FILL-IN-FB3 
         FILL-IN-FB4 FILL-IN-FB5 FILL-IN-FB6 FILL-IN-FB7 FILL-IN-FS1 
         FILL-IN-FS2 FILL-IN-FS3 FILL-IN-FS4 FILL-IN-FS5 FILL-IN-FS6 
         FILL-IN-FS7 FILL-IN-LB1 FILL-IN-LB2 FILL-IN-LB3 FILL-IN-LB4 
         FILL-IN-LB5 FILL-IN-LB6 FILL-IN-LB7 FILL-IN-LS1 FILL-IN-LS2 
         FILL-IN-LS3 FILL-IN-LS4 FILL-IN-LS5 FILL-IN-LS6 FILL-IN-LS7 
         FILL-IN-TOTV1 FILL-IN-VECO1 FILL-IN-KB1 FILL-IN-KB2 FILL-IN-KB3 
         FILL-IN-KB4 FILL-IN-KB5 FILL-IN-KB6 FILL-IN-KB7 FILL-IN-KS1 
         FILL-IN-KS2 FILL-IN-KS3 FILL-IN-KS4 FILL-IN-KS5 FILL-IN-KS6 
         FILL-IN-KS7 FILL-IN-AS1 FILL-IN-AS2 FILL-IN-AS3 FILL-IN-AS4 
         FILL-IN-AS5 FILL-IN-AS6 FILL-IN-AS7 FILL-IN-TIM1 FILL-IN-TIM2 
         FILL-IN-TIM3 FILL-IN-TIM4 FILL-IN-TIM5 FILL-IN-TIM6 FILL-IN-TIM7 
      WITH FRAME FRAME-VISA IN WINDOW C-Win.
  {&OPEN-BROWSERS-IN-QUERY-FRAME-VISA}
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE laddacmb_UI C-Win 
PROCEDURE laddacmb_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   FOR EACH rullschtemp:
      CMB_RUL:ADD-LAST(STRING(rullschtemp.RULLID,"99")) IN FRAME DEFAULT-FRAME. 
   END.
   FOR EACH veckoarbtemp:
      CMB_VNR1:ADD-LAST(STRING(veckoarbtemp.VECKOSCHEMA,">99")) IN FRAME FRAME-ORG. 
      CMB_VNR2:ADD-LAST(STRING(veckoarbtemp.VECKOSCHEMA,">99")) IN FRAME FRAME-ORG. 
      CMB_VNR3:ADD-LAST(STRING(veckoarbtemp.VECKOSCHEMA,">99")) IN FRAME FRAME-ORG. 
      CMB_VEC:ADD-LAST(STRING(veckoarbtemp.VECKOSCHEMA,">99")) IN FRAME DEFAULT-FRAME. 
   END.
   CREATE vectemp.
   ASSIGN
   vectemp.VEC = 1
   vectemp.VECFALT = FILL-IN-VNR1:HANDLE
   vectemp.SCHCMB = CMB_VNR1:HANDLE
   vectemp.TOTFALT = FILL-IN-TOTV1:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 1
   dagtemp.DAG = 1
   dagtemp.DAGCMB = CMB_D1V1:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR1V1:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU1V1:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM1V1:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 1
   dagtemp.DAG = 2
   dagtemp.DAGCMB = CMB_D2V1:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR2V1:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU2V1:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM2V1:HANDLE.  
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 1
   dagtemp.DAG = 3
   dagtemp.DAGCMB = CMB_D3V1:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR3V1:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU3V1:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM3V1:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 1
   dagtemp.DAG = 4
   dagtemp.DAGCMB = CMB_D4V1:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR4V1:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU4V1:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM4V1:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 1
   dagtemp.DAG = 5
   dagtemp.DAGCMB = CMB_D5V1:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR5V1:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU5V1:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM5V1:HANDLE.  
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 1
   dagtemp.DAG = 6
   dagtemp.DAGCMB = CMB_D6V1:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR6V1:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU6V1:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM6V1:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 1
   dagtemp.DAG = 7
   dagtemp.DAGCMB = CMB_D7V1:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR7V1:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU7V1:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM7V1:HANDLE.
   CREATE vectemp.
   ASSIGN
   vectemp.VEC = 2
   vectemp.VECFALT = FILL-IN-VNR2:HANDLE
   vectemp.SCHCMB = CMB_VNR2:HANDLE
   vectemp.TOTFALT = FILL-IN-TOTV2:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 2
   dagtemp.DAG = 1
   dagtemp.DAGCMB = CMB_D1V2:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR1V2:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU1V2:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM1V2:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 2
   dagtemp.DAG = 2
   dagtemp.DAGCMB = CMB_D2V2:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR2V2:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU2V2:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM2V2:HANDLE.  
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 2
   dagtemp.DAG = 3
   dagtemp.DAGCMB = CMB_D3V2:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR3V2:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU3V2:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM3V2:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 2
   dagtemp.DAG = 4
   dagtemp.DAGCMB = CMB_D4V2:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR4V2:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU4V2:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM4V2:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 2
   dagtemp.DAG = 5
   dagtemp.DAGCMB = CMB_D5V2:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR5V2:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU5V2:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM5V2:HANDLE.  
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 2
   dagtemp.DAG = 6
   dagtemp.DAGCMB = CMB_D6V2:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR6V2:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU6V2:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM6V2:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 2
   dagtemp.DAG = 7
   dagtemp.DAGCMB = CMB_D7V2:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR7V2:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU7V2:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM7V2:HANDLE.   
   CREATE vectemp.
   ASSIGN
   vectemp.VEC = 3
   vectemp.VECFALT = FILL-IN-VNR3:HANDLE
   vectemp.SCHCMB = CMB_VNR3:HANDLE
   vectemp.TOTFALT = FILL-IN-TOTV3:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 3
   dagtemp.DAG = 1
   dagtemp.DAGCMB = CMB_D1V3:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR1V3:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU1V3:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM1V3:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 3
   dagtemp.DAG = 2
   dagtemp.DAGCMB = CMB_D2V3:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR2V3:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU2V3:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM2V3:HANDLE.  
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 3
   dagtemp.DAG = 3
   dagtemp.DAGCMB = CMB_D3V3:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR3V3:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU3V3:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM3V3:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 3
   dagtemp.DAG = 4
   dagtemp.DAGCMB = CMB_D4V3:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR4V3:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU4V3:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM4V3:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 3
   dagtemp.DAG = 5
   dagtemp.DAGCMB = CMB_D5V3:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR5V3:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU5V3:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM5V3:HANDLE.  
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 3
   dagtemp.DAG = 6
   dagtemp.DAGCMB = CMB_D6V3:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR6V3:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU6V3:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM6V3:HANDLE.
   CREATE dagtemp.
   ASSIGN 
   dagtemp.VEC = 3
   dagtemp.DAG = 7
   dagtemp.DAGCMB = CMB_D7V3:HANDLE
   dagtemp.BORJFALT = FILL-IN-BOR7V3:HANDLE
   dagtemp.SLUTFALT = FILL-IN-SLU7V3:HANDLE
   dagtemp.TIMFALT = FILL-IN-TIM7V3:HANDLE.   
   FOR EACH dagtemp:
      dagtemp.DAGCMB:DELETE("00").
      FOR EACH arbtidtemp:
         dagtemp.DAGCMB:ADD-LAST(STRING(arbtidtemp.ARBTIDKOD,">99")).
      END.
   END.
   ON VALUE-CHANGED OF CMB_VNR1, CMB_VNR2, CMB_VNR3 PERSISTENT RUN "valchangevec_UI" IN THIS-PROCEDURE. 
   ON VALUE-CHANGED OF CMB_D1V1, CMB_D2V1, CMB_D3V1, CMB_D4V1, CMB_D5V1, CMB_D6V1, CMB_D7V1,
      CMB_D1V2, CMB_D2V2, CMB_D3V2, CMB_D4V2, CMB_D5V2, CMB_D6V2, CMB_D7V2,
      CMB_D1V3, CMB_D2V3, CMB_D3V3, CMB_D4V3, CMB_D5V3, CMB_D6V3, CMB_D7V3
      PERSISTENT RUN "valchangedag_UI" IN THIS-PROCEDURE. 
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE laddapersdata_UI C-Win 
PROCEDURE laddapersdata_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   IF AVAILABLE valperstemp THEN DO:

      IF gamlapkod NE valperstemp.PERSONALKOD THEN mittdatum = TODAY.
      CMB_VEC:SCREEN-VALUE IN FRAME DEFAULT-FRAME = STRING(valperstemp.VECKOSCHEMA,">99").
      FIND FIRST omrtemp WHERE omrtemp.OMRADE = valperstemp.OMRADE NO-LOCK NO-ERROR.
      IF AVAILABLE omrtemp THEN FILL-IN_OMRADE = omrtemp.NAMN.
      ASSIGN
      FILL-IN_EFTERNAMN = valperstemp.EFTERNAMN
      FILL-IN_PERSON = valperstemp.PERSONALKOD
      FILL-IN_FORNAMN = valperstemp.FORNAMN.
      DISPLAY FILL-IN_EFTERNAMN FILL-IN_PERSON FILL-IN_OMRADE FILL-IN_FORNAMN WITH FRAME DEFAULT-FRAME.
      RUN laddavec_UI (INPUT mittdatum).
      RUN openrullpers_UI.
   END.
   FRAME FRAME-ORG:HIDDEN = FALSE.
   FRAME FRAME-VISA:HIDDEN = TRUE.
   FRAME FRAME-ORG:MOVE-TO-TOP().
   IF RAD_VAL = 3 THEN DO:
      FRAME FRAME-ARB:HIDDEN = FALSE.
      FRAME FRAME-ARB:MOVE-TO-TOP().
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE laddavec_UI C-Win 
PROCEDURE laddavec_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE INPUT PARAMETER midvecdate AS DATE NO-UNDO.

   IF AVAILABLE valperstemp THEN DO: /* Hämtar 3*VNR samt 3*Veckoscheman med givet datum(midvecdate) + P-kod */
      RUN veckocheck_UI IN arbproch (INPUT valperstemp.PERSONALKOD, INPUT midvecdate, OUTPUT TABLE vecdagtemp). 
      FOR EACH vectemp, EACH vecdagtemp WHERE vecdagtemp.VEC = vectemp.VEC:
         ASSIGN
         vectemp.VECFALT:SCREEN-VALUE = STRING(vecdagtemp.VNR)
         vectemp.SCHCMB:SCREEN-VALUE = STRING(vecdagtemp.VECSCH)
         vectemp.SCHCMB:PRIVATE-DATA = STRING(vecdagtemp.VECSCH).  /* Används vid fråga om byte av tillfälligt*/
         RUN vecchange_UI (INPUT vectemp.SCHCMB:HANDLE). /* Uppdatera DAG-Combo-boxarna och fill-in-fält */
      END.                                                                                                              
      FILL-IN_STARTVNR:SCREEN-VALUE IN FRAME DEFAULT-FRAME = FILL-IN-VNR2:SCREEN-VALUE IN FRAME FRAME-ORG. 
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE openrullpers_UI C-Win 
PROCEDURE openrullpers_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   RUN setcolsortvar_UI IN brwproc[2] (INPUT " WHERE rullperstemp.PERSONALKOD = '" + perskod + "' "). 
   RUN openbdynspec_UI IN brwproc[2].
   /*
   RUN openbdyn_UI IN brwproc[2] (INPUT " WHERE rullperstemp.PERSONALKOD = '" + perskod + "' ").
   */   
   FIND FIRST rullperstemp WHERE rullperstemp.PERSONALKOD = perskod AND
   rullperstemp.STARTDATUM <= mittdatum AND rullperstemp.SLUTDATUM >= mittdatum NO-LOCK NO-ERROR.
   IF NOT AVAILABLE rullperstemp THEN DO:
      FIND FIRST rullperstemp WHERE rullperstemp.PERSONALKOD = perskod AND
      rullperstemp.STARTDATUM <= mittdatum AND rullperstemp.SLUTDATUM = ? NO-LOCK NO-ERROR.
   END.   
   IF AVAILABLE rullperstemp THEN DO:      
   /*   RUN selectbyrowid_UI IN brwproc[2] (INPUT ROWID(rullperstemp)).*/
      /*LENA 2005-06/22*/
      DO WHILE CMB_ORD:DELETE(1) IN FRAME DEFAULT-FRAME = TRUE : 
      END.
      FOR EACH rullvectemp WHERE rullvectemp.RULLID = rullperstemp.RULLID:
         CMB_ORD:ADD-LAST(STRING(rullvectemp.ORDNING,"99")) IN FRAME DEFAULT-FRAME. 
      END.
      ASSIGN
      CMB_RUL = rullperstemp.RULLID
      CMB_ORD = rullperstemp.ORDNING.       
      IF RAD_VAL = 2 THEN DO:
         CMB_RUL:SCREEN-VALUE = STRING(rullperstemp.RULLID).
         CMB_ORD:SCREEN-VALUE = STRING(rullperstemp.ORDNING).
         DISPLAY CMB_RUL CMB_ORD WITH FRAME DEFAULT-FRAME.
         FIND FIRST rullschtemp WHERE rullschtemp.RULLID = CMB_RUL NO-LOCK NO-ERROR.
         IF AVAILABLE rullschtemp THEN DO:
            FILL-IN_TEXT:SCREEN-VALUE = rullschtemp.BENAMNING.      
         END.
      END.            
      FIND FIRST rullschtemp WHERE rullschtemp.RULLID = CMB_RUL NO-LOCK NO-ERROR.
      IF AVAILABLE rullschtemp THEN DO:         
         RUN setorgtitle_UI IN brwproc[3] (INPUT "Rullschema: " + STRING(CMB_RUL) + " " + rullschtemp.BENAMNING).         
         RUN setcolsortvar_UI IN brwproc[3] (INPUT " WHERE rullvectemp.RULLID = '" + STRING(CMB_RUL) + "' "). 
         RUN openbdynspec_UI IN brwproc[3].
      END.      
      RUN rullperschange_UI.
   END.   
   ELSE DO:
      IF RAD_VAL = 2 THEN DO:
         FIND FIRST rullschtemp WHERE rullschtemp.RULLID = CMB_RUL NO-LOCK NO-ERROR.
         IF AVAILABLE rullschtemp THEN DO:         
            RUN setorgtitle_UI IN brwproc[3] (INPUT "Rullschema: " + STRING(CMB_RUL) + " " + rullschtemp.BENAMNING).         
            RUN setcolsortvar_UI IN brwproc[3] (INPUT " WHERE rullvectemp.RULLID = '" + STRING(CMB_RUL) + "' "). 
            RUN openbdynspec_UI IN brwproc[3].
         END.      
      END.
      ELSE DO:      
         RUN setorgtitle_UI IN brwproc[3] (INPUT "Rullschema").         
         RUN setcolsortvar_UI IN brwproc[3] (INPUT " WHERE rullvectemp.RULLID = ''"). 
         RUN openbdynspec_UI IN brwproc[3].
         /*
         RUN openbdyn_UI IN brwproc[3] (INPUT " WHERE rullvectemp.RULLID = ''").
         */
      END.
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE radvalchange_UI C-Win 
PROCEDURE radvalchange_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE INPUT PARAMETER val AS INTEGER NO-UNDO.
   ENABLE BRW_RULLPERS BRW_RULLVEC WITH FRAME DEFAULT-FRAME. 
   ASSIGN

   FILL-IN_TEXT:HIDDEN IN FRAME DEFAULT-FRAME = TRUE
   FILL-IN_SLUTVNR:HIDDEN IN FRAME DEFAULT-FRAME = TRUE
   CMB_RUL:HIDDEN IN FRAME DEFAULT-FRAME = TRUE
   CMB_VEC:HIDDEN IN FRAME DEFAULT-FRAME = TRUE
   CMB_ORD:HIDDEN IN FRAME DEFAULT-FRAME = TRUE
   BTN_CLEAR:HIDDEN IN FRAME DEFAULT-FRAME = TRUE
   BTN_SLUTVB:HIDDEN IN FRAME DEFAULT-FRAME = TRUE
   BTN_SLUTVF:HIDDEN IN FRAME DEFAULT-FRAME = TRUE
   /*BTN_VRULL:HIDDEN IN FRAME DEFAULT-FRAME = TRUE .  */
   FRAME FRAME-ARB:HIDDEN = TRUE.    
   IF val = 1 THEN DO:
      ASSIGN   
      BTN_SKAPA:LABEL IN FRAME DEFAULT-FRAME = "Koppla"
      CMB_VEC:HIDDEN IN FRAME DEFAULT-FRAME = FALSE.
      BTN_SKAPA:TOOLTIP = "Koppla ordinarie veckoschema för vald person/personer från och med angiven vecka".
   END.
   ELSE IF val = 2 THEN DO:
      ASSIGN
      FILL-IN_SLUTVNR:HIDDEN IN FRAME DEFAULT-FRAME = FALSE
      BTN_SKAPA:LABEL IN FRAME DEFAULT-FRAME = "Koppla"
      FILL-IN_TEXT:HIDDEN IN FRAME DEFAULT-FRAME = FALSE
      CMB_RUL:HIDDEN IN FRAME DEFAULT-FRAME = FALSE
      CMB_ORD:HIDDEN IN FRAME DEFAULT-FRAME = FALSE
      BTN_CLEAR:HIDDEN IN FRAME DEFAULT-FRAME = FALSE
      BTN_SLUTVB:HIDDEN IN FRAME DEFAULT-FRAME = FALSE
      BTN_SLUTVF:HIDDEN IN FRAME DEFAULT-FRAME = FALSE
      /*BTN_VRULL:HIDDEN IN FRAME DEFAULT-FRAME = FALSE . */
      BTN_SKAPA:TOOLTIP = "Koppla rullschema med angiven startordning till vald person från och med angiven vecka".      
      /*LENA 2005-06/22*/            
      IF AVAILABLE rullperstemp THEN DO:
         DO WHILE CMB_ORD:DELETE(1) = TRUE: 
         END.
         FOR EACH rullvectemp WHERE rullvectemp.RULLID = rullperstemp.RULLID:
            CMB_ORD:ADD-LAST(STRING(rullvectemp.ORDNING,"99")) IN FRAME DEFAULT-FRAME. 
         END.
         ASSIGN
         CMB_RUL = rullperstemp.RULLID
         CMB_ORD = rullperstemp.ORDNING.                
         CMB_RUL:SCREEN-VALUE = STRING(rullperstemp.RULLID).
         CMB_ORD:SCREEN-VALUE = STRING(rullperstemp.ORDNING).
      END.
      ELSE DO:         
         FIND FIRST rullvectemp  NO-LOCK NO-ERROR.
         IF AVAILABLE rullvectemp THEN DO:
            CMB_RUL = rullvectemp.RULLID.
            CMB_ORD = rullvectemp.ORDNING.            
            DO WHILE CMB_ORD:DELETE(1) = TRUE: 
            END.
            FOR EACH rullvectemp WHERE rullvectemp.RULLID = CMB_RUL:
               CMB_ORD:ADD-LAST(STRING(rullvectemp.ORDNING,"99")) IN FRAME DEFAULT-FRAME. 
            END.                        
            FIND FIRST rullvectemp  NO-LOCK NO-ERROR.            
            RUN setorgtitle_UI IN brwproc[3] (INPUT "Rullschema: " + STRING(rullvectemp.RULLID) + " " + rullschtemp.BENAMNING ).         
            RUN setcolsortvar_UI IN brwproc[3] (INPUT " WHERE rullvectemp.RULLID = '" + STRING(CMB_RUL) + "' "). 
            RUN openbdynspec_UI IN brwproc[3].            
         END.
      END.
      DISPLAY CMB_RUL CMB_ORD WITH FRAME DEFAULT-FRAME.
      FIND FIRST rullschtemp WHERE rullschtemp.RULLID = CMB_RUL NO-LOCK NO-ERROR.
      IF AVAILABLE rullschtemp THEN DO:
         FILL-IN_TEXT:SCREEN-VALUE = rullschtemp.BENAMNING.      
         RUN setorgtitle_UI IN brwproc[3] (INPUT "Rullschema: " + STRING(CMB_RUL) + " " + rullschtemp.BENAMNING).         
         RUN setcolsortvar_UI IN brwproc[3] (INPUT " WHERE rullvectemp.RULLID = '" + STRING(CMB_RUL:SCREEN-VALUE) + "' "). 
         RUN openbdynspec_UI IN brwproc[3].
      END.
      /*
      RUN openbdyn_UI IN brwproc[3] (INPUT " WHERE rullvectemp.RULLID = '" + STRING(CMB_RUL:SCREEN-VALUE) + "' ").
                                     */
   END.
   ELSE IF val = 3 THEN DO:              
      DISABLE BRW_RULLPERS BRW_RULLVEC WITH FRAME DEFAULT-FRAME. 
      RUN visarb_UI.
      
      /*FIND FIRST vectemp  WHERE vectemp.VEC = 1 NO-LOCK NO-ERROR.
      FIND FIRST vperstid WHERE vperstid.PERSONALKOD = FILL-IN_PERSON AND
      vperstid.VECKA = INTEGER(vectemp.VECFALT:SCREEN-VALUE) 
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE vperstid THEN DO:
         RUN varbtid_UI IN arbproch (INPUT FILL-IN_PERSON,INPUT INTEGER(vectemp.VECFALT:SCREEN-VALUE), OUTPUT TABLE vperstid APPEND).
      END.
      FILL-IN-TOTV1A  = 0.
      FOR EACH vperstid WHERE vperstid.PERSONALKOD = FILL-IN_PERSON AND vperstid.VECKA = INTEGER(vectemp.VECFALT:SCREEN-VALUE): 
         FILL-IN-VNR1A    = vperstid.VECKA.
         
         IF vperstid.DAG = "mån" THEN DO:
            ASSIGN
            FILL-IN-BOR1V1A  = vperstid.REGSTART              
            FILL-IN-SLU1V1A  = vperstid.REGSLUT
            FILL-IN-TIM1V1A  = vperstid.REGTOTALT
            FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "tis" THEN DO:
            ASSIGN
            FILL-IN-BOR2V1A  = vperstid.REGSTART               
            FILL-IN-SLU2V1A  = vperstid.REGSLUT
            FILL-IN-TIM2V1A  = vperstid.REGTOTALT.
            FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "ons" THEN DO:
            ASSIGN
            FILL-IN-BOR3V1A  = vperstid.REGSTART              
            FILL-IN-SLU3V1A  = vperstid.REGSLUT
            FILL-IN-TIM3V1A  = vperstid.REGTOTALT.
            FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "tor" THEN DO:
            ASSIGN
            FILL-IN-BOR4V1A  = vperstid.REGSTART             
            FILL-IN-SLU4V1A  = vperstid.REGSLUT
            FILL-IN-TIM4V1A  = vperstid.REGTOTALT.
            FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "fre" THEN DO:
            ASSIGN
            FILL-IN-BOR5V1A  = vperstid.REGSTART              
            FILL-IN-SLU5V1A  = vperstid.REGSLUT
            FILL-IN-TIM5V1A  = vperstid.REGTOTALT.
            FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "lör" THEN DO:
            ASSIGN
            FILL-IN-BOR6V1A  = vperstid.REGSTART              
            FILL-IN-SLU6V1A  = vperstid.REGSLUT
            FILL-IN-TIM6V1A  = vperstid.REGTOTALT.
            FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "sön" THEN DO:
            ASSIGN
            FILL-IN-BOR7V1A  = vperstid.REGSTART
            FILL-IN-SLU7V1A  = vperstid.REGSLUT          
            FILL-IN-TIM7V1A  = vperstid.REGTOTALT.
            FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
         END.                       
      END.      
      FIND FIRST vectemp  WHERE vectemp.VEC = 2 NO-LOCK NO-ERROR.
      FIND FIRST vperstid WHERE vperstid.PERSONALKOD = FILL-IN_PERSON AND
      vperstid.VECKA = INTEGER(vectemp.VECFALT:SCREEN-VALUE)  
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE vperstid THEN DO:
         RUN varbtid_UI IN arbproch (INPUT FILL-IN_PERSON,INPUT INTEGER(vectemp.VECFALT:SCREEN-VALUE) , OUTPUT TABLE vperstid APPEND).
      END.
      FILL-IN-TOTV2A  = 0.
      FOR EACH vperstid WHERE vperstid.PERSONALKOD = FILL-IN_PERSON AND vperstid.VECKA = INTEGER(vectemp.VECFALT:SCREEN-VALUE) : 
         FILL-IN-VNR2A    = vperstid.VECKA.
         IF vperstid.DAG = "mån" THEN DO:
            ASSIGN
            FILL-IN-BOR1V2A  = vperstid.REGSTART              
            FILL-IN-SLU1V2A  = vperstid.REGSLUT
            FILL-IN-TIM1V2A  = vperstid.REGTOTALT.
            FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "tis" THEN DO:
            ASSIGN
            FILL-IN-BOR2V2A  = vperstid.REGSTART               
            FILL-IN-SLU2V2A  = vperstid.REGSLUT
            FILL-IN-TIM2V2A  = vperstid.REGTOTALT.
            FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "ons" THEN DO:
            ASSIGN
            FILL-IN-BOR3V2A  = vperstid.REGSTART              
            FILL-IN-SLU3V2A  = vperstid.REGSLUT
            FILL-IN-TIM3V2A  = vperstid.REGTOTALT.
            FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "tor" THEN DO:
            ASSIGN
            FILL-IN-BOR4V2A  = vperstid.REGSTART             
            FILL-IN-SLU4V2A  = vperstid.REGSLUT
            FILL-IN-TIM4V2A  = vperstid.REGTOTALT.
            FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "fre" THEN DO:
            ASSIGN
            FILL-IN-BOR5V2A  = vperstid.REGSTART              
            FILL-IN-SLU5V2A  = vperstid.REGSLUT
            FILL-IN-TIM5V2A  = vperstid.REGTOTALT.
            FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "lör" THEN DO:
            ASSIGN
            FILL-IN-BOR6V2A  = vperstid.REGSTART              
            FILL-IN-SLU6V2A  = vperstid.REGSLUT
            FILL-IN-TIM6V2A  = vperstid.REGTOTALT.
            FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "sön" THEN DO:
            ASSIGN
            FILL-IN-BOR7V2A  = vperstid.REGSTART
            FILL-IN-SLU7V2A  = vperstid.REGSLUT          
            FILL-IN-TIM7V2A  = vperstid.REGTOTALT.
            FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
         END.                       
      END.
      FIND FIRST vectemp  WHERE vectemp.VEC = 3 NO-LOCK NO-ERROR.
      FIND FIRST vperstid WHERE vperstid.PERSONALKOD = FILL-IN_PERSON AND
      vperstid.VECKA = INTEGER(vectemp.VECFALT:SCREEN-VALUE)  
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE vperstid THEN DO:
         RUN varbtid_UI IN arbproch (INPUT FILL-IN_PERSON,INPUT INTEGER(vectemp.VECFALT:SCREEN-VALUE) , OUTPUT TABLE vperstid APPEND).
      END.
      FILL-IN-TOTV3A  = 0.
      FOR EACH vperstid WHERE vperstid.PERSONALKOD = FILL-IN_PERSON AND vperstid.VECKA = INTEGER(vectemp.VECFALT:SCREEN-VALUE) : 
         FILL-IN-VNR3A    = vperstid.VECKA.
         IF vperstid.DAG = "mån" THEN DO:
            ASSIGN
            FILL-IN-BOR1V3A  = vperstid.REGSTART              
            FILL-IN-SLU1V3A  = vperstid.REGSLUT
            FILL-IN-TIM1V3A  = vperstid.REGTOTALT.
            FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "tis" THEN DO:
            ASSIGN
            FILL-IN-BOR2V3A  = vperstid.REGSTART               
            FILL-IN-SLU2V3A  = vperstid.REGSLUT
            FILL-IN-TIM2V3A  = vperstid.REGTOTALT.
            FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "ons" THEN DO:
            ASSIGN
            FILL-IN-BOR3V3A  = vperstid.REGSTART              
            FILL-IN-SLU3V3A  = vperstid.REGSLUT
            FILL-IN-TIM3V3A  = vperstid.REGTOTALT.
            FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "tor" THEN DO:
            ASSIGN
            FILL-IN-BOR4V3A  = vperstid.REGSTART             
            FILL-IN-SLU4V3A  = vperstid.REGSLUT
            FILL-IN-TIM4V3A  = vperstid.REGTOTALT.
            FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "fre" THEN DO:
            ASSIGN
            FILL-IN-BOR5V3A  = vperstid.REGSTART              
            FILL-IN-SLU5V3A  = vperstid.REGSLUT
            FILL-IN-TIM5V3A  = vperstid.REGTOTALT.
            FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "lör" THEN DO:
            ASSIGN
            FILL-IN-BOR6V3A  = vperstid.REGSTART              
            FILL-IN-SLU6V3A  = vperstid.REGSLUT
            FILL-IN-TIM6V3A  = vperstid.REGTOTALT.
            FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
         END.
         IF vperstid.DAG = "sön" THEN DO:
            ASSIGN
            FILL-IN-BOR7V3A  = vperstid.REGSTART
            FILL-IN-SLU7V3A  = vperstid.REGSLUT          
            FILL-IN-TIM7V3A  = vperstid.REGTOTALT.
            FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
         END.                       
      END.
      FRAME FRAME-ARB:HIDDEN = FALSE.
      DISPLAY 
         FILL-IN-VNR1A    
            FILL-IN-BOR1V1A            
            FILL-IN-SLU1V1A  
            FILL-IN-TIM1V1A  
            FILL-IN-BOR2V1A             
            FILL-IN-SLU2V1A  
            FILL-IN-TIM2V1A  
            FILL-IN-BOR3V1A            
            FILL-IN-SLU3V1A  
            FILL-IN-TIM3V1A  
            FILL-IN-BOR4V1A           
            FILL-IN-SLU4V1A  
            FILL-IN-TIM4V1A  
            FILL-IN-BOR5V1A            
            FILL-IN-SLU5V1A  
            FILL-IN-TIM5V1A  
            FILL-IN-BOR6V1A            
            FILL-IN-SLU6V1A  
            FILL-IN-TIM6V1A  
            FILL-IN-BOR7V1A  
            FILL-IN-SLU7V1A       
            FILL-IN-TIM7V1A
            FILL-IN-TOTV1A  

            FILL-IN-VNR2A    
            FILL-IN-BOR1V2A  
            FILL-IN-SLU1V2A  
            FILL-IN-TIM1V2A  
            FILL-IN-BOR2V2A  
            FILL-IN-SLU2V2A  
            FILL-IN-TIM2V2A  
            FILL-IN-BOR3V2A  
            FILL-IN-SLU3V2A  
            FILL-IN-TIM3V2A  
            FILL-IN-BOR4V2A  
            FILL-IN-SLU4V2A  
            FILL-IN-TIM4V2A  
            FILL-IN-BOR5V2A  
            FILL-IN-SLU5V2A  
            FILL-IN-TIM5V2A  
            FILL-IN-BOR6V2A  
            FILL-IN-SLU6V2A  
            FILL-IN-TIM6V2A  
            FILL-IN-BOR7V2A  
            FILL-IN-SLU7V2A  
            FILL-IN-TIM7V2A
            FILL-IN-TOTV2A 

            FILL-IN-VNR3A    
            FILL-IN-BOR1V3A  
            FILL-IN-SLU1V3A  
            FILL-IN-TIM1V3A  
            FILL-IN-BOR2V3A  
            FILL-IN-SLU2V3A  
            FILL-IN-TIM2V3A  
            FILL-IN-BOR3V3A  
            FILL-IN-SLU3V3A  
            FILL-IN-TIM3V3A  
            FILL-IN-BOR4V3A  
            FILL-IN-SLU4V3A  
            FILL-IN-TIM4V3A  
            FILL-IN-BOR5V3A  
            FILL-IN-SLU5V3A  
            FILL-IN-TIM5V3A  
            FILL-IN-BOR6V3A  
            FILL-IN-SLU6V3A  
            FILL-IN-TIM6V3A  
            FILL-IN-BOR7V3A  
            FILL-IN-SLU7V3A  
            FILL-IN-TIM7V3A
            FILL-IN-TOTV3A  

         WITH FRAME FRAME-ARB.*/
         
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE rullperschange_UI C-Win 
PROCEDURE rullperschange_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   IF AVAILABLE rullperstemp THEN DO:
      FIND FIRST rullschtemp WHERE rullschtemp.RULLID = rullperstemp.RULLID NO-LOCK NO-ERROR.
      RUN setorgtitle_UI IN brwproc[3] (INPUT "Rullschema: " + STRING(rullperstemp.RULLID) + " " + rullschtemp.BENAMNING).         
      RUN setcolsortvar_UI IN brwproc[3] (INPUT " WHERE rullvectemp.RULLID = '" + STRING(rullperstemp.RULLID) + "' "). 
      RUN openbdynspec_UI IN brwproc[3].
      /*
      RUN openbdyn_UI IN brwproc[3] 
         (INPUT " WHERE rullvectemp.RULLID = '" + STRING(rullperstemp.RULLID) + "' ").
         */
      FIND FIRST rullvectemp WHERE rullvectemp.RULLID = rullperstemp.RULLID AND
         rullvectemp.ORDNING = rullperstemp.ORDNING.
      IF AVAILABLE rullvectemp THEN DO:
         RUN selectbyrowid_UI IN brwproc[3] (INPUT ROWID(rullvectemp)).         
      END.
   END.   
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE skapa_UI C-Win 
PROCEDURE skapa_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE VARIABLE antal_valda AS INTEGER NO-UNDO.
   DEFINE VARIABLE antal_raknare AS INTEGER NO-UNDO.
   ASSIGN 
   FILL-IN_STARTVNR = INPUT FRAME DEFAULT-FRAME FILL-IN_STARTVNR
   FILL-IN_SLUTVNR = INPUT FRAME DEFAULT-FRAME FILL-IN_SLUTVNR.
   EMPTY TEMP-TABLE extraperstemp  NO-ERROR.    
   antal_valda = BRW_ORD:NUM-SELECTED-ROWS IN FRAME DEFAULT-FRAME NO-ERROR.
   IF antal_valda = 0 THEN MESSAGE "Du måste välja någon." VIEW-AS ALERT-BOX.
   ELSE DO:
      antal_raknare= 1.
      DO WHILE antal_raknare LE antal_valda :
         BRW_ORD:FETCH-SELECTED-ROW(antal_raknare) NO-ERROR.
         CREATE extraperstemp.
         ASSIGN 
         extraperstemp.PERSONALKOD = valperstemp.PERSONALKOD
         extraperstemp.VECKOSCHEMA = valperstemp.VECKOSCHEMA
         extraperstemp.FELMEDD = "".
         antal_raknare = antal_raknare + 1.         
      END. 
      IF RAD_VAL = 1 THEN DO:    /* Ordinarie "Koppla" */           
         MESSAGE "Vill du koppla ordinarie schema: " + STRING(CMB_VEC) +  " från  och med vecka " + STRING(FILL-IN_STARTVNR) + " för vald person/personer ?" 
         VIEW-AS ALERT-BOX QUESTION BUTTONS YES-NO UPDATE sparfrag.
         IF sparfrag = TRUE THEN DO:         
            RUN sparaordinarie_UI IN arbproch 
               (INPUT FILL-IN_STARTVNR, INPUT CMB_VEC:SCREEN-VALUE, INPUT-OUTPUT TABLE extraperstemp).
            FOR EACH extraperstemp:
               fragval = FALSE.
               IF extraperstemp.FELMEDD NE "" AND extraperstemp.FELMEDD NE "VEC" THEN DO:
                  MESSAGE extraperstemp.FELMEDD VIEW-AS ALERT-BOX TITLE "Meddelande!".
               END.
               ELSE DO:
                  IF extraperstemp.FELMEDD = "VEC" THEN DO:
                     MESSAGE "Vill du ta bort tillfälliga veckoscheman för " extraperstemp.PERSONALKOD " ?" 
                     VIEW-AS ALERT-BOX QUESTION BUTTONS YES-NO UPDATE fragval.
                  END.
                  FIND FIRST valperstemp WHERE valperstemp.PERSONALKOD = extraperstemp.PERSONALKOD NO-LOCK NO-ERROR.
                  IF AVAILABLE valperstemp THEN valperstemp.VECKOSCHEMA = extraperstemp.VECKOSCHEMA.
                  RUN veckoarbfix_UI IN arbproch (INPUT TRUE, INPUT extraperstemp.PERSONALKOD, INPUT fragval, 
                     INPUT FILL-IN_STARTVNR, INPUT ?, INPUT CMB_VEC:SCREEN-VALUE).
               END.            
            END.   
   
            RUN openbdynspec_UI IN brwproc[1].
            FIND FIRST valperstemp WHERE valperstemp.PERSONALKOD = perskod NO-LOCK NO-ERROR.
            IF AVAILABLE valperstemp THEN RUN selectbyrowid_UI IN brwproc[1] (INPUT ROWID(valperstemp)).
            RUN laddapersdata_UI.
         END.
      END.
      ELSE IF RAD_VAL = 2 THEN DO: /* Rullande "Koppla" */
         IF antal_valda > 1 THEN DO:
            MESSAGE "Du kan bara välja en person vid skapande av ett rullande schema!".
         END.
         ELSE DO:
            BRW_RULLVEC:SELECT-FOCUSED-ROW() IN FRAME DEFAULT-FRAME NO-ERROR.
            MESSAGE "Vill du koppla rullschema: " + STRING(CMB_RUL) + " med startordning: " + STRING(rullvectemp.ORDNING) +  " från  och med vecka " + STRING(FILL-IN_STARTVNR) + " för "  extraperstemp.PERSONALKOD " ?" 
            VIEW-AS ALERT-BOX QUESTION BUTTONS YES-NO UPDATE sparfrag.
            IF sparfrag = TRUE THEN DO:                        
               IF AVAILABLE rullvectemp THEN DO:
                  RUN skaparull_UI IN arbproch 
                     (INPUT rullvectemp.ORDNING, INPUT Guru.Konstanter:globanv, INPUT FILL-IN_STARTVNR, INPUT FILL-IN_SLUTVNR, 
                     INPUT CMB_RUL:SCREEN-VALUE, INPUT-OUTPUT TABLE extraperstemp).
               END.
               ELSE DO:
                  RUN skaparull_UI IN arbproch 
                     (INPUT 1, INPUT Guru.Konstanter:globanv, INPUT FILL-IN_STARTVNR, INPUT FILL-IN_SLUTVNR, 
                     INPUT CMB_RUL:SCREEN-VALUE, INPUT-OUTPUT TABLE extraperstemp).
               END.
               FOR EACH extraperstemp:
                  IF extraperstemp.FELMEDD NE "" AND extraperstemp.FELMEDD NE "VEC" THEN DO:
                     MESSAGE extraperstemp.FELMEDD VIEW-AS ALERT-BOX TITLE "Meddelande!".
                  END.
                  ELSE DO:
                     IF extraperstemp.FELMEDD = "VEC" THEN DO:
                        MESSAGE "Vill du ta bort tillfälliga veckoscheman för " extraperstemp.PERSONALKOD " ?" 
                        VIEW-AS ALERT-BOX QUESTION BUTTONS YES-NO UPDATE fragval.
                     END.                  
                     RUN veckoarbfix_UI IN arbproch 
                        (INPUT FALSE, INPUT extraperstemp.PERSONALKOD, INPUT fragval, 
                        INPUT FILL-IN_STARTVNR, INPUT FILL-IN_SLUTVNR, INPUT CMB_VEC:SCREEN-VALUE).                  
                  END.
               END.
               RUN laddarullpers_UI IN arbproch (OUTPUT TABLE rullperstemp).
               RUN laddavec_UI (INPUT mittdatum).
               RUN openrullpers_UI.
               RUN valrullpers_UI.               
            END.            
            APPLY "ENTRY" TO BRW_RULLVEC.
         END.
      END.
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE totber_UI C-Win 
PROCEDURE totber_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE INPUT PARAMETER vecvar AS INTEGER NO-UNDO.
   DEFINE VARIABLE decvar AS DECIMAL NO-UNDO.
   DEFINE VARIABLE sekunder AS INTEGER NO-UNDO.
   DEFINE VARIABLE minuter AS INTEGER NO-UNDO.
   decvar = 0.0.
   sekunder = 0.
   OPEN QUERY dq FOR EACH dagtemp WHERE dagtemp.VEC = vecvar USE-INDEX DAG NO-LOCK.
   GET FIRST dq NO-LOCK.
   DO WHILE AVAILABLE dagtemp:
      decvar = DECIMAL(dagtemp.TIMFALT:SCREEN-VALUE).
      sekunder = sekunder + TRUNCATE(decvar,0) * 3600 + (decvar - TRUNCATE(decvar,0)) * 100 * 60.
      GET NEXT dq NO-LOCK.
   END.
   minuter = sekunder MODULO 3600.
   decvar = ((sekunder - minuter) / 3600) + (minuter / 6000).
   FIND FIRST vectemp WHERE vectemp.VEC = vecvar NO-LOCK NO-ERROR.
   IF AVAILABLE vectemp THEN vectemp.TOTFALT:SCREEN-VALUE = STRING(decvar).
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE uppdatvisa_UI C-Win 
PROCEDURE uppdatvisa_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE INPUT PARAMETER vecsch AS INTEGER NO-UNDO.

   FIND FIRST veckoarbtemp WHERE veckoarbtemp.VECKOSCHEMA = vecsch NO-LOCK NO-ERROR.
   IF AVAILABLE veckoarbtemp THEN DO:
      ASSIGN
      FILL-IN-D1 = veckoarbtemp.ARBTIDMAN
      FILL-IN-D2 = veckoarbtemp.ARBTIDTIS
      FILL-IN-D3 = veckoarbtemp.ARBTIDONS
      FILL-IN-D4 = veckoarbtemp.ARBTIDTOR
      FILL-IN-D5 = veckoarbtemp.ARBTIDFRE
      FILL-IN-D6 = veckoarbtemp.ARBTIDLOR
      FILL-IN-D7 = veckoarbtemp.ARBTIDSON
      FILL-IN-TOTV1 = veckoarbtemp.TOTVECKTID
      FILL-IN-VECO1 = veckoarbtemp.VECKOSCHEMA.
      FIND FIRST arbtidtemp WHERE arbtidtemp.ARBTIDKOD = veckoarbtemp.ARBTIDMAN NO-LOCK NO-ERROR.
      IF AVAILABLE arbtidtemp THEN DO:
         ASSIGN
         FILL-IN-AB1 = arbtidtemp.START
         FILL-IN-FB1 = arbtidtemp.FRUKOSTSTART
         FILL-IN-FS1 = arbtidtemp.FRUKOSTSLUT  
         FILL-IN-LB1 = arbtidtemp.LUNCHSTART   
         FILL-IN-LS1 = arbtidtemp.LUNCHSLUT    
         FILL-IN-KB1 = arbtidtemp.KAFESTART     
         FILL-IN-KS1 = arbtidtemp.KAFESLUT      
         FILL-IN-AS1 = arbtidtemp.SLUT          
         FILL-IN-TIM1 = arbtidtemp.TOTDAGTID.
      END.
      FIND FIRST arbtidtemp WHERE arbtidtemp.ARBTIDKOD = veckoarbtemp.ARBTIDTIS NO-LOCK NO-ERROR.
      IF AVAILABLE arbtidtemp THEN DO:
         ASSIGN
         FILL-IN-AB2 = arbtidtemp.START
         FILL-IN-FB2 = arbtidtemp.FRUKOSTSTART
         FILL-IN-FS2 = arbtidtemp.FRUKOSTSLUT  
         FILL-IN-LB2 = arbtidtemp.LUNCHSTART   
         FILL-IN-LS2 = arbtidtemp.LUNCHSLUT    
         FILL-IN-KB2 = arbtidtemp.KAFESTART     
         FILL-IN-KS2 = arbtidtemp.KAFESLUT      
         FILL-IN-AS2 = arbtidtemp.SLUT          
         FILL-IN-TIM2 = arbtidtemp.TOTDAGTID.
      END.
      FIND FIRST arbtidtemp WHERE arbtidtemp.ARBTIDKOD = veckoarbtemp.ARBTIDONS NO-LOCK NO-ERROR.
      IF AVAILABLE arbtidtemp THEN DO:
         ASSIGN
         FILL-IN-AB3 = arbtidtemp.START
         FILL-IN-FB3 = arbtidtemp.FRUKOSTSTART
         FILL-IN-FS3 = arbtidtemp.FRUKOSTSLUT  
         FILL-IN-LB3 = arbtidtemp.LUNCHSTART   
         FILL-IN-LS3 = arbtidtemp.LUNCHSLUT    
         FILL-IN-KB3 = arbtidtemp.KAFESTART     
         FILL-IN-KS3 = arbtidtemp.KAFESLUT      
         FILL-IN-AS3 = arbtidtemp.SLUT          
         FILL-IN-TIM3 = arbtidtemp.TOTDAGTID.
      END.
      FIND FIRST arbtidtemp WHERE arbtidtemp.ARBTIDKOD = veckoarbtemp.ARBTIDTOR NO-LOCK NO-ERROR.
      IF AVAILABLE arbtidtemp THEN DO:
         ASSIGN
         FILL-IN-AB4 = arbtidtemp.START
         FILL-IN-FB4 = arbtidtemp.FRUKOSTSTART
         FILL-IN-FS4 = arbtidtemp.FRUKOSTSLUT  
         FILL-IN-LB4 = arbtidtemp.LUNCHSTART   
         FILL-IN-LS4 = arbtidtemp.LUNCHSLUT    
         FILL-IN-KB4 = arbtidtemp.KAFESTART     
         FILL-IN-KS4 = arbtidtemp.KAFESLUT      
         FILL-IN-AS4 = arbtidtemp.SLUT          
         FILL-IN-TIM4 = arbtidtemp.TOTDAGTID.
      END.
      FIND FIRST arbtidtemp WHERE arbtidtemp.ARBTIDKOD = veckoarbtemp.ARBTIDFRE NO-LOCK NO-ERROR.
      IF AVAILABLE arbtidtemp THEN DO:
         ASSIGN
         FILL-IN-AB5 = arbtidtemp.START
         FILL-IN-FB5 = arbtidtemp.FRUKOSTSTART
         FILL-IN-FS5 = arbtidtemp.FRUKOSTSLUT  
         FILL-IN-LB5 = arbtidtemp.LUNCHSTART   
         FILL-IN-LS5 = arbtidtemp.LUNCHSLUT    
         FILL-IN-KB5 = arbtidtemp.KAFESTART     
         FILL-IN-KS5 = arbtidtemp.KAFESLUT      
         FILL-IN-AS5 = arbtidtemp.SLUT          
         FILL-IN-TIM5 = arbtidtemp.TOTDAGTID.
      END.
      FIND FIRST arbtidtemp WHERE arbtidtemp.ARBTIDKOD = veckoarbtemp.ARBTIDLOR NO-LOCK NO-ERROR.
      IF AVAILABLE arbtidtemp THEN DO:
         ASSIGN
         FILL-IN-AB6 = arbtidtemp.START
         FILL-IN-FB6 = arbtidtemp.FRUKOSTSTART
         FILL-IN-FS6 = arbtidtemp.FRUKOSTSLUT  
         FILL-IN-LB6 = arbtidtemp.LUNCHSTART   
         FILL-IN-LS6 = arbtidtemp.LUNCHSLUT    
         FILL-IN-KB6 = arbtidtemp.KAFESTART     
         FILL-IN-KS6 = arbtidtemp.KAFESLUT      
         FILL-IN-AS6 = arbtidtemp.SLUT          
         FILL-IN-TIM6 = arbtidtemp.TOTDAGTID.
      END.
      FIND FIRST arbtidtemp WHERE arbtidtemp.ARBTIDKOD = veckoarbtemp.ARBTIDSON NO-LOCK NO-ERROR.
      IF AVAILABLE arbtidtemp THEN DO:
         ASSIGN
         FILL-IN-AB7 = arbtidtemp.START
         FILL-IN-FB7 = arbtidtemp.FRUKOSTSTART
         FILL-IN-FS7 = arbtidtemp.FRUKOSTSLUT  
         FILL-IN-LB7 = arbtidtemp.LUNCHSTART   
         FILL-IN-LS7 = arbtidtemp.LUNCHSLUT    
         FILL-IN-KB7 = arbtidtemp.KAFESTART     
         FILL-IN-KS7 = arbtidtemp.KAFESLUT      
         FILL-IN-AS7 = arbtidtemp.SLUT          
         FILL-IN-TIM7 = arbtidtemp.TOTDAGTID.
      END.
      DISPLAY FILL-IN-D1 FILL-IN-D2 FILL-IN-D3 FILL-IN-D4 FILL-IN-D5 FILL-IN-D6
         FILL-IN-D7 FILL-IN-TOTV1 FILL-IN-VECO1 FILL-IN-AB1 FILL-IN-FB1 FILL-IN-FS1 FILL-IN-LB1 
         FILL-IN-LS1 FILL-IN-KB1 FILL-IN-KS1 FILL-IN-AS1 FILL-IN-TIM1 FILL-IN-AB2 FILL-IN-FB2 
         FILL-IN-FS2 FILL-IN-LB2 FILL-IN-LS2 FILL-IN-KB2 FILL-IN-KS2 FILL-IN-AS2 FILL-IN-TIM2
         FILL-IN-AB3 FILL-IN-FB3 FILL-IN-FS3 FILL-IN-LB3 FILL-IN-LS3 FILL-IN-KB3 FILL-IN-KS3
         FILL-IN-AS3 FILL-IN-TIM3 FILL-IN-AB4 FILL-IN-FB4 FILL-IN-FS4 FILL-IN-LB4 FILL-IN-LS4 
         FILL-IN-KB4 FILL-IN-KS4 FILL-IN-AS4 FILL-IN-TIM4 FILL-IN-AB5 FILL-IN-FB5 FILL-IN-FS5 
         FILL-IN-LB5 FILL-IN-LS5 FILL-IN-KB5 FILL-IN-KS5 FILL-IN-AS5 FILL-IN-TIM5 FILL-IN-AB6 
         FILL-IN-FB6 FILL-IN-FS6 FILL-IN-LB6 FILL-IN-LS6 FILL-IN-KB6 FILL-IN-KS6 FILL-IN-AS6
         FILL-IN-TIM6 FILL-IN-AB7 FILL-IN-FB7 FILL-IN-FS7 FILL-IN-LB7 FILL-IN-LS7 FILL-IN-KB7 
         FILL-IN-KS7 FILL-IN-AS7 FILL-IN-TIM7 WITH FRAME FRAME-VISA.
   END. 
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE utrull_UI C-Win 
PROCEDURE utrull_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   EMPTY TEMP-TABLE tidut NO-ERROR.    
   
   str = "=====.=======.==========.======.======.======.======.======.======.======.=====".
   CREATE tidut.
   ASSIGN
   SUBSTRING(tidut.UT,1) = "Rullscheman"
   SUBSTRING(tidut.UT,30) = STRING(TODAY).
   CREATE tidut.
   CREATE tidut.    
   ASSIGN          
   SUBSTRING(tidut.UT,1) = "Ord-"
   SUBSTRING(tidut.UT,7) = "Vecko-"
   SUBSTRING(tidut.UT,26) = "Måndag"
   SUBSTRING(tidut.UT,33) = "Tisdag"
   SUBSTRING(tidut.UT,40) = "Onsdag"
   SUBSTRING(tidut.UT,47) = "Torsdag"
   SUBSTRING(tidut.UT,54) = "Fredag"
   SUBSTRING(tidut.UT,61) = "Lördag"
   SUBSTRING(tidut.UT,68) = "Söndag"
   SUBSTRING(tidut.UT,75) = "Tim/".                           
   CREATE tidut.    
   ASSIGN
   SUBSTRING(tidut.UT,1) = "ning"          
   SUBSTRING(tidut.UT,7) = "schema"
   SUBSTRING(tidut.UT,75) = "vecka".
                
   
   CREATE tidut.
   ASSIGN tidut.UT = str.
   
   FOR EACH rullschtemp USE-INDEX RULLID:
      CREATE tidut.
      CREATE tidut.
      ASSIGN
      SUBSTRING(tidut.UT,1) = "Rullschema:"
      SUBSTRING(tidut.UT,15) = STRING(rullschtemp.RULLID)
      SUBSTRING(tidut.UT,20) = SUBSTRING(rullschtemp.BENAMNING,1,30).
      CREATE tidut.
      FOR EACH rullvectemp WHERE rullvectemp.RULLID = rullschtemp.RULLID USE-INDEX RULLID:
         FIND FIRST veckoarbtemp WHERE veckoarbtemp.VECKOSCHEMA = rullvectemp.VECKOSCHEMA NO-ERROR.
         IF AVAILABLE veckoarbtemp THEN DO:
   
            FIND arbma WHERE arbma.ARBTIDKOD = veckoarbtemp.ARBTIDMAN
            USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.  
            FIND arbti WHERE arbti.ARBTIDKOD = veckoarbtemp.ARBTIDTIS
            USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
            FIND arbon WHERE arbon.ARBTIDKOD = veckoarbtemp.ARBTIDONS
            USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
            FIND arbto WHERE arbto.ARBTIDKOD = veckoarbtemp.ARBTIDTOR
            USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
            FIND arbfr WHERE arbfr.ARBTIDKOD = veckoarbtemp.ARBTIDFRE
            USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
            FIND arblo WHERE arblo.ARBTIDKOD = veckoarbtemp.ARBTIDLOR
            USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
            FIND arbso WHERE arbso.ARBTIDKOD = veckoarbtemp.ARBTIDSON
            USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.   
            CREATE tidut.    
            ASSIGN          
            SUBSTRING(tidut.UT,1) = STRING(rullvectemp.ORDNING,"99")
            SUBSTRING(tidut.UT,7) = STRING(veckoarbtemp.VECKOSCHEMA,">99")
            SUBSTRING(tidut.UT,15) = "Dagschema:"
            SUBSTRING(tidut.UT,26) = STRING(arbma.ARBTIDKOD,">99")
            SUBSTRING(tidut.UT,33) = STRING(arbti.ARBTIDKOD,">99")
            SUBSTRING(tidut.UT,40) = STRING(arbon.ARBTIDKOD,">99")
            SUBSTRING(tidut.UT,47) = STRING(arbto.ARBTIDKOD,">99")
            SUBSTRING(tidut.UT,54) = STRING(arbfr.ARBTIDKOD,">99")
            SUBSTRING(tidut.UT,61) = STRING(arblo.ARBTIDKOD,">99")
            SUBSTRING(tidut.UT,68) = STRING(arbso.ARBTIDKOD,">99")
            SUBSTRING(tidut.UT,75) = STRING(veckoarbtemp.TOTVECKTID,"99.99").
            
            
            CREATE tidut.    
            ASSIGN          
            SUBSTRING(tidut.UT,15) = "Börjar:"
            SUBSTRING(tidut.UT,26) = STRING(arbma.START,"99.99")
            SUBSTRING(tidut.UT,33) = STRING(arbti.START,"99.99")
            SUBSTRING(tidut.UT,40) = STRING(arbon.START,"99.99")
            SUBSTRING(tidut.UT,47) = STRING(arbto.START,"99.99")
            SUBSTRING(tidut.UT,54) = STRING(arbfr.START,"99.99")
            SUBSTRING(tidut.UT,61) = STRING(arblo.START,"99.99")
            SUBSTRING(tidut.UT,68) = STRING(arbso.START,"99.99").
            CREATE tidut.    
            ASSIGN          
            SUBSTRING(tidut.UT,15) = "Slutar:"
            SUBSTRING(tidut.UT,26) = STRING(arbma.SLUT,"99.99")
            SUBSTRING(tidut.UT,33) = STRING(arbti.SLUT,"99.99")
            SUBSTRING(tidut.UT,40) = STRING(arbon.SLUT,"99.99")
            SUBSTRING(tidut.UT,47) = STRING(arbto.SLUT,"99.99")
            SUBSTRING(tidut.UT,54) = STRING(arbfr.SLUT,"99.99")
            SUBSTRING(tidut.UT,61) = STRING(arblo.SLUT,"99.99")
            SUBSTRING(tidut.UT,68) = STRING(arbso.SLUT,"99.99").
            CREATE tidut.    
            ASSIGN          
            SUBSTRING(tidut.UT,15) = "Tim/dag:"
            SUBSTRING(tidut.UT,26) = STRING(arbma.TOTDAGTID,"99.99")
            SUBSTRING(tidut.UT,33) = STRING(arbti.TOTDAGTID,"99.99")
            SUBSTRING(tidut.UT,40) = STRING(arbon.TOTDAGTID,"99.99")
            SUBSTRING(tidut.UT,47) = STRING(arbto.TOTDAGTID,"99.99")
            SUBSTRING(tidut.UT,54) = STRING(arbfr.TOTDAGTID,"99.99")
            SUBSTRING(tidut.UT,61) = STRING(arblo.TOTDAGTID,"99.99")
            SUBSTRING(tidut.UT,68) = STRING(arbso.TOTDAGTID,"99.99").
            CREATE tidut.
   
         END.
      END.
   END.
      

   /*OPEN QUERY priq FOR EACH veckoarbtemp NO-LOCK.
   GET FIRST priq NO-LOCK.
   DO WHILE AVAILABLE(veckoarbtemp):
      FIND arbma WHERE arbma.ARBTIDKOD = veckoarbtemp.ARBTIDMAN
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.  
      FIND arbti WHERE arbti.ARBTIDKOD = veckoarbtemp.ARBTIDTIS
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
      FIND arbon WHERE arbon.ARBTIDKOD = veckoarbtemp.ARBTIDONS
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
      FIND arbto WHERE arbto.ARBTIDKOD = veckoarbtemp.ARBTIDTOR
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
      FIND arbfr WHERE arbfr.ARBTIDKOD = veckoarbtemp.ARBTIDFRE
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
      FIND arblo WHERE arblo.ARBTIDKOD = veckoarbtemp.ARBTIDLOR
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
      FIND arbso WHERE arbso.ARBTIDKOD = veckoarbtemp.ARBTIDSON
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.   
      CREATE tidut.    
      ASSIGN          
      SUBSTRING(tidut.UT,1) = "Dagschema:"
      SUBSTRING(tidut.UT,12) = STRING(arbma.ARBTIDKOD,"99")
      SUBSTRING(tidut.UT,19) = STRING(arbti.ARBTIDKOD,"99")
      SUBSTRING(tidut.UT,26) = STRING(arbon.ARBTIDKOD,"99")
      SUBSTRING(tidut.UT,33) = STRING(arbto.ARBTIDKOD,"99")
      SUBSTRING(tidut.UT,40) = STRING(arbfr.ARBTIDKOD,"99")
      SUBSTRING(tidut.UT,47) = STRING(arblo.ARBTIDKOD,"99")
      SUBSTRING(tidut.UT,54) = STRING(arbso.ARBTIDKOD,"99")
      SUBSTRING(tidut.UT,61) = STRING(veckoarbtemp.TOTVECKTID,"99.99")
      SUBSTRING(tidut.UT,71) = STRING(veckoarbtemp.VECKOSCHEMA,"99").
      CREATE tidut.    
      ASSIGN          
      SUBSTRING(tidut.UT,1) = "Börjar:"
      SUBSTRING(tidut.UT,12) = STRING(arbma.START,"99.99")
      SUBSTRING(tidut.UT,19) = STRING(arbti.START,"99.99")
      SUBSTRING(tidut.UT,26) = STRING(arbon.START,"99.99")
      SUBSTRING(tidut.UT,33) = STRING(arbto.START,"99.99")
      SUBSTRING(tidut.UT,40) = STRING(arbfr.START,"99.99")
      SUBSTRING(tidut.UT,47) = STRING(arblo.START,"99.99")
      SUBSTRING(tidut.UT,54) = STRING(arbso.START,"99.99").
      CREATE tidut.    
      ASSIGN          
      SUBSTRING(tidut.UT,1) = "Slutar:"
      SUBSTRING(tidut.UT,12) = STRING(arbma.SLUT,"99.99")
      SUBSTRING(tidut.UT,19) = STRING(arbti.SLUT,"99.99")
      SUBSTRING(tidut.UT,26) = STRING(arbon.SLUT,"99.99")
      SUBSTRING(tidut.UT,33) = STRING(arbto.SLUT,"99.99")
      SUBSTRING(tidut.UT,40) = STRING(arbfr.SLUT,"99.99")
      SUBSTRING(tidut.UT,47) = STRING(arblo.SLUT,"99.99")
      SUBSTRING(tidut.UT,54) = STRING(arbso.SLUT,"99.99").
      CREATE tidut.    
      ASSIGN          
      SUBSTRING(tidut.UT,1) = "Tim/dag:"
      SUBSTRING(tidut.UT,12) = STRING(arbma.TOTDAGTID,"99.99")
      SUBSTRING(tidut.UT,19) = STRING(arbti.TOTDAGTID,"99.99")
      SUBSTRING(tidut.UT,26) = STRING(arbon.TOTDAGTID,"99.99")
      SUBSTRING(tidut.UT,33) = STRING(arbto.TOTDAGTID,"99.99")
      SUBSTRING(tidut.UT,40) = STRING(arbfr.TOTDAGTID,"99.99")
      SUBSTRING(tidut.UT,47) = STRING(arblo.TOTDAGTID,"99.99")
      SUBSTRING(tidut.UT,54) = STRING(arbso.TOTDAGTID,"99.99").
      CREATE tidut.
      GET NEXT priq NO-LOCK.
   END.
   CLOSE QUERY priq.       */
   
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE ut_UI C-Win 
PROCEDURE ut_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   EMPTY TEMP-TABLE tidut NO-ERROR.    
   
   str = "==========.======.======.======.======.======.======.======.=========.========".
   CREATE tidut.
   ASSIGN
   SUBSTRING(tidut.UT,1) = "Veckoscheman"
   SUBSTRING(tidut.UT,30) = STRING(TODAY).
   CREATE tidut.
   CREATE tidut.    
   ASSIGN          
   SUBSTRING(tidut.UT,12) = "Måndag"
   SUBSTRING(tidut.UT,19) = "Tisdag"
   SUBSTRING(tidut.UT,26) = "Onsdag"
   SUBSTRING(tidut.UT,33) = "Torsdag"
   SUBSTRING(tidut.UT,40) = "Fredag"
   SUBSTRING(tidut.UT,47) = "Lördag"
   SUBSTRING(tidut.UT,54) = "Söndag"
   SUBSTRING(tidut.UT,61) = "Tim/vecka"
   SUBSTRING(tidut.UT,71) = "Veckosch".                           
   CREATE tidut.
   ASSIGN tidut.UT = str.
   OPEN QUERY priq FOR EACH veckoarbtemp NO-LOCK.
   GET FIRST priq NO-LOCK.
   DO WHILE AVAILABLE(veckoarbtemp):
      FIND arbma WHERE arbma.ARBTIDKOD = veckoarbtemp.ARBTIDMAN
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.  
      FIND arbti WHERE arbti.ARBTIDKOD = veckoarbtemp.ARBTIDTIS
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
      FIND arbon WHERE arbon.ARBTIDKOD = veckoarbtemp.ARBTIDONS
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
      FIND arbto WHERE arbto.ARBTIDKOD = veckoarbtemp.ARBTIDTOR
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
      FIND arbfr WHERE arbfr.ARBTIDKOD = veckoarbtemp.ARBTIDFRE
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
      FIND arblo WHERE arblo.ARBTIDKOD = veckoarbtemp.ARBTIDLOR
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.
      FIND arbso WHERE arbso.ARBTIDKOD = veckoarbtemp.ARBTIDSON
      USE-INDEX ARBTIDKOD NO-LOCK NO-ERROR.   
      CREATE tidut.    
      ASSIGN          
      SUBSTRING(tidut.UT,1) = "Dagschema:"
      SUBSTRING(tidut.UT,12) = STRING(arbma.ARBTIDKOD,">99")
      SUBSTRING(tidut.UT,19) = STRING(arbti.ARBTIDKOD,">99")
      SUBSTRING(tidut.UT,26) = STRING(arbon.ARBTIDKOD,">99")
      SUBSTRING(tidut.UT,33) = STRING(arbto.ARBTIDKOD,">99")
      SUBSTRING(tidut.UT,40) = STRING(arbfr.ARBTIDKOD,">99")
      SUBSTRING(tidut.UT,47) = STRING(arblo.ARBTIDKOD,">99")
      SUBSTRING(tidut.UT,54) = STRING(arbso.ARBTIDKOD,">99")
      SUBSTRING(tidut.UT,61) = STRING(veckoarbtemp.TOTVECKTID,"99.99")
      SUBSTRING(tidut.UT,71) = STRING(veckoarbtemp.VECKOSCHEMA,">99").
      CREATE tidut.    
      ASSIGN          
      SUBSTRING(tidut.UT,1) = "Börjar:"
      SUBSTRING(tidut.UT,12) = STRING(arbma.START,"99.99")
      SUBSTRING(tidut.UT,19) = STRING(arbti.START,"99.99")
      SUBSTRING(tidut.UT,26) = STRING(arbon.START,"99.99")
      SUBSTRING(tidut.UT,33) = STRING(arbto.START,"99.99")
      SUBSTRING(tidut.UT,40) = STRING(arbfr.START,"99.99")
      SUBSTRING(tidut.UT,47) = STRING(arblo.START,"99.99")
      SUBSTRING(tidut.UT,54) = STRING(arbso.START,"99.99").
      CREATE tidut.    
      ASSIGN          
      SUBSTRING(tidut.UT,1) = "Slutar:"
      SUBSTRING(tidut.UT,12) = STRING(arbma.SLUT,"99.99")
      SUBSTRING(tidut.UT,19) = STRING(arbti.SLUT,"99.99")
      SUBSTRING(tidut.UT,26) = STRING(arbon.SLUT,"99.99")
      SUBSTRING(tidut.UT,33) = STRING(arbto.SLUT,"99.99")
      SUBSTRING(tidut.UT,40) = STRING(arbfr.SLUT,"99.99")
      SUBSTRING(tidut.UT,47) = STRING(arblo.SLUT,"99.99")
      SUBSTRING(tidut.UT,54) = STRING(arbso.SLUT,"99.99").
      CREATE tidut.    
      ASSIGN          
      SUBSTRING(tidut.UT,1) = "Tim/dag:"
      SUBSTRING(tidut.UT,12) = STRING(arbma.TOTDAGTID,"99.99")
      SUBSTRING(tidut.UT,19) = STRING(arbti.TOTDAGTID,"99.99")
      SUBSTRING(tidut.UT,26) = STRING(arbon.TOTDAGTID,"99.99")
      SUBSTRING(tidut.UT,33) = STRING(arbto.TOTDAGTID,"99.99")
      SUBSTRING(tidut.UT,40) = STRING(arbfr.TOTDAGTID,"99.99")
      SUBSTRING(tidut.UT,47) = STRING(arblo.TOTDAGTID,"99.99")
      SUBSTRING(tidut.UT,54) = STRING(arbso.TOTDAGTID,"99.99").
      CREATE tidut.
      GET NEXT priq NO-LOCK.
   END.
   CLOSE QUERY priq.       
   
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE valchangedag_UI C-Win 
PROCEDURE valchangedag_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   MESSAGE "Vill du byta dagschema tillfälligt?" VIEW-AS ALERT-BOX
   QUESTION BUTTONS YES-NO UPDATE fragval.
   IF fragval = TRUE THEN DO:
      FIND FIRST dagtemp WHERE dagtemp.DAGCMB = SELF:HANDLE NO-LOCK NO-ERROR.
      IF AVAILABLE dagtemp THEN DO:
         FIND FIRST vecdagtemp WHERE vecdagtemp.VEC = dagtemp.VEC NO-LOCK NO-ERROR.
         IF AVAILABLE vecdagtemp THEN DO:
            vecdagtemp.DAGLOG = TRUE.
            RUN bytedag_UI IN arbproch 
               (INPUT perskod, INPUT vecdagtemp.VNR, INPUT dagtemp.DAG, OUTPUT vecdagtemp.ARVNR, 
                INPUT INTEGER(dagtemp.DAGCMB:SCREEN-VALUE), OUTPUT felmedd).
            IF felmedd = "" THEN DO:
               dagtemp.DAGCMB:PRIVATE-DATA = dagtemp.DAGCMB:SCREEN-VALUE.
               RUN dagfix_UI(INPUT dagtemp.DAGCMB).
               RUN totber_UI(INPUT dagtemp.VEC).      
            END.
            ELSE DO:
               SELF:SCREEN-VALUE = SELF:PRIVATE-DATA.
               MESSAGE felmedd VIEW-AS ALERT-BOX TITLE "Meddelande!".               
            END.            
         END.   
      END.
   END.
   ELSE SELF:SCREEN-VALUE = SELF:PRIVATE-DATA.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE valchangevec_UI C-Win 
PROCEDURE valchangevec_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/  
   /* Fråga om byte!! */
   DEFINE VARIABLE dagupplog AS LOGICAL NO-UNDO.
   dagupplog = FALSE.
   MESSAGE "Vill du byta veckoschema tillfälligt?" VIEW-AS ALERT-BOX
   QUESTION BUTTONS YES-NO UPDATE fragval.
   IF fragval = TRUE THEN DO:
      FIND FIRST vectemp WHERE vectemp.SCHCMB = SELF:HANDLE NO-LOCK NO-ERROR.
      IF AVAILABLE vectemp THEN DO:  
         FIND FIRST vecdagtemp WHERE vecdagtemp.VEC = vectemp.VEC AND vecdagtemp.DAGLOG = TRUE NO-LOCK NO-ERROR.
         IF AVAILABLE vecdagtemp THEN DO:
            MESSAGE "Det finns tillfälliga dagscheman upplagda denna vecka, " SKIP 
               "vill du ta bort dagcheman för denna vecka?" VIEW-AS ALERT-BOX 
               QUESTION BUTTONS YES-NO UPDATE dagupplog.            
         END.
         RUN bytetillfalligt_UI IN arbproch (INPUT Guru.Konstanter:globanv, INPUT perskod, INPUT INTEGER(vectemp.VECFALT:SCREEN-VALUE), 
               INPUT INTEGER(vectemp.SCHCMB:SCREEN-VALUE), INPUT-OUTPUT TABLE rullperstemp, OUTPUT felmedd).          
         IF felmedd = "" THEN DO:
            IF dagupplog = TRUE THEN DO:
               RUN tabortextradag_UI IN arbproch (INPUT perskod, INPUT vecdagtemp.ARVNR).
               vecdagtemp.DAGLOG = FALSE.
            END.
            RUN vecchange_UI (INPUT SELF:HANDLE). 
            SELF:PRIVATE-DATA = SELF:SCREEN-VALUE.
            RUN setlastrowid_UI IN brwproc[2] (INPUT ?).          
            RUN openrullpers_UI.
            RUN valrullpers_UI.
         END.                                                     
         ELSE DO:                                                 
            MESSAGE felmedd VIEW-AS ALERT-BOX TITLE "Meddelande!".
            SELF:SCREEN-VALUE = SELF:PRIVATE-DATA.                
         END.                                                                    
      END.            
   END.
   ELSE SELF:SCREEN-VALUE = SELF:PRIVATE-DATA.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE valrullpers_UI C-Win 
PROCEDURE valrullpers_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/     
   FIND FIRST rullperstemp WHERE rullperstemp.PERSONALKOD = perskod AND
      rullperstemp.STARTDATUM <= mittdatum AND rullperstemp.SLUTDATUM >= mittdatum NO-LOCK NO-ERROR.
   IF NOT AVAILABLE rullperstemp THEN DO:
      FIND FIRST rullperstemp WHERE rullperstemp.PERSONALKOD = perskod AND
      rullperstemp.STARTDATUM <= mittdatum AND rullperstemp.SLUTDATUM = ? NO-LOCK NO-ERROR.
   END.
   IF AVAILABLE rullperstemp THEN DO:      
      RUN selectbyrowid_UI IN brwproc[2] (INPUT ROWID(rullperstemp)).
      RUN rullperschange_UI.
   END.      
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE vecchange_UI C-Win 
PROCEDURE vecchange_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:      
------------------------------------------------------------------------------*/
   DEFINE INPUT PARAMETER vnrh AS HANDLE NO-UNDO.  /* Handle till VECKOSCHEMA-COMBO */
   FIND FIRST vectemp WHERE vectemp.SCHCMB = vnrh:HANDLE NO-LOCK NO-ERROR.
   IF AVAILABLE vectemp THEN DO:   
      DEFINE VARIABLE dagsveco AS INTEGER NO-UNDO EXTENT 7.
      DEFINE VARIABLE tempvar AS INTEGER NO-UNDO.
      FIND FIRST veckoarbtemp WHERE veckoarbtemp.VECKOSCHEMA = INTEGER(vectemp.SCHCMB:SCREEN-VALUE) NO-LOCK NO-ERROR.
      IF AVAILABLE veckoarbtemp THEN DO:
         ASSIGN                                 
         dagsveco[1] = veckoarbtemp.ARBTIDMAN
         dagsveco[2] = veckoarbtemp.ARBTIDTIS
         dagsveco[3] = veckoarbtemp.ARBTIDONS
         dagsveco[4] = veckoarbtemp.ARBTIDTOR
         dagsveco[5] = veckoarbtemp.ARBTIDFRE
         dagsveco[6] = veckoarbtemp.ARBTIDLOR
         dagsveco[7] = veckoarbtemp.ARBTIDSON.
         tempvar = 1.                           
         FIND FIRST vecdagtemp WHERE vecdagtemp.VEC = vectemp.VEC AND vecdagtemp.DAGLOG = TRUE NO-LOCK NO-ERROR.
         FOR EACH dagtemp WHERE dagtemp.VEC = vectemp.VEC USE-INDEX DAG: /* Laddar dagschman för aktuell vecka */
            IF AVAILABLE vecdagtemp AND vecdagtemp.DAGSCH[tempvar] NE -1 THEN DO:
               dagtemp.DAGCMB:SCREEN-VALUE = STRING(vecdagtemp.DAGSCH[tempvar]).
               dagtemp.DAGCMB:PRIVATE-DATA = STRING(vecdagtemp.DAGSCH[tempvar]).
            END.
            ELSE DO:
               dagtemp.DAGCMB:SCREEN-VALUE = STRING(dagsveco[tempvar]).
               dagtemp.DAGCMB:PRIVATE-DATA = STRING(dagsveco[tempvar]).
            END.            
            RUN dagfix_UI(INPUT dagtemp.DAGCMB).
            tempvar = tempvar + 1.
         END.
         /* Fixa visning av ändrad dag!!! */
         RUN totber_UI(INPUT vectemp.VEC).        /* Räknar ut de totala arbetstimmarna för veckan */
      END.
   END.

END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE veckokoll_UI C-Win 
PROCEDURE veckokoll_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE INPUT PARAMETER vecsch AS INTEGER NO-UNDO.
   
   regvnr = vecsch.
   RUN VECOKOLL.P.
   IF musz = TRUE THEN DO:
      musz = FALSE.      
   END.    
   ELSE DO:
      regvnr = vecsch.
      regdagnamn = "MÅN".
      RUN VECODAT.P.
      mittdatum = regdatum.
      RUN laddavec_UI (INPUT mittdatum).
   END.          
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE visarb_UI C-Win 
PROCEDURE visarb_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   FIND FIRST vectemp  WHERE vectemp.VEC = 1 NO-LOCK NO-ERROR.
   FIND FIRST vperstid WHERE vperstid.PERSONALKOD = FILL-IN_PERSON AND
   vperstid.VECKA = INTEGER(vectemp.VECFALT:SCREEN-VALUE) 
   NO-LOCK NO-ERROR.
   IF NOT AVAILABLE vperstid THEN DO:
      RUN varbtid_UI IN arbproch (INPUT FILL-IN_PERSON,INPUT INTEGER(vectemp.VECFALT:SCREEN-VALUE), OUTPUT TABLE vperstid APPEND).
   END.
   FILL-IN-TOTV1A  = 0.
   FOR EACH vperstid WHERE vperstid.PERSONALKOD = FILL-IN_PERSON AND vperstid.VECKA = INTEGER(vectemp.VECFALT:SCREEN-VALUE): 
      FILL-IN-VNR1A    = vperstid.VECKA.
      
      IF vperstid.DAG = "mån" THEN DO:
         ASSIGN
         FILL-IN-BOR1V1A  = vperstid.REGSTART              
         FILL-IN-SLU1V1A  = vperstid.REGSLUT
         FILL-IN-TIM1V1A  = vperstid.REGTOTALT
         FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "tis" THEN DO:
         ASSIGN
         FILL-IN-BOR2V1A  = vperstid.REGSTART               
         FILL-IN-SLU2V1A  = vperstid.REGSLUT
         FILL-IN-TIM2V1A  = vperstid.REGTOTALT.
         FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "ons" THEN DO:
         ASSIGN
         FILL-IN-BOR3V1A  = vperstid.REGSTART              
         FILL-IN-SLU3V1A  = vperstid.REGSLUT
         FILL-IN-TIM3V1A  = vperstid.REGTOTALT.
         FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "tor" THEN DO:
         ASSIGN
         FILL-IN-BOR4V1A  = vperstid.REGSTART             
         FILL-IN-SLU4V1A  = vperstid.REGSLUT
         FILL-IN-TIM4V1A  = vperstid.REGTOTALT.
         FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "fre" THEN DO:
         ASSIGN
         FILL-IN-BOR5V1A  = vperstid.REGSTART              
         FILL-IN-SLU5V1A  = vperstid.REGSLUT
         FILL-IN-TIM5V1A  = vperstid.REGTOTALT.
         FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "lör" THEN DO:
         ASSIGN
         FILL-IN-BOR6V1A  = vperstid.REGSTART              
         FILL-IN-SLU6V1A  = vperstid.REGSLUT
         FILL-IN-TIM6V1A  = vperstid.REGTOTALT.
         FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "sön" THEN DO:
         ASSIGN
         FILL-IN-BOR7V1A  = vperstid.REGSTART
         FILL-IN-SLU7V1A  = vperstid.REGSLUT          
         FILL-IN-TIM7V1A  = vperstid.REGTOTALT.
         FILL-IN-TOTV1A  = klockan60(klockan100(FILL-IN-TOTV1A) + klockan100(vperstid.REGTOTALT)).
      END.                       
   END.      
   FIND FIRST vectemp  WHERE vectemp.VEC = 2 NO-LOCK NO-ERROR.
   FIND FIRST vperstid WHERE vperstid.PERSONALKOD = FILL-IN_PERSON AND
   vperstid.VECKA = INTEGER(vectemp.VECFALT:SCREEN-VALUE)  
   NO-LOCK NO-ERROR.
   IF NOT AVAILABLE vperstid THEN DO:
      RUN varbtid_UI IN arbproch (INPUT FILL-IN_PERSON,INPUT INTEGER(vectemp.VECFALT:SCREEN-VALUE) , OUTPUT TABLE vperstid APPEND).
   END.
   FILL-IN-TOTV2A  = 0.
   FOR EACH vperstid WHERE vperstid.PERSONALKOD = FILL-IN_PERSON AND vperstid.VECKA = INTEGER(vectemp.VECFALT:SCREEN-VALUE) : 
      FILL-IN-VNR2A    = vperstid.VECKA.
      IF vperstid.DAG = "mån" THEN DO:
         ASSIGN
         FILL-IN-BOR1V2A  = vperstid.REGSTART              
         FILL-IN-SLU1V2A  = vperstid.REGSLUT
         FILL-IN-TIM1V2A  = vperstid.REGTOTALT.
         FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "tis" THEN DO:
         ASSIGN
         FILL-IN-BOR2V2A  = vperstid.REGSTART               
         FILL-IN-SLU2V2A  = vperstid.REGSLUT
         FILL-IN-TIM2V2A  = vperstid.REGTOTALT.
         FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "ons" THEN DO:
         ASSIGN
         FILL-IN-BOR3V2A  = vperstid.REGSTART              
         FILL-IN-SLU3V2A  = vperstid.REGSLUT
         FILL-IN-TIM3V2A  = vperstid.REGTOTALT.
         FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "tor" THEN DO:
         ASSIGN
         FILL-IN-BOR4V2A  = vperstid.REGSTART             
         FILL-IN-SLU4V2A  = vperstid.REGSLUT
         FILL-IN-TIM4V2A  = vperstid.REGTOTALT.
         FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "fre" THEN DO:
         ASSIGN
         FILL-IN-BOR5V2A  = vperstid.REGSTART              
         FILL-IN-SLU5V2A  = vperstid.REGSLUT
         FILL-IN-TIM5V2A  = vperstid.REGTOTALT.
         FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "lör" THEN DO:
         ASSIGN
         FILL-IN-BOR6V2A  = vperstid.REGSTART              
         FILL-IN-SLU6V2A  = vperstid.REGSLUT
         FILL-IN-TIM6V2A  = vperstid.REGTOTALT.
         FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "sön" THEN DO:
         ASSIGN
         FILL-IN-BOR7V2A  = vperstid.REGSTART
         FILL-IN-SLU7V2A  = vperstid.REGSLUT          
         FILL-IN-TIM7V2A  = vperstid.REGTOTALT.
         FILL-IN-TOTV2A  = klockan60(klockan100(FILL-IN-TOTV2A) + klockan100(vperstid.REGTOTALT)).
      END.                       
   END.
   FIND FIRST vectemp  WHERE vectemp.VEC = 3 NO-LOCK NO-ERROR.
   FIND FIRST vperstid WHERE vperstid.PERSONALKOD = FILL-IN_PERSON AND
   vperstid.VECKA = INTEGER(vectemp.VECFALT:SCREEN-VALUE)  
   NO-LOCK NO-ERROR.
   IF NOT AVAILABLE vperstid THEN DO:
      RUN varbtid_UI IN arbproch (INPUT FILL-IN_PERSON,INPUT INTEGER(vectemp.VECFALT:SCREEN-VALUE) , OUTPUT TABLE vperstid APPEND).
   END.
   FILL-IN-TOTV3A  = 0.
   FOR EACH vperstid WHERE vperstid.PERSONALKOD = FILL-IN_PERSON AND vperstid.VECKA = INTEGER(vectemp.VECFALT:SCREEN-VALUE) : 
      FILL-IN-VNR3A    = vperstid.VECKA.
      IF vperstid.DAG = "mån" THEN DO:
         ASSIGN
         FILL-IN-BOR1V3A  = vperstid.REGSTART              
         FILL-IN-SLU1V3A  = vperstid.REGSLUT
         FILL-IN-TIM1V3A  = vperstid.REGTOTALT.
         FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "tis" THEN DO:
         ASSIGN
         FILL-IN-BOR2V3A  = vperstid.REGSTART               
         FILL-IN-SLU2V3A  = vperstid.REGSLUT
         FILL-IN-TIM2V3A  = vperstid.REGTOTALT.
         FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "ons" THEN DO:
         ASSIGN
         FILL-IN-BOR3V3A  = vperstid.REGSTART              
         FILL-IN-SLU3V3A  = vperstid.REGSLUT
         FILL-IN-TIM3V3A  = vperstid.REGTOTALT.
         FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "tor" THEN DO:
         ASSIGN
         FILL-IN-BOR4V3A  = vperstid.REGSTART             
         FILL-IN-SLU4V3A  = vperstid.REGSLUT
         FILL-IN-TIM4V3A  = vperstid.REGTOTALT.
         FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "fre" THEN DO:
         ASSIGN
         FILL-IN-BOR5V3A  = vperstid.REGSTART              
         FILL-IN-SLU5V3A  = vperstid.REGSLUT
         FILL-IN-TIM5V3A  = vperstid.REGTOTALT.
         FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "lör" THEN DO:
         ASSIGN
         FILL-IN-BOR6V3A  = vperstid.REGSTART              
         FILL-IN-SLU6V3A  = vperstid.REGSLUT
         FILL-IN-TIM6V3A  = vperstid.REGTOTALT.
         FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
      END.
      IF vperstid.DAG = "sön" THEN DO:
         ASSIGN
         FILL-IN-BOR7V3A  = vperstid.REGSTART
         FILL-IN-SLU7V3A  = vperstid.REGSLUT          
         FILL-IN-TIM7V3A  = vperstid.REGTOTALT.
         FILL-IN-TOTV3A  = klockan60(klockan100(FILL-IN-TOTV3A) + klockan100(vperstid.REGTOTALT)).
      END.                       
   END.
   FRAME FRAME-ARB:HIDDEN = FALSE.
   DISPLAY 
   FILL-IN-VNR1A    
   FILL-IN-BOR1V1A            
   FILL-IN-SLU1V1A  
   FILL-IN-TIM1V1A  
   FILL-IN-BOR2V1A             
   FILL-IN-SLU2V1A  
   FILL-IN-TIM2V1A  
   FILL-IN-BOR3V1A            
   FILL-IN-SLU3V1A  
   FILL-IN-TIM3V1A  
   FILL-IN-BOR4V1A           
   FILL-IN-SLU4V1A  
   FILL-IN-TIM4V1A  
   FILL-IN-BOR5V1A            
   FILL-IN-SLU5V1A  
   FILL-IN-TIM5V1A  
   FILL-IN-BOR6V1A            
   FILL-IN-SLU6V1A  
   FILL-IN-TIM6V1A  
   FILL-IN-BOR7V1A  
   FILL-IN-SLU7V1A       
   FILL-IN-TIM7V1A
   FILL-IN-TOTV1A  

   FILL-IN-VNR2A    
   FILL-IN-BOR1V2A  
   FILL-IN-SLU1V2A  
   FILL-IN-TIM1V2A  
   FILL-IN-BOR2V2A  
   FILL-IN-SLU2V2A  
   FILL-IN-TIM2V2A  
   FILL-IN-BOR3V2A  
   FILL-IN-SLU3V2A  
   FILL-IN-TIM3V2A  
   FILL-IN-BOR4V2A  
   FILL-IN-SLU4V2A  
   FILL-IN-TIM4V2A  
   FILL-IN-BOR5V2A  
   FILL-IN-SLU5V2A  
   FILL-IN-TIM5V2A  
   FILL-IN-BOR6V2A  
   FILL-IN-SLU6V2A  
   FILL-IN-TIM6V2A  
   FILL-IN-BOR7V2A  
   FILL-IN-SLU7V2A  
   FILL-IN-TIM7V2A
   FILL-IN-TOTV2A 

   FILL-IN-VNR3A    
   FILL-IN-BOR1V3A  
   FILL-IN-SLU1V3A  
   FILL-IN-TIM1V3A  
   FILL-IN-BOR2V3A  
   FILL-IN-SLU2V3A  
   FILL-IN-TIM2V3A  
   FILL-IN-BOR3V3A  
   FILL-IN-SLU3V3A  
   FILL-IN-TIM3V3A  
   FILL-IN-BOR4V3A  
   FILL-IN-SLU4V3A  
   FILL-IN-TIM4V3A  
   FILL-IN-BOR5V3A  
   FILL-IN-SLU5V3A  
   FILL-IN-TIM5V3A  
   FILL-IN-BOR6V3A  
   FILL-IN-SLU6V3A  
   FILL-IN-TIM6V3A  
   FILL-IN-BOR7V3A  
   FILL-IN-SLU7V3A  
   FILL-IN-TIM7V3A
   FILL-IN-TOTV3A  

   WITH FRAME FRAME-ARB.
      
   
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

