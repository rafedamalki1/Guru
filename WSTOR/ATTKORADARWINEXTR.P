/*ATTKORADARWINEXTR.P */
/*  JMF ATTKORADARWIN.P
for each STORDISTRIKT Where  ARTAL = 2004:
   DELETE  STORDISTRIKT .
END.
for each KUNDSTOR Where  ARTAL = 2004:
   DELETE  KUNDSTOR .
END.
for each LEDNINGSDATA  Where  ARTAL = 2004:
   DELETE  LEDNINGSDATA.
END.
for each STORNINGSTAB Where  DATUM100% >= 04/01/01:
   DELETE  STORNINGSTAB .
END.
   

Query phrase =  'for each KUNDSTOR'
Where phrase = ARTAL = 2004
Query phrase =  'for each STORNINGSTAB'
Where phrase = DATUM100% >= 04/01/01
*/


DEFINE VARIABLE nd1 AS INTEGER NO-UNDO.
DEFINE VARIABLE nd2 AS INTEGER NO-UNDO.
DEFINE VARIABLE nd3 AS INTEGER NO-UNDO.
DEFINE VARIABLE nd4 AS INTEGER NO-UNDO.
DEFINE VARIABLE txt1 AS CHARACTER NO-UNDO.
DEFINE VARIABLE txt2 AS CHARACTER NO-UNDO.
DEFINE VARIABLE langdvar1000 AS INTEGER NO-UNDO. /*vad är det som styr*/
DEFINE TEMP-TABLE natupptt NO-UNDO
FIELD N1 AS INTEGER
FIELD N2 AS INTEGER
FIELD N3 AS INTEGER
FIELD N4 AS INTEGER
INDEX N1234 N1 N2 N3 N4.
FUNCTION FFinlasttab RETURNS INTEGER 
(INPUT sid AS INTEGER):
   DO TRANSACTION:
      FIND FIRST SPANNINGSNIV WHERE SPANNINGSNIV.SPANID = sid USE-INDEX SPANID NO-LOCK NO-ERROR.
      IF AVAILABLE SPANNINGSNIV THEN DO:
         FIND FIRST INLASTAB WHERE INLASTAB.INKODID = SPANNINGSNIV.INKODID
         USE-INDEX INKODID EXCLUSIVE-LOCK NO-ERROR.
         IF AVAILABLE INLASTAB THEN DO:
            IF INLASTAB.INKODPOSCH = "0" OR INLASTAB.INKODPOSCH = "" THEN DO :
               INLASTAB.INKODPOSCH = STRING(INLASTAB.INKODID).
            END.   
            RETURN INTEGER(INLASTAB.INKODPOSCH).
         END.   
         ELSE RETURN sid.
      END.
      ELSE RETURN sid.
   END.
END FUNCTION.

FUNCTION FFinlasttabFL RETURNS INTEGER 
(INPUT tabnamn AS CHARACTER,INPUT sid AS INTEGER):
   IF tabnamn = "SEKTIONERING" THEN DO:  
      FIND FIRST SEKTIONERING WHERE SEKTIONERING.SEKTIONERID = STRING(sid) NO-LOCK NO-ERROR.
      IF NOT AVAILABLE SEKTIONERING THEN RETURN sid.
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = SEKTIONERING.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid. 
      RETURN INTEGER(INLASTAB.INKODPOSCH).
   END.
   IF tabnamn = "RELAINDIKERING" THEN DO:  
      FIND FIRST RELAINDIKERING WHERE RELAINDIKERING.RELINID = sid NO-LOCK NO-ERROR.
      IF NOT AVAILABLE RELAINDIKERING THEN RETURN sid.
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = RELAINDIKERING.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      RETURN INTEGER(INLASTAB.INKODPOSCH).
   END.        
   IF tabnamn = "FELORSAK" THEN DO:  
      FIND FIRST FELORSAK WHERE FELORSAK.FELOID = sid NO-LOCK NO-ERROR.
      IF NOT AVAILABLE FELORSAK THEN RETURN 93.
      IF FELORSAK.FELOID >= 500 THEN RETURN 93.
      /*tester*/
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = FELORSAK.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      RETURN INTEGER(INLASTAB.INKODPOSCH).
   END.   
  
   IF tabnamn = "BRYTORGAN" THEN DO:  
      FIND FIRST BRYTORGAN WHERE BRYTORGAN.BRYTOID = sid NO-LOCK NO-ERROR.
      IF NOT AVAILABLE BRYTORGAN THEN RETURN sid.
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = BRYTORGAN.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      RETURN INTEGER(INLASTAB.INKODPOSCH).
   END.  
   IF tabnamn = "STORDRIFTOMR" THEN DO:  
      FIND FIRST STORDRIFTOMR WHERE STORDRIFTOMR.STDRIFTID = sid NO-LOCK NO-ERROR.
      IF NOT AVAILABLE STORDRIFTOMR THEN RETURN sid.
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = STORDRIFTOMR.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      RETURN INTEGER(INLASTAB.INKODPOSCH).
   END. 
   IF tabnamn = "NATTYP" THEN DO:  
      FIND FIRST NATTYP WHERE NATTYP.NATTYPID = STRING(sid) NO-LOCK NO-ERROR.
      IF NOT AVAILABLE NATTYP THEN RETURN sid.
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = NATTYP.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      RETURN INTEGER(INLASTAB.INKODPOSCH).
   END.
   IF tabnamn = "NATSTRUKTUR1" THEN DO:  
      FIND FIRST NATTYP WHERE NATTYP.NATTYPID = STRING(sid) NO-LOCK NO-ERROR.
      IF NOT AVAILABLE NATTYP THEN RETURN sid.
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = NATTYP.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      RETURN INTEGER(INLASTAB.INKODPOSCH).
   END.
   IF tabnamn = "NATSTRUKTUR2" THEN DO:  
      FIND FIRST NATTYP WHERE NATTYP.NATTYPID = STRING(sid) NO-LOCK NO-ERROR.
      IF NOT AVAILABLE NATTYP THEN RETURN sid.
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = NATTYP.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      RETURN INTEGER(INLASTAB.INKODPOSCH).
   END.
   IF tabnamn = "ANLAGGNINGSDEL" THEN DO: 
      IF sid >= 5 AND  sid <= 12 THEN RETURN 50. 
      FIND FIRST ANLAGGNINGSDEL WHERE ANLAGGNINGSDEL.ADELID = sid NO-LOCK NO-ERROR.
      
      IF NOT AVAILABLE ANLAGGNINGSDEL THEN RETURN sid.
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = ANLAGGNINGSDEL.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      RETURN INTEGER(INLASTAB.INKODPOSCH).
   END.
   IF tabnamn = "UTLOSNINGSKYDD" THEN DO:  
      FIND FIRST UTLOSNINGSKYDD WHERE UTLOSNINGSKYDD.UTLOSID = sid NO-LOCK NO-ERROR.
      IF NOT AVAILABLE UTLOSNINGSKYDD THEN RETURN sid.
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = UTLOSNINGSKYDD.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      IF NOT AVAILABLE INLASTAB THEN RETURN sid.
      RETURN INTEGER(INLASTAB.INKODPOSCH).
   END.
   
END FUNCTION.   
MESSAGE "start"
VIEW-AS ALERT-BOX.
      
 

RUN Kunddatafix_UI.
MESSAGE "slut attköra"
VIEW-AS ALERT-BOX.

PROCEDURE Spanfix_UI :
   
   FOR EACH SPANNINGSNIV  WHERE EXCLUSIVE-LOCK:
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = SPANNINGSNIV.INKODID AND INLASTAB.INKODTYP = "1" 
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      IF AVAILABLE INLASTAB THEN DO:
         SPANNINGSNIV.SPANDARWINID = INTEGER(INLASTAB.INKODPOSCH).
      END.
      IF SPANNINGSNIV.NAMN MATCHES "*" + "FÖRDELNINGSNÄT" + "*" THEN DO:
         SPANNINGSNIV.NAMN = REPLACE(SPANNINGSNIV.NAMN,"FÖRDELNINGSNÄT","LOKALNÄT").
      END.    
         
   END.
   FOR EACH SPANNINGSNIV WHERE EXCLUSIVE-LOCK:
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = SPANNINGSNIV.INKODID 
      USE-INDEX INKODID NO-LOCK NO-ERROR.       
      IF INLASTAB.INKODTYP = "2" THEN SPANNINGSNIV.SPANDARWINID = 0.
   END.
END PROCEDURE.
PROCEDURE Vallistafix :
   
   FOR EACH SEKTIONERING WHERE  EXCLUSIVE-LOCK.
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = SEKTIONERING.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      SEKTIONERING.SEKTIONERDARWINID = INTEGER(INLASTAB.INKODPOSCH).
   END.
   FOR EACH RELAINDIKERING EXCLUSIVE-LOCK:
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = RELAINDIKERING.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      RELAINDIKERING.RELINDARWINID = INTEGER(INLASTAB.INKODPOSCH).
   END.        
   FOR EACH FELORSAK EXCLUSIVE-LOCK:
      IF FELORSAK.FELOID >= 500 THEN FELORSAK.FELODARWINID = 93.
      /*tester*/
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = FELORSAK.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      FELORSAK.FELODARWINID = INTEGER(INLASTAB.INKODPOSCH).
   END.   
  
   FOR EACH BRYTORGAN  EXCLUSIVE-LOCK:
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = BRYTORGAN.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      BRYTORGAN.BRYTODARWINID = INTEGER(INLASTAB.INKODPOSCH).
   END.  
   FOR EACH STORDRIFTOMR EXCLUSIVE-LOCK:
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = STORDRIFTOMR.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      STORDRIFTOMR.STDRIFTDARWINID = INTEGER(INLASTAB.INKODPOSCH).
   END. 
   FOR EACH NATTYP EXCLUSIVE-LOCK:
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = NATTYP.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      NATTYP.NATTYPDARWINID = INTEGER(INLASTAB.INKODPOSCH).
   END.
   /*
   FOR EACH NATTYP EXCLUSIVE-LOCK:
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = NATTYP.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      NATTYP.NATTYPDARWINID = INTEGER(INLASTAB.INKODPOSCH).
   END.
   */
   FOR EACH ANLAGGNINGSDEL EXCLUSIVE-LOCK:
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = ANLAGGNINGSDEL.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      IF AVAILABLE INLASTAB THEN ANLAGGNINGSDEL.ADELDARWINID = INTEGER(INLASTAB.INKODPOSCH).
   END.
   FOR EACH UTLOSNINGSKYDD EXCLUSIVE-LOCK:
      FIND FIRST INLASTAB WHERE INLASTAB.INKODID = UTLOSNINGSKYDD.INKODID
      USE-INDEX INKODID NO-LOCK NO-ERROR.
      UTLOSNINGSKYDD.UTLOSDARWINID = INTEGER(INLASTAB.INKODPOSCH).
   END.
END PROCEDURE.

PROCEDURE Kunddatafix_UI :
   MESSAGE "KUND"
   VIEW-AS ALERT-BOX.
   FOR EACH KUNDSTOR  EXCLUSIVE-LOCK:
      KUNDSTOR.SPANDARWINID = FFinlasttab(KUNDSTOR.SPANID).
   END.
   MESSAGE "LED"
   VIEW-AS ALERT-BOX.
   FOR EACH LEDNINGSDATA  EXCLUSIVE-LOCK:
      LEDNINGSDATA.SPANDARWINID = FFinlasttab(LEDNINGSDATA.SPANID).
   END.
   MESSAGE "STOR"
   VIEW-AS ALERT-BOX.
   DEFINE VARIABLE AA AS INTEGER NO-UNDO.
   FOR EACH STORNINGSTAB EXCLUSIVE-LOCK:
     AA = AA + 1.
      IF STORNINGSTAB.STORTYPID = 1 THEN DO:
         STORNINGSTAB.FELSPANDARWINID = FFinlasttab(STORNINGSTAB.FELSPANID).
         STORNINGSTAB.SEKTIONERDARWINID = FFinlasttabFL("SEKTIONERING",INTEGER(STORNINGSTAB.SEKTIONERID)).
         STORNINGSTAB.UTLOSDARWINID = FFinlasttabFL("LUTLOSNINGSKYDD",STORNINGSTAB.UTLOSID).
         STORNINGSTAB.RELINDARWINID = FFinlasttabFL("RELAINDIKERING",STORNINGSTAB.RELINID).
         STORNINGSTAB.FELODARWINID = FFinlasttabFL("FELORSAK",STORNINGSTAB.FELOID).
      END.
      STORNINGSTAB.FRANSPANDARWINID = FFinlasttab(STORNINGSTAB.FRANSPANID).
      STORNINGSTAB.BRYTODARWINID = FFinlasttabFL("BRYTORGAN",STORNINGSTAB.BRYTOID).
      STORNINGSTAB.STDRIFTDARWINID = FFinlasttabFL("STORDRIFTOMR",STORNINGSTAB.STDRIFTID).
      STORNINGSTAB.NATTYPDARWINID = FFinlasttabFL("NATTYP",INTEGER(STORNINGSTAB.NATTYPID)).
      STORNINGSTAB.STRUKDARWINIDP1 = FFinlasttabFL("NATSTRUKTUR1",STORNINGSTAB.STRUKIDP1).
      STORNINGSTAB.STRUKDARWINIDP2 = FFinlasttabFL("NATSTRUKTUR2",STORNINGSTAB.STRUKIDP2).
      STORNINGSTAB.ADELDARWINID = FFinlasttabFL("ANLAGGNINGSDEL",STORNINGSTAB.ADELID).
   END.
   
   MESSAGE STRING(TIME,"HH:MM")
   VIEW-AS ALERT-BOX.
END PROCEDURE.
   
           


PROCEDURE KundTABFIX_UI :
   FOR EACH KUNDSTOR WHERE EXCLUSIVE-LOCK:
       IF KUNDSTOR.ANTALKUNDER = 0 THEN DO:
          KUNDSTOR.ANTALKUNDER = KUNDSTOR.ANTALLUFT + KUNDSTOR.ANTALBLAND + KUNDSTOR.ANTALKABEL.
       END.
   END.
   FOR EACH LEDNINGSDATA WHERE EXCLUSIVE-LOCK:
      IF LEDNINGSDATA.LANGD = 0 THEN DO:
         LEDNINGSDATA.LANGD = LEDNINGSDATA.LANGDLUFT + LEDNINGSDATA.LANGDBLAND + LEDNINGSDATA.LANGDKABEL.
      END.
   END.
   DO TRANSACTION:
      CREATE ANLAGGNINGSDEL.
      ASSIGN 
      ANLAGGNINGSDEL.ADELID = 26
      ANLAGGNINGSDEL.ATYPID = 2
      ANLAGGNINGSDEL.INKODID = "247"
      ANLAGGNINGSDEL.NAMN = "Nätstation".
      
      CREATE ANLAGGNINGSDEL.
      ASSIGN 
      ANLAGGNINGSDEL.ADELID = 70
      ANLAGGNINGSDEL.ATYPID = 6
      ANLAGGNINGSDEL.INKODID = ""
      ANLAGGNINGSDEL.NAMN = "Skarv".
      
      CREATE INLASTAB.
      ASSIGN 
      INLASTAB.INKODID = "247"
      INLASTAB.INKOD = "R"
      INLASTAB.NAMN = "Nätstation"
      INLASTAB.INLASTNR = 247
      INLASTAB.TABNAMN = "ANLAGGNINGSDEL"
      INLASTAB.INKODTYP = "4"
      INLASTAB.ORDNING = 0
      INLASTAB.INKODPOSCH = "50".
   END.   
   FOR EACH STORNINGSTAB WHERE STORNINGSTAB.ADELID >= 5 AND  STORNINGSTAB.ADELID <= 12 EXCLUSIVE-LOCK:
      STORNINGSTAB.ADELID = 26.
   END.
   DO TRANSACTION:
      FIND FIRST ANLAGGNINGSDEL WHERE ANLAGGNINGSDEL.ADELID = 14 EXCLUSIVE-LOCK NO-ERROR.
      ANLAGGNINGSDEL.NAMN = "Friledning, isolerad BLL/BLX".
      FIND FIRST ANLAGGNINGSDEL WHERE ANLAGGNINGSDEL.ADELID = 15 EXCLUSIVE-LOCK NO-ERROR.
      ANLAGGNINGSDEL.NAMN = "Hängspiralkabelledning ALUS".  
     /*
      FIND FIRST STORTEXTER WHERE STORTEXTER.TID = 210 EXCLUSIVE-LOCK NO-ERROR.
      STORTEXTER.NAMN = "FRILEDNING, ISOLERAD BLL/BLX".
      FIND FIRST STORTEXTER WHERE STORTEXTER.TID = 211 EXCLUSIVE-LOCK NO-ERROR.
      STORTEXTER.NAMN = "HÄNGKABELLEDNING ALUS".
      */
      /* NÄTSATION*/
       
      
   END.   
   RUN Dubbletter_UI.
   
   
END PROCEDURE.

PROCEDURE Dubbletter_UI :
   DEFINE BUFFER kbuff FOR KUNDSTOR.
   DO TRANSACTION:
      FOR EACH KUNDSTOR WHERE NO-LOCK:
         FIND FIRST kbuff WHERE kbuff.DISTRIKTID = KUNDSTOR.DISTRIKTID AND kbuff.SPANID = KUNDSTOR.SPANID AND
          kbuff.ARTAL = KUNDSTOR.ARTAL  AND ROWID(kbuff) NE ROWID(KUNDSTOR) EXCLUSIVE-LOCK NO-ERROR.
          IF AVAILABLE kbuff THEN DELETE kbuff.
      END.
      DEFINE BUFFER lbuff FOR LEDNINGSDATA.
      FOR EACH LEDNINGSDATA WHERE NO-LOCK:
         FIND FIRST lbuff WHERE lbuff.DISTRIKTID = LEDNINGSDATA.DISTRIKTID AND lbuff.SPANID = LEDNINGSDATA.SPANID AND
          lbuff.ARTAL = LEDNINGSDATA.ARTAL  AND ROWID(lbuff) NE ROWID(LEDNINGSDATA) EXCLUSIVE-LOCK NO-ERROR.
          IF AVAILABLE lbuff THEN DELETE lbuff.
      END.
    END.
END PROCEDURE.

PROCEDURE texter_UI :
   DEFINE VARIABLE ii AS INTEGER NO-UNDO.
   FOR EACH NATUPPLAGG1 WHERE NO-LOCK:
      CREATE STORTEXTER.
      STORTEXTER.TID = INTEGER(NATUPPLAGG1.INKODID).
      STORTEXTER.NAMN = NATUPPLAGG1.NAMN.   
   END.
   FOR EACH NATUPPLAGG2 WHERE NO-LOCK:
      CREATE STORTEXTER.
      STORTEXTER.TID = INTEGER(NATUPPLAGG2.INKODID).
      STORTEXTER.NAMN = NATUPPLAGG2.NAMN.   
   END.
   FOR EACH NATUPPLAGG3 WHERE NO-LOCK:
      CREATE STORTEXTER.
      STORTEXTER.TID = INTEGER(NATUPPLAGG3.INKODID).
      STORTEXTER.NAMN = NATUPPLAGG3.NAMN.   
   END.
   FOR EACH NATUPPLAGG4 WHERE NO-LOCK:
      CREATE STORTEXTER.
      STORTEXTER.TID = INTEGER(NATUPPLAGG4.INKODID).
      STORTEXTER.NAMN = NATUPPLAGG4.NAMN.   
   END.
   FIND LAST STORTEXTER WHERE NO-LOCK NO-ERROR.
   IF AVAILABLE STORTEXTER THEN ii = STORTEXTER.TID + 1.
   ELSE ii = 1.
   DO TRANSACTION:
      CREATE STORTEXTER.
      STORTEXTER.TID = ii.
      STORTEXTER.NAMN = "Oljeisolerad krafttransformator".
      CREATE STORNATUPPKOPP.
      ASSIGN     
      STORNATUPPKOPP.NATUPPLAGGID1 = 4
      
      STORNATUPPKOPP.NATUPPLAGGID2 = 10 
      STORNATUPPKOPP.NATUPPLAGGID3 = 23
      STORNATUPPKOPP.NATUPPLAGGID4 = 0
      STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID
      STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID
      STORNATUPPKOPP.M-KM = 1
      STORNATUPPKOPP.TEXTKOMBID = 128.  
      ii = ii + 1.
      CREATE STORTEXTER.
      STORTEXTER.TID = ii.
      STORTEXTER.NAMN = "Torrisolerad krafttransformator".
      CREATE STORNATUPPKOPP.
      ASSIGN     
      STORNATUPPKOPP.NATUPPLAGGID1 = 4
      STORNATUPPKOPP.NATUPPLAGGID2 = 10 
      STORNATUPPKOPP.NATUPPLAGGID3 = 31
      STORNATUPPKOPP.NATUPPLAGGID4 = 0
      STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID
      STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID
      STORNATUPPKOPP.M-KM = 1
      STORNATUPPKOPP.TEXTKOMBID = 129.
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Station" NO-LOCK NO-ERROR.
      IF NOT AVAILABLE STORTEXTER THEN  DO:
         ii = ii + 1.
         CREATE STORTEXTER.
         STORTEXTER.TID = ii.
         STORTEXTER.NAMN = "Station".
      END.
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Luftledning BLL/BLX" NO-LOCK NO-ERROR.
      IF NOT AVAILABLE STORTEXTER THEN  DO:
         ii = ii + 1.
         CREATE STORTEXTER.
         STORTEXTER.TID = ii.
         STORTEXTER.NAMN = "Luftledning BLL/BLX".
      END.
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Luftledning Alus" NO-LOCK NO-ERROR.
      IF NOT AVAILABLE STORTEXTER THEN  DO:
         ii = ii + 1.
         CREATE STORTEXTER.
         STORTEXTER.TID = ii.
         STORTEXTER.NAMN = "Luftledning Alus".
      END.
      
      
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Kraftkabel i mark" NO-LOCK NO-ERROR.
      IF NOT AVAILABLE STORTEXTER THEN  DO:
         ii = ii + 1.
         CREATE STORTEXTER.
         STORTEXTER.TID = ii.
         STORTEXTER.NAMN = "Kraftkabel i mark".
      END.
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Kraftkabel i vatten" NO-LOCK NO-ERROR.
      IF NOT AVAILABLE STORTEXTER THEN  DO:
         ii = ii + 1.
         CREATE STORTEXTER.
         STORTEXTER.TID = ii.
         STORTEXTER.NAMN = "Kraftkabel i vatten".
      END.
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Avgrenings-/Kabelskåp" NO-LOCK NO-ERROR.
      IF NOT AVAILABLE STORTEXTER THEN  DO:
         ii = ii + 1.
         CREATE STORTEXTER.
         STORTEXTER.TID = ii.
         STORTEXTER.NAMN = "Avgrenings-/Kabelskåp".
      END.
      FIND FIRST STORTEXTER WHERE  STORTEXTER.NAMN = "Lastfrånskiljare med säkring" NO-LOCK NO-ERROR.
      IF NOT AVAILABLE STORTEXTER THEN  DO:
         ii = ii + 1.
         CREATE STORTEXTER.
         STORTEXTER.TID = ii.
         STORTEXTER.NAMN = "Lastfrånskiljare med säkring".
      END.
      
      
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Markstation" NO-LOCK NO-ERROR.
      IF NOT AVAILABLE STORTEXTER THEN  DO:
         ii = ii + 1.
         CREATE STORTEXTER.
         STORTEXTER.TID = ii.
         STORTEXTER.NAMN = "Markstation".
      END.
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Betongstn. inomhusman" EXCLUSIVE-LOCK NO-ERROR.
      IF AVAILABLE STORTEXTER THEN STORTEXTER.NAMN = "Btg el stenstn. inomhusman". 
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Betongstn. utomhusman" EXCLUSIVE-LOCK NO-ERROR.
      IF AVAILABLE STORTEXTER THEN STORTEXTER.NAMN = "Btg el stenstn. utomhusman". 
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Apparater i luftledning och stolpstationer" EXCLUSIVE-LOCK NO-ERROR.
      IF AVAILABLE STORTEXTER THEN STORTEXTER.NAMN = "App. i luftledn. och stolpstn". 
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Krafttransformatorer" EXCLUSIVE-LOCK  NO-ERROR.
      IF AVAILABLE STORTEXTER THEN STORTEXTER.NAMN = "Krafttransformator".
      
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Friledning ,isolerad" EXCLUSIVE-LOCK  NO-ERROR.
      IF AVAILABLE STORTEXTER THEN STORTEXTER.NAMN = "Friledning, isolerad". 
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Friledning ,oisolerad" EXCLUSIVE-LOCK  NO-ERROR.
      IF AVAILABLE STORTEXTER THEN STORTEXTER.NAMN = "Friledning, oisolerad".
      
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "-torrisolerad luft" EXCLUSIVE-LOCK  NO-ERROR.
      IF AVAILABLE STORTEXTER THEN STORTEXTER.NAMN = "-torrisolerad, luft".
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "-torrisolerad solid" EXCLUSIVE-LOCK  NO-ERROR.
      IF AVAILABLE STORTEXTER THEN STORTEXTER.NAMN = "-torrisolerad, solid".
     
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "likriktatsation" EXCLUSIVE-LOCK  NO-ERROR.
      IF AVAILABLE STORTEXTER THEN STORTEXTER.NAMN = "Likriktarstation".
   END.      
   /*
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "varav -PCB" NO-LOCK NO-ERROR.
      IF NOT AVAILABLE STORTEXTER THEN  DO:
         ii = ii + 1.
         CREATE STORTEXTER.
         STORTEXTER.TID = ii.
         STORTEXTER.NAMN = "varav -PCB".
      END.
      
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = "Varav PEX" NO-LOCK NO-ERROR.
      IF NOT AVAILABLE STORTEXTER THEN  DO:
         ii = ii + 1.
         CREATE STORTEXTER.
         STORTEXTER.TID = ii.
         STORTEXTER.NAMN = "Varav PEX".
      END.
      */ 
END PROCEDURE.



DEFINE TEMP-TABLE stnattt NO-UNDO
FIELD TEXTID1 AS INTEGER
FIELD TEXTID2 AS INTEGER

FIELD t1 AS CHARACTER
FIELD t2 AS CHARACTER. 

PROCEDURE ntxt1_UI :
   DEFINE INPUT PARAMETER ntxt AS CHARACTER NO-UNDO.
   DO TRANSACTION:
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = ntxt EXCLUSIVE-LOCK NO-ERROR.  
      STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID.  
      STORTEXTER.NAMN = ntxt.
   END.    
END PROCEDURE.
PROCEDURE ntxt2_UI :
   DEFINE INPUT PARAMETER ntxt AS CHARACTER NO-UNDO.
   DO TRANSACTION:
      FIND FIRST STORTEXTER WHERE STORTEXTER.NAMN = ntxt EXCLUSIVE-LOCK NO-ERROR.  
      STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID.
      STORTEXTER.NAMN = ntxt.
   END.     
END PROCEDURE.




PROCEDURE UPPKOLL_UI:
   DEFINE VARIABLE ntxt AS CHARACTER NO-UNDO.
   DO TRANSACTION:
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 10
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 3 
         STORNATUPPKOPP.NATUPPLAGGID3 = 0  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Regionstation".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Station".
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 20        
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 4 
         STORNATUPPKOPP.NATUPPLAGGID3 = 0  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Fördelningsstation".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Station".
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 30
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 5 
         STORNATUPPKOPP.NATUPPLAGGID3 = 0  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Kopplingsstation".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Station".
      CREATE STORNATUPPKOPP. 
      ASSIGN
       
         STORNATUPPKOPP.TEXTKOMBID =  35
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 6 
         STORNATUPPKOPP.NATUPPLAGGID3 = 0  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Likriktarstation".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Station".
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 41
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 7 
         STORNATUPPKOPP.NATUPPLAGGID3 = 13  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Stolpstation".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Stolpstation".
      RUN ntxt2_UI(ntxt) .  
      FIND FIRST STORTEXTER  WHERE STORTEXTER.NAMN = "Nätstation" NO-LOCK NO-ERROR.
      CREATE STORNATUPPKOPP.
      ASSIGN
         STORNATUPPKOPP.TEXTKOMBID = 50
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 7 
         STORNATUPPKOPP.NATUPPLAGGID3 = 35  
         STORNATUPPKOPP.NATUPPLAGGID4 = 0
         STORNATUPPKOPP.TEXTID1 = STORTEXTER.TID
         STORNATUPPKOPP.TEXTID2 = STORTEXTER.TID.  
         
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 51 
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 1 
         STORNATUPPKOPP.NATUPPLAGGID3 = 1  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 
         STORNATUPPKOPP.M-KM = 1000.
      ntxt = "Friledning, oisolerad".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Luftledning".
      RUN ntxt2_UI(ntxt) .  
      RUN ntxt2_UI(ntxt) .   
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 52
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 1 
         STORNATUPPKOPP.NATUPPLAGGID3 = 6  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 
         STORNATUPPKOPP.M-KM = 1000.
      ntxt = "Friledning, isolerad".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Luftledning BLL/BLX".
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 53
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 1 
         STORNATUPPKOPP.NATUPPLAGGID3 = 7  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
         STORNATUPPKOPP.M-KM = 1000.
      ntxt = "Hängkabelledning".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Luftledning".
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 54
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 1 
         STORNATUPPKOPP.NATUPPLAGGID3 = 8  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
         STORNATUPPKOPP.M-KM = 1000.
      ntxt = "Hängspiralkabelledning".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Luftledning Alus".
      RUN ntxt2_UI(ntxt) .     
       CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 55
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 1 
         STORNATUPPKOPP.NATUPPLAGGID3 = 35  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .      
      ntxt = "Annan ledning".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Luftledning".
      RUN ntxt2_UI(ntxt) .  
     
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 59
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 1 
         STORNATUPPKOPP.NATUPPLAGGID3 = 33  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .      
      ntxt = "Säkrings- och apparatlåda".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Luftledning".
      
      RUN ntxt2_UI(ntxt) .  
     
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 61
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 2 
         STORNATUPPKOPP.NATUPPLAGGID3 = 3  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
         STORNATUPPKOPP.M-KM = 1000.   
      ntxt = "Kraftkabel i mark".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Markledning".
       CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 62
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 2 
         STORNATUPPKOPP.NATUPPLAGGID3 = 5  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
         STORNATUPPKOPP.M-KM = 1000.   
      ntxt = "Kraftkabel i vatten".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Markledning".
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 68
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 2 
         STORNATUPPKOPP.NATUPPLAGGID3 = 9  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Avgrenings-/Kabelskåp".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Markledning".
      RUN ntxt2_UI(ntxt) .   
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 69
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 2 
         STORNATUPPKOPP.NATUPPLAGGID3 = 10  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .      
      ntxt = "Säkrings- och apparatlåda".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Markledning".
      RUN ntxt2_UI(ntxt) .
      RUN ntxt2_UI(ntxt) .
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 100
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 8 
         STORNATUPPKOPP.NATUPPLAGGID3 = 19  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Effektbrytare -inomhus".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Effektbrytare".
      RUN ntxt2_UI(ntxt) .
      
      CREATE STORNATUPPKOPP.
      ASSIGN
         STORNATUPPKOPP.TEXTKOMBID = 101
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 8 
         STORNATUPPKOPP.NATUPPLAGGID3 = 20  
         STORNATUPPKOPP.NATUPPLAGGID4 = 0 .
      ntxt = "Effektbrytare -utomhus".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Effektbrytare".
      RUN ntxt2_UI(ntxt) .  
       CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 102
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 9 
         STORNATUPPKOPP.NATUPPLAGGID3 = 21  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Frånskiljare -inomhus".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Frånskiljare".
      RUN ntxt2_UI(ntxt) . 
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 103
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 9 
         STORNATUPPKOPP.NATUPPLAGGID3 = 22  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Frånskiljare -utomhus".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Frånskiljare".
      RUN ntxt2_UI(ntxt) .   
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 104
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 12 
         STORNATUPPKOPP.NATUPPLAGGID3 = 26  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Lastfrånskiljare -inomhus ".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Lastfrånskiljare".
      RUN ntxt2_UI(ntxt) .
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 105
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 12 
         STORNATUPPKOPP.NATUPPLAGGID3 = 27  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Lastfrånskiljare -utomhus ".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Lastfrånskiljare".
      RUN ntxt2_UI(ntxt) .
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 106
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 12 
         STORNATUPPKOPP.NATUPPLAGGID3 = 28  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Lastfr.sk. m. säkr. -inomhus".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Lastfrånskiljare med säkring".
      RUN ntxt2_UI(ntxt) .
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 107
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 12 
         STORNATUPPKOPP.NATUPPLAGGID3 = 29  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Lastfr.sk. m. säkr. -utomhus".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Lastfrånskiljare med säkring".
      RUN ntxt2_UI(ntxt) .
      
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 115
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 11 
         STORNATUPPKOPP.NATUPPLAGGID3 = 24  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Kondensatorbatterier totalt".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Kondensatorbatterier".
      RUN ntxt2_UI(ntxt) .
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 120
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 1 
         STORNATUPPKOPP.NATUPPLAGGID3 = 2  
         STORNATUPPKOPP.NATUPPLAGGID4 = 1 .
      ntxt = "Effektbrytare".
      RUN ntxt1_UI(ntxt) .
      ntxt = "App. i luftledn. och stolpstn".
      RUN ntxt2_UI(ntxt) .
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 121
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 1 
         STORNATUPPKOPP.NATUPPLAGGID3 = 2  
         STORNATUPPKOPP.NATUPPLAGGID4   = 2 .
      ntxt = "Frånskiljare".
      RUN ntxt1_UI(ntxt) .
      ntxt = "App. i luftledn. och stolpstn".
      RUN ntxt2_UI(ntxt) .
      CREATE STORNATUPPKOPP. 
       ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 122
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 1 
         STORNATUPPKOPP.NATUPPLAGGID3 = 2  
         STORNATUPPKOPP.NATUPPLAGGID4   = 3 .
         
      ntxt = "Lastfrånskiljare".
      RUN ntxt1_UI(ntxt) .
      ntxt = "App. i luftledn. och stolpstn".
      RUN ntxt2_UI(ntxt) .
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 123
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 1 
         STORNATUPPKOPP.NATUPPLAGGID3 = 2  
         STORNATUPPKOPP.NATUPPLAGGID4   = 4 .
      ntxt = "Kondensatorbatteri, serie".
      RUN ntxt1_UI(ntxt) .
      ntxt = "App. i luftledn. och stolpstn".
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 124
         STORNATUPPKOPP.NATUPPLAGGID1 = 2  
         STORNATUPPKOPP.NATUPPLAGGID2 = 1 
         STORNATUPPKOPP.NATUPPLAGGID3 = 2  
         STORNATUPPKOPP.NATUPPLAGGID4   = 5 . 
      ntxt = "Kondensatorbatteri, shunt".
      RUN ntxt1_UI(ntxt) .
      ntxt = "App. i luftledn. och stolpstn".
      RUN ntxt2_UI(ntxt) .  
      
  /*ej giltiga*/
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 110
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 10 
         STORNATUPPKOPP.NATUPPLAGGID3 = 23  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "-olje med exp.kärl".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Krafttransformator".
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 110
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 10 
         STORNATUPPKOPP.NATUPPLAGGID3 = 30  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "-olje sluten".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Krafttransformator".
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 112
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 10 
         STORNATUPPKOPP.NATUPPLAGGID3 = 31  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "-torrisolerad, luft".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Krafttransformator".
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN
         STORNATUPPKOPP.TEXTKOMBID = 42
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 7 
         STORNATUPPKOPP.NATUPPLAGGID3 = 11  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Btg el stenstn. inomhusman".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Nätstation".
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 43
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 7 
         STORNATUPPKOPP.NATUPPLAGGID3 = 12  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Btg el stenstn. utomhusman".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Nätstation".
      
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 44
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 7 
         STORNATUPPKOPP.NATUPPLAGGID3 = 14  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Plåtstation".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Nätstation".
      
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 45
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 7 
         STORNATUPPKOPP.NATUPPLAGGID3 = 15  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Satellitstation".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Nätstation".
      
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 47
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 7 
         STORNATUPPKOPP.NATUPPLAGGID3 = 17  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Kapslad transformator".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Nätstation".
      
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN
         STORNATUPPKOPP.TEXTKOMBID = 48
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 7 
         STORNATUPPKOPP.NATUPPLAGGID3 = 18  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "Inhyst station".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Nätstation".
      
      RUN ntxt2_UI(ntxt) .     
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 49
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 7 
         STORNATUPPKOPP.NATUPPLAGGID3 = 34  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .      
      ntxt = "Annan stationstyp".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Nätstation".
      
       CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 46
         STORNATUPPKOPP.NATUPPLAGGID1 = 3  
         STORNATUPPKOPP.NATUPPLAGGID2 = 7 
         STORNATUPPKOPP.NATUPPLAGGID3 = 16  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
         
      ntxt = "Markstation".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Nätstation".
      RUN ntxt2_UI(ntxt) .  
      RUN ntxt2_UI(ntxt) .  
      CREATE STORNATUPPKOPP. 
      ASSIGN 
         STORNATUPPKOPP.TEXTKOMBID = 113
         STORNATUPPKOPP.NATUPPLAGGID1 = 4  
         STORNATUPPKOPP.NATUPPLAGGID2 = 10 
         STORNATUPPKOPP.NATUPPLAGGID3 = 32  
         STORNATUPPKOPP.NATUPPLAGGID4   = 0 .
      ntxt = "-torrisolerad, solid".
      RUN ntxt1_UI(ntxt) .
      ntxt = "Krafttransformator".
      
      RUN ntxt2_UI(ntxt) .  
      
   END.    
END PROCEDURE.                


