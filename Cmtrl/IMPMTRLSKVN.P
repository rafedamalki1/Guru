/*IMPMTRLSKVN.P INLÄSNING AV SEMIKOLONFIL FÖR IMPORT AV KONSTRUKTION*/       

DEFINE NEW SHARED VARIABLE quotervar AS CHARACTER FORMAT "X(256)" NO-UNDO.





DEFINE VARIABLE musz AS LOGICAL NO-UNDO.

DEFINE VARIABLE rad AS INTEGER NO-UNDO.
DEFINE VARIABLE prognamn AS CHARACTER FORMAT "X(20)" NO-UNDO.
DEFINE VARIABLE prognamndat AS CHARACTER FORMAT "X(20)" NO-UNDO.
DEFINE VARIABLE prognamnque AS CHARACTER FORMAT "X(20)" NO-UNDO.                
DEFINE VARIABLE words AS CHARACTER FORMAT "X(132)" NO-UNDO.
DEFINE VARIABLE kommando AS CHARACTER FORMAT "X(132)" NO-UNDO.
DEFINE VARIABLE kommandoprog AS CHARACTER FORMAT "X(20)" NO-UNDO.
DEFINE VARIABLE satsvar AS CHARACTER FORMAT "X(11)" NO-UNDO.
DEFINE VARIABLE enrvar AS CHARACTER FORMAT "X(11)" NO-UNDO.
DEFINE VARIABLE melvar AS INTEGER NO-UNDO.
DEFINE VARIABLE melvar2 AS INTEGER NO-UNDO.
DEFINE VARIABLE langd AS INTEGER NO-UNDO.
DEFINE VARIABLE pos1 AS INTEGER NO-UNDO. 
DEFINE VARIABLE svar AS LOGICAL NO-UNDO.
DEFINE VARIABLE var2 AS CHARACTER NO-UNDO.


DEFINE TEMP-TABLE tidin   
   FIELD ENR                AS CHARACTER 
   FIELD BENAMNING          AS CHARACTER 
   FIELD ENHET              AS CHARACTER
   FIELD BPRIS              AS CHARACTER
   FIELD NPRIS              AS CHARACTER
   FIELD MARK               AS CHARACTER
   INDEX ENR IS PRIMARY ENR.
DEFINE TEMP-TABLE felmex   
   FIELD ENR                AS CHARACTER 
   FIELD BENAMNING          AS CHARACTER 
   FIELD ENHET              AS CHARACTER
   FIELD BPRIS              AS DECIMAL
   FIELD NPRIS              AS DECIMAL
   INDEX ENR IS PRIMARY ENR.   

DEFINE TEMP-TABLE infil
   FIELD PROGNAMN AS CHARACTER FORMAT "X(78)" 
   INDEX PRO IS PRIMARY PROGNAMN.
DEFINE TEMP-TABLE intid
   FIELD TIN AS CHARACTER FORMAT "X(78)" .
   
DEFINE INPUT PARAMETER filnamn AS CHARACTER NO-UNDO.   
DEFINE INPUT PARAMETER leverant AS CHARACTER NO-UNDO.   
DEFINE INPUT PARAMETER svar5 AS LOGICAL NO-UNDO.
DEFINE INPUT PARAMETER mkat AS INTEGER NO-UNDO.
DEFINE OUTPUT PARAMETER TABLE FOR felmex.
DEFINE INPUT PARAMETER svar10 AS LOGICAL NO-UNDO.
DEFINE INPUT PARAMETER svar12 AS LOGICAL NO-UNDO.
{AMERICANEUROPEAN.I}
{muswait.i}      
   EMPTY TEMP-TABLE intid NO-ERROR. 
   EMPTY TEMP-TABLE tidin NO-ERROR.    
   EMPTY TEMP-TABLE felmex NO-ERROR. 

   INPUT FROM VALUE(filnamn) NO-ECHO.
   REPEAT:
      DO TRANSACTION: 
         CREATE tidin.
         ASSIGN.
         IMPORT DELIMITER ";" tidin   NO-ERROR.
      END.               
   END.
/*   DEFINE VARIABLE A AS INTEGER NO-UNDO.
   DEFINE VARIABLE B AS INTEGER NO-UNDO.
   FOR EACH tidin:
      A = A + 1.
   END.    
   FOR EACH tidin WHERE tidin.ENR = "":
      DELETE tidin.
   END.
   FOR EACH tidin:
      B = B + 1.
   END.  
   MESSAGE A  B
   VIEW-AS ALERT-BOX.*/
   /*FOR EACH tidin WHERE tidin.ENR = "ENR":
      DELETE tidin.      
   END.*/
   /*FOR EACH tidin USE-INDEX enr NO-LOCK:   
      MESSAGE tidin.enr tidin.npris VIEW-AS ALERT-BOX.
   END.*/
   RUN skapaenr_UI.

{EUROPEANAMERICAN.I}

PROCEDURE skapaenr_UI:         
   IF Guru.Konstanter:appcon THEN DO:                           
      RUN IMPMTRLSKVN2.P ON Guru.Konstanter:apphand TRANSACTION DISTINCT 
      (INPUT TABLE tidin, INPUT leverant,INPUT svar5,INPUT mkat,OUTPUT TABLE felmex, INPUT svar10, INPUT svar12).
   END.
   ELSE DO:
      RUN IMPMTRLSKVN2.P 
      (INPUT TABLE tidin, INPUT leverant,INPUT svar5,INPUT mkat,OUTPUT TABLE felmex, INPUT svar10, INPUT svar12).
   END.         
END PROCEDURE.   

                
