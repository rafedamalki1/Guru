/*XPLUFLYT.P**/
DEF VAR MUSZ AS LOGICAL.

FOR EACH AO NO-LOCK:
   IF AO.UTFORG NE "ELAVD" THEN NEXT.
   IF AO.AONR >= "060194" AND AO.AONR <= "060240" THEN musz = musz.
   ELSE NEXT.
   FIND FIRST PROJKTO WHERE projkto.PROJKOD = ao.PROJKOD AND
   projkto.AOKOD = ao.AOKOD NO-LOCK NO-ERROR.
   IF NOT AVAILABLE PROJKTO THEN DO:
      MESSAGE AO.AONR "PROJKOD SAKNAS" VIEW-AS ALERT-BOX.
   END. 
   ELSE DO:
      FIND FIRST KONTO WHERE konto.KONTOKOD = projkto.KONTOKOD
      NO-LOCK NO-ERROR.
      IF NOT AVAILABLE KONTO THEN DO:
         MESSAGE AO.AONR projkto.KONTOKOD "KONTO SAKNAS" VIEW-AS ALERT-BOX.
      END.
      ELSE DO TRANSACTION:         
         FIND FIRST AONRKONTKOD WHERE AONRKONTKOD.AONR = ao.AONR NO-LOCK NO-ERROR.
         IF NOT AVAILABLE AONRKONTKOD THEN DO:
            CREATE AONRKONTKOD.
            ASSIGN
            AONRKONTKOD.AONR = AO.AONR
            AONRKONTKOD.K1 = konto.KONTODEL[1]
            AONRKONTKOD.K2 = konto.KONTODEL[2]
            AONRKONTKOD.K3 = konto.KONTODEL[3]
            AONRKONTKOD.K4 = konto.KONTODEL[4].
         END.
         FIND FIRST AONRTAB WHERE AONRTAB.AONR = AO.AONR NO-LOCK NO-ERROR.
         IF NOT AVAILABLE AONRTAB THEN DO:
            CREATE AONRTAB.
            ASSIGN 
            AONRTAB.AONR = AO.AONR
            AONRTAB.ORT = AO.RUBRIK
            AONRTAB.OMRADE = AO.UTFORG
            AONRTAB.BESTID = AO.UTFORG.
         END.
      END.    
   END.
END.                 
