/*NYSINGCON.P*/
DEFINE INPUT PARAMETER arbdbb AS CHARACTER NO-UNDO.
DEFINE SHARED TEMP-TABLE tabnamn NO-UNDO
   FIELD NAMN AS CHARACTER
   INDEX NAMN IS PRIMARY NAMN.
DEFINE VARIABLE qh AS HANDLE NO-UNDO.
DEFINE VARIABLE bh AS HANDLE NO-UNDO.
DEFINE VARIABLE falth AS HANDLE NO-UNDO.
DEFINE VARIABLE tabvar AS CHARACTER NO-UNDO.
DEFINE VARIABLE kommando AS CHARACTER NO-UNDO.
tabvar = arbdbb + "._file".
kommando = "FOR EACH " + tabvar + " WHERE " + tabvar + "._FROZEN = FALSE NO-LOCK".
CREATE BUFFER bh FOR TABLE tabvar.
CREATE QUERY qh.
qh:SET-BUFFERS(bh).
qh:QUERY-PREPARE(kommando).   
qh:QUERY-OPEN().
qh:GET-FIRST(NO-LOCK).
DO WHILE bh:AVAILABLE:
   falth = bh:BUFFER-FIELD("_FILE-NAME").
   CREATE tabnamn.
   ASSIGN
   tabnamn.NAMN = falth:BUFFER-VALUE.
   qh:GET-NEXT(NO-LOCK).        
END.
RETURN.

