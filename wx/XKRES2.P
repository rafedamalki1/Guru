DEFINE TEMP-TABLE persres 
   FIELD PERSONALKOD LIKE TIDREGITAB.PERSONALKOD
   FIELD tidres AS DECIMAL   
   FIELD sumares AS DECIMAL   
   FIELD sumdagres AS DECIMAL
   INDEX RES PERSONALKOD.   
DEFINE VARIABLE ressumar AS DECIMAL NO-UNDO.        
DEFINE VARIABLE ressumdag AS DECIMAL NO-UNDO. 
DEFINE VARIABLE restidreg AS DECIMAL NO-UNDO.
DEFINE QUERY tq FOR TIDREGITAB.
DEFINE QUERY saq FOR SUMTID.    
DEFINE QUERY sdq FOR SUMTIDDAG.
OUTPUT TO tidres.
OPEN QUERY tq FOR EACH TIDREGITAB WHERE TIDREGITAB.AONR = "630001" AND TIDREGITAB.PERSONALKOD = "35109" AND
TIDREGITAB.DELNR = 0 AND TIDREGITAB.PRISTYP = "RESTID..." USE-INDEX AONR NO-LOCK. 
GET FIRST tq.
DO WHILE AVAILABLE(TIDREGITAB):
   IF YEAR(TIDREGITAB.DATUM) = 1997 THEN DO:
   IF TIDREGITAB.VECKOKORD NE "" THEN DO:
      DISPLAY TIDREGITAB.DATUM TIDREGITAB.TOTALT TIDREGITAB.VECKOKORD WITH FRAME CC2 DOWN.
      DOWN 1 WITH FRAME CC2.
   END.                                     
   END.
   GET NEXT tq.
END.   
OUTPUT close.
OUTPUT TO dagres.
OPEN QUERY sdq FOR EACH SUMTIDDAG WHERE SUMTIDDAG.AONR = "630001" AND SUMTIDDAG.PERSONALKOD = "35109" AND 
SUMTIDDAG.DELNR = 0 AND SUMTIDDAG.PRISTYP = "RESTID..." USE-INDEX AONR NO-LOCK. 
GET FIRST sdq.
DO WHILE AVAILABLE(SUMTIDDAG):
   IF YEAR(SUMTIDDAG.DATUM) = 1997 THEN DO:
   IF SUMTIDDAG.VECKOKORD NE "" THEN DO: 
      DISPLAY "1" SUMTIDDAG.AUTODATUM SUMTIDDAG.DATUM SUMTIDDAG.TIMMAR SUMTIDDAG.VECKOKORD WITH FRAME CC3 DOWN.
      DOWN 1 WITH FRAME CC3.
   END.
   END. 
   GET NEXT sdq.
END.        
OUTPUT close. 
OUTPUT TO arres.
OPEN QUERY saq FOR EACH SUMTID WHERE SUMTID.AONR = "630001" AND SUMTID.PERSONALKOD = "35109" AND 
SUMTID.DELNR = 0 AND SUMTID.PRISTYP = "RESTID..." USE-INDEX AONR NO-LOCK. 
GET FIRST saq.
DO WHILE AVAILABLE(SUMTID):  
   IF YEAR(SUMTID.DATUM) = 1997 THEN DO:
   IF SUMTID.VECKOKORD NE "" THEN DO:
      DISPLAY SUMTID.AUTODATUM SUMTID.DATUM SUMTID.TIMMAR SUMTID.VECKOKORD WITH FRAME CC4 DOWN.
      DOWN 1 WITH FRAME CC4.
   END. 
   END.
   GET NEXT saq.
END.    
OUTPUT close.    
