/*WC-CHECK.P*/
{VALDBTEMP.I} 
/*Anders Olsson Elpool i Umeå AB  22 nov 2022 12:33:10 
om runvar retuneras valdbtemp.GFORETAG  så kommer VALDBGURU.W REPOSITIONERA TILL DEN POSTEN 
OBS! FLEX OCH DEPÅ DATORERNA SKA ABSOLUT INTE RETUNERA  GFORETAG!!
*/
DEFINE INPUT PARAMETER FILL-IN-STARTIN AS CHARACTER NO-UNDO.
DEFINE OUTPUT PARAMETER runvar AS CHARACTER NO-UNDO.
DEFINE OUTPUT PARAMETER TABLE FOR valdbtemp.
DEFINE VARIABLE laddserver    AS CHARACTER NO-UNDO.
DEFINE VARIABLE FILL-IN-START AS CHARACTER NO-UNDO.
/*
ONE-DB
WWW2
valdbtemp.DBNAMN = "ETSAONE"  168
valdbtemp.DBNAMN = "WIGAONE"  7
EGNA
valdbtemp.DBNAMN = "GRELONE" 67
valdbtemp.DBNAMN = "ELKO"   7
valdbtemp.DBNAMN = "ONEWWW"

ÄGDA
valdbtemp.DBNAMN = "GETBO"
valdbtemp.DBNAMN = "REJLONE"

*/
FILL-IN-STARTIN = TRIM(FILL-IN-STARTIN).

IF INDEX(FILL-IN-STARTIN,"WTID") NE 0 THEN DO:
  
   FILL-IN-START = SUBSTRING(FILL-IN-STARTIN,1, INDEX(FILL-IN-STARTIN,"WTID") - 1).
   laddserver = "WTID".
END.   
ELSE FILL-IN-START = FILL-IN-STARTIN.

IF FILL-IN-START = "ELPA" THEN DO:
   runvar = FILL-IN-START.
   {VALDBALL.I} 
   {VALDBELPADPLUS.I}
   {VALDBSEKGS.I}
   
END.
ELSE IF FILL-IN-START = "BERGSUPPORT" THEN DO:
   /*GURUSUPPORT*/
   runvar = FILL-IN-START.
   /*FORSSERVER*/
   {VALDBINFRAOMEXOMSERVER.I}
   
   
   /*EGENBERGET*/
   {VALDBEGENBERGET.I}
   
  /*WWW2BERGET*/ 
   {VALDBWWW2BERGET.I}
   
END.      
ELSE IF FILL-IN-START = "FELPA" THEN DO:
   runvar = FILL-IN-START.
   CREATE valdbtemp.
      ASSIGN
      valdbtemp.WWWSTART =  {WWWGURU11.I}
      valdbtemp.WWWSTART10 = {WWWGURU10.I}
      valdbtemp.FORETAG = "ELPA"
      valdbtemp.GFORETAG = "fELPA"
      valdbtemp.DBNAMN = "flextid"
      valdbtemp.ORDNING = 2      
      valdbtemp.DBPLATS = "c:\DELAD\PRO11S\DB\"
      valdbtemp.DBCACHE = ""  
      valdbtemp.VALDB = "Elpool Flextid".
      valdbtemp.WWWFTP = FALSE.    
      valdbtemp.APPCON = {App11elpool.i}.
      valdbtemp.DBCON = "-db flextid -S 2551 -H " + {pc122db.I} + " -N TCP".
END.  
ELSE IF FILL-IN-START = "SUND" OR FILL-IN-START = "ASUND" OR FILL-IN-START = "SUNDEN" THEN DO:
   runvar = FILL-IN-START.
   {VALDBSUND9.I}
   
END.
ELSE IF FILL-IN-START = "FSUND" THEN DO:
   runvar = FILL-IN-START.
   {VALDBSUND9.I} /*flexsund*/
END.  

ELSE IF FILL-IN-START = "SUNDNAT" THEN DO:
   runvar = FILL-IN-START.
    {VALDBSUNDNAT.I} /*ELNÄT*/
END. 

ELSE IF FILL-IN-START = "FSNAT" THEN DO:
   /* VALDBMAING.I i VALDBGURU.W styr att man kör flexsund_ui SÄTTER appfel start MULTISTART STARTA FLEXTID.W*/
   runvar = FILL-IN-START.
   {VALDBSUNDNAT.I} /*flexsNAT*/
END.  
ELSE IF FILL-IN-START = "SELNDEPA" THEN DO:
   /* VALDBMAING.I i VALDBGURU.W styr att man kör flexsund_ui SÄTTER appfel start MULTISTART STARTA depå*/
   runvar = FILL-IN-START.
   {VALDBSUNDNAT.I} /*depåNAT*/
END. 
 
   
ELSE IF FILL-IN-START = "MISV" OR FILL-IN-START = "AMISV" THEN DO:
   runvar = FILL-IN-START.
   {VALDBMISV.I} /*MITT */
END. 
ELSE IF FILL-IN-START = "FMISV" THEN DO:
   runvar = FILL-IN-START.
   {VALDBMISV.I} /*flexmitt*/
   
END.   
  
ELSE IF FILL-IN-START = "UMEA" THEN DO:
   runvar = FILL-IN-START.
   {VALDBUMEA.I}
END.  
ELSE IF FILL-IN-START = "UMBR" THEN DO:
   runvar = FILL-IN-START.
   {VALDBUMBR.I}
   {VALDBUMEA.I}
END.   
  
ELSE IF FILL-IN-START = "VATTEN" OR FILL-IN-START = "vattenfall" THEN DO:
   runvar = FILL-IN-START.
    {VALDBVESABPRO.I}
   {VALDBVESABUTBIPRO.I}
    runvar = "VSABPRO".   
END. 

ELSE IF FILL-IN-START = "VATTENDP" THEN DO:
   runvar = FILL-IN-START.
  /* {VALDBVESAB.I}*/
   {VALDBVESABPRO.I}
   {VALDBVESABDP.I}
   runvar = "VSABDP".    
END.

ELSE IF FILL-IN-START = "LULE" THEN DO:
  runvar = FILL-IN-START.
   {VALDBLUL.I}
END.  
ELSE IF FILL-IN-START = "TECT" THEN DO:
   runvar = FILL-IN-START.
   {VALDBTECT.I}
  /* {VALDBELPC.I*/
  /* {VALDBSWECO.I}*/
  
END.   
ELSE IF FILL-IN-START = "LAPP" THEN DO:
   runvar = FILL-IN-START.
   {VALDBLAPP.I}
END.   

   
ELSE IF FILL-IN-START = "EonES" OR FILL-IN-START = "ONENO" THEN DO:
   runvar = FILL-IN-START.
   {VALDBONE.I} 
   {VALDBC4EN.I}
   {VALDBONEWWW.I}
END.   
ELSE IF FILL-IN-START = "KALM" THEN DO:
   runvar = FILL-IN-START.
   {VALDBKALM.I}
END.
/*
ELSE IF FILL-IN-START = "ELTEL" THEN DO:
   runvar = FILL-IN-START.
   {VALDBELTEL.I}
  
END.
*/   
ELSE IF FILL-IN-START = "FORS" OR FILL-IN-START = "INFRA" THEN DO:
   runvar = FILL-IN-START.
   {VALDBINFRAOMEXOMSERVER.I}
   
END.   
ELSE IF FILL-IN-START = "BODEN" THEN DO:
   runvar = FILL-IN-START.
   {VALDBBODEN.I}
END.   
ELSE IF FILL-IN-START = "REJLERS" THEN DO:
   runvar = FILL-IN-START.
   {VALDBREJL.I}
   /*Anders Olsson Elpool i Umeå AB  13 sep 2022 11:56:08 
   SORTERINGS SPECIAL 
   
   valdbtemp.VALDB = " " + valdbtemp.VALDB.
   */
  /* {VALDBINFRAOMEXOM.I}*/
   {VALDBKRIN.I}
   {VALDBVESABPRO.I}
    {VALDBONEWWW.I}  
    runvar = "REJI".
END.   
ELSE IF FILL-IN-START = "ELKB" THEN DO:
   runvar = FILL-IN-START.
    {VALDBELKB.I}
    {VALDBKRIN.I}
    {VALDBONEWWW.I}
END.   
ELSE IF FILL-IN-START = "SKOGSK" THEN DO:
   runvar = FILL-IN-START.
   {VALDBSKOGSK.I}
   {VALDBKEKR.I}

END.  
ELSE IF FILL-IN-START = "JSBF" THEN DO:
   runvar = FILL-IN-START.
   {VALDBJSBF.I}
END.  

ELSE IF FILL-IN-START = "ATSK" THEN DO:
   runvar = FILL-IN-START. 
   {VALDBATS.I}
END.   
  
ELSE IF FILL-IN-START = "SWEO" OR FILL-IN-START = "PICAB" THEN DO:
   runvar = FILL-IN-START.
   {VALDBSWECO.I}
   {VALDBPICA.I}
   {VALDBINFRAOMEXOM.I}
   {VALDBONEWWW.I}
   {VALDBBODEN.I}
END.   
ELSE IF FILL-IN-START = "LIMO" THEN DO:
   runvar = FILL-IN-START.
   {VALDBLIMO.I}
END.   
   
ELSE IF FILL-IN-START = "SSEL" THEN DO:
   runvar = FILL-IN-START.
   {VALDBSSEL.I}
   {VALDBKRIN.I}
   /*{VALDBINFRAOMEXOM.I}*/
   {VALDBONEWWW.I}
END.
ELSE IF FILL-IN-START = "LAKL" THEN DO:
   runvar = FILL-IN-START.
   {VALDBLAKL.I}
   {VALDBVSWWW.I}
END.  
ELSE IF FILL-IN-START = "ÅFCON" THEN DO:
   runvar = FILL-IN-START.
   {VALDBAFCO.I}
   {VALDBKRIN.I}
   {VALDBONEWWW.I}
   {VALDBVESABPRO.I}
   {VALDBINFRAOMEXOM.I}
   runvar = "AFCO".
   
END.
  
ELSE IF FILL-IN-START = "OXEL" THEN DO:
   runvar = FILL-IN-START.
   {VALDBOXEL.I} 
END.   
ELSE IF FILL-IN-START = "ESKOG" THEN DO:
   runvar = FILL-IN-START.
   {VALDBESKOG.I} 
END.   
ELSE IF FILL-IN-START = "OPPU" THEN DO:
   runvar = FILL-IN-START.
   {VALDBOPPU.I} 
END.   
ELSE IF FILL-IN-START = "NSKOG" THEN DO:
   runvar = FILL-IN-START.
   {VALDBNSKOG.I}
END.
ELSE IF FILL-IN-START = "ELPC" THEN DO:
   runvar = FILL-IN-START.
   {VALDBELPC.I}
  
END.   

ELSE IF FILL-IN-START = "HJEL" THEN DO:
   runvar = FILL-IN-START.
   {VALDBHJORT.I}
END.  
  
ELSE IF FILL-IN-START = "KEWAB" OR FILL-IN-START = "Axeda" THEN DO:
   runvar = FILL-IN-START.
   {VALDBKEWA.I}
END.


ELSE IF FILL-IN-START = "DUTAB" THEN DO:
   runvar = FILL-IN-START.
   {VALDBDUTA.I}
END.   

ELSE IF FILL-IN-START = "POLA" THEN DO:
   runvar = FILL-IN-START.
   {VALDBPOLA.I}
END.   

ELSE IF FILL-IN-START = "SEKG" THEN DO:
   /*KÖR PASOE*/
   runvar = FILL-IN-START.
    {VALDBSEKG.I}
END.
ELSE IF FILL-IN-START = "SEKGS" THEN DO:
   runvar = FILL-IN-START.
   /*KÖR APPSINGEL*/
    {VALDBSEKGS.I}
END.   
   
ELSE IF FILL-IN-START = "SKEK" THEN DO:
   runvar = FILL-IN-START.
   {VALDBSKEK.I} 
END.   

ELSE IF FILL-IN-START = "KRIN" THEN DO:
   runvar = FILL-IN-START.
   {VALDBKRIN.I}
   {VALDBKRINM.I}
END. 

ELSE IF FILL-IN-START = "WIGA" THEN DO:
   runvar = FILL-IN-START.
  {VALDBWIGA.I}
 /* {VALDBINFRAOMEXOM.I}*/
  {VALDBVESABPRO.I}
  {VALDBONEWWW.I}
END. 
ELSE IF FILL-IN-START = "WSP" THEN DO:
   runvar = FILL-IN-START.
  {VALDBWSP.I}
  {VALDBONEWWW.I}
  {VALDBVSWWW.I}
  {VALDBINFRAOMEXOM.I}
END.

ELSE IF FILL-IN-START = "KEKR" THEN DO:
   runvar = FILL-IN-START.
  {VALDBKEKR.I}
  {VALDBSKOGSK.I}
END.
ELSE IF FILL-IN-START = "POWE" THEN DO:
   runvar = FILL-IN-START.
   {VALDBPOWE.I}
   {VALDBAFCO.I}
   {VALDBKEWA.I}

END. 
ELSE IF FILL-IN-START = "ENKA" THEN DO:
   runvar = FILL-IN-START.
  {VALDBENKAB.I}
END.

ELSE IF FILL-IN-START = "AKEA" THEN DO:
   runvar = FILL-IN-START.
  {VALDBAKEA.I}
END.

ELSE IF FILL-IN-START = "POFO" THEN DO:
   runvar = FILL-IN-START.
   {VALDBPOFO.I}
   
END.
ELSE IF FILL-IN-START = "ROJO" THEN DO:
   runvar = FILL-IN-START.
   {VALDBROJO.I}
   
END.
ELSE IF FILL-IN-START = "VSWWW" THEN DO:
   runvar = FILL-IN-START.
   {VALDBVSWWW.I}
END.

ELSE IF FILL-IN-START = "SVEA" THEN DO:
   runvar = FILL-IN-START.
  {VALDBSVEA.I}
  {VALDBONEWWW.I}
  {VALDBKRIN.I}
END.

ELSE IF FILL-IN-START = "PC2U" THEN DO:
  runvar = FILL-IN-START.
  {VALDBPC2U.I}
  {VALDBVSWWW.I}
END.
ELSE IF FILL-IN-START = "C4EN" THEN DO:
  runvar = FILL-IN-START.
  {VALDBC4EN.I}
END.
ELSE IF FILL-IN-START = "GULL" THEN DO:
  runvar = FILL-IN-START.
  {VALDBGULL.I}
  {VALDBKEWA.I}
END.

ELSE IF FILL-IN-START = "SVAR" THEN DO:
  runvar = FILL-IN-START.
  {VALDBSVAR.I}
END.
ELSE IF FILL-IN-START = "ZVEN" THEN DO:
  runvar = FILL-IN-START.
  {VALDBZVENZA.I}
END.
ELSE IF FILL-IN-START = "SKYN" THEN DO:
  runvar = FILL-IN-START.
  {VALDBSKYN.I}
END. 
/*
ELSE IF FILL-IN-START = "VINN" THEN DO:
  runvar = FILL-IN-START.
  {VALDBVINNEN.I}
END. 
*/
ELSE IF FILL-IN-START = "SKANT" THEN DO:
  runvar = FILL-IN-START.
  {VALDBSkantr.I}
END.
 
ELSE IF FILL-IN-START = "SVKK" THEN DO:
  runvar = FILL-IN-START.
  {VALDBSVKK.I}
  {VALDBKEWA.I}
END.



ELSE IF FILL-IN-START = "KRINUNI" THEN DO:
   runvar = FILL-IN-START.
   {VALDBGURUUNI.I}
   {VALDBKRIN.I}
   runvar = "KRIN".
END.

ELSE IF FILL-IN-START = "GURUUTIB" THEN DO:
   runvar = FILL-IN-START.
   {VALDBUTBIWWW.I}
END. 

ELSE IF FILL-IN-START = "GURUUNI" THEN DO:
   runvar = FILL-IN-START.
   {VALDBGURUUNI.I}
END.

IF laddserver = "wtid" THEN DO:
   
   CREATE valdbtemp.
   ASSIGN
   valdbtemp.FORETAG = "ELPA"
   valdbtemp.GFORETAG = "INGEN"
   valdbtemp.DBNAMN = ""
   valdbtemp.ORDNING = 99      
   
   valdbtemp.DBCON = ""
   valdbtemp.DBPLATS = ""
   valdbtemp.DBCACHE = ""  
   valdbtemp.APPCON = ""
   valdbtemp.VALDB = "LADDA WTID".
   valdbtemp.WWWFTP = FALSE.
   /*
   CREATE valdbtemp.
   ASSIGN
   valdbtemp.FORETAG = "ELPA"
   valdbtemp.GFORETAG = "ALLADB"
   valdbtemp.DBNAMN = ""
   valdbtemp.ORDNING = 99      
   
   valdbtemp.DBCON = ""
   valdbtemp.DBPLATS = ""
   valdbtemp.DBCACHE = ""  
   valdbtemp.APPCON = ""
   valdbtemp.VALDB = "Alla anslutningar".
   valdbtemp.WWWFTP = FALSE.
   */
 /*
   CREATE valdbtemp.
   ASSIGN
   valdbtemp.FORETAG = "ELPA"
   valdbtemp.GFORETAG = "WWW2"
   valdbtemp.DBNAMN = ""
   valdbtemp.ORDNING = 99      
   
   valdbtemp.DBCON = ""
   valdbtemp.DBPLATS = ""
   valdbtemp.DBCACHE = ""  
   valdbtemp.VALDB = "USERS WWW2.GURUONWEB".
   valdbtemp.WWWFTP = FALSE.
   valdbtemp.APPCON = {APPWWW2.i}.
   CREATE valdbtemp.
   ASSIGN
   valdbtemp.FORETAG = "ELPA"
   valdbtemp.GFORETAG = "EGNA"
   valdbtemp.DBNAMN = ""
   valdbtemp.ORDNING = 99      
   
   valdbtemp.DBCON = ""
   valdbtemp.DBPLATS = ""
   valdbtemp.DBCACHE = ""  
   valdbtemp.VALDB = "USERS EGNA.GURUONWEB".
   valdbtemp.WWWFTP = FALSE.  
   valdbtemp.APPCON = {AppEgna.i}. 
   */        
END. 
RETURN.
/*
ELSE IF FILL-IN-START = "KRAF" THEN DO:
   /* i stockholm*/
   runvar = FILL-IN-START.
   {VALDBKRAF.I}
END.
*/
/*
ELSE IF FILL-IN-START = "VTGE" THEN DO:
  runvar = FILL-IN-START.
  {VALDBVTGE.I}
  
END.
*/
 /*
IF FILL-IN-START = "alte" THEN DO:
 
   runvar = FILL-IN-START. 
   {VALDBALTE.I}
   {VALDBAFCO.I}
END.   
  
ELSE 
*/
 /*
ELSE IF FILL-IN-START = "NELK" THEN DO:
   runvar = FILL-IN-START.
   {VALDBNELK.I}
   {VALDBVSWWW.I}
END.
*/
 /*
 ELSE IF FILL-IN-START = "TECMAR" THEN DO:
   runvar = FILL-IN-START.
  {VALDBTECMAR.I}
  
END.
ELSE IF FILL-IN-START = "EFLA" THEN DO:
   runvar = FILL-IN-START.
  {VALDBEFLA.I}
END.
*/
/*
ELSE IF FILL-IN-START = "SWEOS" OR FILL-IN-START = "PICAB" THEN DO:
   runvar = FILL-IN-START.
   {VALDBSWECOS.I}
   
END.
*/ 

/*
ELSE IF FILL-IN-START = "PENO" THEN DO:
   runvar = FILL-IN-START.
  {VALDBPENO.I}
END.
*/
