DEFINE NEW SHARED VARIABLE globforetag LIKE FORETAG.FORETAG NO-UNDO.
DEFINE NEW SHARED VARIABLE vkdatum AS DATE NO-UNDO.
DEFINE NEW SHARED VARIABLE gvisatidpermanad AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE man AS INTEGER FORMAT "99" NO-UNDO.
DEFINE NEW SHARED VARIABLE globanv LIKE ANVANDARE.ANVANDARE NO-UNDO.
 
DEFINE  VARIABLE appcon AS LOGICAL NO-UNDO.
DEFINE VARIABLE manval AS LOGICAL NO-UNDO.
DEFINE VARIABLE samvar AS CHARACTER NO-UNDO.
DEFINE VARIABLE prognamn2 AS CHARACTER  NO-UNDO.
DEFINE VARIABLE prognamn3 AS CHARACTER  NO-UNDO.
DEFINE NEW SHARED TEMP-TABLE tidut
   FIELD UT AS CHARACTER FORMAT "X(132)".
FIND FIRST FORETAG USE-INDEX FORETAG NO-LOCK NO-ERROR.
globforetag = FORETAG.FORETAG.
CREATE ALIAS RT9 FOR DATABASE VALUE(LDBNAME(1)) NO-ERROR.
{CONAPP.I}




find first foretag no-error.
IF globforetag = "SUND" THEN samvar = "D:\DELAD\SERVER\PRO10S\SULESAMM.TXT".
IF globforetag = "SNAT" THEN samvar = "D:\DELAD\SERVER\PRO10S\SNATLESAMM.TXT".
IF globforetag  = "SUND" OR globforetag  = "SNAT" THEN DO:      
   IF Guru.Konstanter:appcon THEN DO:
      RUN OBEORDLIST.P ON Guru.Konstanter:apphand TRANSACTION DISTINCT (INPUT samvar).
      RUN VECKOVFLEX.P ON Guru.Konstanter:apphand TRANSACTION DISTINCT (INPUT samvar).
      IF globforetag = "SUND" THEN DO:
         RUN LAKINTYGSU.P ON Guru.Konstanter:apphand TRANSACTION DISTINCT (INPUT samvar).
      END.   
   END.
END.
