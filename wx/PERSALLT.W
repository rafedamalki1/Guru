&ANALYZE-SUSPEND _VERSION-NUMBER UIB_v9r12 GUI
&ANALYZE-RESUME
/* Connected Databases 
          temp-db          PROGRESS
*/
&Scoped-define WINDOW-NAME CURRENT-WINDOW
&Scoped-define FRAME-NAME Dialog-Frame





&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CUSTOM _DEFINITIONS Dialog-Frame 
/*------------------------------------------------------------------------

  File: 

  Description: 

  Input Parameters:
      <none>

  Output Parameters:
      <none>

  Author: 

  Created: 
------------------------------------------------------------------------*/
/*          This .W file was created with the Progress AppBuilder.       */
/*----------------------------------------------------------------------*/

/* ***************************  Definitions  ************************** */

/* Parameters Definitions ---                                           */
DEFINE INPUT PARAMETER varifran AS INTEGER NO-UNDO.
DEFINE INPUT-OUTPUT PARAMETER pkod AS CHARACTER NO-UNDO.
/* Local Variable Definitions ---                                       */
/* varifran = 0 endast puppgifter
   varifran = 1 ny pers
   varifran = 2 ändra*/ 

{ALLDEF.I}
&Scoped-define NEW 
&Scoped-define SHARED SHARED
{GLOBVAR2DEL1.I}
{SOKDEF.I}
{PHMT.I}
{PHMTA.I}
/*{EGENBEN.I}*/
{UPPGHMT.I} 
{OMRTEMPW.I}                 
DEFINE SHARED VARIABLE musz AS LOGICAL NO-UNDO.
DEFINE VARIABLE status-ok AS LOGICAL NO-UNDO.
DEFINE VARIABLE lopkollk AS LOGICAL EXTENT 10 NO-UNDO.
DEFINE VARIABLE FILL-IN-FAVTAL AS CHARACTER NO-UNDO.
DEFINE VARIABLE persnr AS INTEGER EXTENT 10 FORMAT "99" NO-UNDO.
DEFINE VARIABLE varsechema AS INTEGER NO-UNDO.
DEFINE VARIABLE tal1 AS INTEGER NO-UNDO.
DEFINE VARIABLE tal2 AS INTEGER NO-UNDO.
DEFINE VARIABLE ksiffran AS INTEGER NO-UNDO.
DEFINE VARIABLE ansvgamla AS CHARACTER NO-UNDO.
DEFINE VARIABLE tidggamla AS CHARACTER NO-UNDO.
DEFINE VARIABLE avkfaktor AS DECIMAL NO-UNDO.
DEFINE VARIABLE sefaktor AS DECIMAL NO-UNDO.
DEFINE VARIABLE asfaktapph AS HANDLE NO-UNDO.                     /**/
DEFINE VARIABLE dispens AS LOGICAL NO-UNDO.
DEFINE VARIABLE dmandatum AS DATE  NO-UNDO.
DEFINE VARIABLE dmangodk AS CHARACTER NO-UNDO.
DEFINE VARIABLE dardatum AS DATE  NO-UNDO.
DEFINE VARIABLE dargodk AS CHARACTER NO-UNDO.
DEFINE VARIABLE d48datum AS DATE  NO-UNDO.
DEFINE VARIABLE d48godk AS CHARACTER NO-UNDO.   

DEFINE VARIABLE dispensm AS LOGICAL NO-UNDO.
DEFINE VARIABLE dispens48 AS LOGICAL NO-UNDO.
DEFINE VARIABLE lakdispens AS LOGICAL NO-UNDO.
DEFINE VARIABLE lonvaxatk AS LOGICAL NO-UNDO.
DEFINE VARIABLE avarfor AS INTEGER NO-UNDO.
DEFINE VARIABLE spafr AS LOGICAL NO-UNDO.

DEFINE VARIABLE ftro AS LOGICAL NO-UNDO.
DEFINE VARIABLE foremaxarbkort AS DECIMAL NO-UNDO.
DEFINE VARIABLE spomr AS CHARACTER NO-UNDO.
DEFINE VARIABLE judbyt AS LOGICAL NO-UNDO.
DEFINE VARIABLE finnstid AS LOGICAL NO-UNDO.
DEFINE TEMP-TABLE valperskolltemp NO-UNDO LIKE valperstemp.
 DEFINE TEMP-TABLE rgrtemp NO-UNDO
   FIELD RGR AS CHARACTER
   FIELD ORDNING AS INTEGER
   INDEX ORDNING ORDNING.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-PREPROCESSOR-BLOCK 

/* ********************  Preprocessor Definitions  ******************** */

&Scoped-define PROCEDURE-TYPE Dialog-Box
&Scoped-define DB-AWARE no

/* Name of designated FRAME-NAME and/or first browse and/or first query */
&Scoped-define FRAME-NAME Dialog-Frame
&Scoped-define BROWSE-NAME BRW_GODK

/* Internal Tables (found by Frame, Query & Browse Queries)             */
&Scoped-define INTERNAL-TABLES godkannartemp

/* Definitions for BROWSE BRW_GODK                                      */
&Scoped-define FIELDS-IN-QUERY-BRW_GODK godkannartemp.PERSONALKOD ~
godkannartemp.FORNAMN godkannartemp.EFTERNAMN 
&Scoped-define ENABLED-FIELDS-IN-QUERY-BRW_GODK godkannartemp.PERSONALKOD 
&Scoped-define ENABLED-TABLES-IN-QUERY-BRW_GODK godkannartemp
&Scoped-define FIRST-ENABLED-TABLE-IN-QUERY-BRW_GODK godkannartemp
&Scoped-define QUERY-STRING-BRW_GODK FOR EACH godkannartemp NO-LOCK
&Scoped-define OPEN-QUERY-BRW_GODK OPEN QUERY BRW_GODK FOR EACH godkannartemp NO-LOCK.
&Scoped-define TABLES-IN-QUERY-BRW_GODK godkannartemp
&Scoped-define FIRST-TABLE-IN-QUERY-BRW_GODK godkannartemp


/* Definitions for DIALOG-BOX Dialog-Frame                              */

/* Standard List Definitions                                            */
&Scoped-Define ENABLED-OBJECTS FILL-IN-DISPELAK FILL-IN-DISPENS ~
FILL-IN_PERSONALKOD FILL-IN_ANSTNR FILL-IN_PERSONNUMMER FILL-IN_FORNAMN ~
FILL-IN_EFTERNAMN CMB_OMR RAD_PERS CMB_VECKO FILL-IN_GATUADRESS ~
FILL-IN_TIDSGODK FILL-IN_AKTIV BRW_GODK CMB_BEF2 FILL-IN-MAN FILL-IN-TIS ~
FILL-IN-ONS FILL-IN-TOR FILL-IN-FRE FILL-IN-LOR FILL-IN-SON FILL-IN-TOT ~
CMB_BEF FILL-IN_BOXEN CMB_ORGCHEF CMB_OVERUT FILL-IN-DSCH1 FILL-IN-DSCH2 ~
FILL-IN-DSCH3 FILL-IN-DSCH4 FILL-IN-DSCH5 FILL-IN-DSCH6 FILL-IN-DSCH7 ~
FILL-IN-TOTV CMB_ANST FILL-IN_POSTNUMMER FILL-IN_POSTADRESS FILL-IN-BORJ1 ~
FILL-IN-BORJ2 FILL-IN-BORJ3 FILL-IN-BORJ4 FILL-IN-BORJ5 FILL-IN-BORJ6 ~
FILL-IN-BORJ7 FILL-IN_TELEFON FILL-IN_MOBILTEL FILL-IN_EPOST ~
FILL-IN_PERSONSOK FILL-IN_TELEFON2 FILL-IN_MOBILRADIO FILL-IN_TELEFONSEM ~
CMB_TRA FILL-IN-SLU1 FILL-IN-SLU2 FILL-IN-SLU3 FILL-IN-SLU4 FILL-IN-SLU5 ~
FILL-IN-SLU6 FILL-IN-SLU7 CMB_BER FILL-IN-TIM1 FILL-IN-TIM2 FILL-IN-TIM3 ~
FILL-IN-TIM4 FILL-IN-TIM5 FILL-IN-TIM6 FILL-IN-TIM7 FILL-IN_DELTID ~
FILL-IN_FLEXTID CMB_FAVTAL FILL-IN_SEMFOR FILL-IN_LAGBAS FILL-IN-AKFAKTOR ~
FILL-IN-SFAKTOR BTN_OK Btn_AVB FILL-IN-AVAFOR FILL-IN-SPARRFR ~
FILL-IN_FORTRO FILL-IN-DISPENSM FILL-IN-DISPENS48 FILL-IN_LONVATK 
&Scoped-Define DISPLAYED-OBJECTS FILL-IN-DISPELAK FILL-IN-DISPENS ~
FILL-IN_PERSONALKOD FILL-IN_ANSTNR FILL-IN_PERSONNUMMER FILL-IN_FORNAMN ~
FILL-IN_EFTERNAMN CMB_OMR RAD_PERS FILL-IN_GATUADRESS FILL-IN_TIDSGODK ~
FILL-IN_AKTIV CMB_BEF2 CMB_BEF FILL-IN_BOXEN CMB_ORGCHEF CMB_OVERUT ~
CMB_ANST FILL-IN_POSTNUMMER FILL-IN_POSTADRESS FILL-IN_TELEFON ~
FILL-IN_MOBILTEL FILL-IN_EPOST FILL-IN_PERSONSOK FILL-IN_TELEFON2 ~
FILL-IN_MOBILRADIO FILL-IN_TELEFONSEM CMB_TRA CMB_BER FILL-IN_DELTID ~
FILL-IN_FLEXTID FILL-IN_SEMFOR FILL-IN_LAGBAS FILL-IN-AKFAKTOR ~
FILL-IN-SFAKTOR FILL-IN-AVAFOR FILL-IN-SPARRFR FILL-IN_FORTRO ~
FILL-IN-DISPENSM FILL-IN-DISPENS48 FILL-IN_LONVATK 

/* Custom List Definitions                                              */
/* List-1,List-2,List-3,List-4,List-5,List-6                            */

/* _UIB-PREPROCESSOR-BLOCK-END */
&ANALYZE-RESUME


/* ************************  Function Prototypes ********************** */

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION-FORWARD tabortblanka Dialog-Frame 
FUNCTION tabortblanka RETURNS CHARACTER
  ( INPUT namnblanka AS CHARACTER )  FORWARD.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


/* ***********************  Control Definitions  ********************** */

/* Define a dialog box                                                  */

/* Definitions of the field level widgets                               */
DEFINE BUTTON Btn_AVB AUTO-END-KEY 
     LABEL "Avbryt" 
     SIZE 14 BY 1
     BGCOLOR 8 .

DEFINE BUTTON BTN_OK AUTO-GO 
     LABEL "Ok":L 
     SIZE 14 BY 1.

DEFINE VARIABLE CMB_ANST AS CHARACTER FORMAT "X(256)":U 
     LABEL "Anst.form" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     DROP-DOWN-LIST
     SIZE 40.5 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_BEF AS CHARACTER FORMAT "X(256)":U 
     LABEL "Befattning" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     DROP-DOWN-LIST
     SIZE 25 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_BEF2 AS CHARACTER FORMAT "X(256)":U 
     LABEL "Befattning" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     DROP-DOWN-LIST
     SIZE 25 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_BER AS CHARACTER FORMAT "X(256)":U 
     LABEL "Beredskapsalt." 
     VIEW-AS COMBO-BOX INNER-LINES 5
     DROP-DOWN-LIST
     SIZE 40 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_FAVTAL AS CHARACTER FORMAT "X(256)":U 
     LABEL "Flexavtal" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     DROP-DOWN-LIST
     SIZE 25 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_OMR AS CHARACTER FORMAT "X(16)" 
     LABEL "Område" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     DROP-DOWN-LIST
     SIZE 26 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_ORGCHEF AS CHARACTER FORMAT "X(256)":U 
     LABEL "Rörelsegren" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     DROP-DOWN-LIST
     SIZE 25 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_OVERUT AS CHARACTER FORMAT "X(4)":U 
     LABEL "Övertiduttag" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "Komp","Över","Flex","Ejöv" 
     DROP-DOWN-LIST
     SIZE 7.5 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_TRA AS CHARACTER FORMAT "X(256)":U 
     LABEL "Trakt.avtal" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     DROP-DOWN-LIST
     SIZE 25 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_VECKO AS INTEGER FORMAT ">99":U INITIAL 0 
     LABEL "Veckoschema" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 6.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-AKFAKTOR AS DECIMAL FORMAT ">9.99":U INITIAL 1 
     LABEL "Kal.faktor" 
     VIEW-AS FILL-IN 
     SIZE 8 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-AVAFOR AS INTEGER FORMAT ">>9":U INITIAL 0 
     LABEL "Avvik ATK" 
     VIEW-AS FILL-IN 
     SIZE 8 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-BORJ1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Börjar" 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-BORJ2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-BORJ3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-BORJ4 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-BORJ5 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-BORJ6 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-BORJ7 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-DISPELAK AS LOGICAL FORMAT "Ja/Nej":U INITIAL NO 
     LABEL "Disp.läk.besök" 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-DISPENS AS LOGICAL FORMAT "Ja/Nej":U INITIAL NO 
     LABEL "Tillåt > 350 tim/år ÖV" 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-DISPENS48 AS LOGICAL FORMAT "Ja/Nej":U INITIAL NO 
     LABEL "Tillåt > 48 tim/4v ÖV" 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-DISPENSM AS LOGICAL FORMAT "Ja/Nej":U INITIAL NO 
     LABEL "Tillåt > 50 tim/mån ÖV" 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-DSCH1 AS INTEGER FORMAT ">99":U INITIAL 0 
     LABEL "Dagschema" 
     VIEW-AS FILL-IN 
     SIZE 4.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-DSCH2 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 4.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-DSCH3 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 4.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-DSCH4 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-DSCH5 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 4.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-DSCH6 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 4.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-DSCH7 AS INTEGER FORMAT ">99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 4.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-FRE AS CHARACTER FORMAT "X(8)":U 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-LOR AS CHARACTER FORMAT "X(8)":U 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-MAN AS CHARACTER FORMAT "X(8)":U 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-ONS AS CHARACTER FORMAT "X(8)":U 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-SFAKTOR AS DECIMAL FORMAT ">9.99":U INITIAL 1 
     LABEL "Sem.faktor" 
     VIEW-AS FILL-IN 
     SIZE 8 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Slutar" 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU4 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU5 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU6 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-SLU7 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-SON AS CHARACTER FORMAT "X(8)":U 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-SPARRFR AS LOGICAL FORMAT "Ja/Nej":U INITIAL NO 
     LABEL "Spärr Friskv" 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM1 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     LABEL "Tim/Dag" 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM2 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM3 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM4 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM5 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM6 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-TIM7 AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-TIS AS CHARACTER FORMAT "X(8)":U 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-TOR AS CHARACTER FORMAT "X(8)":U 
     VIEW-AS FILL-IN 
     SIZE 8 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-TOT AS CHARACTER FORMAT "X(8)":U 
     VIEW-AS FILL-IN 
     SIZE 9 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-TOTV AS DECIMAL FORMAT "99.99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN_AKTIV AS LOGICAL FORMAT "Aktiv/Inaktiv" INITIAL NO 
     LABEL "Tidskrivning" 
     VIEW-AS FILL-IN 
     SIZE 8 BY 1.

DEFINE VARIABLE FILL-IN_ANSTNR AS CHARACTER FORMAT "x(12)" 
     LABEL "Anställningsnr" 
     VIEW-AS FILL-IN 
     SIZE 10.5 BY 1.

DEFINE VARIABLE FILL-IN_BOXEN AS CHARACTER FORMAT "x(8)" 
     LABEL "Box" 
     VIEW-AS FILL-IN 
     SIZE 10 BY 1.

DEFINE VARIABLE FILL-IN_DELTID AS LOGICAL FORMAT "Ja/Nej" INITIAL NO 
     LABEL "Deltid" 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1.

DEFINE VARIABLE FILL-IN_EFTERNAMN AS CHARACTER FORMAT "x(256)" 
     LABEL "Efternamn" 
     VIEW-AS FILL-IN 
     SIZE 26 BY 1.

DEFINE VARIABLE FILL-IN_EPOST AS CHARACTER FORMAT "x(256)" 
     LABEL "E-post" 
     VIEW-AS FILL-IN 
     SIZE 25 BY 1.

DEFINE VARIABLE FILL-IN_FLEXTID AS LOGICAL FORMAT "Ja/Nej" INITIAL NO 
     LABEL "Flextid" 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN_FORNAMN AS CHARACTER FORMAT "x(256)" 
     LABEL "Förnamn" 
     VIEW-AS FILL-IN 
     SIZE 26 BY 1.

DEFINE VARIABLE FILL-IN_FORTRO AS LOGICAL FORMAT "Ja/Nej" INITIAL NO 
     LABEL "Förtroendetid" 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1.

DEFINE VARIABLE FILL-IN_GATUADRESS AS CHARACTER FORMAT "X(25)" 
     LABEL "Gatuadress" 
     VIEW-AS FILL-IN 
     SIZE 26 BY 1.

DEFINE VARIABLE FILL-IN_LAGBAS AS LOGICAL FORMAT "Ja/Nej" INITIAL NO 
     LABEL "Lagbas" 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1.

DEFINE VARIABLE FILL-IN_LONVATK AS LOGICAL FORMAT "Ja/Nej" INITIAL NO 
     LABEL "Löneväxla ATK" 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1.

DEFINE VARIABLE FILL-IN_MOBILRADIO AS CHARACTER FORMAT "x(256)" 
     LABEL "Mobilradio" 
     VIEW-AS FILL-IN 
     SIZE 13 BY 1.

DEFINE VARIABLE FILL-IN_MOBILTEL AS CHARACTER FORMAT "x(256)" 
     LABEL "Mobiltel" 
     VIEW-AS FILL-IN 
     SIZE 13 BY 1.

DEFINE VARIABLE FILL-IN_OVERTIDUTTAG AS CHARACTER FORMAT "x(1)" INITIAL "K" 
     LABEL "Övertiduttag" 
     VIEW-AS FILL-IN 
     SIZE 2.5 BY 1.

DEFINE VARIABLE FILL-IN_PERSONALKOD AS CHARACTER FORMAT "x(5)" 
     LABEL "Enhet/Sign" 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1.

DEFINE VARIABLE FILL-IN_PERSONNUMMER AS CHARACTER FORMAT "999999-9999" INITIAL "0000000000" 
     LABEL "Personnummer" 
     VIEW-AS FILL-IN 
     SIZE 15 BY 1.

DEFINE VARIABLE FILL-IN_PERSONSOK AS CHARACTER FORMAT "x(256)" 
     LABEL "Personsökare" 
     VIEW-AS FILL-IN 
     SIZE 13 BY 1.

DEFINE VARIABLE FILL-IN_POSTADRESS AS CHARACTER FORMAT "X(20)" 
     LABEL "Postadress" 
     VIEW-AS FILL-IN 
     SIZE 23 BY 1.

DEFINE VARIABLE FILL-IN_POSTNUMMER AS CHARACTER FORMAT "XXX XX" 
     LABEL "Postnummer" 
     VIEW-AS FILL-IN 
     SIZE 10 BY 1.

DEFINE VARIABLE FILL-IN_SEMFOR AS LOGICAL FORMAT "Ja/Nej" INITIAL NO 
     LABEL "Spärr ATK" 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1.

DEFINE VARIABLE FILL-IN_TELEFON AS CHARACTER FORMAT "x(256)" 
     LABEL "Telefon" 
     VIEW-AS FILL-IN 
     SIZE 13 BY 1.

DEFINE VARIABLE FILL-IN_TELEFON2 AS CHARACTER FORMAT "x(256)" 
     LABEL "Telefon2" 
     VIEW-AS FILL-IN 
     SIZE 13 BY 1.

DEFINE VARIABLE FILL-IN_TELEFONSEM AS CHARACTER FORMAT "x(256)" 
     LABEL "Semestertele" 
     VIEW-AS FILL-IN 
     SIZE 13 BY 1.

DEFINE VARIABLE FILL-IN_TIDSGODK AS CHARACTER FORMAT "x(5)" 
     LABEL "Godkänner tid" 
     VIEW-AS FILL-IN 
     SIZE 7 BY 1.

DEFINE VARIABLE RAD_PERS AS INTEGER 
     VIEW-AS RADIO-SET HORIZONTAL
     RADIO-BUTTONS 
          "Adress-tele", 1,
"Tidskrivning", 2,
"Avtal", 3,
"Arbetstider", 4
     SIZE 84 BY 1 NO-UNDO.

/* Query definitions                                                    */
&ANALYZE-SUSPEND
DEFINE QUERY BRW_GODK FOR 
      godkannartemp SCROLLING.
&ANALYZE-RESUME

/* Browse definitions                                                   */
DEFINE BROWSE BRW_GODK
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _DISPLAY-FIELDS BRW_GODK Dialog-Frame _STRUCTURED
  QUERY BRW_GODK NO-LOCK DISPLAY
      godkannartemp.PERSONALKOD COLUMN-LABEL "Enhet/!Sign" FORMAT "x(5)":U
            WIDTH 7
      godkannartemp.FORNAMN COLUMN-LABEL "Förnamn" FORMAT "x(256)":U
            WIDTH 12
      godkannartemp.EFTERNAMN COLUMN-LABEL "Efternamn" FORMAT "x(256)":U
            WIDTH 22
  ENABLE
      godkannartemp.PERSONALKOD
/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME
    WITH NO-ROW-MARKERS NO-COLUMN-SCROLLING MULTIPLE SIZE 44.5 BY 8.21
         TITLE "Godkänner tidsedlar".


/* ************************  Frame Definitions  *********************** */

DEFINE FRAME Dialog-Frame
     FILL-IN-DISPELAK AT ROW 21.71 COL 15 COLON-ALIGNED
     FILL-IN-DISPENS AT ROW 22.96 COL 23 COLON-ALIGNED
     FILL-IN_PERSONALKOD AT ROW 3.33 COL 12 COLON-ALIGNED
     FILL-IN_ANSTNR AT ROW 3.33 COL 49 COLON-ALIGNED
     FILL-IN_PERSONNUMMER AT ROW 3.33 COL 73.75 COLON-ALIGNED
     FILL-IN_FORNAMN AT ROW 4.96 COL 12 COLON-ALIGNED
     FILL-IN_EFTERNAMN AT ROW 4.96 COL 49 COLON-ALIGNED
     CMB_OMR AT ROW 6.58 COL 12 COLON-ALIGNED
     RAD_PERS AT ROW 8.08 COL 7.5 NO-LABEL
     CMB_VECKO AT ROW 9.25 COL 44 COLON-ALIGNED
     FILL-IN_GATUADRESS AT ROW 10.08 COL 15 COLON-ALIGNED
     FILL-IN_TIDSGODK AT ROW 10.08 COL 15 COLON-ALIGNED
     FILL-IN_AKTIV AT ROW 10.08 COL 15 COLON-ALIGNED
     BRW_GODK AT ROW 10.08 COL 46.5
     CMB_BEF2 AT ROW 10.08 COL 53 COLON-ALIGNED
     FILL-IN-MAN AT ROW 10.5 COL 13.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIS AT ROW 10.5 COL 22.5 COLON-ALIGNED NO-LABEL
     FILL-IN-ONS AT ROW 10.5 COL 31.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TOR AT ROW 10.5 COL 40.5 COLON-ALIGNED NO-LABEL
     FILL-IN-FRE AT ROW 10.5 COL 49.5 COLON-ALIGNED NO-LABEL
     FILL-IN-LOR AT ROW 10.5 COL 58.5 COLON-ALIGNED NO-LABEL
     FILL-IN-SON AT ROW 10.5 COL 67.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TOT AT ROW 10.5 COL 75.5 COLON-ALIGNED NO-LABEL
     CMB_BEF AT ROW 11.33 COL 15 COLON-ALIGNED
     FILL-IN_BOXEN AT ROW 11.33 COL 15 COLON-ALIGNED
     CMB_ORGCHEF AT ROW 11.33 COL 64 COLON-ALIGNED
     CMB_OVERUT AT ROW 11.58 COL 15 COLON-ALIGNED
     FILL-IN-DSCH1 AT ROW 12 COL 13.5 COLON-ALIGNED
     FILL-IN-DSCH2 AT ROW 12 COL 22.5 COLON-ALIGNED NO-LABEL
     FILL-IN-DSCH3 AT ROW 12 COL 31.5 COLON-ALIGNED NO-LABEL
     FILL-IN-DSCH4 AT ROW 12 COL 40.5 COLON-ALIGNED NO-LABEL
     FILL-IN-DSCH5 AT ROW 12 COL 49.5 COLON-ALIGNED NO-LABEL
     FILL-IN-DSCH6 AT ROW 12 COL 58.5 COLON-ALIGNED NO-LABEL
     FILL-IN-DSCH7 AT ROW 12 COL 67.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TOTV AT ROW 12 COL 75.5 COLON-ALIGNED NO-LABEL
     CMB_ANST AT ROW 12.58 COL 15 COLON-ALIGNED
     FILL-IN_POSTNUMMER AT ROW 12.58 COL 15 COLON-ALIGNED
     FILL-IN_POSTADRESS AT ROW 12.58 COL 52 COLON-ALIGNED
     FILL-IN-BORJ1 AT ROW 13.17 COL 13.5 COLON-ALIGNED
     FILL-IN-BORJ2 AT ROW 13.17 COL 22.5 COLON-ALIGNED NO-LABEL
     FILL-IN-BORJ3 AT ROW 13.17 COL 31.5 COLON-ALIGNED NO-LABEL
     FILL-IN-BORJ4 AT ROW 13.17 COL 40.5 COLON-ALIGNED NO-LABEL
     FILL-IN-BORJ5 AT ROW 13.17 COL 49.5 COLON-ALIGNED NO-LABEL
     FILL-IN-BORJ6 AT ROW 13.17 COL 58.5 COLON-ALIGNED NO-LABEL
     FILL-IN-BORJ7 AT ROW 13.17 COL 67.5 COLON-ALIGNED NO-LABEL
     FILL-IN_TELEFON AT ROW 13.83 COL 15 COLON-ALIGNED HELP
          "HEMTELE"
     FILL-IN_MOBILTEL AT ROW 15.08 COL 15 COLON-ALIGNED
     FILL-IN_EPOST AT ROW 16.33 COL 15 COLON-ALIGNED
     FILL-IN_PERSONSOK AT ROW 17.58 COL 15 COLON-ALIGNED
     FILL-IN_TELEFON2 AT ROW 13.83 COL 52 COLON-ALIGNED HELP
          "ARB.TELE"
     FILL-IN_MOBILRADIO AT ROW 15.08 COL 52 COLON-ALIGNED
     FILL-IN_TELEFONSEM AT ROW 16.33 COL 52 COLON-ALIGNED
     CMB_TRA AT ROW 13.83 COL 15 COLON-ALIGNED
     FILL-IN-SLU1 AT ROW 14.42 COL 13.5 COLON-ALIGNED
     FILL-IN-SLU2 AT ROW 14.42 COL 22.5 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU3 AT ROW 14.42 COL 31.5 COLON-ALIGNED NO-LABEL
    WITH VIEW-AS DIALOG-BOX KEEP-TAB-ORDER 
         SIDE-LABELS NO-UNDERLINE THREE-D  SCROLLABLE .

/* DEFINE FRAME statement is approaching 4K Bytes.  Breaking it up   */
DEFINE FRAME Dialog-Frame
     FILL-IN-SLU4 AT ROW 14.42 COL 40.5 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU5 AT ROW 14.42 COL 49.5 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU6 AT ROW 14.42 COL 58.5 COLON-ALIGNED NO-LABEL
     FILL-IN-SLU7 AT ROW 14.42 COL 67.5 COLON-ALIGNED NO-LABEL
     CMB_BER AT ROW 15.08 COL 15 COLON-ALIGNED
     FILL-IN-TIM1 AT ROW 15.58 COL 13.5 COLON-ALIGNED
     FILL-IN-TIM2 AT ROW 15.58 COL 22.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM3 AT ROW 15.58 COL 31.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM4 AT ROW 15.58 COL 40.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM5 AT ROW 15.58 COL 49.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM6 AT ROW 15.58 COL 58.5 COLON-ALIGNED NO-LABEL
     FILL-IN-TIM7 AT ROW 15.58 COL 67.5 COLON-ALIGNED NO-LABEL
     FILL-IN_DELTID AT ROW 16.33 COL 15 COLON-ALIGNED
     FILL-IN_FLEXTID AT ROW 17.58 COL 15 COLON-ALIGNED
     CMB_FAVTAL AT ROW 17.58 COL 52 COLON-ALIGNED
     FILL-IN_SEMFOR AT ROW 18.96 COL 15 COLON-ALIGNED
     FILL-IN_LAGBAS AT ROW 21.71 COL 15 COLON-ALIGNED
     FILL-IN_OVERTIDUTTAG AT ROW 20.5 COL 68 COLON-ALIGNED
     FILL-IN-AKFAKTOR AT ROW 22.88 COL 44.75 COLON-ALIGNED
     FILL-IN-SFAKTOR AT ROW 24.13 COL 44.75 COLON-ALIGNED
     BTN_OK AT ROW 25.5 COL 62
     Btn_AVB AT ROW 25.5 COL 77
     FILL-IN-AVAFOR AT ROW 18.96 COL 49.75 COLON-ALIGNED
     FILL-IN-SPARRFR AT ROW 20.33 COL 15 COLON-ALIGNED
     FILL-IN_FORTRO AT ROW 21.71 COL 44.75 COLON-ALIGNED WIDGET-ID 2
     FILL-IN-DISPENSM AT ROW 24.17 COL 23 COLON-ALIGNED WIDGET-ID 4
     FILL-IN-DISPENS48 AT ROW 25.42 COL 23 COLON-ALIGNED WIDGET-ID 6
     FILL-IN_LONVATK AT ROW 18.96 COL 34.25 COLON-ALIGNED WIDGET-ID 8
     SPACE(51.62) SKIP(6.70)
    WITH VIEW-AS DIALOG-BOX KEEP-TAB-ORDER 
         SIDE-LABELS NO-UNDERLINE THREE-D  SCROLLABLE 
         TITLE "Personal"
         CANCEL-BUTTON Btn_AVB.


/* *********************** Procedure Settings ************************ */

&ANALYZE-SUSPEND _PROCEDURE-SETTINGS
/* Settings for THIS-PROCEDURE
   Type: Dialog-Box
   Allow: Basic,Browse,DB-Fields,Query
   Temp-Tables and Buffers:
      TABLE: ansvarigtemp T "?" NO-UNDO temp-db ansvarigtemp
      TABLE: godkannartemp T "?" NO-UNDO temp-db godkannartemp
      TABLE: personaltemp T "?" NO-UNDO temp-db personaltemp
   END-TABLES.
 */
&ANALYZE-RESUME _END-PROCEDURE-SETTINGS



/* ***********  Runtime Attributes and AppBuilder Settings  *********** */

&ANALYZE-SUSPEND _RUN-TIME-ATTRIBUTES
/* SETTINGS FOR DIALOG-BOX Dialog-Frame
   NOT-VISIBLE FRAME-NAME Custom                                        */
/* BROWSE-TAB BRW_GODK FILL-IN_AKTIV Dialog-Frame */
ASSIGN 
       FRAME Dialog-Frame:SCROLLABLE       = FALSE
       FRAME Dialog-Frame:HIDDEN           = TRUE.

ASSIGN 
       BRW_GODK:MAX-DATA-GUESS IN FRAME Dialog-Frame         = 300
       BRW_GODK:ALLOW-COLUMN-SEARCHING IN FRAME Dialog-Frame = TRUE
       BRW_GODK:COLUMN-RESIZABLE IN FRAME Dialog-Frame       = TRUE.

/* SETTINGS FOR COMBO-BOX CMB_FAVTAL IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR COMBO-BOX CMB_VECKO IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-BORJ1 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-BORJ2 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-BORJ3 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-BORJ4 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-BORJ5 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-BORJ6 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-BORJ7 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-DSCH1 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-DSCH2 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-DSCH3 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-DSCH4 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-DSCH5 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-DSCH6 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-DSCH7 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-FRE IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-LOR IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-MAN IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-ONS IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-SLU1 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-SLU2 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-SLU3 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-SLU4 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-SLU5 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-SLU6 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-SLU7 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-SON IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-TIM1 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-TIM2 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-TIM3 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-TIM4 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-TIM5 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-TIM6 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-TIM7 IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-TIS IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-TOR IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-TOT IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN-TOTV IN FRAME Dialog-Frame
   NO-DISPLAY                                                           */
/* SETTINGS FOR FILL-IN FILL-IN_OVERTIDUTTAG IN FRAME Dialog-Frame
   NO-DISPLAY NO-ENABLE                                                 */
ASSIGN 
       FILL-IN_OVERTIDUTTAG:HIDDEN IN FRAME Dialog-Frame           = TRUE.

/* _RUN-TIME-ATTRIBUTES-END */
&ANALYZE-RESUME


/* Setting information for Queries and Browse Widgets fields            */

&ANALYZE-SUSPEND _QUERY-BLOCK BROWSE BRW_GODK
/* Query rebuild information for BROWSE BRW_GODK
     _TblList          = "Temp-Tables.godkannartemp"
     _Options          = "NO-LOCK"
     _FldNameList[1]   > Temp-Tables.godkannartemp.PERSONALKOD
"godkannartemp.PERSONALKOD" "Enhet/!Sign" ? "character" ? ? ? ? ? ? yes ? no no "7" yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _FldNameList[2]   > Temp-Tables.godkannartemp.FORNAMN
"godkannartemp.FORNAMN" "Förnamn" "x(256)" "character" ? ? ? ? ? ? no ? no no "12" yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _FldNameList[3]   > Temp-Tables.godkannartemp.EFTERNAMN
"godkannartemp.EFTERNAMN" "Efternamn" "x(256)" "character" ? ? ? ? ? ? no ? no no "22" yes no no "U" "" "" "" "" "" "" 0 no 0 no no
     _Query            is NOT OPENED
*/  /* BROWSE BRW_GODK */
&ANALYZE-RESUME

 



/* ************************  Control Triggers  ************************ */

&Scoped-define SELF-NAME Dialog-Frame
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL Dialog-Frame Dialog-Frame
ON WINDOW-CLOSE OF FRAME Dialog-Frame /* Personal */
DO:
   {BORTBRWPROC.I}
  APPLY "END-ERROR":U TO SELF.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define BROWSE-NAME BRW_GODK
&Scoped-define SELF-NAME BRW_GODK
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BRW_GODK Dialog-Frame
ON ANY-PRINTABLE OF BRW_GODK IN FRAME Dialog-Frame /* Godkänner tidsedlar */
DO:
   RUN hittadyn_UI IN brwproc[{&RIGHT-BROWSE}]. 
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BRW_GODK Dialog-Frame
ON START-SEARCH OF BRW_GODK IN FRAME Dialog-Frame /* Godkänner tidsedlar */
DO:
   RUN colsortdynbrw_UI IN brwproc[{&RIGHT-BROWSE}] (INPUT "").
   RUN lastselectdyn_UI IN brwproc[{&RIGHT-BROWSE}].
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BRW_GODK Dialog-Frame
ON VALUE-CHANGED OF BRW_GODK IN FRAME Dialog-Frame /* Godkänner tidsedlar */
DO:
   RUN fetchselrowid_UI IN brwproc[{&RIGHT-BROWSE}].  
   IF AVAILABLE godkannartemp THEN DO:
      ASSIGN FILL-IN_TIDSGODK  = godkannartemp.PERSONALKOD.
      DISPLAY FILL-IN_TIDSGODK WITH FRAME {&FRAME-NAME}.
   END.     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME Btn_AVB
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL Btn_AVB Dialog-Frame
ON CHOOSE OF Btn_AVB IN FRAME Dialog-Frame /* Avbryt */
DO:
   musz = TRUE.   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME BTN_OK
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_OK Dialog-Frame
ON CHOOSE OF BTN_OK IN FRAME Dialog-Frame /* Ok */
DO:    
   
   {muswait.i}      
   RUN btnok_UI.
   {musarrow.i}     
   IF musz = TRUE THEN DO:
      musz = FALSE.
      RETURN NO-APPLY.
   END.
   ELSE DO:
      {BORTBRWPROC.I}
      pkod = valperskolltemp.PERSONALKOD.
      FRAME Dialog-Frame:HIDDEN = TRUE.
      RETURN. 
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_ANST
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_ANST Dialog-Frame
ON VALUE-CHANGED OF CMB_ANST IN FRAME Dialog-Frame /* Anst.form */
DO:
   CMB_ANST = INPUT CMB_ANST.     
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_BEF
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_BEF Dialog-Frame
ON VALUE-CHANGED OF CMB_BEF IN FRAME Dialog-Frame /* Befattning */
DO:
   CMB_BEF = INPUT CMB_BEF.   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_BEF2
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_BEF2 Dialog-Frame
ON VALUE-CHANGED OF CMB_BEF2 IN FRAME Dialog-Frame /* Befattning */
DO:
   CMB_BEF2 = INPUT CMB_BEF2.   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_BER
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_BER Dialog-Frame
ON VALUE-CHANGED OF CMB_BER IN FRAME Dialog-Frame /* Beredskapsalt. */
DO:
   CMB_BER = INPUT CMB_BER.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_OMR
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_OMR Dialog-Frame
ON LEAVE OF CMB_OMR IN FRAME Dialog-Frame /* Område */
DO:
   CMB_OMR = INPUT CMB_OMR.      
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_ORGCHEF
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_ORGCHEF Dialog-Frame
ON VALUE-CHANGED OF CMB_ORGCHEF IN FRAME Dialog-Frame /* Rörelsegren */
DO:
   CMB_ORGCHEF = INPUT CMB_ORGCHEF.       
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_OVERUT
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_OVERUT Dialog-Frame
ON VALUE-CHANGED OF CMB_OVERUT IN FRAME Dialog-Frame /* Övertiduttag */
DO:
   CMB_OVERUT = INPUT CMB_OVERUT.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_TRA
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_TRA Dialog-Frame
ON VALUE-CHANGED OF CMB_TRA IN FRAME Dialog-Frame /* Trakt.avtal */
DO:
   CMB_TRA = INPUT CMB_TRA.       
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_VECKO
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_VECKO Dialog-Frame
ON ENTRY OF CMB_VECKO IN FRAME Dialog-Frame /* Veckoschema */
DO:
   CMB_VECKO = INPUT CMB_VECKO. 
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_VECKO Dialog-Frame
ON LEAVE OF CMB_VECKO IN FRAME Dialog-Frame /* Veckoschema */
DO:
   CMB_VECKO = INPUT CMB_VECKO.    
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_VECKO Dialog-Frame
ON VALUE-CHANGED OF CMB_VECKO IN FRAME Dialog-Frame /* Veckoschema */
DO:
   CMB_VECKO = INPUT CMB_VECKO.
   FOR EACH valperskolltemp:
      DELETE valperskolltemp.
   END.
   FOR EACH valsoktemp:
      DELETE valsoktemp.
   END.   
   CREATE valperskolltemp.
   valperskolltemp.VECKOSCHEMA = CMB_VECKO.
   IF Guru.Konstanter:appcon THEN DO:      
      RUN PERSUPP.P ON Guru.Konstanter:apphand TRANSACTION DISTINCT 
      (INPUT 3,INPUT pkod,INPUT TABLE valperskolltemp,INPUT-OUTPUT TABLE valsoktemp,OUTPUT TABLE felmeddtemp).
   END.
   ELSE DO:
      RUN PERSUPP.P 
      (INPUT 3,INPUT pkod,INPUT TABLE valperskolltemp,INPUT-OUTPUT TABLE valsoktemp,OUTPUT TABLE felmeddtemp).
   END.
   RUN vladda_UI.    
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-DISPELAK
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-DISPELAK Dialog-Frame
ON MOUSE-SELECT-CLICK OF FILL-IN-DISPELAK IN FRAME Dialog-Frame /* Disp.läk.besök */
DO:
   IF INPUT FILL-IN-DISPELAK = TRUE THEN FILL-IN-DISPELAK = FALSE.
   IF INPUT FILL-IN-DISPELAK = FALSE THEN FILL-IN-DISPELAK = TRUE.
   DISPLAY FILL-IN-DISPELAK WITH FRAME {&FRAME-NAME}.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-DISPENS
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-DISPENS Dialog-Frame
ON MOUSE-SELECT-CLICK OF FILL-IN-DISPENS IN FRAME Dialog-Frame /* Tillåt > 350 tim/år ÖV */
DO:
   IF INPUT FILL-IN-DISPENS = TRUE THEN FILL-IN-DISPENS = FALSE.
   IF INPUT FILL-IN-DISPENS = FALSE THEN FILL-IN-DISPENS = TRUE.
   DISPLAY FILL-IN-DISPENS WITH FRAME {&FRAME-NAME}.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-DISPENS48
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-DISPENS48 Dialog-Frame
ON MOUSE-SELECT-CLICK OF FILL-IN-DISPENS48 IN FRAME Dialog-Frame /* Tillåt > 48 tim/4v ÖV */
DO:
   IF INPUT FILL-IN-DISPENS48 = TRUE THEN FILL-IN-DISPENS48 = FALSE.
   IF INPUT FILL-IN-DISPENS48 = FALSE THEN FILL-IN-DISPENS48 = TRUE.
   DISPLAY FILL-IN-DISPENS48 WITH FRAME {&FRAME-NAME}.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-DISPENSM
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-DISPENSM Dialog-Frame
ON MOUSE-SELECT-CLICK OF FILL-IN-DISPENSM IN FRAME Dialog-Frame /* Tillåt > 50 tim/mån ÖV */
DO:
   IF INPUT FILL-IN-DISPENSM = TRUE THEN FILL-IN-DISPENSM = FALSE.
   IF INPUT FILL-IN-DISPENSM = FALSE THEN FILL-IN-DISPENSM = TRUE.
   DISPLAY FILL-IN-DISPENSM WITH FRAME {&FRAME-NAME}.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-SPARRFR
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-SPARRFR Dialog-Frame
ON MOUSE-SELECT-CLICK OF FILL-IN-SPARRFR IN FRAME Dialog-Frame /* Spärr Friskv */
DO:
   IF INPUT FILL-IN-SPARRFR = TRUE THEN FILL-IN-SPARRFR = FALSE.
   IF INPUT FILL-IN-SPARRFR = FALSE THEN FILL-IN-SPARRFR = TRUE.
   DISPLAY FILL-IN-SPARRFR WITH FRAME {&FRAME-NAME}.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_AKTIV
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_AKTIV Dialog-Frame
ON LEAVE OF FILL-IN_AKTIV IN FRAME Dialog-Frame /* Tidskrivning */
DO:
   ASSIGN FILL-IN_AKTIV = INPUT FILL-IN_AKTIV.
    
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_AKTIV Dialog-Frame
ON MOUSE-SELECT-CLICK OF FILL-IN_AKTIV IN FRAME Dialog-Frame /* Tidskrivning */
DO:
   IF INPUT FILL-IN_AKTIV = TRUE THEN FILL-IN_AKTIV = FALSE.
   IF INPUT FILL-IN_AKTIV = FALSE THEN FILL-IN_AKTIV = TRUE.   
   DISPLAY FILL-IN_AKTIV WITH FRAME {&FRAME-NAME}.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_ANSTNR
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_ANSTNR Dialog-Frame
ON LEAVE OF FILL-IN_ANSTNR IN FRAME Dialog-Frame /* Anställningsnr */
DO:    
   FILL-IN_ANSTNR = INPUT FILL-IN_ANSTNR.   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_BOXEN
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_BOXEN Dialog-Frame
ON LEAVE OF FILL-IN_BOXEN IN FRAME Dialog-Frame /* Box */
DO:
    FILL-IN_BOXEN = INPUT FILL-IN_BOXEN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_DELTID
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_DELTID Dialog-Frame
ON LEAVE OF FILL-IN_DELTID IN FRAME Dialog-Frame /* Deltid */
DO:
    ASSIGN FILL-IN_DELTID = INPUT FILL-IN_DELTID.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_DELTID Dialog-Frame
ON MOUSE-SELECT-CLICK OF FILL-IN_DELTID IN FRAME Dialog-Frame /* Deltid */
DO:
   IF INPUT FILL-IN_DELTID = TRUE THEN FILL-IN_DELTID = FALSE.
   IF INPUT FILL-IN_DELTID = FALSE THEN FILL-IN_DELTID = TRUE.
   DISPLAY FILL-IN_DELTID WITH FRAME {&FRAME-NAME}.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_EFTERNAMN
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_EFTERNAMN Dialog-Frame
ON LEAVE OF FILL-IN_EFTERNAMN IN FRAME Dialog-Frame /* Efternamn */
DO:
    FILL-IN_EFTERNAMN = INPUT FILL-IN_EFTERNAMN. 
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_EPOST
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_EPOST Dialog-Frame
ON LEAVE OF FILL-IN_EPOST IN FRAME Dialog-Frame /* E-post */
DO:
   ASSIGN FILL-IN_EPOST = INPUT FILL-IN_EPOST.
   IF FILL-IN_EPOST NE "" THEN DO:
      RUN EPOSTKOLL.P (INPUT FILL-IN_EPOST,OUTPUT musz).
      IF musz = FALSE THEN DO:
         APPLY "ENTRY" TO FILL-IN_EPOST IN FRAME {&FRAME-NAME}.
         RETURN NO-APPLY.
      END.
      musz = FALSE.
   END.   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_FLEXTID
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_FLEXTID Dialog-Frame
ON LEAVE OF FILL-IN_FLEXTID IN FRAME Dialog-Frame /* Flextid */
DO:
  FILL-IN_FLEXTID = INPUT FILL-IN_FLEXTID.
  IF Guru.Konstanter:globforetag = "ELPA" OR Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "MISV"  THEN DO:   
     IF FILL-IN_FLEXTID = TRUE THEN DO:              
        IF Guru.Konstanter:globforetag = "SUND" THEN DO:                
           IF FILL-IN-FAVTAL = "T" THEN ASSIGN CMB_FAVTAL = "Sundsvall Övriga".                   
           IF FILL-IN-FAVTAL = "TU" THEN ASSIGN CMB_FAVTAL = "Korsta".
           IF FILL-IN-FAVTAL = "" THEN ASSIGN CMB_FAVTAL = "Sundsvall Övriga".
        END.
        ELSE IF Guru.Konstanter:globforetag = "SNAT"  THEN DO:     
           IF FILL-IN-FAVTAL = "TE" THEN ASSIGN CMB_FAVTAL = "8-17".               /*   "Sundsvall Elnät".*/           
           IF FILL-IN-FAVTAL = "K" THEN ASSIGN CMB_FAVTAL = "7-16".                      /*"Sundsvall kollektiv Elnät".*/
           IF FILL-IN-FAVTAL = "" THEN ASSIGN CMB_FAVTAL = "8-17".         
           
        END.
        ELSE if Guru.Konstanter:globforetag = "MISV"  THEN DO: 
           IF FILL-IN-FAVTAL = "T" THEN ASSIGN CMB_FAVTAL = "Sundsvall Övriga".           
           IF FILL-IN-FAVTAL = "KV" THEN ASSIGN CMB_FAVTAL = "Sundsvall kollektiv Vatten".          
           IF FILL-IN-FAVTAL = "" THEN ASSIGN CMB_FAVTAL = "Sundsvall Övriga".
        END.     
        ASSIGN
        CMB_FAVTAL:HIDDEN = FALSE.
        ENABLE CMB_FAVTAL WITH FRAME {&FRAME-NAME}.
        DISPLAY CMB_FAVTAL WITH FRAME {&FRAME-NAME}.
           
     END.
     ELSE CMB_FAVTAL:HIDDEN = TRUE.   
  END.   
  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_FLEXTID Dialog-Frame
ON MOUSE-SELECT-CLICK OF FILL-IN_FLEXTID IN FRAME Dialog-Frame /* Flextid */
DO:
   IF INPUT FILL-IN_FLEXTID = TRUE THEN FILL-IN_FLEXTID = FALSE.
   IF INPUT FILL-IN_FLEXTID = FALSE THEN FILL-IN_FLEXTID = TRUE.
   DISPLAY FILL-IN_FLEXTID WITH FRAME {&FRAME-NAME}.
   IF Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "MISV"  THEN DO:
      IF FILL-IN_FLEXTID = TRUE THEN DO:                       
         IF FILL-IN-FAVTAL = "TE" THEN ASSIGN CMB_FAVTAL =  "8-17".                       /*"Sundsvall Elnät".*/
         IF FILL-IN-FAVTAL = "K" THEN ASSIGN CMB_FAVTAL =  "7-16".                          /*"Sundsvall kollektiv Elnät".*/
         IF FILL-IN-FAVTAL = "T" THEN ASSIGN CMB_FAVTAL = "Sundsvall Övriga".    
         IF FILL-IN-FAVTAL = "KV" THEN ASSIGN CMB_FAVTAL = "Sundsvall kollektiv Vatten".
         IF FILL-IN-FAVTAL = "TU" THEN ASSIGN CMB_FAVTAL = "Korsta".
         IF FILL-IN-FAVTAL = "" THEN ASSIGN CMB_FAVTAL = "Sundsvall Övriga".
         ASSIGN
         CMB_FAVTAL:HIDDEN = FALSE.
         ENABLE CMB_FAVTAL WITH FRAME {&FRAME-NAME}.
         DISPLAY CMB_FAVTAL WITH FRAME {&FRAME-NAME}.
      END.
      ELSE CMB_FAVTAL:HIDDEN = TRUE.    
   END. 
   ELSE CMB_FAVTAL:HIDDEN = TRUE.    
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_FORNAMN
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_FORNAMN Dialog-Frame
ON LEAVE OF FILL-IN_FORNAMN IN FRAME Dialog-Frame /* Förnamn */
DO:
   ASSIGN FILL-IN_FORNAMN = INPUT FILL-IN_FORNAMN. 
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_FORTRO
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_FORTRO Dialog-Frame
ON MOUSE-SELECT-CLICK OF FILL-IN_FORTRO IN FRAME Dialog-Frame /* Förtroendetid */
DO:
   IF INPUT FILL-IN_FORTRO = TRUE THEN FILL-IN_FORTRO = FALSE.
   IF INPUT FILL-IN_FORTRO = FALSE THEN FILL-IN_FORTRO = TRUE.
   DISPLAY FILL-IN_FORTRO WITH FRAME {&FRAME-NAME}.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_GATUADRESS
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_GATUADRESS Dialog-Frame
ON LEAVE OF FILL-IN_GATUADRESS IN FRAME Dialog-Frame /* Gatuadress */
DO:
     ASSIGN FILL-IN_GATUADRESS = INPUT FILL-IN_GATUADRESS. 
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_LAGBAS
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_LAGBAS Dialog-Frame
ON MOUSE-SELECT-CLICK OF FILL-IN_LAGBAS IN FRAME Dialog-Frame /* Lagbas */
DO:
   IF INPUT FILL-IN_LAGBAS = TRUE THEN FILL-IN_LAGBAS = FALSE.
   IF INPUT FILL-IN_LAGBAS = FALSE THEN FILL-IN_LAGBAS = TRUE.
   DISPLAY FILL-IN_LAGBAS WITH FRAME {&FRAME-NAME}.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_LONVATK
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_LONVATK Dialog-Frame
ON MOUSE-SELECT-CLICK OF FILL-IN_LONVATK IN FRAME Dialog-Frame /* Löneväxla ATK */
DO:
   IF INPUT FILL-IN_LONVATK = TRUE THEN FILL-IN_LONVATK = FALSE.
   IF INPUT FILL-IN_LONVATK = FALSE THEN FILL-IN_LONVATK = TRUE.
   DISPLAY FILL-IN_LONVATK WITH FRAME {&FRAME-NAME}.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_MOBILRADIO
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_MOBILRADIO Dialog-Frame
ON LEAVE OF FILL-IN_MOBILRADIO IN FRAME Dialog-Frame /* Mobilradio */
DO:
    ASSIGN FILL-IN_MOBILRADIO = INPUT FILL-IN_MOBILRADIO.   
    FILL-IN_MOBILRADIO= tabortblanka(FILL-IN_MOBILRADIO).
    DISPLAY FILL-IN_MOBILRADIO WITH FRAME Dialog-Frame. 

END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_MOBILTEL
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_MOBILTEL Dialog-Frame
ON LEAVE OF FILL-IN_MOBILTEL IN FRAME Dialog-Frame /* Mobiltel */
DO:
    ASSIGN FILL-IN_MOBILTEL = INPUT FILL-IN_MOBILTEL. 
    FILL-IN_MOBILTEL = tabortblanka(FILL-IN_MOBILTEL ).
   DISPLAY FILL-IN_MOBILTEL WITH FRAME Dialog-Frame. 
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_OVERTIDUTTAG
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_OVERTIDUTTAG Dialog-Frame
ON LEAVE OF FILL-IN_OVERTIDUTTAG IN FRAME Dialog-Frame /* Övertiduttag */
DO:
   ASSIGN FILL-IN_OVERTIDUTTAG = INPUT FILL-IN_OVERTIDUTTAG.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_PERSONALKOD
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_PERSONALKOD Dialog-Frame
ON LEAVE OF FILL-IN_PERSONALKOD IN FRAME Dialog-Frame /* Enhet/Sign */
DO:  
   ASSIGN FILL-IN_PERSONALKOD = INPUT FILL-IN_PERSONALKOD.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_PERSONNUMMER
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_PERSONNUMMER Dialog-Frame
ON LEAVE OF FILL-IN_PERSONNUMMER IN FRAME Dialog-Frame /* Personnummer */
DO:   
   IF INPUT FILL-IN_PERSONNUMMER = "" THEN  ASSIGN FILL-IN_PERSONNUMMER = "0000000000".
   ELSE ASSIGN FILL-IN_PERSONNUMMER = INPUT FILL-IN_PERSONNUMMER.
   IF FILL-IN_PERSONNUMMER NE "0000000000" THEN DO:  
      persnr[1] = INTEGER(SUBSTRING(STRING(FILL-IN_PERSONNUMMER,"999999-9999"),1,1)).
      persnr[2] = INTEGER(SUBSTRING(STRING(FILL-IN_PERSONNUMMER,"999999-9999"),2,1)).
      persnr[3] = INTEGER(SUBSTRING(STRING(FILL-IN_PERSONNUMMER,"999999-9999"),3,1)).
      persnr[4] = INTEGER(SUBSTRING(STRING(FILL-IN_PERSONNUMMER,"999999-9999"),4,1)).
      persnr[5] = INTEGER(SUBSTRING(STRING(FILL-IN_PERSONNUMMER,"999999-9999"),5,1)).
      persnr[6] = INTEGER(SUBSTRING(STRING(FILL-IN_PERSONNUMMER,"999999-9999"),6,1)).
      persnr[7] = INTEGER(SUBSTRING(STRING(FILL-IN_PERSONNUMMER,"999999-9999"),8,1)).
      persnr[8] = INTEGER(SUBSTRING(STRING(FILL-IN_PERSONNUMMER,"999999-9999"),9,1)).
      persnr[9] = INTEGER(SUBSTRING(STRING(FILL-IN_PERSONNUMMER,"999999-9999"),10,1)).
      persnr[10] = INTEGER(SUBSTRING(STRING(FILL-IN_PERSONNUMMER,"999999-9999"),11,1)).
      persnr[1] = persnr[1] * 2.
      IF persnr[1] > 9 THEN persnr[1] = 
      INTEGER(SUBSTRING(STRING(persnr[1],"99"),1,1)) + 
      INTEGER(SUBSTRING(STRING(persnr[1],"99"),2,1)).
      persnr[3] = persnr[3] * 2.
      IF persnr[3] > 9 THEN persnr[3] =
      INTEGER(SUBSTRING(STRING(persnr[3],"99"),1,1)) +
      INTEGER(SUBSTRING(STRING(persnr[3],"99"),2,1)).
      persnr[5] = persnr[5] * 2.
      IF persnr[5] > 9 THEN persnr[5] =
      INTEGER(SUBSTRING(STRING(persnr[5],"99"),1,1)) +
      INTEGER(SUBSTRING(STRING(persnr[5],"99"),2,1)).
      persnr[7] = persnr[7] * 2.
      IF persnr[7] > 9 THEN persnr[7] =
      INTEGER(SUBSTRING(STRING(persnr[7],"99"),1,1)) +
      INTEGER(SUBSTRING(STRING(persnr[7],"99"),2,1)).
      persnr[9] = persnr[9] * 2.
      IF persnr[9] > 9 THEN persnr[9] =
      INTEGER(SUBSTRING(STRING(persnr[9],"99"),1,1)) +
      INTEGER(SUBSTRING(STRING(persnr[9],"99"),2,1)).
      tal1 = persnr[1] + persnr[2] + persnr[3] + persnr[4] + persnr[5] +
      persnr[6] + persnr[7] + persnr[8] + persnr[9].

      IF tal1 > 99 THEN
      tal2 = INTEGER(SUBSTRING(STRING(tal1,"999"),3,1)).
      IF tal1 < 100 THEN
      tal2 = INTEGER(SUBSTRING(STRING(tal1,"99"),2,1)).
      ksiffran = 10 - tal2.
      IF ksiffran = 10 THEN ksiffran = 0.
      IF persnr[10] = ksiffran OR (persnr[7] = 0 AND persnr[8] = 0 AND
      persnr[9] = 0 AND persnr[10] = 0) THEN ksiffran = ksiffran.
      ELSE DO:
         MESSAGE "Felaktigt personnummer." VIEW-AS ALERT-BOX.
         RETURN NO-APPLY.
      END.   
   END.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_PERSONSOK
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_PERSONSOK Dialog-Frame
ON LEAVE OF FILL-IN_PERSONSOK IN FRAME Dialog-Frame /* Personsökare */
DO:
   ASSIGN FILL-IN_PERSONSOK = INPUT FILL-IN_PERSONSOK. 
   FILL-IN_PERSONSOK = tabortblanka(FILL-IN_PERSONSOK).
   DISPLAY FILL-IN_PERSONSOK WITH FRAME Dialog-Frame. 
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_POSTADRESS
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_POSTADRESS Dialog-Frame
ON LEAVE OF FILL-IN_POSTADRESS IN FRAME Dialog-Frame /* Postadress */
DO:
    ASSIGN FILL-IN_POSTADRESS = INPUT FILL-IN_POSTADRESS.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_POSTNUMMER
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_POSTNUMMER Dialog-Frame
ON LEAVE OF FILL-IN_POSTNUMMER IN FRAME Dialog-Frame /* Postnummer */
DO:
    ASSIGN FILL-IN_POSTNUMMER = INPUT FILL-IN_POSTNUMMER.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_SEMFOR
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_SEMFOR Dialog-Frame
ON MOUSE-SELECT-CLICK OF FILL-IN_SEMFOR IN FRAME Dialog-Frame /* Spärr ATK */
DO:
   IF INPUT FILL-IN_SEMFOR = TRUE THEN FILL-IN_SEMFOR = FALSE.
   IF INPUT FILL-IN_SEMFOR = FALSE THEN FILL-IN_SEMFOR = TRUE.
   DISPLAY FILL-IN_SEMFOR WITH FRAME {&FRAME-NAME}.  
   IF FILL-IN_SEMFOR = TRUE THEN  FILL-IN_LONVATK:HIDDEN                    = FALSE.
   ELSE DO:
      FILL-IN_LONVATK = FALSE.
      FILL-IN_LONVATK:HIDDEN                    = TRUE.
   END.   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_TELEFON
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_TELEFON Dialog-Frame
ON LEAVE OF FILL-IN_TELEFON IN FRAME Dialog-Frame /* Telefon */
DO:
    ASSIGN FILL-IN_TELEFON = INPUT FILL-IN_TELEFON.   
   FILL-IN_TELEFON = tabortblanka(FILL-IN_TELEFON ).
   DISPLAY FILL-IN_TELEFON WITH FRAME Dialog-Frame. 

END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_TELEFON2
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_TELEFON2 Dialog-Frame
ON LEAVE OF FILL-IN_TELEFON2 IN FRAME Dialog-Frame /* Telefon2 */
DO:
   ASSIGN FILL-IN_TELEFON2 = INPUT FILL-IN_TELEFON2.
   FILL-IN_TELEFON2 = tabortblanka(FILL-IN_TELEFON2).
   DISPLAY FILL-IN_TELEFON2 WITH FRAME Dialog-Frame. 

END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_TELEFONSEM
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_TELEFONSEM Dialog-Frame
ON LEAVE OF FILL-IN_TELEFONSEM IN FRAME Dialog-Frame /* Semestertele */
DO:
   ASSIGN FILL-IN_TELEFONSEM = INPUT FILL-IN_TELEFONSEM.
   FILL-IN_TELEFONSEM = tabortblanka(FILL-IN_TELEFONSEM ).
   DISPLAY FILL-IN_TELEFONSEM WITH FRAME Dialog-Frame. 

END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN_TIDSGODK
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_TIDSGODK Dialog-Frame
ON ENTRY OF FILL-IN_TIDSGODK IN FRAME Dialog-Frame /* Godkänner tid */
DO:   
   
   ENABLE BRW_GODK WITH FRAME {&FRAME-NAME}.
   
   FIND FIRST godkannartemp WHERE 
   godkannartemp.PERSONALKOD = FILL-IN_TIDSGODK 
   NO-LOCK NO-ERROR.   

   IF NOT AVAILABLE godkannartemp THEN DO:
      GET FIRST BRW_GODK.
      
   END.
   IF AVAILABLE godkannartemp THEN DO:
      RUN setlastrowid_UI IN brwproc[{&RIGHT-BROWSE}] (INPUT ROWID(godkannartemp)).
      RUN lastselectdyn_UI IN brwproc[{&RIGHT-BROWSE}].         
   END.             
   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN_TIDSGODK Dialog-Frame
ON LEAVE OF FILL-IN_TIDSGODK IN FRAME Dialog-Frame /* Godkänner tid */
DO:
   ASSIGN FILL-IN_TIDSGODK = INPUT FILL-IN_TIDSGODK.      
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME RAD_PERS
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL RAD_PERS Dialog-Frame
ON VALUE-CHANGED OF RAD_PERS IN FRAME Dialog-Frame
DO:
   RAD_PERS = INPUT RAD_PERS.
   RUN goma_UI.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&UNDEFINE SELF-NAME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CUSTOM _MAIN-BLOCK Dialog-Frame 


/* ***************************  Main Block  *************************** */

/* Parent the dialog-box to the ACTIVE-WINDOW, if there is no parent.   */
IF VALID-HANDLE(ACTIVE-WINDOW) AND FRAME {&FRAME-NAME}:PARENT eq ?
THEN FRAME {&FRAME-NAME}:PARENT = ACTIVE-WINDOW.


/* Now enable the interface and wait for the exit condition.            */
/* (NOTE: handle ERROR and END-KEY so cleanup code will always fire.    */
MAIN-BLOCK:
DO ON ERROR   UNDO MAIN-BLOCK, LEAVE MAIN-BLOCK
   ON END-KEY UNDO MAIN-BLOCK, LEAVE MAIN-BLOCK:
   
   {DIA_M_START.I}
   {muswait.i}
   {ALLSTARTDYN.I}
   RUN ladda_UI.
   IF varforetypval[46] = 1 THEN DO:     
      RUN hfaktor IN asfaktapph (INPUT pkod, OUTPUT avkfaktor, OUTPUT sefaktor).   
      IF avkfaktor > 0 THEN DO:
         ASSIGN FILL-IN-AKFAKTOR = avkfaktor.
      END.
      IF sefaktor > 0 THEN DO:
         ASSIGN FILL-IN-SFAKTOR = avkfaktor.
      END.
   END.
   IF Guru.Konstanter:globforetag = "gkal" OR Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "MISV" OR Guru.Konstanter:globforetag = "elpa" THEN DO:   
      RUN hdispens IN asfaktapph (INPUT pkod, OUTPUT dispens, OUTPUT dardatum, OUTPUT dargodk).         
      ASSIGN FILL-IN-DISPENS = dispens.
      RUN hdispensm IN asfaktapph (INPUT pkod, OUTPUT dispensm, OUTPUT dmandatum, OUTPUT dmangodk).         
      ASSIGN FILL-IN-DISPENSM = dispensm.            
   END.
   IF Guru.Konstanter:globforetag = "MISV"  THEN DO:   
      RUN hdispens48 IN asfaktapph (INPUT pkod, OUTPUT dispens48, OUTPUT d48datum, OUTPUT d48godk).         
      ASSIGN FILL-IN-DISPENS48 = dispens48.                  
   END.
   
   IF Guru.Konstanter:globforetag = "gkal" OR Guru.Konstanter:globforetag = "elpa" THEN DO:   
      RUN spfrisk IN asfaktapph (INPUT pkod, OUTPUT spafr).         
      ASSIGN FILL-IN-SPARRFR = spafr.            
   END.
   IF Guru.Konstanter:globforetag = "gkal" OR  Guru.Konstanter:globforetag = "Csund" OR Guru.Konstanter:globforetag = "elpa" THEN DO:   
      RUN fortro IN asfaktapph (INPUT pkod, OUTPUT ftro).         
      ASSIGN FILL-IN_FORTRO = ftro.            
   END.
   
   IF Guru.Konstanter:globforetag = "gkal" OR Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "MISV" OR Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "elpa" THEN DO:   
      RUN havafor IN asfaktapph (INPUT pkod, OUTPUT avarfor).         
      ASSIGN FILL-IN-AVAFOR = avarfor.            
   END.
   IF Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "GKAL" OR Guru.Konstanter:globforetag = "elpa" THEN DO:   
      RUN lakdispens IN asfaktapph (INPUT pkod, OUTPUT lakdispens).         
      ASSIGN FILL-IN-DISPELAK = lakdispens.            
   END.
   /*IF Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "MISV" OR Guru.Konstanter:globforetag = "GKAL" OR Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "elpa" THEN DO:   
      FILL-IN_SEMFOR:LABEL = "Spärr arbförk".     
   END.*/
   IF Guru.Konstanter:globforetag = "MISV"  THEN DO:  
      FILL-IN-DISPENS:LABEL = " Tillåt > 200 tim/år ÖV".     
   END.
      
   IF Guru.Konstanter:globforetag = "GKAL"  THEN DO:   
      RUN lonvaxatk IN asfaktapph (INPUT pkod, OUTPUT lonvaxatk).         
      ASSIGN FILL-IN_LONVATK = lonvaxatk.            
   END.

   RUN enable_UI.
 
   RUN vdis_UI.
   RAD_PERS = 1.
   APPLY "VALUE-CHANGED" TO RAD_PERS.
   IF varifran = 1 THEN musz = musz.
   ELSE DO: 
      DISABLE FILL-IN_PERSONALKOD CMB_VECKO WITH FRAME {&FRAME-NAME}.
   END.
   IF varifran = 0 THEN DO:    
      /*enbart visning av uppgifter*/
      DISABLE FILL-IN_FORNAMN FILL-IN_EFTERNAMN FILL-IN_ANSTNR FILL-IN_PERSONNUMMER FILL-IN_TIDSGODK CMB_OMR BRW_GODK WITH FRAME {&FRAME-NAME}.         
   END.
   /*EJTIDFOR*/
   IF varforetypval[2] = 1 AND varifran = 0 THEN DO:
      BTN_OK:HIDDEN = TRUE.
   END.
   
   {FRMSIZED.I}
   {musarrow.i}   
   {DIA_M_SLUT.I}
   WAIT-FOR GO OF FRAME {&FRAME-NAME}.
END.
RUN disable_UI.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


/* **********************  Internal Procedures  *********************** */

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE allstartbrw_UI Dialog-Frame 
PROCEDURE allstartbrw_UI :
/* -----------------------------------------------------------
  Purpose: Changing screen-value for combo-box CMB_OMR     
  Parameters:  Input = Screen-value for CMB_FOR
  Notes:       
-------------------------------------------------------------*/    
   ASSIGN
   /*ansvarigtemp.PERSONALKOD:READ-ONLY IN BROWSE BRW_ANSV = TRUE    */
   godkannartemp.PERSONALKOD:READ-ONLY IN BROWSE BRW_GODK = TRUE.
   /*RUN DYNBRW.P PERSISTENT SET brwproc[{&LEFT-BROWSE}] 
      (INPUT BRW_ANSV:HANDLE IN FRAME {&FRAME-NAME}).*/
   RUN DYNBRW.P PERSISTENT SET brwproc[{&RIGHT-BROWSE}] 
      (INPUT BRW_GODK:HANDLE IN FRAME {&FRAME-NAME}).       
   IF Guru.Konstanter:appcon THEN DO:
      IF varforetypval[27] = 0 THEN RUN ASFAKTAPP.P PERSISTENT SET asfaktapph ON Guru.Konstanter:apphand TRANSACTION DISTINCT. 
   END.
   ELSE DO:      
      IF varforetypval[27] = 0 THEN RUN ASFAKTAPP.P PERSISTENT SET asfaktapph.
   END.   
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE btnok_UI Dialog-Frame 
PROCEDURE btnok_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   ASSIGN
   CMB_OMR = INPUT FRAME {&FRAME-NAME} CMB_OMR
   CMB_ORGCHEF = INPUT CMB_ORGCHEF
   FILL-IN_ANSTNR = INPUT FILL-IN_ANSTNR
   /*FILL-IN_ANSVARIGTIDR = INPUT FILL-IN_ANSVARIGTIDR*/
   FILL-IN_BOXEN = INPUT FILL-IN_BOXEN
   FILL-IN_EFTERNAMN = INPUT FILL-IN_EFTERNAMN
   FILL-IN_FORNAMN = INPUT FILL-IN_FORNAMN
   FILL-IN_GATUADRESS = INPUT FILL-IN_GATUADRESS
   FILL-IN_MOBILRADIO = INPUT FILL-IN_MOBILRADIO
   FILL-IN_MOBILTEL = INPUT FILL-IN_MOBILTEL
   FILL-IN_PERSONALKOD = INPUT FILL-IN_PERSONALKOD   
   FILL-IN_PERSONSOK = INPUT FILL-IN_PERSONSOK
   FILL-IN_EPOST = INPUT FILL-IN_EPOST
   FILL-IN_POSTADRESS = INPUT FILL-IN_POSTADRESS
   FILL-IN_POSTNUMMER = INPUT FILL-IN_POSTNUMMER
   FILL-IN_TELEFON = INPUT FILL-IN_TELEFON
   FILL-IN_TELEFON2 = INPUT FILL-IN_TELEFON2
   FILL-IN_TELEFONSEM = INPUT FILL-IN_TELEFONSEM
   FILL-IN_TIDSGODK = INPUT FILL-IN_TIDSGODK
   FILL-IN_AKTIV = INPUT FILL-IN_AKTIV
   FILL-IN_DELTID = INPUT FILL-IN_DELTID   
   FILL-IN_FLEXTID = INPUT FILL-IN_FLEXTID
   FILL-IN-AKFAKTOR = INPUT FILL-IN-AKFAKTOR   
   FILL-IN-SFAKTOR = INPUT FILL-IN-SFAKTOR
   FILL-IN_PERSONNUMMER = INPUT FILL-IN_PERSONNUMMER
   FILL-IN-DISPENS = INPUT FILL-IN-DISPENS
   FILL-IN-DISPENSM = INPUT FILL-IN-DISPENSM
   FILL-IN-DISPENS48 = INPUT FILL-IN-DISPENS48
   FILL-IN-DISPELAK = INPUT FILL-IN-DISPELAK
   FILL-IN-AVAFOR = INPUT FILL-IN-AVAFOR
   FILL-IN-SPARRFR = INPUT FILL-IN-SPARRFR
   FILL-IN_FORTRO = INPUT FILL-IN_FORTRO
   FILL-IN_LONVATK = INPUT FILL-IN_LONVATK.
   FIND FIRST omrtemp WHERE omrtemp.NAMN = CMB_OMR USE-INDEX OMRNAMN NO-LOCK.
   FIND FIRST valperstemp WHERE valperstemp.PERSONALKOD = FILL-IN_PERSONALKOD NO-ERROR.
   IF NOT AVAILABLE valperstemp THEN CREATE valperstemp.
   ASSIGN                     
   valperstemp.ORGCHEF       = CMB_ORGCHEF
   valperstemp.OMRADE        = omrtemp.OMRADE
   valperstemp.AKTIV         = FILL-IN_AKTIV         
   valperstemp.DELTID        = FILL-IN_DELTID        
   valperstemp.ANSTNR        = FILL-IN_ANSTNR        
   /*valperstemp.ANSVARIGTIDR  = FILL-IN_ANSVARIGTIDR  */
   valperstemp.BOXEN         = FILL-IN_BOXEN         
   valperstemp.EFTERNAMN     = FILL-IN_EFTERNAMN     
   valperstemp.FORNAMN       = FILL-IN_FORNAMN       
   valperstemp.GATUADRESS    = FILL-IN_GATUADRESS    
   valperstemp.MOBILRADIO    = FILL-IN_MOBILRADIO    
   valperstemp.MOBILTEL      = FILL-IN_MOBILTEL      
   valperstemp.PERSONALKOD   = FILL-IN_PERSONALKOD   
   valperstemp.PERSONNUMMER  = FILL-IN_PERSONNUMMER  
   valperstemp.PERSONSOK = ""
   SUBSTRING(valperstemp.PERSONSOK,1,19) = FILL-IN_PERSONSOK     
   SUBSTRING(valperstemp.PERSONSOK,20) = FILL-IN_EPOST
   valperstemp.POSTADRESS    = FILL-IN_POSTADRESS    
   valperstemp.POSTNUMMER    = FILL-IN_POSTNUMMER    
   valperstemp.TELEFON       = FILL-IN_TELEFON       
   valperstemp.TELEFON2      = FILL-IN_TELEFON2      
   valperstemp.TELEFONSEM    = FILL-IN_TELEFONSEM    
   valperstemp.TIDSGODK      = FILL-IN_TIDSGODK      
   valperstemp.LAGBAS        = FILL-IN_LAGBAS        
   valperstemp.OVERTIDUTTAG  = FILL-IN_OVERTIDUTTAG .
   IF      FILL-IN_SEMFOR = FALSE THEN valperstemp.OMREGTID = 0.
   ELSE IF FILL-IN_SEMFOR = TRUE  THEN valperstemp.OMREGTID = 1.
   ASSIGN 
   CMB_VECKO = INPUT FRAME {&FRAME-NAME} CMB_VECKO  
   CMB_TRA   = INPUT CMB_TRA 
   CMB_ANST  = INPUT CMB_ANST
   CMB_BEF   = INPUT CMB_BEF
   CMB_BEF2   = INPUT CMB_BEF2
   CMB_OVERUT   = INPUT CMB_OVERUT
   CMB_BER   = INPUT CMB_BER.
   
  
   IF CMB_OVERUT = "Komp" THEN valperstemp.OVERTIDUTTAG = "K" .
   IF CMB_OVERUT = "Över" THEN valperstemp.OVERTIDUTTAG = "Ö" .
   IF CMB_OVERUT = "Flex" THEN valperstemp.OVERTIDUTTAG = "F" . 
   IF CMB_OVERUT = "Ejöv" THEN valperstemp.OVERTIDUTTAG = "I" .
   
   IF Guru.Konstanter:globforetag = "ESAN" AND CMB_OVERUT = "Komb" THEN valperstemp.OVERTIDUTTAG = "L".
   ELSE IF CMB_OVERUT = "Ledi" THEN valperstemp.OVERTIDUTTAG = "L".  
   FOR EACH valperskolltemp:
      DELETE valperskolltemp.
   END.
   CREATE valperskolltemp.
   BUFFER-COPY valperstemp TO valperskolltemp.
   FOR EACH valsoktemp:
      DELETE valsoktemp.
   END.   
   IF Guru.Konstanter:globforetag = "cELPA" OR Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "MISV" THEN DO: 
      ASSIGN 
      CMB_FAVTAL = INPUT CMB_FAVTAL.
      /*IF CMB_FAVTAL = "Sundsvall Elnät" THEN FILL-IN-FAVTAL = "TE".
      IF CMB_FAVTAL = "Sundsvall kollektiv Elnät" THEN FILL-IN-FAVTAL = "K".*/
      IF CMB_FAVTAL = "8-17" THEN FILL-IN-FAVTAL = "TE".
      IF CMB_FAVTAL = "7-16" THEN FILL-IN-FAVTAL = "K".
      IF CMB_FAVTAL = "Sundsvall kollektiv Vatten" THEN FILL-IN-FAVTAL = "KV".
      IF CMB_FAVTAL = "Sundsvall Övriga" THEN FILL-IN-FAVTAL = "T".         
      IF CMB_FAVTAL = "Korsta" THEN FILL-IN-FAVTAL = "TU".         
   END.
   ELSE FILL-IN-FAVTAL = "T".
   
   IF FILL-IN_FORTRO = TRUE AND  FILL-IN_FLEXTID = TRUE THEN DO:
      MESSAGE "Förtroendetid går inte att ha om man har flexavtal." VIEW-AS ALERT-BOX.      
      musz = TRUE.
      RETURN.
   END.       
   IF FILL-IN_FORTRO = TRUE AND  CMB_OVERUT NE "Ejöv" THEN DO:
      MESSAGE "Förtroendetid går inte att ha om man har övertidsavtal." VIEW-AS ALERT-BOX.      
      musz = TRUE.
      RETURN.
   END.    
   IF varforetypval[27] = 0 THEN DO:
      CREATE valsoktemp.
      ASSIGN
      valsoktemp.SOKVAL = 1
      valsoktemp.SOKINT[1]  =  CMB_VECKO 
      valsoktemp.SOKCHAR[1] =  CMB_TRA  
      valsoktemp.SOKCHAR[2] = CMB_ANST 
      valsoktemp.SOKCHAR[3] = CMB_BEF  
      valsoktemp.SOKCHAR[4] = CMB_BER.
   END.   
   /*IF Guru.Konstanter:globforetag = "LULE" THEN DO: 
      ASSIGN
      valsoktemp.SOKCHAR[3] = CMB_BEF2.  
   END.*/
   IF varforetypval[2] = 1 THEN.
   ELSE DO:
      IF pkod NE "" THEN DO:
         IF spomr NE valperstemp.OMRADE THEN DO:
            RUN bytbolag IN asfaktapph (INPUT FILL-IN_PERSONALKOD,INPUT valperstemp.OMRADE,INPUT spomr,OUTPUT judbyt, OUTPUT finnstid).
            IF judbyt = TRUE AND finnstid = TRUE THEN DO:
               MESSAGE "Du byter bolag på denna person. Personen har tid skriven som ännu ej är körd till ekonomi och lön."  SKIP  
                       "Denna tid kommer att gå över på det nya bolaget. Kontrollera att debiteringspriserna för tidregistreringarna har rätt pris vid brytningen."
               VIEW-AS ALERT-BOX.
            END.   
         END.
      END.
   END.            
   
   IF varforetypval[27] = 0 THEN DO:
      CREATE valsoktemp.
      ASSIGN
      valsoktemp.SOKVAL = 11
      valsoktemp.SOKLOG[1]  =  FILL-IN_FLEXTID  
      valsoktemp.SOKCHAR[1] =  FILL-IN-FAVTAL.
      CREATE valsoktemp.
      ASSIGN
      valsoktemp.SOKVAL = 2
      valsoktemp.SOKCHAR[1] = ansvgamla
      valsoktemp.SOKCHAR[2] = tidggamla
      valsoktemp.SOKCHAR[3] = Guru.Konstanter:globanv
      valsoktemp.SOKINT[3] = Guru.Konstanter:globniv.
   END.
   IF varforetypval[27] = 1 THEN DO:
      IF Guru.Konstanter:appcon THEN DO:      
         RUN PERSUPP2.P ON Guru.Konstanter:apphand TRANSACTION DISTINCT 
         (INPUT 2,INPUT pkod,INPUT TABLE valperskolltemp,INPUT-OUTPUT TABLE valsoktemp,OUTPUT TABLE felmeddtemp).
      END.
      ELSE DO:
         RUN PERSUPP2.P 
         (INPUT 2,INPUT pkod,INPUT TABLE valperskolltemp,INPUT-OUTPUT TABLE valsoktemp,OUTPUT TABLE felmeddtemp).
      END.
   END. 
   ELSE DO:   
      IF Guru.Konstanter:appcon THEN DO:      
         RUN PERSUPP.P ON Guru.Konstanter:apphand TRANSACTION DISTINCT 
         (INPUT 2,INPUT pkod,INPUT TABLE valperskolltemp,INPUT-OUTPUT TABLE valsoktemp,OUTPUT TABLE felmeddtemp).
      END.
      ELSE DO:
         RUN PERSUPP.P 
         (INPUT 2,INPUT pkod,INPUT TABLE valperskolltemp,INPUT-OUTPUT TABLE valsoktemp,OUTPUT TABLE felmeddtemp).
      END.
   END.   
   FOR EACH felmeddtemp:
      MESSAGE felmeddtemp.FELMEDD VIEW-AS ALERT-BOX.
      DELETE felmeddtemp.
      musz = TRUE.
      RETURN.
   END.
   IF varforetypval[46] = 1 THEN DO:     
      RUN sphfaktor IN asfaktapph (INPUT FILL-IN_PERSONALKOD, INPUT FILL-IN-AKFAKTOR, INPUT FILL-IN-SFAKTOR).   
   END.
   IF Guru.Konstanter:globforetag = "gkal" OR Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "MISV" OR Guru.Konstanter:globforetag = "elpa" THEN DO:   
      IF FILL-IN-DISPENS = FALSE THEN RUN bortdispens IN asfaktapph (INPUT FILL-IN_PERSONALKOD).   
      ELSE RUN spdispens IN asfaktapph (INPUT FILL-IN_PERSONALKOD, INPUT FILL-IN-DISPENS, INPUT TODAY, INPUT Guru.Konstanter:globanv).
      IF FILL-IN-DISPENSM = FALSE THEN RUN bortdispensm IN asfaktapph (INPUT FILL-IN_PERSONALKOD).   
      ELSE RUN spdispensM IN asfaktapph (INPUT FILL-IN_PERSONALKOD, INPUT FILL-IN-DISPENSM, INPUT TODAY, INPUT Guru.Konstanter:globanv).   
   END.
   IF Guru.Konstanter:globforetag = "MISV"  THEN DO:   
      IF FILL-IN-DISPENS48 = FALSE THEN RUN bortdispens48 IN asfaktapph (INPUT FILL-IN_PERSONALKOD).   
      ELSE RUN spdispens48 IN asfaktapph (INPUT FILL-IN_PERSONALKOD, INPUT FILL-IN-DISPENS48, INPUT TODAY, INPUT Guru.Konstanter:globanv).         
   END.
   IF Guru.Konstanter:globforetag = "gkal" OR Guru.Konstanter:globforetag = "elpa" THEN DO:   
      IF FILL-IN-SPARRFR = FALSE THEN RUN bortspfr IN asfaktapph (INPUT FILL-IN_PERSONALKOD).   
      ELSE RUN spspfr IN asfaktapph (INPUT FILL-IN_PERSONALKOD, INPUT FILL-IN-SPARRFR).   
   END.
   IF Guru.Konstanter:globforetag = "GKAL" OR  Guru.Konstanter:globforetag = "CSUND" OR Guru.Konstanter:globforetag = "elpa" THEN DO:   
      IF FILL-IN_FORTRO = FALSE THEN RUN bortftro IN asfaktapph (INPUT FILL-IN_PERSONALKOD).   
      ELSE RUN spfortro IN asfaktapph (INPUT FILL-IN_PERSONALKOD, INPUT FILL-IN_FORTRO).   
   END.
   IF Guru.Konstanter:globforetag = "gkal" OR Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "MISV" OR Guru.Konstanter:globforetag = "elpa" THEN DO:      
      IF Guru.Konstanter:globforetag = "gkal" THEN foremaxarbkort = 63.
      ELSE IF Guru.Konstanter:globforetag = "SNAT" THEN foremaxarbkort = 63.
      ELSE IF Guru.Konstanter:globforetag = "LULE" THEN foremaxarbkort = 63.
      ELSE IF Guru.Konstanter:globforetag = "MISV" THEN foremaxarbkort = 27.
      ELSE foremaxarbkort = 54.     
      IF FILL-IN-AVAFOR = 0 OR FILL-IN-AVAFOR = foremaxarbkort THEN RUN bortavafor IN asfaktapph (INPUT FILL-IN_PERSONALKOD).   
      ELSE RUN spavafor IN asfaktapph (INPUT FILL-IN_PERSONALKOD, INPUT FILL-IN-AVAFOR).   
   END.
   
   IF Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "GKAL" OR Guru.Konstanter:globforetag = "elpa" THEN DO:   
      IF FILL-IN-DISPELAK = FALSE THEN RUN bortdispensla IN asfaktapph (INPUT FILL-IN_PERSONALKOD).   
      ELSE RUN spdispenslak IN asfaktapph (INPUT FILL-IN_PERSONALKOD, INPUT FILL-IN-DISPELAK).   
   END.
  
   IF  Guru.Konstanter:globforetag = "GKAL"  THEN DO:
      IF FILL-IN_SEMFOR = FALSE THEN FILL-IN_LONVATK = FALSE.   
      IF FILL-IN_LONVATK = FALSE THEN RUN bortlonvatk IN asfaktapph (INPUT FILL-IN_PERSONALKOD).   
      ELSE RUN splonvatk IN asfaktapph (INPUT FILL-IN_PERSONALKOD, INPUT FILL-IN_LONVATK).   
   END.
   
     
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE disable_UI Dialog-Frame  _DEFAULT-DISABLE
PROCEDURE disable_UI :
/*------------------------------------------------------------------------------
  Purpose:     DISABLE the User Interface
  Parameters:  <none>
  Notes:       Here we clean-up the user-interface by deleting
               dynamic widgets we have created and/or hide 
               frames.  This procedure is usually called when
               we are ready to "clean-up" after running.
------------------------------------------------------------------------------*/
  /* Hide all frames. */
  HIDE FRAME Dialog-Frame.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE enable_UI Dialog-Frame  _DEFAULT-ENABLE
PROCEDURE enable_UI :
/*------------------------------------------------------------------------------
  Purpose:     ENABLE the User Interface
  Parameters:  <none>
  Notes:       Here we display/view/enable the widgets in the
               user-interface.  In addition, OPEN all queries
               associated with each FRAME and BROWSE.
               These statements here are based on the "Other 
               Settings" section of the widget Property Sheets.
------------------------------------------------------------------------------*/
  DISPLAY FILL-IN-DISPELAK FILL-IN-DISPENS FILL-IN_PERSONALKOD FILL-IN_ANSTNR 
          FILL-IN_PERSONNUMMER FILL-IN_FORNAMN FILL-IN_EFTERNAMN CMB_OMR 
          RAD_PERS FILL-IN_GATUADRESS FILL-IN_TIDSGODK FILL-IN_AKTIV CMB_BEF2 
          CMB_BEF FILL-IN_BOXEN CMB_ORGCHEF CMB_OVERUT CMB_ANST 
          FILL-IN_POSTNUMMER FILL-IN_POSTADRESS FILL-IN_TELEFON FILL-IN_MOBILTEL 
          FILL-IN_EPOST FILL-IN_PERSONSOK FILL-IN_TELEFON2 FILL-IN_MOBILRADIO 
          FILL-IN_TELEFONSEM CMB_TRA CMB_BER FILL-IN_DELTID FILL-IN_FLEXTID 
          FILL-IN_SEMFOR FILL-IN_LAGBAS FILL-IN-AKFAKTOR FILL-IN-SFAKTOR 
          FILL-IN-AVAFOR FILL-IN-SPARRFR FILL-IN_FORTRO FILL-IN-DISPENSM 
          FILL-IN-DISPENS48 FILL-IN_LONVATK 
      WITH FRAME Dialog-Frame.
  ENABLE FILL-IN-DISPELAK FILL-IN-DISPENS FILL-IN_PERSONALKOD FILL-IN_ANSTNR 
         FILL-IN_PERSONNUMMER FILL-IN_FORNAMN FILL-IN_EFTERNAMN CMB_OMR 
         RAD_PERS CMB_VECKO FILL-IN_GATUADRESS FILL-IN_TIDSGODK FILL-IN_AKTIV 
         BRW_GODK CMB_BEF2 FILL-IN-MAN FILL-IN-TIS FILL-IN-ONS FILL-IN-TOR 
         FILL-IN-FRE FILL-IN-LOR FILL-IN-SON FILL-IN-TOT CMB_BEF FILL-IN_BOXEN 
         CMB_ORGCHEF CMB_OVERUT FILL-IN-DSCH1 FILL-IN-DSCH2 FILL-IN-DSCH3 
         FILL-IN-DSCH4 FILL-IN-DSCH5 FILL-IN-DSCH6 FILL-IN-DSCH7 FILL-IN-TOTV 
         CMB_ANST FILL-IN_POSTNUMMER FILL-IN_POSTADRESS FILL-IN-BORJ1 
         FILL-IN-BORJ2 FILL-IN-BORJ3 FILL-IN-BORJ4 FILL-IN-BORJ5 FILL-IN-BORJ6 
         FILL-IN-BORJ7 FILL-IN_TELEFON FILL-IN_MOBILTEL FILL-IN_EPOST 
         FILL-IN_PERSONSOK FILL-IN_TELEFON2 FILL-IN_MOBILRADIO 
         FILL-IN_TELEFONSEM CMB_TRA FILL-IN-SLU1 FILL-IN-SLU2 FILL-IN-SLU3 
         FILL-IN-SLU4 FILL-IN-SLU5 FILL-IN-SLU6 FILL-IN-SLU7 CMB_BER 
         FILL-IN-TIM1 FILL-IN-TIM2 FILL-IN-TIM3 FILL-IN-TIM4 FILL-IN-TIM5 
         FILL-IN-TIM6 FILL-IN-TIM7 FILL-IN_DELTID FILL-IN_FLEXTID CMB_FAVTAL 
         FILL-IN_SEMFOR FILL-IN_LAGBAS FILL-IN-AKFAKTOR FILL-IN-SFAKTOR BTN_OK 
         Btn_AVB FILL-IN-AVAFOR FILL-IN-SPARRFR FILL-IN_FORTRO FILL-IN-DISPENSM 
         FILL-IN-DISPENS48 FILL-IN_LONVATK 
      WITH FRAME Dialog-Frame.
  {&OPEN-BROWSERS-IN-QUERY-Dialog-Frame}
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE goma_UI Dialog-Frame 
PROCEDURE goma_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/                                 
   /*BRW_ANSV:HIDDEN IN FRAME {&FRAME-NAME} = TRUE */
   ASSIGN 
   BRW_GODK:HIDDEN IN FRAME {&FRAME-NAME} = TRUE
   CMB_OVERUT:HIDDEN                      = TRUE
   CMB_ANST:HIDDEN                        = TRUE
   CMB_BEF:HIDDEN                         = TRUE
   CMB_BEF2:HIDDEN                        = TRUE
   CMB_BER:HIDDEN                         = TRUE
   CMB_FAVTAL:HIDDEN                      = TRUE   
   CMB_TRA:HIDDEN                         = TRUE
   CMB_ORGCHEF:HIDDEN                     = TRUE
   CMB_VECKO:HIDDEN                       = TRUE
   FILL-IN-BORJ1:HIDDEN                   = TRUE
   FILL-IN-BORJ2:HIDDEN                   = TRUE
   FILL-IN-BORJ3:HIDDEN                   = TRUE
   FILL-IN-BORJ4:HIDDEN                   = TRUE
   FILL-IN-BORJ5:HIDDEN                   = TRUE
   FILL-IN-BORJ6:HIDDEN                   = TRUE
   FILL-IN-BORJ7:HIDDEN                   = TRUE
   FILL-IN-DSCH1:HIDDEN                   = TRUE
   FILL-IN-DSCH2:HIDDEN                   = TRUE
   FILL-IN-DSCH3:HIDDEN                   = TRUE
   FILL-IN-DSCH4:HIDDEN                   = TRUE
   FILL-IN-DSCH5:HIDDEN                   = TRUE
   FILL-IN-DSCH6:HIDDEN                   = TRUE
   FILL-IN-DSCH7:HIDDEN                   = TRUE
   FILL-IN-FRE:HIDDEN                     = TRUE
   FILL-IN-LOR:HIDDEN                     = TRUE
   FILL-IN-MAN:HIDDEN                     = TRUE
   FILL-IN-ONS:HIDDEN                     = TRUE
   FILL-IN-SLU1:HIDDEN                    = TRUE
   FILL-IN-SLU2:HIDDEN                    = TRUE
   FILL-IN-SLU3:HIDDEN                    = TRUE
   FILL-IN-SLU4:HIDDEN                    = TRUE
   FILL-IN-SLU5:HIDDEN                    = TRUE
   FILL-IN-SLU6:HIDDEN                    = TRUE
   FILL-IN-SLU7:HIDDEN                    = TRUE
   FILL-IN-SON:HIDDEN                     = TRUE
   FILL-IN-TIM1:HIDDEN                    = TRUE
   FILL-IN-TIM2:HIDDEN                    = TRUE
   FILL-IN-TIM3:HIDDEN                    = TRUE
   FILL-IN-TIM4:HIDDEN                    = TRUE
   FILL-IN-TIM5:HIDDEN                    = TRUE
   FILL-IN-TIM6:HIDDEN                    = TRUE
   FILL-IN-TIM7:HIDDEN                    = TRUE
   FILL-IN-TIS:HIDDEN                     = TRUE
   FILL-IN-TOR:HIDDEN                     = TRUE
   FILL-IN-TOT:HIDDEN                     = TRUE
   FILL-IN-TOTV:HIDDEN                    = TRUE
   FILL-IN_AKTIV:HIDDEN                          = TRUE
   FILL-IN_DELTID:HIDDEN                         = TRUE
   FILL-IN_FLEXTID:HIDDEN                        = TRUE
   FILL-IN-AKFAKTOR:HIDDEN                        = TRUE
   FILL-IN-SFAKTOR:HIDDEN                        = TRUE
   FILL-IN-DISPENS:HIDDEN                        = TRUE
   FILL-IN-DISPENSM:HIDDEN                        = TRUE
   FILL-IN-DISPENS48:HIDDEN                        = TRUe
   FILL-IN-DISPELAK:HIDDEN                        = TRUE
   FILL-IN-AVAFOR:HIDDEN                        = TRUE
   FILL-IN-SPARRFR:HIDDEN                        = TRUE
   FILL-IN_FORTRO:HIDDEN                        = TRUE
   /*FILL-IN_ANSVARIGTIDR:HIDDEN                   = TRUE*/
   FILL-IN_BOXEN:HIDDEN                          = TRUE
   FILL-IN_GATUADRESS:HIDDEN                     = TRUE
   FILL-IN_LAGBAS:HIDDEN                         = TRUE
   FILL-IN_MOBILRADIO :HIDDEN                    = TRUE
   FILL-IN_MOBILTEL:HIDDEN                       = TRUE
   FILL-IN_PERSONSOK:HIDDEN                      = TRUE
   FILL-IN_EPOST:HIDDEN                      = TRUE
   FILL-IN_POSTADRESS:HIDDEN                     = TRUE
   FILL-IN_POSTNUMMER:HIDDEN                     = TRUE
   FILL-IN_SEMFOR:HIDDEN                         = TRUE
   FILL-IN_LONVATK:HIDDEN                         = TRUE
   FILL-IN_TELEFON:HIDDEN                        = TRUE
   FILL-IN_TELEFON2:HIDDEN                       = TRUE
   FILL-IN_TELEFONSEM:HIDDEN                     = TRUE
   FILL-IN_TIDSGODK:HIDDEN                       = TRUE.
   IF RAD_PERS = 1 THEN DO:
      ASSIGN
      FILL-IN_BOXEN:HIDDEN                          = FALSE
      FILL-IN_GATUADRESS:HIDDEN                     = FALSE
      FILL-IN_MOBILRADIO:HIDDEN                     = FALSE
      FILL-IN_MOBILTEL:HIDDEN                       = FALSE
      FILL-IN_PERSONSOK:HIDDEN                      = FALSE
      FILL-IN_EPOST:HIDDEN                          = FALSE
      FILL-IN_POSTADRESS:HIDDEN                     = FALSE
      FILL-IN_POSTNUMMER:HIDDEN                     = FALSE
      FILL-IN_TELEFON:HIDDEN                        = FALSE
      FILL-IN_TELEFON2:HIDDEN                       = FALSE
      FILL-IN_TELEFONSEM:HIDDEN                     = FALSE.    
      /*IF Guru.Konstanter:globforetag = "LULE" THEN DO:
         CMB_BEF2:HIDDEN                            = FALSE.
      END.*/
   END.
   ELSE IF RAD_PERS = 2 THEN DO:
      ASSIGN
      BRW_GODK:HIDDEN                               = FALSE
      /*BRW_ANSV:HIDDEN                               = FALSE */
      CMB_OVERUT:HIDDEN                             = FALSE
      /*FILL-IN_SEMFOR:HIDDEN                         = FALSE
      FILL-IN_LAGBAS:HIDDEN                         = FALSE*/
      /*FILL-IN_ANSVARIGTIDR:HIDDEN                   = FALSE*/
      FILL-IN_TIDSGODK:HIDDEN                       = FALSE.
      IF Guru.Konstanter:globforetag = "CELPA" THEN DO:
         ASSIGN
         FILL-IN_SEMFOR:HIDDEN = TRUE .
      END.
   END.
   ELSE IF RAD_PERS = 3 THEN DO:
      ASSIGN
      CMB_ANST:HIDDEN                            = FALSE
      CMB_BEF:HIDDEN                                = FALSE
      CMB_BER:HIDDEN                                = FALSE
      CMB_TRA:HIDDEN                                = FALSE
      FILL-IN_AKTIV:HIDDEN                          = FALSE
      FILL-IN_DELTID:HIDDEN                         = FALSE.
      IF Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "ELPA" THEN DO:
         CMB_ORGCHEF:HIDDEN                     = FALSE.
      END.
      IF varforetypval[46] = 1 THEN DO:      
         ASSIGN
         FILL-IN-AKFAKTOR:HIDDEN                    = FALSE
         FILL-IN-SFAKTOR:HIDDEN                     = FALSE.
      END.
      IF Guru.Konstanter:globforetag = "GKAL" OR Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "MISV" OR Guru.Konstanter:globforetag = "ELPA" THEN DO:
         ASSIGN
         FILL-IN-DISPENS:HIDDEN                    = FALSE.
         FILL-IN-DISPENSM:HIDDEN                    = FALSE.
         IF Guru.Konstanter:globforetag = "MISV"  THEN DO:
            FILL-IN-DISPENS48:HIDDEN                    = FALSE.
         END.            
      END.
      IF Guru.Konstanter:globforetag = "GKAL" OR Guru.Konstanter:globforetag = "ELPA" THEN DO:
         ASSIGN
         FILL-IN-SPARRFR:HIDDEN                    = FALSE.         
      END.
      IF Guru.Konstanter:globforetag = "cSUND" OR Guru.Konstanter:globforetag = "ELPA" THEN DO:
         ASSIGN
         FILL-IN_FORTRO:HIDDEN                    = FALSE.         
      END.
      IF Guru.Konstanter:globforetag = "GKAL" OR Guru.Konstanter:globforetag = "ELPA" THEN DO:
         /*ftro*/         
         FILL-IN_FORTRO:HIDDEN                    = FALSE.         
      END.
      
      IF Guru.Konstanter:globforetag = "GKAL" OR Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "MISV" OR Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "ELPA" THEN DO:
         ASSIGN
         FILL-IN-AVAFOR:HIDDEN                    = FALSE.         
      END.
      IF Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "GKAL"  OR Guru.Konstanter:globforetag = "ELPA" THEN DO:
         ASSIGN
         FILL-IN-DISPELAK:HIDDEN                    = FALSE.         
      END.
      IF Guru.Konstanter:globforetag = "ESMA" OR  Guru.Konstanter:globforetag = "ESAN" OR  Guru.Konstanter:globforetag = "ETA" OR 
      Guru.Konstanter:globforetag = "ELPA" OR Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "MISV" OR Guru.Konstanter:globforetag = "SUFL" OR 
      Guru.Konstanter:globforetag = "GKAL" OR Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "SKOK" THEN DO:
         ASSIGN
         FILL-IN_FLEXTID:HIDDEN = FALSE.
         ENABLE FILL-IN_FLEXTID WITH FRAME {&FRAME-NAME}.
         DISPLAY FILL-IN_FLEXTID WITH FRAME {&FRAME-NAME}.
      END.   
      IF Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "MISV" THEN DO:
         IF FILL-IN_FLEXTID = TRUE THEN DO:
            CMB_FAVTAL:HIDDEN = FALSE.
            ENABLE CMB_FAVTAL WITH FRAME {&FRAME-NAME}.
            DISPLAY CMB_FAVTAL WITH FRAME {&FRAME-NAME}.
         END.
      END.
      ASSIGN
      FILL-IN_SEMFOR:HIDDEN                         = FALSE.
      IF Guru.Konstanter:globforetag = "GKAL" THEN DO:
         /*LÖNEVÄXLING ATK*/
         IF FILL-IN_SEMFOR = TRUE THEN  FILL-IN_LONVATK:HIDDEN                    = FALSE.
         ELSE DO:
            FILL-IN_LONVATK = FALSE.
            FILL-IN_LONVATK:HIDDEN                    = TRUE.
         END.            
      END.        
      IF Guru.Konstanter:globforetag = "GRAN"  THEN DO:      
         FILL-IN_LAGBAS:HIDDEN                         = FALSE.
      END.
   END.
   ELSE IF RAD_PERS = 4 THEN DO:
      ASSIGN   
      CMB_VECKO:HIDDEN                               = FALSE
      FILL-IN-BORJ1:HIDDEN                           = FALSE
      FILL-IN-BORJ2:HIDDEN                           = FALSE
      FILL-IN-BORJ3:HIDDEN                           = FALSE
      FILL-IN-BORJ4:HIDDEN                           = FALSE
      FILL-IN-BORJ5:HIDDEN                           = FALSE
      FILL-IN-BORJ6:HIDDEN                           = FALSE
      FILL-IN-BORJ7:HIDDEN                           = FALSE
      FILL-IN-DSCH1:HIDDEN                           = FALSE
      FILL-IN-DSCH2:HIDDEN                           = FALSE
      FILL-IN-DSCH3:HIDDEN                           = FALSE
      FILL-IN-DSCH4:HIDDEN                           = FALSE
      FILL-IN-DSCH5:HIDDEN                           = FALSE
      FILL-IN-DSCH6:HIDDEN                           = FALSE
      FILL-IN-DSCH7:HIDDEN                           = FALSE
      FILL-IN-FRE:HIDDEN                             = FALSE
      FILL-IN-LOR:HIDDEN                             = FALSE
      FILL-IN-MAN:HIDDEN                             = FALSE
      FILL-IN-ONS:HIDDEN                             = FALSE
      FILL-IN-SLU1:HIDDEN                            = FALSE
      FILL-IN-SLU2:HIDDEN                            = FALSE
      FILL-IN-SLU3:HIDDEN                            = FALSE
      FILL-IN-SLU4:HIDDEN                            = FALSE
      FILL-IN-SLU5:HIDDEN                            = FALSE
      FILL-IN-SLU6:HIDDEN                            = FALSE
      FILL-IN-SLU7:HIDDEN                            = FALSE
      FILL-IN-SON:HIDDEN                             = FALSE
      FILL-IN-TIM1:HIDDEN                            = FALSE
      FILL-IN-TIM2:HIDDEN                            = FALSE
      FILL-IN-TIM3:HIDDEN                            = FALSE
      FILL-IN-TIM4:HIDDEN                            = FALSE
      FILL-IN-TIM5:HIDDEN                            = FALSE
      FILL-IN-TIM6:HIDDEN                            = FALSE
      FILL-IN-TIM7:HIDDEN                            = FALSE
      FILL-IN-TIS:HIDDEN                             = FALSE
      FILL-IN-TOR:HIDDEN                             = FALSE
      FILL-IN-TOT:HIDDEN                             = FALSE
      FILL-IN-TOTV:HIDDEN                            = FALSE.
   END.
   IF Guru.Konstanter:globforetag = "CELPA" THEN DO:
      ASSIGN
      FILL-IN_SEMFOR:HIDDEN = TRUE .
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE ladda_UI Dialog-Frame 
PROCEDURE ladda_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/ 
   /*EJTIDFOR*/
   
   IF varforetypval[2] = 1  THEN DO:
      RAD_PERS:DELETE("Tidskrivning") IN FRAME {&FRAME-NAME}.     
      RAD_PERS:DELETE("Avtal") IN FRAME {&FRAME-NAME}.
      RAD_PERS:DELETE("Arbetstider") IN FRAME {&FRAME-NAME}.
   END.
   ELSE IF varifran = 0 THEN DO:      
      RAD_PERS:DELETE("Avtal") IN FRAME {&FRAME-NAME}.
      RAD_PERS:DELETE("Arbetstider") IN FRAME {&FRAME-NAME}.            
   END.

   IF Guru.Konstanter:globforetag = "SUND" THEN DO:            
      status-ok = CMB_FAVTAL:ADD-LAST("Sundsvall Övriga") IN FRAME {&FRAME-NAME}.     
      status-ok = CMB_FAVTAL:ADD-LAST("Korsta") IN FRAME {&FRAME-NAME}.     
   END.
   IF Guru.Konstanter:globforetag = "SNAT" THEN DO:
      status-ok = CMB_FAVTAL:ADD-LAST("8-17") IN FRAME {&FRAME-NAME}.
      status-ok = CMB_FAVTAL:ADD-LAST("7-16") IN FRAME {&FRAME-NAME}.      
           
   END.
   IF Guru.Konstanter:globforetag = "MISV" THEN DO:      
      status-ok = CMB_FAVTAL:ADD-LAST("Sundsvall kollektiv Vatten") IN FRAME {&FRAME-NAME}.
      status-ok = CMB_FAVTAL:ADD-LAST("Sundsvall Övriga") IN FRAME {&FRAME-NAME}.           
   END.
      
   ASSIGN
   FILL-IN-MAN = "måndag"
   FILL-IN-TIS = "tisdag"
   FILL-IN-ONS = "onsdag"
   FILL-IN-TOR = "torsdag"
   FILL-IN-FRE = "fredag"
   FILL-IN-LOR = "lördag"
   FILL-IN-SON = "söndag"
   FILL-IN-TOT = "Tim/Veck".
   FOR EACH omrtemp USE-INDEX OMR NO-LOCK:
      status-ok = CMB_OMR:ADD-LAST(omrtemp.NAMN).
   END.       
   FIND FIRST omrtemp USE-INDEX OMR NO-LOCK NO-ERROR.   
   CMB_OMR:SCREEN-VALUE = omrtemp.NAMN.
   IF pkod NE "" THEN DO:
      FIND FIRST valperstemp WHERE valperstemp.PERSONALKOD = pkod NO-ERROR.
      ASSIGN
      FILL-IN_AKTIV = valperstemp.AKTIV
      FILL-IN_DELTID = valperstemp.DELTID
      FILL-IN_ANSTNR = valperstemp.ANSTNR
      /*FILL-IN_ANSVARIGTIDR = valperstemp.ANSVARIGTIDR*/
      FILL-IN_BOXEN = valperstemp.BOXEN
      FILL-IN_EFTERNAMN = valperstemp.EFTERNAMN
      FILL-IN_FORNAMN = valperstemp.FORNAMN
      FILL-IN_GATUADRESS = valperstemp.GATUADRESS
      FILL-IN_MOBILRADIO = valperstemp.MOBILRADIO
      FILL-IN_MOBILTEL = valperstemp.MOBILTEL
      FILL-IN_PERSONALKOD = valperstemp.PERSONALKOD
      FILL-IN_PERSONNUMMER = valperstemp.PERSONNUMMER
      FILL-IN_PERSONSOK = SUBSTRING(valperstemp.PERSONSOK,1,19)
      FILL-IN_EPOST = SUBSTRING(valperstemp.PERSONSOK,20)
      FILL-IN_POSTADRESS = valperstemp.POSTADRESS
      FILL-IN_POSTNUMMER = valperstemp.POSTNUMMER
      FILL-IN_TELEFON = valperstemp.TELEFON
      FILL-IN_TELEFON2 = valperstemp.TELEFON2
      FILL-IN_TELEFONSEM = valperstemp.TELEFONSEM
      FILL-IN_TIDSGODK = valperstemp.TIDSGODK
      FILL-IN_LAGBAS = valperstemp.LAGBAS
      FILL-IN_OVERTIDUTTAG = valperstemp.OVERTIDUTTAG.
      IF valperstemp.OMREGTID = 0 THEN FILL-IN_SEMFOR = FALSE.
      ELSE IF valperstemp.OMREGTID = 1 THEN FILL-IN_SEMFOR = TRUE.
      IF valperstemp.OVERTIDUTTAG = "K" THEN ASSIGN CMB_OVERUT:SCREEN-VALUE = "Komp".
      IF valperstemp.OVERTIDUTTAG = "Ö" THEN ASSIGN CMB_OVERUT:SCREEN-VALUE = "Över".
      IF valperstemp.OVERTIDUTTAG = "F" THEN ASSIGN CMB_OVERUT:SCREEN-VALUE = "Flex". 
      IF valperstemp.OVERTIDUTTAG = "I" THEN ASSIGN CMB_OVERUT:SCREEN-VALUE = "Ejöv".
      IF Guru.Konstanter:globforetag = "ESAN" AND valperstemp.OVERTIDUTTAG = "L" THEN ASSIGN CMB_OVERUT:SCREEN-VALUE = "Komb".
      ELSE IF valperstemp.OVERTIDUTTAG = "L" THEN ASSIGN CMB_OVERUT:SCREEN-VALUE = "Ledi".  
      CMB_OVERUT = INPUT CMB_OVERUT.
      /*ansvgamla = FILL-IN_ANSVARIGTIDR.*/
      tidggamla = FILL-IN_TIDSGODK.
      FIND FIRST omrtemp WHERE omrtemp.OMRADE = valperstemp.OMRADE 
      USE-INDEX OMR NO-LOCK NO-ERROR.
      IF AVAILABLE omrtemp THEN 
      ASSIGN  CMB_OMR:SCREEN-VALUE = omrtemp.NAMN.       
      spomr = valperstemp.OMRADE.
   END.
   IF Guru.Konstanter:globforetag = "LULE" OR Guru.Konstanter:globforetag = "ELPA" THEN DO:
     IF Guru.Konstanter:appcon THEN DO:      
         RUN RGRHMT.P ON Guru.Konstanter:apphand TRANSACTION DISTINCT 
         (INPUT Guru.Konstanter:globforetag,OUTPUT TABLE rgrtemp).
      END.
      ELSE DO:
         RUN RGRHMT.P 
         (INPUT Guru.Konstanter:globforetag,OUTPUT TABLE rgrtemp).
      END.
      FOR EACH rgrtemp:
         CMB_ORGCHEF:ADD-LAST(rgrtemp.RGR).      
      END.
      FIND FIRST rgrtemp WHERE NO-LOCK NO-ERROR.
      IF AVAILABLE rgrtemp THEN DO:
         CMB_ORGCHEF:SCREEN-VALUE = rgrtemp.RGR.
      END.
      IF AVAILABLE valperstemp THEN DO:
         IF valperstemp.ORGCHEF NE "" THEN CMB_ORGCHEF:SCREEN-VALUE = valperstemp.ORGCHEF NO-ERROR.         
      END.
   END.
   FOR EACH aavtaltemp:
      IF aavtaltemp.TYP = "BEF" THEN DO:
         status-ok = CMB_BEF:ADD-LAST(aavtaltemp.AVTALNAMN).      
         status-ok = CMB_BEF2:ADD-LAST(aavtaltemp.AVTALNAMN).      
         IF lopkollk[1] = FALSE THEN DO:
            lopkollk[1] = TRUE.            
            ASSIGN CMB_BEF:SCREEN-VALUE = aavtaltemp.AVTALNAMN. 
            ASSIGN CMB_BEF2:SCREEN-VALUE = aavtaltemp.AVTALNAMN. 
/*            MESSAGE "1" lopkollk[1] aavtaltemp.AVTALNAMN CMB_BEF:SCREEN-VALUE VIEW-AS ALERT-BOX.*/
         END.
         ELSE DO:
            /*MESSAGE "2F" lopkollk[1] aavtaltemp.AVTALNAMN CMB_BEF:SCREEN-VALUE VIEW-AS ALERT-BOX.            
            MESSAGE "2G" lopkollk[1] aavtaltemp.AVTALNAMN CMB_BEF:SCREEN-VALUE VIEW-AS ALERT-BOX.*/
            IF AVAILABLE valperstemp THEN DO:
               IF aavtaltemp.AVTALTYP = valperstemp.BEFATTNING THEN CMB_BEF:SCREEN-VALUE = aavtaltemp.AVTALNAMN. 
               IF aavtaltemp.AVTALTYP = valperstemp.BEFATTNING THEN CMB_BEF2:SCREEN-VALUE = aavtaltemp.AVTALNAMN. 
            END.
            ELSE DO:
              IF ( Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" ) AND aavtaltemp.AVTALNAMN = "Ej tid" THEN ASSIGN CMB_BEF:SCREEN-VALUE = "Ej tid". 
              IF Guru.Konstanter:globforetag = "MISV" AND aavtaltemp.AVTALNAMN = "Ej tid" THEN ASSIGN CMB_BEF:SCREEN-VALUE = "Ej tid". 
            END.
            /*MESSAGE "2E" lopkollk[1] valperstemp.BEFATTNING aavtaltemp.AVTALNAMN CMB_BEF:SCREEN-VALUE VIEW-AS ALERT-BOX.*/
         END.
      END.
      IF aavtaltemp.TYP = "BER" THEN DO:
         status-ok = CMB_BER:ADD-LAST(aavtaltemp.AVTALNAMN).
         IF lopkollk[2] = FALSE THEN DO:
            lopkollk[2] = TRUE.
            ASSIGN CMB_BER:SCREEN-VALUE = aavtaltemp.AVTALNAMN.
         END.
         ELSE DO:
            IF AVAILABLE valperstemp THEN DO:
              IF aavtaltemp.AVTALTYP = valperstemp.BEREDSKAPSAVTAL THEN CMB_BER:SCREEN-VALUE = aavtaltemp.AVTALNAMN.
            END.
         END.
      END.
      IF aavtaltemp.TYP = "TRA" THEN DO:
         status-ok = CMB_TRA:ADD-LAST(aavtaltemp.AVTALNAMN).
         IF lopkollk[3] = FALSE THEN DO:
            lopkollk[3] = TRUE.
            ASSIGN CMB_TRA:SCREEN-VALUE = aavtaltemp.AVTALNAMN.
         END.
         ELSE DO:
            IF AVAILABLE valperstemp THEN DO:
               IF aavtaltemp.AVTALTYP = valperstemp.TRAAVTAL THEN CMB_TRA:SCREEN-VALUE = aavtaltemp.AVTALNAMN.
            END.
         END.
      END.
      IF aavtaltemp.TYP = "ANS" THEN DO:
         status-ok = CMB_ANST:ADD-LAST(aavtaltemp.AVTALNAMN).
         IF lopkollk[4] = FALSE THEN DO:
            lopkollk[4] = TRUE.
            ASSIGN CMB_ANST:SCREEN-VALUE = aavtaltemp.AVTALNAMN.
         END.
         ELSE DO:
            IF AVAILABLE valperstemp THEN DO:
               IF aavtaltemp.AVTALTYP = valperstemp.ANSTALLNING THEN CMB_ANST:SCREEN-VALUE = aavtaltemp.AVTALNAMN.
            END.
         END.
      END.
      IF aavtaltemp.TYP = "VEC" THEN DO:
         status-ok = CMB_VECKO:ADD-LAST(aavtaltemp.AVTALNAMN).      
      END.
   END.
   status-ok = CMB_VECKO:DELETE("0") NO-ERROR.      
   IF (globforetag = "CELPA" OR Guru.Konstanter:globforetag = "cGRAN") THEN DO:
      FILL-IN_ANSTNR:LABEL = "Succel sign".     
   END.
   ELSE DO:
      FILL-IN_ANSTNR:LABEL = "Anställningsnr.".  
   END.
   IF (globforetag = "cELPA" OR Guru.Konstanter:globforetag = "VATT" ) THEN DO:
      FILL-IN_LAGBAS:LABEL = "Jour".     
   END.
   ELSE DO:
      FILL-IN_LAGBAS:LABEL = "Lagbas".  
   END.
   CMB_OMR:LABEL = Guru.Konstanter:gomrk.
   IF varforetypval[27] = 1 THEN.
   ELSE IF pkod NE "" THEN DO:
      {SOKSTART.I}
      ASSIGN
      soktemp.SOKVAL = 21
      soktemp.SOKINT[1] = 2
      soktemp.SOKCHAR[1] = pkod.      
      {SOKANROP.I}        
      IF (globforetag = "cELPA" OR Guru.Konstanter:globforetag = "GRAN"  OR 
      Guru.Konstanter:globforetag = "GRIT"   
      ) THEN DO:
         status-ok = CMB_OVERUT:DELETE("Ledi") IN FRAME {&FRAME-NAME}.
         IF soktemp.SOKCHAR[2] BEGINS "K" THEN DO:                                         
            status-ok = CMB_OVERUT:ADD-LAST("Ledi") IN FRAME {&FRAME-NAME}.
         END.  
         DISPLAY CMB_OVERUT WITH FRAME {&FRAME-NAME}.         
      END.
      IF (globforetag = "ELPA" OR Guru.Konstanter:globforetag = "ESAN") THEN DO:
         status-ok = CMB_OVERUT:DELETE("Komb") IN FRAME {&FRAME-NAME}.
         IF soktemp.SOKCHAR[2] = "TA" OR soktemp.SOKCHAR[2] = "TC" OR soktemp.SOKCHAR[2] = "TD" OR 
         soktemp.SOKCHAR[2] = "TF" OR soktemp.SOKCHAR[2] = "TG" OR soktemp.SOKCHAR[2] = "TJ" OR 
         soktemp.SOKCHAR[2] = "TK" OR soktemp.SOKCHAR[2] = "TL" OR soktemp.SOKCHAR[2] = "KA" OR 
         soktemp.SOKCHAR[2] = "KG" OR soktemp.SOKCHAR[2] = "KI" OR soktemp.SOKCHAR[2] = "KJ" OR 
         soktemp.SOKCHAR[2] = "KK" OR soktemp.SOKCHAR[2] = "KL" THEN DO:                                         
            status-ok = CMB_OVERUT:ADD-LAST("Komb") IN FRAME {&FRAME-NAME}.
         END.  
         DISPLAY CMB_OVERUT WITH FRAME {&FRAME-NAME}.         
      END.
   END.
   ELSE DO:
      IF (globforetag = "GRAN"  OR 
      Guru.Konstanter:globforetag = "GRIT"   
      ) THEN DO:
         status-ok = CMB_OVERUT:DELETE("Ledi") IN FRAME {&FRAME-NAME}.                                           
         status-ok = CMB_OVERUT:ADD-LAST("Ledi") IN FRAME {&FRAME-NAME}.     
      END.   
      IF Guru.Konstanter:globforetag = "ESAN" THEN DO:
         status-ok = CMB_OVERUT:DELETE("Komb") IN FRAME {&FRAME-NAME}.                                           
         status-ok = CMB_OVERUT:ADD-LAST("Komb") IN FRAME {&FRAME-NAME}.     
      END.
      CMB_OVERUT = INPUT CMB_OVERUT. 
      ASSIGN  CMB_OVERUT:SCREEN-VALUE = "Över".
   END.
   IF varforetypval[27] = 0 THEN DO:
      IF Guru.Konstanter:appcon THEN DO:      
         RUN PERSUPP.P ON Guru.Konstanter:apphand TRANSACTION DISTINCT 
         (INPUT 1,INPUT pkod,INPUT TABLE valperskolltemp,INPUT-OUTPUT TABLE valsoktemp,OUTPUT TABLE felmeddtemp).
      END.
      ELSE DO:
         RUN PERSUPP.P 
         (INPUT 1,INPUT pkod,INPUT TABLE valperskolltemp,INPUT-OUTPUT TABLE valsoktemp,OUTPUT TABLE felmeddtemp).
      END.
   END.
   FIND FIRST valsoktemp WHERE valsoktemp.SOKVAL = 11 NO-ERROR.
   IF AVAILABLE valsoktemp THEN DO:
      ASSIGN            
      FILL-IN_FLEXTID = valsoktemp.SOKLOG[1] 
      FILL-IN-FAVTAL =  valsoktemp.SOKCHAR[1].
      IF FILL-IN_FLEXTID = TRUE THEN DO:               
         IF Guru.Konstanter:globforetag = "SUND" OR Guru.Konstanter:globforetag = "SNAT" OR Guru.Konstanter:globforetag = "MISV" THEN DO:
            IF FILL-IN-FAVTAL = "TE" THEN ASSIGN CMB_FAVTAL:SCREEN-VALUE = "8-17".
            IF FILL-IN-FAVTAL = "K" THEN ASSIGN CMB_FAVTAL:SCREEN-VALUE = "7-16".
            IF FILL-IN-FAVTAL = "T" THEN ASSIGN CMB_FAVTAL:SCREEN-VALUE = "Sundsvall Övriga".            
            IF FILL-IN-FAVTAL = "KV" THEN ASSIGN CMB_FAVTAL:SCREEN-VALUE = "Sundsvall kollektiv Vatten".
            IF FILL-IN-FAVTAL = "TU" THEN ASSIGN CMB_FAVTAL:SCREEN-VALUE = "Korsta".
            IF FILL-IN-FAVTAL = "" THEN ASSIGN CMB_FAVTAL:SCREEN-VALUE = "Sundsvall Övriga".
            ENABLE CMB_FAVTAL WITH FRAME {&FRAME-NAME}.            
            
         END.
      END.
   END.
   OPEN QUERY BRW_ANSV FOR EACH ansvarigtemp NO-LOCK .                                                                  
   OPEN QUERY BRW_GODK FOR EACH godkannartemp NO-LOCK .      
   RUN vladda_UI.
   IF varforetypval[2] = 1 THEN varforetypval[2] = varforetypval[2].
   ELSE DO:
      IF AVAILABLE valperstemp THEN DO:
         IF valperstemp.VECKOSCHEM = 0 THEN musz = musz.
         ELSE CMB_VECKO:SCREEN-VALUE = STRING(valperstemp.VECKOSCHEMA).         
      END.
      ELSE DO:            
         CMB_VECKO:SCREEN-VALUE = STRING(varsechema).
         /*IF varsechema = 0 THEN musz = musz.
         ELSE CMB_VECKO:SCREEN-VALUE = STRING(varsechema).*/                  
      END.
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE vdis_UI Dialog-Frame 
PROCEDURE vdis_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DISABLE  
   FILL-IN-MAN FILL-IN-TIS FILL-IN-ONS FILL-IN-TOR FILL-IN-FRE FILL-IN-LOR FILL-IN-SON 
   FILL-IN-TOT FILL-IN-TOTV
   FILL-IN-BORJ1 FILL-IN-BORJ2 FILL-IN-BORJ3 FILL-IN-BORJ4 FILL-IN-BORJ5 FILL-IN-BORJ6 
   FILL-IN-BORJ7 
   FILL-IN-DSCH1 FILL-IN-DSCH2 FILL-IN-DSCH3 FILL-IN-DSCH4 FILL-IN-DSCH5 FILL-IN-DSCH6
   FILL-IN-DSCH7   
   FILL-IN-SLU1 FILL-IN-SLU2 FILL-IN-SLU3 FILL-IN-SLU4 FILL-IN-SLU5 FILL-IN-SLU6 
   FILL-IN-SLU7     
   FILL-IN-TIM1 FILL-IN-TIM2 FILL-IN-TIM3 FILL-IN-TIM4 FILL-IN-TIM5 FILL-IN-TIM6 
   FILL-IN-TIM7 
   WITH FRAME {&FRAME-NAME}.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE vladda_UI Dialog-Frame 
PROCEDURE vladda_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   FIND FIRST valsoktemp WHERE valsoktemp.SOKVAL = 1 NO-ERROR.
   IF NOT AVAILABLE valsoktemp THEN RETURN.
   varsechema = valsoktemp.SOKINT[1].
   IF AVAILABLE valsoktemp THEN DO:
      FILL-IN-TOTV = valsoktemp.SOKDECI[1].
      ASSIGN
      FILL-IN-DSCH1 = valsoktemp.SOKDECI[2]
      FILL-IN-BORJ1 = valsoktemp.SOKDECI[3]
      FILL-IN-SLU1  = valsoktemp.SOKDECI[4]
      FILL-IN-TIM1  = valsoktemp.SOKDECI[5].
   END.
   FIND FIRST valsoktemp WHERE valsoktemp.SOKVAL = 2 NO-ERROR.
   IF AVAILABLE valsoktemp THEN DO:        
      ASSIGN
      FILL-IN-DSCH2 = valsoktemp.SOKDECI[2] 
      FILL-IN-BORJ2 = valsoktemp.SOKDECI[3] 
      FILL-IN-SLU2  = valsoktemp.SOKDECI[4] 
      FILL-IN-TIM2  = valsoktemp.SOKDECI[5].
   END.
   FIND FIRST valsoktemp WHERE valsoktemp.SOKVAL = 3 NO-ERROR.
   IF AVAILABLE valsoktemp THEN DO:        
      ASSIGN
      FILL-IN-DSCH3 = valsoktemp.SOKDECI[2] 
      FILL-IN-BORJ3 = valsoktemp.SOKDECI[3] 
      FILL-IN-SLU3  = valsoktemp.SOKDECI[4] 
      FILL-IN-TIM3  = valsoktemp.SOKDECI[5].
   END.
   FIND FIRST valsoktemp WHERE valsoktemp.SOKVAL = 4 NO-ERROR.
   IF AVAILABLE valsoktemp THEN DO:        
      ASSIGN
      FILL-IN-DSCH4 = valsoktemp.SOKDECI[2] 
      FILL-IN-BORJ4 = valsoktemp.SOKDECI[3] 
      FILL-IN-SLU4  = valsoktemp.SOKDECI[4] 
      FILL-IN-TIM4  = valsoktemp.SOKDECI[5].
   END.
   FIND FIRST valsoktemp WHERE valsoktemp.SOKVAL = 5 NO-ERROR.
   IF AVAILABLE valsoktemp THEN DO:
      ASSIGN
      FILL-IN-DSCH5 = valsoktemp.SOKDECI[2] 
      FILL-IN-BORJ5 = valsoktemp.SOKDECI[3] 
      FILL-IN-SLU5  = valsoktemp.SOKDECI[4] 
      FILL-IN-TIM5  = valsoktemp.SOKDECI[5].
   END.
   FIND FIRST valsoktemp WHERE valsoktemp.SOKVAL = 6 NO-ERROR.
   IF AVAILABLE valsoktemp THEN DO:        
      ASSIGN
      FILL-IN-DSCH6 = valsoktemp.SOKDECI[2] 
      FILL-IN-BORJ6 = valsoktemp.SOKDECI[3] 
      FILL-IN-SLU6  = valsoktemp.SOKDECI[4] 
      FILL-IN-TIM6  = valsoktemp.SOKDECI[5].
   END.
   FIND FIRST valsoktemp WHERE valsoktemp.SOKVAL = 7 NO-ERROR.
   IF AVAILABLE valsoktemp THEN DO:      
      ASSIGN
      FILL-IN-DSCH7 = valsoktemp.SOKDECI[2] 
      FILL-IN-BORJ7 = valsoktemp.SOKDECI[3] 
      FILL-IN-SLU7  = valsoktemp.SOKDECI[4] 
      FILL-IN-TIM7  = valsoktemp.SOKDECI[5].     
   END.
   
   DISPLAY 
   FILL-IN-MAN FILL-IN-TIS FILL-IN-ONS FILL-IN-TOR FILL-IN-FRE FILL-IN-LOR FILL-IN-SON 
   FILL-IN-TOT FILL-IN-TOTV
   FILL-IN-BORJ1 FILL-IN-BORJ2 FILL-IN-BORJ3 FILL-IN-BORJ4 FILL-IN-BORJ5 FILL-IN-BORJ6 
   FILL-IN-BORJ7 
   FILL-IN-DSCH1 FILL-IN-DSCH2 FILL-IN-DSCH3 FILL-IN-DSCH4 FILL-IN-DSCH5 FILL-IN-DSCH6
   FILL-IN-DSCH7   
   FILL-IN-SLU1 FILL-IN-SLU2 FILL-IN-SLU3 FILL-IN-SLU4 FILL-IN-SLU5 FILL-IN-SLU6 
   FILL-IN-SLU7     
   FILL-IN-TIM1 FILL-IN-TIM2 FILL-IN-TIM3 FILL-IN-TIM4 FILL-IN-TIM5 FILL-IN-TIM6 
   FILL-IN-TIM7 
   WITH FRAME {&FRAME-NAME}.
   
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

/* ************************  Function Implementations ***************** */

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _FUNCTION tabortblanka Dialog-Frame 
FUNCTION tabortblanka RETURNS CHARACTER
  ( INPUT namnblanka AS CHARACTER ) :
/*------------------------------------------------------------------------------
  Purpose:  
    Notes:  
------------------------------------------------------------------------------*/
  namnblanka = REPLACE(namnblanka," ","").
  RETURN   namnblanka.   /* Function return value. */

END FUNCTION.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

