DEFINE TEMP-TABLE AEE
FIELD AVDELNINGNR 		LIKE AVDELNINGEXTRA.AVDELNINGNR 
FIELD BANKGIRO 		LIKE AVDELNINGEXTRA.BANKGIRO 
FIELD POSTGIRO 		LIKE AVDELNINGEXTRA.POSTGIRO 
FIELD F-SKATT              LIKE AVDELNINGEXTRA.F-SKATT     
FIELD DROJRANT 		LIKE AVDELNINGEXTRA.DROJRANT 
FIELD VATNR		LIKE AVDELNINGEXTRA.VATNR
FIELD ORGNR 		LIKE AVDELNINGEXTRA.ORGNR. 
DEFINE TEMP-TABLE ATT
FIELD AVDELNINGNR 		LIKE AVDELNING.AVDELNINGNR 
FIELD AVDELNINGNAMN 		LIKE AVDELNING.AVDELNINGNAMN 
FIELD GATUADR 		LIKE AVDELNING.GATUADR 
FIELD POSTNR 		LIKE AVDELNING.POSTNR 
FIELD POSTANST 		LIKE AVDELNING.POSTANST 
FIELD TELVXL		LIKE AVDELNING.TELVXL
FIELD TELJOUR 		LIKE AVDELNING.TELJOUR
FIELD KONTOA 		LIKE AVDELNING.KONTOA 
FIELD KONTOB 		LIKE AVDELNING.KONTOB 
FIELD KONTOC 		LIKE AVDELNING.KONTOC 
FIELD KONTOD 		LIKE AVDELNING.KONTOD 
FIELD KOSTMASK 		LIKE AVDELNING.KOSTMASK 
FIELD KOSTPERS 		LIKE AVDELNING.KOSTPERS
FIELD NUAK 		LIKE AVDELNING.NUAK 
FIELD ANTALAB 		LIKE AVDELNING.ANTALAB 
FIELD BUDGRAMUH 		LIKE AVDELNING.BUDGRAMUH 
FIELD BUDGRAMINV 		LIKE AVDELNING.BUDGRAMINV 
FIELD ANTALANST 		LIKE AVDELNING.ANTALANST 
FIELD POSTADR 		LIKE AVDELNING.POSTADR
FIELD ELVOMRKOD 		LIKE AVDELNING.ELVOMRKOD 
FIELD KOSTNTYPINV		LIKE AVDELNING.KOSTNTYPINV
FIELD KOSTNTYPUH 		LIKE AVDELNING.KOSTNTYPUH .

DEFINE TEMP-TABLE OT
FIELD NAMN 	LIKE OMRADETAB.NAMN
FIELD GATUADR 	LIKE OMRADETAB.GATUADR
FIELD POSTNR 	LIKE OMRADETAB.POSTNR 
FIELD POSTANST 	LIKE OMRADETAB.POSTANST 
FIELD TELVXL 	LIKE OMRADETAB.TELVXL 
FIELD TELJOUR 	LIKE OMRADETAB.TELJOUR 
FIELD ELVOMRKOD 	LIKE OMRADETAB.ELVOMRKOD 
FIELD ORGIDNUM 	LIKE OMRADETAB.ORGIDNUM 
FIELD AVDELNINGNR 	LIKE OMRADETAB.AVDELNINGNR 
FIELD AVDELNINGNAMN 	LIKE OMRADETAB.AVDELNINGNAMN 
FIELD OMRADE 	LIKE OMRADETAB.OMRADE
FIELD PROJINT1 	LIKE OMRADETAB.PROJINT1 
FIELD PROJINT2 	LIKE OMRADETAB.PROJINT2 
FIELD SISTPROJ 	LIKE OMRADETAB.SISTPROJ 
FIELD TIMKOST 	LIKE OMRADETAB.TIMKOST 
FIELD TIMKOSTMASK	LIKE OMRADETAB.TIMKOSTMASK
FIELD KONTOOB 	LIKE OMRADETAB.KONTOOB  
FIELD KALKYLINT1 	LIKE OMRADETAB.KALKYLINT1 
FIELD KALKYLINT2 	LIKE OMRADETAB.KALKYLINT2
FIELD OMKOSTP 	LIKE OMRADETAB.OMKOSTP  
FIELD KALKYLSIST 	LIKE OMRADETAB.KALKYLSIST 
FIELD KUNDPRISF 	LIKE OMRADETAB.KUNDPRISF 
FIELD OMKMTR 	LIKE OMRADETAB.OMKMTR 
FIELD PLANINT1 	LIKE OMRADETAB.PLANINT1 
FIELD PLANINT2 	LIKE OMRADETAB.PLANINT2 
FIELD SISTPLAN 	LIKE OMRADETAB.SISTPLAN .

INPUT FROM A:\OMRADETA.D NO-ECHO.
REPEAT:
   CREATE OT.
   ASSIGN.
   IMPORT OT.
END.             
MESSAGE "1" VIEW-AS ALERT-BOX.
FOR EACH OT :
FIND FIRST OMRADETAB WHERE OMRADETAB.OMRADE = OT.OMRADE NO-ERROR.
IF AVAILABLE OMRADETAB THEN DO:
ASSIGN
OMRADETAB.AVDELNINGNAMN 	= OT.AVDELNINGNAMN 
OMRADETAB.AVDELNINGNR 	= OT.AVDELNINGNR 
OMRADETAB.ELVOMRKOD 	= OT.ELVOMRKOD 
OMRADETAB.GATUADR 	= OT.GATUADR 
OMRADETAB.KALKYLINT1 	= OT.KALKYLINT1 
OMRADETAB.KALKYLINT2 	= OT.KALKYLINT2 
OMRADETAB.KALKYLSIST 	= OT.KALKYLSIST 
OMRADETAB.KONTOOB 	= OT.KONTOOB 
OMRADETAB.KUNDPRISF 	= OT.KUNDPRISF 
OMRADETAB.NAMN 	= OT.NAMN 
OMRADETAB.OMKMTR 	= OT.OMKMTR 
OMRADETAB.OMKOSTP 	= OT.OMKOSTP 
OMRADETAB.OMRADE 	= OT.OMRADE 
OMRADETAB.PLANINT1 	= OT.PLANINT1 
OMRADETAB.PLANINT2 	= OT.PLANINT2 
OMRADETAB.POSTANST 	= OT.POSTANST 
OMRADETAB.POSTNR 	= OT.POSTNR 
OMRADETAB.PROJINT1 	= OT.PROJINT1 
OMRADETAB.PROJINT2 	= OT.PROJINT2 
OMRADETAB.SISTPLAN 	= OT.SISTPLAN 
OMRADETAB.SISTPROJ 	= OT.SISTPROJ 
OMRADETAB.TELJOUR 	= OT.TELJOUR 
OMRADETAB.TELVXL 	= OT.TELVXL 

OMRADETAB.TIMKOSTMASK	= OT.TIMKOSTMASK.
END.
END. 
MESSAGE "2" VIEW-AS ALERT-BOX.
INPUT FROM A:\AVDELNIN.D NO-ECHO.
REPEAT:
   CREATE ATT.
   ASSIGN.
   IMPORT ATT.
END.             
MESSAGE "3" VIEW-AS ALERT-BOX.
FOR EACH ATT:
FIND FIRST AVDELNING WHERE AVDELNING.AVDELNINGNR = ATT.AVDELNINGNR NO-ERROR.
IF AVAILABLE AVDELNING THEN DO:
ASSIGN
AVDELNING.ANTALAB 		= ATT.ANTALAB 
AVDELNING.ANTALANST 		= ATT.ANTALANST 
AVDELNING.AVDELNINGNAMN 		= ATT.AVDELNINGNAMN 
AVDELNING.AVDELNINGNR 		= ATT.AVDELNINGNR 
AVDELNING.BUDGRAMINV 		= ATT.BUDGRAMINV 
AVDELNING.BUDGRAMUH 		= ATT.BUDGRAMUH 
AVDELNING.ELVOMRKOD 		= ATT.ELVOMRKOD 
AVDELNING.GATUADR 		= ATT.GATUADR 
AVDELNING.KONTOA 		= ATT.KONTOA 
AVDELNING.KONTOB 		= ATT.KONTOB 
AVDELNING.KONTOC 		= ATT.KONTOC 
AVDELNING.KONTOD 		= ATT.KONTOD 
AVDELNING.KOSTMASK 		= ATT.KOSTMASK 
AVDELNING.KOSTNTYPINV		= ATT.KOSTNTYPINV
AVDELNING.KOSTNTYPUH 		= ATT.KOSTNTYPUH 
AVDELNING.KOSTPERS 		= ATT.KOSTPERS 
AVDELNING.NUAK 		= ATT.NUAK 
AVDELNING.POSTADR 		= ATT.POSTADR 
AVDELNING.POSTANST 		= ATT.POSTANST 
AVDELNING.POSTNR 		= ATT.POSTNR 
AVDELNING.TELJOUR 		= ATT.TELJOUR 
AVDELNING.TELVXL		= ATT.TELVXL.
END.
END.
MESSAGE "4" VIEW-AS ALERT-BOX.
INPUT FROM A:\AVDELEXT.D NO-ECHO.
REPEAT:
   CREATE AEE.
   ASSIGN.
   IMPORT AEE.
END.
MESSAGE "5" VIEW-AS ALERT-BOX.
FOR EACH AEE: 
FIND FIRST AVDELNINGEXTRA WHERE AVDELNINGEXTRA.AVDELNINGNR = AEE.AVDELNINGNR NO-ERROR.
IF AVAILABLE AVDELNINGEXTRA THEN DO:
ASSIGN
   AVDELNINGEXTRA.AVDELNINGNR 	=	AEE.AVDELNINGNR 
AVDELNINGEXTRA.BANKGIRO 		= AEE.BANKGIRO 
AVDELNINGEXTRA.DROJRANT 		= AEE.DROJRANT 
AVDELNINGEXTRA.F-SKATT 		= AEE.F-SKATT 
AVDELNINGEXTRA.ORGNR 		= AEE.ORGNR 
AVDELNINGEXTRA.POSTGIRO 		= AEE.POSTGIRO 
AVDELNINGEXTRA.VATNR		= AEE.VATNR.

END.
END.
MESSAGE "6" VIEW-AS ALERT-BOX.
