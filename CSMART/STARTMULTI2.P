/*STARTMULTI2.P*/
{GLOBVAR2DEL1.I}
DEFINE INPUT-OUTPUT PARAMETER nyprog AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE summeradberedning AS LOGICAL NO-UNDO.
&Scoped-define NEW NEW
&Scoped-define SHARED SHARED
/*FAKT*/
{FAKTTEMP.I}
{FAKKOTEMP.I}
DEFINE NEW SHARED VARIABLE skarpfaktok AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE faktrec AS RECID NO-UNDO.     
/*mark*/
DEFINE NEW SHARED VARIABLE fastigregapph AS HANDLE NO-UNDO.
DEFINE NEW SHARED VARIABLE typpris AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE mtrlspec AS LOGICAL NO-UNDO .
DEFINE NEW SHARED VARIABLE vardrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE vardrec2 AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE karlrec AS RECID NO-UNDO. 
DEFINE NEW SHARED VARIABLE fastrec2 AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE fastrec AS RECID NO-UNDO. 
DEFINE NEW SHARED VARIABLE skogrec2 AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE skogrec AS RECID NO-UNDO. 
DEFINE NEW SHARED VARIABLE volrec2 AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE volrec AS RECID NO-UNDO. 
DEFINE NEW SHARED VARIABLE akerrec2 AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE akerrec AS RECID NO-UNDO. 
DEFINE NEW SHARED VARIABLE kabrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE kabrec2 AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE fastvrec AS RECID NO-UNDO. 
DEFINE NEW SHARED VARIABLE valmarkrec AS RECID NO-UNDO. 
DEFINE NEW SHARED VARIABLE radvar AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE valvard AS CHARACTER NO-UNDO.
DEFINE NEW SHARED VARIABLE kindrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE kindrec2 AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE volkrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE volkrec2 AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE aoplan AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE avbryt AS LOGICAL NO-UNDO.                           
DEFINE NEW SHARED VARIABLE markrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE markvrec AS RECID NO-UNDO.
&Scoped-define NEW NEW
&Scoped-define SHARED SHARED
{ANSVMARK.I}
{FASTIGHET.I}   
{MARKTEMP.I}
{MARKVARD.I}
{MARKVAL.I}
{LANKOM.I}
{VOLUPPSK.I}

DEFINE NEW SHARED VARIABLE TOG_ALLAMA AS LOGICAL INITIAL no 
     LABEL "ALLA MARKÄGARE":L 
     VIEW-AS TOGGLE-BOX
     SIZE 22.75 BY 1 NO-UNDO.
DEFINE NEW SHARED VARIABLE TOG_FORSTA AS LOGICAL INITIAL no 
     LABEL "ENBART SAMMANSTÄLLNING":L 
     VIEW-AS TOGGLE-BOX
     SIZE 26.38 BY 1 NO-UNDO.
DEFINE NEW SHARED VARIABLE TOG_STAMP AS LOGICAL INITIAL NO 
     LABEL "ENBART STÄMPLINSLÄNGD":L 
     VIEW-AS TOGGLE-BOX
     SIZE 26.38 BY 1 NO-UNDO.
DEFINE NEW SHARED VARIABLE TOG_VAGHALLARE AS LOGICAL INITIAL no 
     LABEL "Väghållare" 
     VIEW-AS TOGGLE-BOX
     SIZE 17 BY .79 NO-UNDO.
DEFINE NEW SHARED VARIABLE TOG_TILLFSK AS LOGICAL INITIAL no 
     LABEL "Visa enbart tillfällig skada" 
     VIEW-AS TOGGLE-BOX
     SIZE 30.5 BY .79 NO-UNDO.


/*mtrl*/
&Scoped-define NEW NEW
&Scoped-define SHARED SHARED
{LEVTEMP.I}
{DEPATEMP.I}
{SOKDEF.I}
{DEFSOK.I}

/*DEPÅ*/
&Scoped-define NEW NEW
&Scoped-define SHARED SHARED
{DEPSEKTEMP.I}
{LTRPTEMP.I}
{SPECMTRLTEMP.I}
{BESTKUNDALLT.I}
{ANSPROJBER.I}
{ARBATE.I}
{TIDUTTTNEW.I}
{AOBESTMTRLDEP.I}
{BESTMTRLDEP.I}
{LAGERTRUM.I}

DEFINE NEW SHARED VARIABLE depatitta AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE vald_depa AS INTEGER NO-UNDO.     
DEFINE NEW SHARED VARIABLE uttag AS LOGICAL NO-UNDO. 
DEFINE NEW SHARED VARIABLE lista AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE dbenamning AS CHARACTER NO-UNDO.  
DEFINE NEW SHARED VARIABLE alla AS LOGICAL NO-UNDO.

DEFINE NEW SHARED VARIABLE aonummer AS CHARACTER NO-UNDO.
DEFINE NEW SHARED VARIABLE delnummer AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE valmanad AS INTEGER NO-UNDO.   
DEFINE NEW SHARED VARIABLE valar AS INTEGER NO-UNDO. 
DEFINE NEW SHARED VARIABLE utomr AS CHARACTER NO-UNDO. 
DEFINE NEW SHARED VARIABLE omr AS LOGICAL NO-UNDO. 
DEFINE NEW SHARED VARIABLE akval AS INTEGER NO-UNDO.  
DEFINE NEW SHARED VARIABLE valaonr AS CHARACTER NO-UNDO.
DEFINE NEW SHARED VARIABLE valdelnr AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE valort AS CHARACTER NO-UNDO. 
DEFINE NEW SHARED VARIABLE valomrade AS CHARACTER NO-UNDO. 
DEFINE NEW SHARED VARIABLE valkund AS CHARACTER NO-UNDO. 
DEFINE NEW SHARED VARIABLE valnamn AS CHARACTER NO-UNDO.  
DEFINE NEW SHARED VARIABLE datvar AS DATE NO-UNDO. 
DEFINE NEW SHARED VARIABLE mellanrum AS LOGICAL NO-UNDO.
DEFINE NEW SHARED TEMP-TABLE aoval NO-UNDO           
   FIELD AONR AS CHARACTER
   FIELD DELNR AS INTEGER 
   FIELD AONRREC AS RECID
   INDEX AONR IS PRIMARY AONR DELNR.
DEFINE NEW SHARED TEMP-TABLE gam_mtrl NO-UNDO
   FIELD DATUM AS DATE
   FIELD DATUM2 AS DATE
   FIELD KOM AS CHARACTER. 
/*TID*/
&Scoped-define NEW NEW
&Scoped-define SHARED SHARED
{TIDALLT.I}
{TIDPERS.I}
{UPPGHMT.I}
{DIRDEF.I}
{PHMT.I}
{FLEXTAB.I}
DEFINE NEW SHARED VARIABLE tomdat AS DATE NO-UNDO.
DEFINE NEW SHARED VARIABLE manad AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE korda AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE dirtid AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE dirtidoveraknare AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE dirtidrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE allatidvar AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE manvaxla AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE flexav AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE bustart3 AS DECIMAL NO-UNDO. 
DEFINE NEW SHARED VARIABLE vaxla AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE perssokrec AS RECID NO-UNDO. 
DEFINE NEW SHARED VARIABLE tidtabrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE tidtabrec2 AS RECID NO-UNDO.  
DEFINE NEW SHARED VARIABLE tidsedrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE tidsedlog AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE andvisrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE persrec AS RECID NO-UNDO. 
DEFINE NEW SHARED VARIABLE persrec2 AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE vartgamla AS CHARACTER FORMAT "X(3)" NO-UNDO.
DEFINE NEW SHARED VARIABLE klocka AS DECIMAL NO-UNDO. 
DEFINE NEW SHARED VARIABLE andvisvnr AS INTEGER FORMAT "999" NO-UNDO.
DEFINE NEW SHARED VARIABLE andvisdatum AS DATE NO-UNDO.
DEFINE NEW SHARED VARIABLE radmusz AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE flrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE flrec2 AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE fldrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE fldrec2 AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE arnr AS INTEGER FORMAT "9999" NO-UNDO. 
DEFINE NEW SHARED VARIABLE manadnr AS INTEGER FORMAT "99" NO-UNDO.
DEFINE NEW SHARED VARIABLE manadnamn AS CHARACTER NO-UNDO.
DEFINE NEW SHARED VARIABLE vkdatum AS DATE NO-UNDO.
DEFINE {&NEW} SHARED VARIABLE RAD_LISTA AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE TOGGLE-MONTH AS LOGICAL INITIAL ? NO-UNDO.
DEFINE NEW SHARED VARIABLE RAD_GOD AS INTEGER NO-UNDO.
/*UPPF*/
DEFINE {&NEW} SHARED VARIABLE SEL_UPP AS CHARACTER INITIAL ?  NO-UNDO.
DEFINE {&NEW} SHARED VARIABLE FILL-IN-STARTDAT AS DATE FORMAT "99/99/99":U    NO-UNDO.
DEFINE {&NEW} SHARED VARIABLE FILL-IN-STOPPDAT AS DATE FORMAT "99/99/99":U   NO-UNDO.
DEFINE {&NEW} SHARED VARIABLE RAD_ALLVAL AS INTEGER                         NO-UNDO.
DEFINE {&NEW} SHARED VARIABLE RAD_PERIOD AS INTEGER                NO-UNDO.
DEFINE {&NEW} SHARED VARIABLE RAD_SORT AS INTEGER         NO-UNDO.
DEFINE {&NEW} SHARED VARIABLE RAD_TYP AS INTEGER  NO-UNDO.
{AVDTEMP.I}
{OMRTEMPW.I}
{OTIDBEORD.I}
DEFINE NEW SHARED VARIABLE aonrrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE aonrrec2 AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE valaonrrec AS RECID NO-UNDO. 
DEFINE NEW SHARED VARIABLE valanlrec AS RECID NO-UNDO. 
DEFINE NEW SHARED VARIABLE tillrec AS RECID NO-UNDO.    
DEFINE NEW SHARED VARIABLE omrrec AS RECID NO-UNDO. 
DEFINE NEW SHARED VARIABLE musz AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE kto AS CHARACTER NO-UNDO.
DEFINE NEW SHARED VARIABLE typ_val AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE valdelnrlog AS LOGICAL NO-UNDO.
DEFINE {&NEW} SHARED TEMP-TABLE valbefattningstemp NO-UNDO LIKE befattningstemp.
DEFINE {&NEW} SHARED TEMP-TABLE omrtemp2 NO-UNDO LIKE omrtemp.
/*PERS*/
DEFINE NEW SHARED VARIABLE persproch AS HANDLE NO-UNDO.     /* PERSONALAPP.P */

{ANVTEMPS.I}
{SEKXGURUTEMP.I}
{RHMT.I}
{VHMT.I}
{DHMT.I}
{AVTAL.I}
/*SEK*/
DEFINE NEW SHARED VARIABLE anvapph AS HANDLE NO-UNDO. 

/*plan*/
DEFINE NEW SHARED VARIABLE franar AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE tillar AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE period AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE omrbildvar AS CHARACTER NO-UNDO.
&Scoped-define NEW NEW                 
&Scoped-define SHARED SHARED                                         
{ANSVPLANTEMP.I}                       
{AONRDEF.I}                            
{AVTPLANTEMP.I}                        
{PLANNRTEMP.I}                         

DEFINE NEW SHARED TEMP-TABLE plantemp    
   FIELD PLANNR AS CHARACTER 
   FIELD ARTAL AS INTEGER 
   FIELD OMRADE AS CHARACTER
   FIELD AONR AS CHARACTER
   FIELD DELNR AS INTEGER
   FIELD PLANNRTABREC AS RECID
   INDEX PLANNR IS PRIMARY PLANNR ARTAL ASCENDING.
/*STOR*/
{STORTEMP2.I}   
DEFINE NEW SHARED VARIABLE valrec AS RECID NO-UNDO.
DEFINE NEW SHARED VARIABLE distvar AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE stornrid AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE forvar AS INTEGER NO-UNDO.
DEFINE NEW SHARED VARIABLE ny AS LOGICAL NO-UNDO.
DEFINE NEW SHARED VARIABLE sistartal AS INTEGER NO-UNDO.

COLOR-TABLE:SET-DYNAMIC(22, YES) NO-ERROR.                      
COLOR-TABLE:SET-RGB-VALUE(22, RGB-VALUE(236,233,216)) NO-ERROR. 
RUN  KontrollAvSek.P.
RUN MULTISTART.w (INPUT-OUTPUT nyprog).
