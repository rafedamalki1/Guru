DEFINE VARIABLE hjdat AS DATE NO-UNDO.
FOR EACH BERVAL WHERE BERVAL.AONR = "xx" AND BERVAL.OMRADE = "yy" AND BERVAL.ORT NE "" AND BERVAL.DELNR = 0 AND BERVAL.KSKAP = FALSE EXCLUSIVE-LOCK BY BERVAL.NUM:
   hjdat = DATE(INTEGER(SUBSTRING(BERVAL.ORT,4,2)),INTEGER(SUBSTRING(BERVAL.ORT,7,2)),INTEGER("20" + SUBSTRING(BERVAL.ORT,1,2))).
   FIND FIRST BERMTRL WHERE BERMTRL.AONR = BERVAL.AONR AND 
   BERMTRL.OMRADE = BERVAL.OMRADE AND BERMTRL.INKOP = TRUE AND BERMTRL.KLAR = TRUE AND
   BERMTRL.DATUM = hjdat NO-LOCK NO-ERROR. 
   IF AVAILABLE BERMTRL THEN DO:
      DISP BERVAL.AONR BERVAL.OMRADE BERVAL.ORT BERVAL.DELNR FORMAT ">>>>>99" BERMTRL.DATUM BERMTRL.DELNR FORMAT ">>>>>99".
      /* ASSIGN BERVAL.DELNR = BERMTRL.DELNR. */
   END.

END.

/* /*koll vilka beredningar som har 0 i delnr*/
FOR EACH berval WHERE ort BEGINS "09" AND delnr = 0 AND berval.kskap = FALSE NO-LOCK:
   DISP aonr omrade NUM KSKAP ort delnr FORMAT ">>>>99".
END.*/
