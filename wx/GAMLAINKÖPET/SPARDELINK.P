   /*SPARDELINK.P*/ 
              
&Scoped-define NEW NEW              
{delvaltemp.i}

DEFINE INPUT PARAMETER valaonr LIKE AONRTAB.AONR NO-UNDO.
DEFINE INPUT PARAMETER valomrade LIKE AONRTAB.OMRADE NO-UNDO.
DEFINE INPUT PARAMETER TABLE FOR del_val.

FOR EACH del_val:  
   DO TRANSACTION:
      FIND FIRST BERVAL WHERE BERVAL.AONR = valaonr AND BERVAL.OMRADE = valomrade AND 
      BERVAL.KSKAP = FALSE AND BERVAL.NUM = del_val.NUM EXCLUSIVE-LOCK NO-ERROR.
      IF AVAILABLE BERVAL THEN DO:
         ASSIGN
         BERVAL.DELNR = del_val.DELNR
         BERVAL.ORT = del_val.ORT.
      END.
   END.
END.

