/*
     Filename: DOKALKAPP.P
     
      Created: 2004.04.22 09:37ELPAO     
     Modified: 
     KATAR" OF "P1" AS integer  ARBETKODER P1

KATAR" OF "P2" AS integer  ARBETKODER P2
KATAR" OF "P3" AS integer  ARBETKODER P3
KATAR" OF "P5" AS integer  ARBETKODER P5
KATAR" OF "LOP1" AS integer  LÖPNR P1
KATAR" OF "LOP2" AS integer  LÖPNR P2
KATAR" OF "LOP3" AS integer  LÖPNR P3
KATAR" OF "LOP5" AS integer  LÖPNR P4
KATAR" OF "BEREDNING" AS integer OM P3 KALKYL
!!!!!!!
KATAR" OF "KALKBEF" AS integer   kalknr = 0 är årets timmprsier   kalknr ne 0 är om man sätter faktorer mm

KATAR" OF "FREKVENS" AS integer P1 P2 P3
!!!!!!
KATAR" OF "KALKNATT" AS integer  KALKNATT.DELNR = KALKSPEC.KALKNR extra tabell för KALSPEC
KATAR" OF "KALKBER" AS integer  KOPPLA TILL BEREDNINGS KONSTRUKTION
KATAR" OF "FASTSPEC" AS integer KALKYL HUVUD
KATAR" OF "HDKKOPP" AS integer KOPPLINGSTABELL HANDDATOR
EBRPRIS  ARTAL PRISER FÖR KATALOGEN
SEBRPRIS ARTAL PRIS FÖR SAMBYGGNAD
KALKFOR
FASTKALK.FAST = TRUE = OM UTRUSTNING NÖDLÖSNING
KALKSPEC
KALKYL
KALKAONR skapas när kalkylen skapas KALKAPP1.P 
FASTSPEC skapas när kalkylen skapas KALKAPP1.P katar sätts om det är en sambygg tas årtalet fråm senaste SEBRPRIS
KALKUPP
FAKTOR
KALKFOR
inextradatatemp.PROGRAM = "DOKALKYL" känner av om typen är en loptemp.typ = 5 


     
     
*/
&SCOPED-DEFINE NEW NEW
&SCOPED-DEFINE SHARED SHARED
{GLOBVAR2DEL1.I}
FIND FIRST FORETAG NO-LOCK NO-ERROR.
Guru.Konstanter:globforetag = FORETAG.FORETAG.
DEFINE VARIABLE idrakn AS INTEGER NO-UNDO.
DEFINE VARIABLE xtypmtrl AS INTEGER NO-UNDO.
DEFINE VARIABLE offert AS LOGICAL NO-UNDO.
DEFINE VARIABLE monpris AS DECIMAL NO-UNDO.
DEFINE VARIABLE berpris AS DECIMAL NO-UNDO.
DEFINE VARIABLE region AS LOGICAL NO-UNDO.
DEFINE VARIABLE msktim AS DECIMAL NO-UNDO.
DEFINE VARIABLE eavar AS DECIMAL NO-UNDO.
DEFINE VARIABLE arbvar AS DECIMAL NO-UNDO.
DEFINE VARIABLE mskvar AS DECIMAL NO-UNDO.
DEFINE VARIABLE faktvar AS DECIMAL NO-UNDO.
DEFINE VARIABLE prisvar AS DECIMAL NO-UNDO.
DEFINE VARIABLE delningsvar AS INTEGER NO-UNDO. /*sätts till 1 om F9 värde = 0 och 100 om F9 värde = 1*/
DEFINE VARIABLE fakdelningvar AS INTEGER NO-UNDO. /*sätts till 1 om F9 värde = 1 och 100 om F9 värde = 2*/
DEFINE VARIABLE emask3 AS DECIMAL NO-UNDO.
DEFINE VARIABLE edataapph AS HANDLE NO-UNDO.
RUN STYRFORE.P (INPUT Guru.Konstanter:globforetag).

&SCOPED-DEFINE NEW
&SCOPED-DEFINE SHARED
{FORKUND.I}
{KALKBEFTEMP.I}
{FASTKALKTEMP.I}
{LOPTEMP.I}
{PTEMP.I}
{FAKTORTEMP.I}
{FREKVENSTEMP.I}
{KALKSTART.I}
{TEMPKUND.I}
{EBRPRISTEMP.I}
DEFINE BUFFER befbuff FOR KALKBEF.   
{KALKTEMP3.I}

{EXTRADATA.I}

PROCEDURE laddafrek_UI:
   DEFINE INPUT PARAMETER kodvar AS CHARACTER NO-UNDO.
   DEFINE INPUT PARAMETER lopvar AS INTEGER NO-UNDO.
   DEFINE INPUT PARAMETER katvar AS INTEGER NO-UNDO.
   DEFINE OUTPUT PARAMETER TABLE FOR frekvenstemp.
   EMPTY TEMP-TABLE frekvenstemp NO-ERROR. 
   /*kalkår har rätt katar 8 siffror*/
   FOR EACH FREKVENS WHERE FREKVENS.ARBKOD = kodvar AND
   FREKVENS.LOPNR = lopvar AND FREKVENS.KATAR = katvar USE-INDEX KOD NO-LOCK:
      CREATE frekvenstemp.
      BUFFER-COPY FREKVENS TO frekvenstemp.
   END.
END PROCEDURE.
