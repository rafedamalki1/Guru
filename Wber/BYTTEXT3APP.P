/*BYTTEXT3APP.P.*/

PROCEDURE skapalista_UI :
   DEFINE INPUT PARAMETER aovar AS CHARACTER NO-UNDO.
   DEFINE INPUT PARAMETER omrvar AS CHARACTER NO-UNDO.
   DEFINE INPUT PARAMETER franvar AS CHARACTER NO-UNDO.
   DEFINE INPUT PARAMETER tillvar AS CHARACTER NO-UNDO.
   OPEN QUERY BQ FOR EACH BERVAL WHERE BERVAL.AONR = aovar AND BERVAL.OMRADE = omrvar NO-LOCK.
   DO  TRANSACTION:
      GET FIRST BQ EXCLUSIVE-LOCK.
      BERVAL.ANMARK = REPLACE(BERVAL.ANMARK,franvar,tillvar).
   END.
   REPEAT:
      DO TRANSACTION:
         GET NEXT BQ EXCLUSIVE-LOCK.
         IF AVAILABLE BERVAL THEN DO:
            BERVAL.ANMARK = REPLACE(BERVAL.ANMARK,franvar,tillvar).
         END.
         ELSE LEAVE.
      END.
   END.
   CLOSE QUERY BQ.
   OPEN QUERY IQ FOR EACH BERID WHERE BERID.AONR = aovar AND BERID.OMRADE = omrvar NO-LOCK.
   DO  TRANSACTION:
      GET FIRST IQ EXCLUSIVE-LOCK.
      IF AVAILABLE BERID THEN DO:
         ASSIGN
         BERID.NATNR = REPLACE(BERID.NATNR,franvar,tillvar)
         BERID.FRI3 = REPLACE(BERID.FRI3,franvar,tillvar).
      END.
   END.
   REPEAT:
      DO TRANSACTION:
         GET NEXT IQ EXCLUSIVE-LOCK.
         IF AVAILABLE BERID THEN DO:
            ASSIGN
            BERID.NATNR = REPLACE(BERID.NATNR,franvar,tillvar)
            BERID.FRI3 = REPLACE(BERID.FRI3,franvar,tillvar).
         END.
         ELSE LEAVE.
      END.
   END.
   CLOSE QUERY IQ.
   OPEN QUERY MQ FOR EACH BERMTRL WHERE BERMTRL.AONR = aovar AND BERMTRL.OMRADE = omrvar NO-LOCK.
   DO  TRANSACTION:
      GET FIRST MQ EXCLUSIVE-LOCK.
      IF AVAILABLE BERMTRL THEN DO:
         BERMTRL.MTRLTEXT = REPLACE(BERMTRL.MTRLTEXT,franvar,tillvar).
      END.
   END.
   REPEAT:
      DO TRANSACTION:
         GET NEXT MQ EXCLUSIVE-LOCK.
         IF AVAILABLE BERMTRL THEN DO:
            BERMTRL.MTRLTEXT = REPLACE(BERMTRL.MTRLTEXT,franvar,tillvar).
         END.
         ELSE LEAVE.
      END.
   END.
   CLOSE QUERY MQ.

END PROCEDURE.
