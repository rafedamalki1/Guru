/*BERSTOLPAPP.P*/
{BERSTOLP.I}

PROCEDURE laddastolp_UI :
   DEFINE OUTPUT PARAMETER TABLE FOR berstolptemp.
   EMPTY TEMP-TABLE berstolptemp NO-ERROR. 
   OPEN QUERY bq FOR EACH BERSTOLP NO-LOCK.
   GET FIRST bq NO-LOCK.
   DO WHILE AVAILABLE(BERSTOLP):
      CREATE berstolptemp.
      BUFFER-COPY BERSTOLP TO berstolptemp.
      GET NEXT bq NO-LOCK.     
   END.
   CLOSE QUERY bq.
END PROCEDURE.

PROCEDURE bort_UI :
   DEFINE INPUT PARAMETER berenr AS CHARACTER NO-UNDO.
   DEFINE INPUT PARAMETER stolpvar AS LOGICAL NO-UNDO.
   DO TRANSACTION:
      FIND FIRST BERSTOLP WHERE BERSTOLP.ENR = berenr AND 
      BERSTOLP.STOLPE = stolpvar EXCLUSIVE-LOCK NO-ERROR.
      IF AVAILABLE BERSTOLP THEN DO:
         DELETE BERSTOLP.
      END.
   END. 
END PROCEDURE.

PROCEDURE skapa_UI :
   DEFINE INPUT PARAMETER TABLE FOR berstolptemp.
   FIND FIRST berstolptemp NO-LOCK NO-ERROR.
   IF AVAILABLE berstolptemp THEN DO TRANSACTION:
      FIND FIRST BERSTOLP WHERE BERSTOLP.STOLPE = berstolptemp.STOLPE AND BERSTOLP.ENR = berstolptemp.ENR  AND BERSTOLP.LEVKOD = berstolptemp.LEVKOD  EXCLUSIVE-LOCK NO-ERROR.
      IF NOT AVAILABLE BERSTOLP THEN DO:
         CREATE BERSTOLP.
      END.
      BUFFER-COPY berstolptemp TO BERSTOLP.
   END.
   RELEASE BERSTOLP NO-ERROR.
   
END PROCEDURE.
