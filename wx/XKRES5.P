DEFINE NEW SHARED VARIABLE regvnr AS INTEGER FORMAT "999" NO-UNDO.     
DEFINE VARIABLE vnr AS INTEGER FORMAT "999" NO-UNDO.
DEFINE NEW SHARED VARIABLE regdatum AS DATE NO-UNDO.
DEFINE TEMP-TABLE persres 
   FIELD PERSONALKOD LIKE TIDREGITAB.PERSONALKOD
   FIELD tidres AS DECIMAL   
   FIELD sumares AS DECIMAL   
   FIELD sumdagres AS DECIMAL
   INDEX RES PERSONALKOD.   
DEFINE VARIABLE ressumar AS DECIMAL NO-UNDO.        
DEFINE VARIABLE ressumdag AS DECIMAL NO-UNDO. 
DEFINE VARIABLE restidreg AS DECIMAL NO-UNDO.
DEFINE QUERY tq FOR TIDREGITAB.
DEFINE QUERY saq FOR SUMTID.    
DEFINE QUERY sdq FOR SUMTIDDAG.
DEFINE BUFFER sumbuff FOR SUMTIDDAG.    
DEFINE BUFFER sumarbuff FOR SUMTID.

OPEN QUERY sdq FOR EACH SUMTIDDAG WHERE  
SUMTIDDAG.AONR = "630001"  AND 
SUMTIDDAG.DELNR = 0 AND   
sumtiddag.PERSONALKOD = "35055"
AND YEAR(SUMTIDDAG.DATUM) = 1997 USE-INDEX AONR NO-LOCK. 

OPEN QUERY Tq FOR EACH TIDREGITAB WHERE  
TIDREGITAB.AONR = "630001"  AND 
TIDREGITAB.DELNR = 0 AND   
TIDREGITAB.PERSONALKOD = "35055"
AND YEAR(TIDREGITAB.DATUM) = 1997 USE-INDEX AONR NO-LOCK. 


OPEN QUERY saq FOR EACH SUMTID WHERE 
SUMTID.AONR = "630001" AND 
SUMTID.DELNR = 0 AND 
sumtid.PERSONALKOD = "35055" AND 
SUMTID.DATUM = 01/01/97 
USE-INDEX AONR NO-LOCK. 
   
GET FIRST sdq NO-LOCK.
DO WHILE AVAILABLE(SUMTIDDAG):      
   DISPLAY SUMTIDDAG.TBELOPP SUMTIDDAG.DATUM SUMTIdDAG.PRISTYP SUMTIDDAG.VECKOKORD 
   WITH FRAME CC1  DOWN.
   DOWN 1 WITH FRAME CC1.   
   GET NEXT sdq NO-LOCK.
END. 
GET FIRST saq NO-LOCK.
DO WHILE AVAILABLE(SUMTID):      
   DISPLAY SUMTID.TBELOPP SUMTID.DATUM SUMTID.PRISTYP SUMTID.VECKOKORD
   WITH FRAME CC2 DOWN.
   DOWN 1 WITH FRAME CC2.   
   GET NEXT saq NO-LOCK.
END. 
GET FIRST tq NO-LOCK.
DO WHILE AVAILABLE(TIDREGITAB):      
   DISPLAY TIDREGITAB.TRAKTKOD TRAKTANTAL TIDREGITAB.DATUM TIDREGITAB.PRISTYP  
   TIDREGITAB.PROGRAM FORMAT "X(30)"
   TIDREGITAB.VECKOKORD
   WITH FRAME CC3 DOWN.
   DOWN 1 WITH FRAME CC3.   
   GET NEXT tq NO-LOCK.
END. 