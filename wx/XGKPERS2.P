/*XGKPERS.P*/
DEF TEMP-TABLE pekod   
      FIELD PEFTER AS CHARACTER
      FIELD PINNAN AS CHARACTER.
DEFINE BUFFER persbuff FOR PERSONALTAB.
INPUT FROM F:\DELAD\ELPOOL\ELPLO\KALMAR\PKOD2.TXT.
REPEAT TRANSACTION:
  CREATE PEKOD.
  ASSIGN.
  IMPORT PEKOD.
END.   
FOR EACH pekod :
   
   
   FIND FIRST PERSONALTAB WHERE PERSONALTAB.PERSONALKOD = pekod.PINNAN NO-LOCK NO-ERROR.
   IF AVAILABLE PERSONALTAB  THEN DO TRANSACTION:
   
   
      FIND FIRST ANSVARIGTAB WHERE ANSVARIGTAB.PERSONALKOD = pekod.PINNAN EXCLUSIVE-LOCK NO-ERROR.
      IF NOT AVAILABLE ANSVARIGTAB  THEN DO:
         CREATE ANSVARIGTAB.      
         ASSIGN
         ANSVARIGTAB.FORNAMN = PERSONALTAB.FORNAMN
         ANSVARIGTAB.EFTERNAMN = PERSONALTAB.EFTERNAMN
         ANSVARIGTAB.OMREGTID = 00.15.  
      END.
      ASSIGN ANSVARIGTAB.PERSONALKOD = pekod.PEFTER.
      
   
      FIND FIRST GODKANNARTAB WHERE GODKANNARTAB.PERSONALKOD = pekod.PINNAN EXCLUSIVE-LOCK NO-ERROR.
      IF AVAILABLE GODKANNARTAB  THEN DO:
         ASSIGN GODKANNARTAB.PERSONALKOD = pekod.PEFTER.
      END.
      FIND FIRST FLEXAVT WHERE FLEXAVT.PERSONALKOD = pekod.PINNAN EXCLUSIVE-LOCK NO-ERROR.
      IF NOT AVAILABLE FLEXAVT  THEN DO:
         CREATE FLEXAVT.
         FLEXAVT.FLEXKOD = "T".
      END.
      ASSIGN
      FLEXAVT.PERSONALKOD = pekod.PEFTER.      
      
        
   END.
   DO TRANSACTION:
      FIND CURRENT PERSONALTAB EXCLUSIVE-LOCK NO-ERROR.
      ASSIGN PERSONALTAB.PERSONALKOD = pekod.PEFTER.
      
   END.
   DO TRANSACTION:   
      FOR EACH persbuff WHERE persbuff.TIDSGODK = pekod.PINNAN EXCLUSIVE-LOCK:
         ASSIGN persbuff.TIDSGODK = pekod.PEFTER.
      END.
   END.
   DO TRANSACTION:   
      FOR EACH persbuff WHERE persbuff.ANSVARIGTIDR = pekod.PINNAN EXCLUSIVE-LOCK:
         ASSIGN persbuff.ANSVARIGTIDR = pekod.PEFTER.
      END.
   END.
   DO TRANSACTION:   
      FOR EACH TIDSEK WHERE TIDSEK.PERSONALKOD = pekod.PINNAN EXCLUSIVE-LOCK:
         ASSIGN TIDSEK.PERSONALKOD = pekod.PEFTER.
      END.
   END.
   DO TRANSACTION:   
      FOR EACH PERSEK WHERE PERSEK.PERSONALKOD = pekod.PINNAN EXCLUSIVE-LOCK:
         ASSIGN PERSEK.PERSONALKOD = pekod.PEFTER.
      END.
   END.
   DO TRANSACTION:   
      FOR EACH ANVANDARE WHERE ANVANDARE.PERSONALKOD = pekod.PINNAN EXCLUSIVE-LOCK:
         ASSIGN ANVANDARE.PERSONALKOD = pekod.PEFTER.
      END.
   END.
   DO TRANSACTION:
      FOR EACH PERSONALPRIS  WHERE PERSONALPRIS.PERSONALKOD = pekod.PINNAN EXCLUSIVE-LOCK:
        ASSIGN PERSONALPRIS.PERSONALKOD = pekod.PEFTER.
      END.
   END.
   DO TRANSACTION:
      FOR EACH TIMKOSTNADSTAB  WHERE TIMKOSTNADSTAB.PERSONALKOD = pekod.PINNAN EXCLUSIVE-LOCK:
        ASSIGN TIMKOSTNADSTAB.PERSONALKOD = pekod.PEFTER.
      END.
   END.
END.
