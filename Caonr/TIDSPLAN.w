&ANALYZE-SUSPEND _VERSION-NUMBER UIB_v9r12 GUI
&ANALYZE-RESUME
&Scoped-define WINDOW-NAME C-Win
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CUSTOM _DEFINITIONS C-Win 
/*------------------------------------------------------------------------

  File: 

  Description: 

  Input Parameters:
      <none>

  Output Parameters:
      <none>

  Author: 

  Created: 

------------------------------------------------------------------------*/
/*          This .W file was created with the Progress AppBuilder.      */
/*----------------------------------------------------------------------*/

/* Create an unnamed pool to store all the widgets created 
     by this procedure. This is a good default which assures
     that this procedure's triggers and internal procedures 
     will execute in this procedure's storage, and that proper
     cleanup will occur on deletion of the procedure. */

CREATE WIDGET-POOL.

/* ***************************  Definitions  ************************** */

/* Parameters Definitions ---                                           */

/* Local Variable Definitions ---                                       */
{ALLDEF.I}
{EXTRADATA.I}
&Scoped-define NEW 
{GLOBVAR2DEL1.I}

&Scoped-define SHARED SHARED 
{REGVAR.I}
{DIRDEF.I}
{PLANNRTEMP.I} /* för plannr */
&Scoped-define NEW NEW
&Scoped-define SHARED SHARED 
{AVTAONRTEMP.I}
DEFINE TEMP-TABLE tidslagentemp NO-UNDO LIKE tidslagtemp.
{TIDSPLAN.I}
{ARBART.I}
 {KALKSUMMTEMP.I}
{WHANDLTEMP.I}
DEFINE NEW SHARED VARIABLE nyttaoapph AS HANDLE NO-UNDO.                      /*NYTTAOAPP.P*/
DEFINE NEW SHARED VARIABLE grundmappvar AS CHARACTER NO-UNDO.
DEFINE SHARED VARIABLE vartpro AS CHARACTER FORMAT "X(3)" NO-UNDO.
DEFINE SHARED VARIABLE musz AS LOGICAL NO-UNDO.

DEFINE VARIABLE svar AS LOGICAL NO-UNDO.
DEFINE VARIABLE ingenkod AS LOGICAL NO-UNDO.

DEFINE VARIABLE tidsplandynh AS HANDLE NO-UNDO.
DEFINE VARIABLE exdatahmth AS HANDLE NO-UNDO.

DEFINE VARIABLE arbapph AS HANDLE NO-UNDO.
DEFINE NEW SHARED VARIABLE skrivskydd AS LOGICAL NO-UNDO.
DEFINE VARIABLE tabellhandle AS HANDLE NO-UNDO.
DEFINE BUFFER tidsplantempbuff FOR tidsplantemp.
DEFINE INPUT PARAMETER typ AS CHARACTER NO-UNDO. /* typ av tidsplan, PLAN=plannr, PROJEKT=aonr  */

DEFINE VARIABLE status-ok AS LOGICAL NO-UNDO.
DEFINE VARIABLE indate AS DATE NO-UNDO.
DEFINE VARIABLE mregvnr AS INTEGER NO-UNDO.
DEFINE VARIABLE ye AS INTEGER FORMAT "9999" NO-UNDO.
DEFINE VARIABLE man AS INTEGER FORMAT "99" NO-UNDO.
DEFINE VARIABLE day AS INTEGER FORMAT "99" NO-UNDO.
DEFINE VARIABLE forstaregvnr AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE forstaregdatum AS DATE NO-UNDO.
DEFINE VARIABLE andraregvnr AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE regvnr1 AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE regvnr2 AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE vnr1 AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE vnr2 AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE antal AS INTEGER FORMAT "9" NO-UNDO.
DEFINE VARIABLE regdatum2 AS DATE NO-UNDO.
DEFINE VARIABLE nyladdning AS LOGICAL NO-UNDO.
DEFINE VARIABLE vecknumm AS INTEGER FORMAT "999" NO-UNDO. 
DEFINE VARIABLE vnr4 AS INTEGER NO-UNDO.  
DEFINE VARIABLE regdatumspar AS DATE NO-UNDO.          
DEFINE VARIABLE regvnrspar AS INTEGER FORMAT "999" NO-UNDO.
DEFINE VARIABLE skillnad AS INTEGER FORMAT "99" NO-UNDO.
DEFINE VARIABLE tal AS INTEGER FORMAT "9" NO-UNDO.
DEFINE VARIABLE datumval AS INTEGER NO-UNDO.


/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-PREPROCESSOR-BLOCK 

/* ********************  Preprocessor Definitions  ******************** */

&Scoped-define PROCEDURE-TYPE Window
&Scoped-define DB-AWARE no

/* Name of designated FRAME-NAME and/or first browse and/or first query */
&Scoped-define FRAME-NAME DEFAULT-FRAME

/* Standard List Definitions                                            */
&Scoped-Define ENABLED-OBJECTS RECT-1 FILL-IN-AVSTARTD FILL-IN-AVSLUTD ~
CMB_PERS RAD_VAL CMB_ENTRE CMB_PROJL TOG_KALKYL TOG_OVRIGA BTN_SKRIV ~
BTN_EXCEL BTN_FARG BTN_RENSA BTN_SPARA BTN_OK BTN_AVB FILL-IN_PROJEKT ~
FILL-IN_DATUM 
&Scoped-Define DISPLAYED-OBJECTS FILL-IN-AVSTARTD FILL-IN-OCH ~
FILL-IN-AVSLUTD CMB_PERS RAD_VAL CMB_ENTRE CMB_PROJL TOG_KALKYL TOG_OVRIGA ~
FILL-IN_PROJEKT FILL-IN_DATUM 

/* Custom List Definitions                                              */
/* List-1,List-2,List-3,List-4,List-5,List-6                            */

/* _UIB-PREPROCESSOR-BLOCK-END */
&ANALYZE-RESUME



/* ***********************  Control Definitions  ********************** */

/* Define the widget handle for the window                              */
DEFINE VAR C-Win AS WIDGET-HANDLE NO-UNDO.

/* Definitions of the field level widgets                               */
DEFINE BUTTON BTN_AVB 
     LABEL "Avbryt" 
     SIZE 14 BY 1.

DEFINE BUTTON BTN_EXCEL 
     LABEL "excel" 
     SIZE 14 BY 1.

DEFINE BUTTON BTN_FARG 
     LABEL "Färgkoder" 
     SIZE 14 BY 1.

DEFINE BUTTON BTN_OK 
     LABEL "OK" 
     SIZE 14 BY 1.

DEFINE BUTTON BTN_RENSA 
     LABEL "Rensa tid" 
     SIZE 14 BY 1.

DEFINE BUTTON BTN_SKRIV 
     LABEL "SKRIV UT" 
     SIZE 14 BY 1.

DEFINE BUTTON BTN_SPARA 
     LABEL "Snabbspara" 
     SIZE 14 BY 1.

DEFINE VARIABLE CMB_ENTRE AS CHARACTER FORMAT "X(256)":U 
     LABEL "Entreprenör" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "Item 1" 
     DROP-DOWN-LIST
     SIZE 10 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_PERS AS CHARACTER FORMAT "X(256)":U 
     LABEL "Personal" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "Item 1" 
     DROP-DOWN-LIST
     SIZE 10 BY 1 NO-UNDO.

DEFINE VARIABLE CMB_PROJL AS CHARACTER FORMAT "X(256)":U 
     LABEL "Projektledare" 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "Item 1" 
     DROP-DOWN-LIST
     SIZE 10 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-AVSLUTD AS DATE FORMAT "99/99/99":U 
     VIEW-AS FILL-IN 
     SIZE 9 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-AVSTARTD AS DATE FORMAT "99/99/99":U 
     LABEL "Visa veckor mellan" 
     VIEW-AS FILL-IN 
     SIZE 9 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-OCH AS CHARACTER FORMAT "X(3)":U 
     VIEW-AS FILL-IN 
     SIZE 4 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN_DATUM AS DATE FORMAT "9999/99/99":U 
     LABEL "Datum" 
      VIEW-AS TEXT 
     SIZE 15.88 BY .63 NO-UNDO.

DEFINE VARIABLE FILL-IN_PROJEKT AS CHARACTER FORMAT "X(256)":U 
     LABEL "Projekt" 
      VIEW-AS TEXT 
     SIZE 27.13 BY .63 NO-UNDO.

DEFINE VARIABLE RAD_VAL AS INTEGER 
     VIEW-AS RADIO-SET HORIZONTAL
     RADIO-BUTTONS 
          "Visning per dag", 1,
"Visning per vecka", 2,
"Visning per månad", 3
     SIZE 41.5 BY .79 NO-UNDO.

DEFINE RECTANGLE RECT-1
     EDGE-PIXELS 2 GRAPHIC-EDGE  NO-FILL   
     SIZE 37.5 BY 2.5.

DEFINE VARIABLE TOG_KALKYL AS LOGICAL INITIAL no 
     LABEL "Tidlägen för kalkyl" 
     VIEW-AS TOGGLE-BOX
     SIZE 15 BY .79 NO-UNDO.

DEFINE VARIABLE TOG_OVRIGA AS LOGICAL INITIAL no 
     LABEL "Övriga tidlägen" 
     VIEW-AS TOGGLE-BOX
     SIZE 15 BY .79 NO-UNDO.

DEFINE BUTTON BTN_AVB-alm 
     LABEL "Avbryt":L 
     SIZE 14 BY 1.

DEFINE BUTTON btn_back-ALM 
     IMAGE-UP FILE "BILDER\prev-u":U
     LABEL "":L 
     SIZE 4 BY 1.21.

DEFINE BUTTON BTN_KLAR-alm 
     LABEL "Ok":L 
     SIZE 14 BY 1.

DEFINE BUTTON btn_over-ALM 
     IMAGE-UP FILE "BILDER\next-u":U
     LABEL "":L 
     SIZE 4 BY 1.21.

DEFINE VARIABLE CMB_AR AS INTEGER FORMAT "9999":U INITIAL 0 
     VIEW-AS COMBO-BOX INNER-LINES 5
     LIST-ITEMS "0" 
     DROP-DOWN-LIST
     SIZE 12.5 BY 1
     FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE CMB_MANAD AS CHARACTER FORMAT "X(9)":U INITIAL "januari" 
     VIEW-AS COMBO-BOX INNER-LINES 12
     LIST-ITEMS "januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december" 
     DROP-DOWN-LIST
     SIZE 12.5 BY 1
     FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-1 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-10 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-11 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-12 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-13 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-14 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-15 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-16 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-17 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-18 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-19 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-2 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-20 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-21 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-22 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-23 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-24 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-25 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15  NO-UNDO.

DEFINE VARIABLE FILL-IN-26 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-27 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-28 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-29 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-3 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-30 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-31 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-32 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-33 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-34 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-35 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-36 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-37 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-4 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-5 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-6 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-7 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1
     BGCOLOR 15 FGCOLOR 0  NO-UNDO.

DEFINE VARIABLE FILL-IN-8 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-9 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-V-1 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-V-2 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-V-3 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-V-4 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-V-5 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3.5 BY 1 NO-UNDO.

DEFINE VARIABLE FILL-IN-V-6 AS INTEGER FORMAT "99":U INITIAL 0 
     VIEW-AS FILL-IN 
     SIZE 3.5 BY 1 NO-UNDO.


/* ************************  Frame Definitions  *********************** */

DEFINE FRAME DEFAULT-FRAME
     FILL-IN-AVSTARTD AT ROW 1.5 COL 27.25 COLON-ALIGNED
     FILL-IN-OCH AT ROW 1.5 COL 37.63 COLON-ALIGNED NO-LABEL
     FILL-IN-AVSLUTD AT ROW 1.5 COL 41.63 COLON-ALIGNED NO-LABEL
     CMB_PERS AT ROW 1.5 COL 60.38 COLON-ALIGNED
     RAD_VAL AT ROW 1.5 COL 67.5 NO-LABEL
     CMB_ENTRE AT ROW 1.5 COL 81.13 COLON-ALIGNED
     CMB_PROJL AT ROW 1.5 COL 103.38 COLON-ALIGNED
     TOG_KALKYL AT ROW 1.58 COL 1.5
     TOG_OVRIGA AT ROW 2.25 COL 1.5 WIDGET-ID 2
     BTN_SKRIV AT ROW 28.17 COL 18.5
     BTN_EXCEL AT ROW 28.17 COL 35.5
     BTN_FARG AT ROW 28.17 COL 51.75
     BTN_RENSA AT ROW 28.17 COL 66.5
     BTN_SPARA AT ROW 28.17 COL 81.5
     BTN_OK AT ROW 28.17 COL 96.5
     BTN_AVB AT ROW 28.17 COL 111.5
     FILL-IN_PROJEKT AT ROW 25.71 COL 94.88 COLON-ALIGNED
     FILL-IN_DATUM AT ROW 26.96 COL 94.88 COLON-ALIGNED
     RECT-1 AT ROW 25.5 COL 87.5
    WITH 1 DOWN NO-BOX KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1 ROW 1
         SIZE 124.75 BY 28.38.

DEFINE FRAME FRAME-ALMAN
     CMB_AR AT ROW 1.25 COL 1.5 COLON-ALIGNED NO-LABEL WIDGET-ID 10
     CMB_MANAD AT ROW 1.25 COL 15.5 COLON-ALIGNED NO-LABEL WIDGET-ID 12
     btn_back-ALM AT ROW 2.33 COL 3.5 WIDGET-ID 6
     btn_over-ALM AT ROW 2.33 COL 26 WIDGET-ID 8
     FILL-IN-V-1 AT ROW 5.08 COL 3.5 COLON-ALIGNED NO-LABEL WIDGET-ID 88
     FILL-IN-1 AT ROW 5.08 COL 9.38 COLON-ALIGNED NO-LABEL WIDGET-ID 14
     FILL-IN-2 AT ROW 5.08 COL 13.38 COLON-ALIGNED NO-LABEL WIDGET-ID 36
     FILL-IN-3 AT ROW 5.08 COL 17.38 COLON-ALIGNED NO-LABEL WIDGET-ID 58
     FILL-IN-4 AT ROW 5.08 COL 21.38 COLON-ALIGNED NO-LABEL WIDGET-ID 76
     FILL-IN-5 AT ROW 5.08 COL 25.38 COLON-ALIGNED NO-LABEL WIDGET-ID 78
     FILL-IN-6 AT ROW 5.08 COL 29.38 COLON-ALIGNED NO-LABEL WIDGET-ID 80
     FILL-IN-7 AT ROW 5.08 COL 33.38 COLON-ALIGNED NO-LABEL WIDGET-ID 82
     FILL-IN-V-2 AT ROW 6.58 COL 3.5 COLON-ALIGNED NO-LABEL WIDGET-ID 90
     FILL-IN-8 AT ROW 6.58 COL 9.38 COLON-ALIGNED NO-LABEL WIDGET-ID 84
     FILL-IN-9 AT ROW 6.58 COL 13.38 COLON-ALIGNED NO-LABEL WIDGET-ID 86
     FILL-IN-10 AT ROW 6.58 COL 17.38 COLON-ALIGNED NO-LABEL WIDGET-ID 16
     FILL-IN-11 AT ROW 6.58 COL 21.38 COLON-ALIGNED NO-LABEL WIDGET-ID 18
     FILL-IN-12 AT ROW 6.58 COL 25.38 COLON-ALIGNED NO-LABEL WIDGET-ID 20
     FILL-IN-13 AT ROW 6.58 COL 29.38 COLON-ALIGNED NO-LABEL WIDGET-ID 22
     FILL-IN-14 AT ROW 6.58 COL 33.38 COLON-ALIGNED NO-LABEL WIDGET-ID 24
     FILL-IN-V-3 AT ROW 8.08 COL 3.5 COLON-ALIGNED NO-LABEL WIDGET-ID 92
     FILL-IN-15 AT ROW 8.08 COL 9.38 COLON-ALIGNED NO-LABEL WIDGET-ID 26
     FILL-IN-16 AT ROW 8.08 COL 13.38 COLON-ALIGNED NO-LABEL WIDGET-ID 28
     FILL-IN-17 AT ROW 8.08 COL 17.38 COLON-ALIGNED NO-LABEL WIDGET-ID 30
     FILL-IN-18 AT ROW 8.08 COL 21.38 COLON-ALIGNED NO-LABEL WIDGET-ID 32
     FILL-IN-19 AT ROW 8.08 COL 25.38 COLON-ALIGNED NO-LABEL WIDGET-ID 34
     FILL-IN-20 AT ROW 8.08 COL 29.38 COLON-ALIGNED NO-LABEL WIDGET-ID 38
     FILL-IN-21 AT ROW 8.08 COL 33.38 COLON-ALIGNED NO-LABEL WIDGET-ID 40
     FILL-IN-V-4 AT ROW 9.58 COL 3.5 COLON-ALIGNED NO-LABEL WIDGET-ID 94
     FILL-IN-22 AT ROW 9.58 COL 9.38 COLON-ALIGNED NO-LABEL WIDGET-ID 42
     FILL-IN-23 AT ROW 9.58 COL 13.38 COLON-ALIGNED NO-LABEL WIDGET-ID 44
     FILL-IN-24 AT ROW 9.58 COL 17.38 COLON-ALIGNED NO-LABEL WIDGET-ID 46
     FILL-IN-25 AT ROW 9.58 COL 21.38 COLON-ALIGNED NO-LABEL WIDGET-ID 48
     FILL-IN-26 AT ROW 9.58 COL 25.38 COLON-ALIGNED NO-LABEL WIDGET-ID 50
     FILL-IN-27 AT ROW 9.58 COL 29.38 COLON-ALIGNED NO-LABEL WIDGET-ID 52
     FILL-IN-28 AT ROW 9.58 COL 33.38 COLON-ALIGNED NO-LABEL WIDGET-ID 54
     FILL-IN-V-5 AT ROW 11.08 COL 3.5 COLON-ALIGNED NO-LABEL WIDGET-ID 96
     FILL-IN-29 AT ROW 11.08 COL 9.38 COLON-ALIGNED NO-LABEL WIDGET-ID 56
     FILL-IN-30 AT ROW 11.08 COL 13.38 COLON-ALIGNED NO-LABEL WIDGET-ID 60
     FILL-IN-31 AT ROW 11.08 COL 17.38 COLON-ALIGNED NO-LABEL WIDGET-ID 62
     FILL-IN-32 AT ROW 11.08 COL 21.38 COLON-ALIGNED NO-LABEL WIDGET-ID 64
     FILL-IN-33 AT ROW 11.08 COL 25.38 COLON-ALIGNED NO-LABEL WIDGET-ID 66
     FILL-IN-34 AT ROW 11.08 COL 29.38 COLON-ALIGNED NO-LABEL WIDGET-ID 68
     FILL-IN-35 AT ROW 11.08 COL 33.38 COLON-ALIGNED NO-LABEL WIDGET-ID 70
     FILL-IN-V-6 AT ROW 12.58 COL 3.5 COLON-ALIGNED NO-LABEL WIDGET-ID 98
    WITH 1 DOWN KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1.75 ROW 1.08
         SIZE 41 BY 17 WIDGET-ID 100.

/* DEFINE FRAME statement is approaching 4K Bytes.  Breaking it up   */
DEFINE FRAME FRAME-ALMAN
     FILL-IN-36 AT ROW 12.58 COL 9.38 COLON-ALIGNED NO-LABEL WIDGET-ID 72
     FILL-IN-37 AT ROW 12.58 COL 13.38 COLON-ALIGNED NO-LABEL WIDGET-ID 74
     BTN_KLAR-alm AT ROW 16.5 COL 11.5 WIDGET-ID 4
     BTN_AVB-alm AT ROW 16.5 COL 26.5 WIDGET-ID 2
     "Vnr   M   T   O   T   F   L   S" VIEW-AS TEXT
          SIZE 33.5 BY 1 AT ROW 3.75 COL 5.88 WIDGET-ID 100
          BGCOLOR 15 FGCOLOR 0 FONT 24
    WITH 1 DOWN KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1.75 ROW 1.08
         SIZE 41 BY 17 WIDGET-ID 100.

DEFINE FRAME FRAME-MONTH
    WITH 1 DOWN NO-BOX KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1 ROW 3
         SIZE 124.75 BY 22.

DEFINE FRAME FRAME-WEEK
    WITH 1 DOWN NO-BOX KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1 ROW 3
         SIZE 124.75 BY 22.

DEFINE FRAME FRAME-DAY
    WITH 1 DOWN NO-BOX KEEP-TAB-ORDER OVERLAY 
         SIDE-LABELS NO-UNDERLINE THREE-D 
         AT COL 1 ROW 3
         SIZE 124.75 BY 22.


/* *********************** Procedure Settings ************************ */

&ANALYZE-SUSPEND _PROCEDURE-SETTINGS
/* Settings for THIS-PROCEDURE
   Type: Window
   Allow: Basic,Browse,DB-Fields,Window,Query
 */
&ANALYZE-RESUME _END-PROCEDURE-SETTINGS

/* *************************  Create Window  ************************** */

&ANALYZE-SUSPEND _CREATE-WINDOW
IF SESSION:DISPLAY-TYPE = "GUI":U THEN
  CREATE WINDOW C-Win ASSIGN
         HIDDEN             = YES
         TITLE              = "Guru-Tidplan"
         HEIGHT             = 28.42
         WIDTH              = 124.88
         MAX-HEIGHT         = 28.42
         MAX-WIDTH          = 124.88
         VIRTUAL-HEIGHT     = 28.42
         VIRTUAL-WIDTH      = 124.88
         RESIZE             = yes
         SCROLL-BARS        = no
         STATUS-AREA        = no
         BGCOLOR            = ?
         FGCOLOR            = ?
         KEEP-FRAME-Z-ORDER = yes
         THREE-D            = yes
         MESSAGE-AREA       = no
         SENSITIVE          = yes.
ELSE {&WINDOW-NAME} = CURRENT-WINDOW.
/* END WINDOW DEFINITION                                                */
&ANALYZE-RESUME



/* ***********  Runtime Attributes and AppBuilder Settings  *********** */

&ANALYZE-SUSPEND _RUN-TIME-ATTRIBUTES
/* SETTINGS FOR WINDOW C-Win
  NOT-VISIBLE,,RUN-PERSISTENT                                           */
/* REPARENT FRAME */
ASSIGN FRAME FRAME-ALMAN:FRAME = FRAME DEFAULT-FRAME:HANDLE
       FRAME FRAME-DAY:FRAME = FRAME DEFAULT-FRAME:HANDLE
       FRAME FRAME-MONTH:FRAME = FRAME DEFAULT-FRAME:HANDLE
       FRAME FRAME-WEEK:FRAME = FRAME DEFAULT-FRAME:HANDLE.

/* SETTINGS FOR FRAME DEFAULT-FRAME
   FRAME-NAME                                                           */
ASSIGN 
       FILL-IN-AVSLUTD:HIDDEN IN FRAME DEFAULT-FRAME           = TRUE.

ASSIGN 
       FILL-IN-AVSTARTD:HIDDEN IN FRAME DEFAULT-FRAME           = TRUE.

/* SETTINGS FOR FILL-IN FILL-IN-OCH IN FRAME DEFAULT-FRAME
   NO-ENABLE                                                            */
ASSIGN 
       FILL-IN-OCH:HIDDEN IN FRAME DEFAULT-FRAME           = TRUE.

ASSIGN 
       FILL-IN_DATUM:READ-ONLY IN FRAME DEFAULT-FRAME        = TRUE.

ASSIGN 
       FILL-IN_PROJEKT:READ-ONLY IN FRAME DEFAULT-FRAME        = TRUE.

/* SETTINGS FOR FRAME FRAME-ALMAN
   NOT-VISIBLE                                                          */
ASSIGN 
       FRAME FRAME-ALMAN:HIDDEN           = TRUE.

ASSIGN 
       BTN_KLAR-alm:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-1:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-2:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-29:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-3:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-30:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-31:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-32:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-4:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-5:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

ASSIGN 
       FILL-IN-6:HIDDEN IN FRAME FRAME-ALMAN           = TRUE.

/* SETTINGS FOR FRAME FRAME-DAY
   NOT-VISIBLE                                                          */
ASSIGN 
       FRAME FRAME-DAY:HIDDEN           = TRUE.

/* SETTINGS FOR FRAME FRAME-MONTH
   NOT-VISIBLE                                                          */
ASSIGN 
       FRAME FRAME-MONTH:HIDDEN           = TRUE.

/* SETTINGS FOR FRAME FRAME-WEEK
   NOT-VISIBLE                                                          */
ASSIGN 
       FRAME FRAME-WEEK:HIDDEN           = TRUE.

IF SESSION:DISPLAY-TYPE = "GUI":U AND VALID-HANDLE(C-Win)
THEN C-Win:HIDDEN = yes.

/* _RUN-TIME-ATTRIBUTES-END */
&ANALYZE-RESUME


/* Setting information for Queries and Browse Widgets fields            */

&ANALYZE-SUSPEND _QUERY-BLOCK FRAME FRAME-ALMAN
/* Query rebuild information for FRAME FRAME-ALMAN
     _Query            is NOT OPENED
*/  /* FRAME FRAME-ALMAN */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _QUERY-BLOCK FRAME FRAME-DAY
/* Query rebuild information for FRAME FRAME-DAY
     _Query            is NOT OPENED
*/  /* FRAME FRAME-DAY */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _QUERY-BLOCK FRAME FRAME-MONTH
/* Query rebuild information for FRAME FRAME-MONTH
     _Query            is NOT OPENED
*/  /* FRAME FRAME-MONTH */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _QUERY-BLOCK FRAME FRAME-WEEK
/* Query rebuild information for FRAME FRAME-WEEK
     _Query            is NOT OPENED
*/  /* FRAME FRAME-WEEK */
&ANALYZE-RESUME

 



/* ************************  Control Triggers  ************************ */

&Scoped-define SELF-NAME C-Win
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL C-Win C-Win
ON END-ERROR OF C-Win /* Guru-Tidplan */
OR ENDKEY OF {&WINDOW-NAME} ANYWHERE DO:
   IF skrivskydd = TRUE THEN RETURN NO-APPLY.
  /* This case occurs when the user presses the "Esc" key.
     In a persistently run window, just ignore this.  If we did not, the
     application would exit. */
   APPLY "CLOSE":U TO THIS-PROCEDURE.
   IF THIS-PROCEDURE:PERSISTENT THEN RETURN NO-APPLY.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL C-Win C-Win
ON WINDOW-CLOSE OF C-Win /* Guru-Tidplan */
DO:
  /* This event will close the window and terminate the procedure.  */
  IF skrivskydd = TRUE THEN RETURN NO-APPLY.
  APPLY "CLOSE":U TO THIS-PROCEDURE.
  RETURN NO-APPLY.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME BTN_AVB
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_AVB C-Win
ON CHOOSE OF BTN_AVB IN FRAME DEFAULT-FRAME /* Avbryt */
DO:
   IF skrivskydd = TRUE THEN RETURN NO-APPLY.
   MESSAGE "OBS! Vill du spara dina ändringar?"
   VIEW-AS ALERT-BOX
   QUESTION BUTTONS YES-NO-CANCEL TITLE "Spara ändringar?" UPDATE svar.         
   IF svar THEN DO:
      APPLY "CHOOSE" TO BTN_OK.         
   END.
   ELSE IF NOT svar THEN DO:          
   END.                    
   ELSE DO:
      RETURN NO-APPLY.
   END. 

   APPLY "CLOSE":U TO THIS-PROCEDURE.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME FRAME-ALMAN
&Scoped-define SELF-NAME BTN_AVB-alm
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_AVB-alm C-Win
ON CHOOSE OF BTN_AVB-alm IN FRAME FRAME-ALMAN /* Avbryt */
DO:
   regdatum = forstaregdatum.
   FRAME FRAME-ALMAN:HIDDEN = TRUE.
   RETURN.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME btn_back-ALM
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL btn_back-ALM C-Win
ON CHOOSE OF btn_back-ALM IN FRAME FRAME-ALMAN
DO:
   IF man = 01 THEN DO:
      CMB_AR = CMB_AR - 1.
      man = 12.
   END.
   ELSE man = man - 1.
   IF man = 01 THEN CMB_MANAD = STRING("januari"). 
   ELSE IF man = 02 THEN CMB_MANAD = STRING("februari").
   ELSE IF man = 03 THEN CMB_MANAD = STRING("mars").
   ELSE IF man = 04 THEN CMB_MANAD = STRING("april").
   ELSE IF man = 05 THEN CMB_MANAD = STRING("maj").
   ELSE IF man = 06 THEN CMB_MANAD = STRING("juni").
   ELSE IF man = 07 THEN CMB_MANAD = STRING("juli").
   ELSE IF man = 08 THEN CMB_MANAD = STRING("augusti").
   ELSE IF man = 09 THEN CMB_MANAD = STRING("september").
   ELSE IF man = 10 THEN CMB_MANAD = STRING("oktober").
   ELSE IF man = 11 THEN CMB_MANAD = STRING("november").
   ELSE IF man = 12 THEN CMB_MANAD = STRING("december").   
   DISP CMB_AR CMB_MANAD WITH FRAME FRAME-ALMAN. 
   APPLY "VALUE-CHANGED" TO CMB_MANAD.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME DEFAULT-FRAME
&Scoped-define SELF-NAME BTN_FARG
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_FARG C-Win
ON CHOOSE OF BTN_FARG IN FRAME DEFAULT-FRAME /* Färgkoder */
DO:
  IF skrivskydd = TRUE THEN RETURN NO-APPLY.
  skrivskydd = TRUE.
  RUN ARBAREG2.W (INPUT-OUTPUT skrivskydd).

END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME FRAME-ALMAN
&Scoped-define SELF-NAME BTN_KLAR-alm
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_KLAR-alm C-Win
ON CHOOSE OF BTN_KLAR-alm IN FRAME FRAME-ALMAN /* Ok */
DO:   
   IF datumval = 1 THEN FILL-IN-AVSTARTD = regdatum.
   IF datumval = 2 THEN FILL-IN-AVSLUTD = regdatum.
   FRAME FRAME-ALMAN:HIDDEN = TRUE.
   DISPLAY FILL-IN-AVSTARTD FILL-IN-AVSLUTD WITH FRAME DEFAULT-FRAME.
   RETURN.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME DEFAULT-FRAME
&Scoped-define SELF-NAME BTN_OK
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_OK C-Win
ON CHOOSE OF BTN_OK IN FRAME DEFAULT-FRAME /* OK */
DO:
   RUN sparplan_UI (INPUT TRUE).
   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME FRAME-ALMAN
&Scoped-define SELF-NAME btn_over-ALM
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL btn_over-ALM C-Win
ON CHOOSE OF btn_over-ALM IN FRAME FRAME-ALMAN
DO:
   IF man = 12 THEN DO:
      CMB_AR = CMB_AR + 1.
      man = 01.
   END.
   ELSE man = man + 1.
   IF man = 01 THEN CMB_MANAD = STRING("januari"). 
   ELSE IF man = 02 THEN CMB_MANAD = STRING("februari").
   ELSE IF man = 03 THEN CMB_MANAD = STRING("mars").
   ELSE IF man = 04 THEN CMB_MANAD = STRING("april").
   ELSE IF man = 05 THEN CMB_MANAD = STRING("maj").
   ELSE IF man = 06 THEN CMB_MANAD = STRING("juni").
   ELSE IF man = 07 THEN CMB_MANAD = STRING("juli").
   ELSE IF man = 08 THEN CMB_MANAD = STRING("augusti").
   ELSE IF man = 09 THEN CMB_MANAD = STRING("september").
   ELSE IF man = 10 THEN CMB_MANAD = STRING("oktober").
   ELSE IF man = 11 THEN CMB_MANAD = STRING("november").
   ELSE IF man = 12 THEN CMB_MANAD = STRING("december").   
   DISP CMB_AR CMB_MANAD WITH FRAME FRAME-ALMAN. 
   APPLY "VALUE-CHANGED" TO CMB_MANAD.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME DEFAULT-FRAME
&Scoped-define SELF-NAME BTN_RENSA
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_RENSA C-Win
ON CHOOSE OF BTN_RENSA IN FRAME DEFAULT-FRAME /* Rensa tid */
DO:
   IF skrivskydd = TRUE THEN RETURN NO-APPLY.
   RUN rensa_UI IN tidsplandynh.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME BTN_SPARA
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL BTN_SPARA C-Win
ON CHOOSE OF BTN_SPARA IN FRAME DEFAULT-FRAME /* Snabbspara */
DO:
   RUN sparplan_UI (INPUT FALSE).

END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME FRAME-ALMAN
&Scoped-define SELF-NAME CMB_AR
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_AR C-Win
ON LEAVE OF CMB_AR IN FRAME FRAME-ALMAN
DO:
   CMB_AR = INPUT CMB_AR.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_AR C-Win
ON VALUE-CHANGED OF CMB_AR IN FRAME FRAME-ALMAN
DO:
   CMB_AR = INPUT CMB_AR.
   RUN laddadag_UI. /*LADDAR DAGAR. I FILL-IN-FÄLT*/
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME DEFAULT-FRAME
&Scoped-define SELF-NAME CMB_ENTRE
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_ENTRE C-Win
ON VALUE-CHANGED OF CMB_ENTRE IN FRAME DEFAULT-FRAME /* Entreprenör */
DO:
   IF skrivskydd = TRUE THEN RETURN NO-APPLY.
   RUN entre_UI IN tidsplandynh (INPUT CMB_ENTRE:HANDLE).
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME FRAME-ALMAN
&Scoped-define SELF-NAME CMB_MANAD
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_MANAD C-Win
ON LEAVE OF CMB_MANAD IN FRAME FRAME-ALMAN
DO:
   CMB_MANAD = INPUT CMB_MANAD.
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_MANAD C-Win
ON VALUE-CHANGED OF CMB_MANAD IN FRAME FRAME-ALMAN
DO:
   CMB_MANAD = INPUT CMB_MANAD.
   RUN laddadag_UI. /*LADDAR DAGAR I FILL-IN-FÄLT*/
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME DEFAULT-FRAME
&Scoped-define SELF-NAME CMB_PERS
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_PERS C-Win
ON VALUE-CHANGED OF CMB_PERS IN FRAME DEFAULT-FRAME /* Personal */
DO:
   IF skrivskydd = TRUE THEN RETURN NO-APPLY.
   RUN pers_UI IN tidsplandynh (INPUT CMB_PERS:HANDLE).
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME CMB_PROJL
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL CMB_PROJL C-Win
ON VALUE-CHANGED OF CMB_PROJL IN FRAME DEFAULT-FRAME /* Projektledare */
DO:
   IF skrivskydd = TRUE THEN RETURN NO-APPLY.
   RUN proj_UI IN tidsplandynh (INPUT CMB_PROJL:HANDLE).
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME FRAME-ALMAN
&Scoped-define SELF-NAME FILL-IN-1
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-1 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-1 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-1 = INPUT FILL-IN-1
   regdatum = DATE(man,FILL-IN-1,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-10
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-10 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-10 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-10 = INPUT FILL-IN-10
   regdatum = DATE(man,FILL-IN-10,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-11
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-11 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-11 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-11 = INPUT FILL-IN-11
   regdatum = DATE(man,FILL-IN-11,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-12
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-12 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-12 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-12 = INPUT FILL-IN-12
   regdatum = DATE(man,FILL-IN-12,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-13
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-13 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-13 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-13 = INPUT FILL-IN-13
   regdatum = DATE(man,FILL-IN-13,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-14
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-14 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-14 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-14 = INPUT FILL-IN-14
   regdatum = DATE(man,FILL-IN-14,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-15
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-15 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-15 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-15 = INPUT FILL-IN-15
   regdatum = DATE(man,FILL-IN-15,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-16
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-16 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-16 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-16 = INPUT FILL-IN-16
   regdatum = DATE(man,FILL-IN-16,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-17
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-17 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-17 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-17 = INPUT FILL-IN-17
   regdatum = DATE(man,FILL-IN-17,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-18
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-18 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-18 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-18 = INPUT FILL-IN-18
   regdatum = DATE(man,FILL-IN-18,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-19
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-19 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-19 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-19 = INPUT FILL-IN-19
   regdatum = DATE(man,FILL-IN-19,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-2
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-2 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-2 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-2 = INPUT FILL-IN-2
   regdatum = DATE(man,FILL-IN-2,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-20
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-20 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-20 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-20 = INPUT FILL-IN-20
   regdatum = DATE(man,FILL-IN-20,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-21
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-21 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-21 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-21 = INPUT FILL-IN-21
   regdatum = DATE(man,FILL-IN-21,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-22
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-22 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-22 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-22 = INPUT FILL-IN-22
   regdatum = DATE(man,FILL-IN-22,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-23
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-23 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-23 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-23 = INPUT FILL-IN-23
   regdatum = DATE(man,FILL-IN-23,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-24
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-24 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-24 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-24 = INPUT FILL-IN-24
   regdatum = DATE(man,FILL-IN-24,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-25
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-25 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-25 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-25 = INPUT FILL-IN-25
   regdatum = DATE(man,FILL-IN-25,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-26
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-26 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-26 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-26 = INPUT FILL-IN-26
   regdatum = DATE(man,FILL-IN-26,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-27
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-27 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-27 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-27 = INPUT FILL-IN-27
   regdatum = DATE(man,FILL-IN-27,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-28
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-28 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-28 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-28 = INPUT FILL-IN-28
   regdatum = DATE(man,FILL-IN-28,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-29
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-29 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-29 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-29 = INPUT FILL-IN-29
   regdatum = DATE(man,FILL-IN-29,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-3
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-3 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-3 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-3 = INPUT FILL-IN-3
   regdatum = DATE(man,FILL-IN-3,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-30
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-30 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-30 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-30 = INPUT FILL-IN-30
   regdatum = DATE(man,FILL-IN-30,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-31
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-31 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-31 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-31 = INPUT FILL-IN-31
   regdatum = DATE(man,FILL-IN-31,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-32
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-32 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-32 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-32 = INPUT FILL-IN-32
   regdatum = DATE(man,FILL-IN-32,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-33
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-33 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-33 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-33 = INPUT FILL-IN-33
   regdatum = DATE(man,FILL-IN-33,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-34
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-34 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-34 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-34 = INPUT FILL-IN-34
   regdatum = DATE(man,FILL-IN-34,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-35
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-35 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-35 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-35 = INPUT FILL-IN-35
   regdatum = DATE(man,FILL-IN-35,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-36
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-36 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-36 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-36 = INPUT FILL-IN-36
   regdatum = DATE(man,FILL-IN-36,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-37
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-37 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-37 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-37 = INPUT FILL-IN-37
   regdatum = DATE(man,FILL-IN-37,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-4
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-4 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-4 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-4 = INPUT FILL-IN-4
   regdatum = DATE(man,FILL-IN-4,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-5
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-5 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-5 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-5 = INPUT FILL-IN-5
   regdatum = DATE(man,FILL-IN-5,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-6
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-6 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-6 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-6 = INPUT FILL-IN-6
   regdatum = DATE(man,FILL-IN-6,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-7
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-7 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-7 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-7 = INPUT FILL-IN-7
   regdatum = DATE(man,FILL-IN-7,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-8
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-8 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-8 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-8 = INPUT FILL-IN-8
   regdatum = DATE(man,FILL-IN-8,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-9
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-9 C-Win
ON MOUSE-SELECT-CLICK OF FILL-IN-9 IN FRAME FRAME-ALMAN
DO:
   ASSIGN
   FILL-IN-9 = INPUT FILL-IN-9
   regdatum = DATE(man,FILL-IN-9,ye).
   APPLY "CHOOSE" TO BTN_KLAR-alm in FRAME FRAME-ALMAN.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define FRAME-NAME DEFAULT-FRAME
&Scoped-define SELF-NAME FILL-IN-AVSLUTD
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-AVSLUTD C-Win
ON MOUSE-MENU-CLICK OF FILL-IN-AVSLUTD IN FRAME DEFAULT-FRAME
DO:
   datumval = 2.
   ASSIGN
   FILL-IN-AVSLUTD = INPUT FILL-IN-AVSLUTD
   regdatum = INPUT FILL-IN-AVSLUTD.
   FRAME FRAME-ALMAN:HIDDEN = FALSE.
   RUN allman_UI.
   
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&Scoped-define SELF-NAME FILL-IN-AVSTARTD
&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CONTROL FILL-IN-AVSTARTD C-Win
ON MOUSE-MENU-CLICK OF FILL-IN-AVSTARTD IN FRAME DEFAULT-FRAME /* Visa veckor mellan */
DO:
   
   datumval = 1.
   ASSIGN
   FILL-IN-AVSTARTD = INPUT FILL-IN-AVSTARTD
   regdatum = INPUT FILL-IN-AVSTARTD.
   FRAME FRAME-ALMAN:HIDDEN = FALSE.
   RUN allman_UI.
    
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


&UNDEFINE SELF-NAME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _CUSTOM _MAIN-BLOCK C-Win 


/* ***************************  Main Block  *************************** */

/* Set CURRENT-WINDOW: this will parent dialog-boxes and frames.        */
ASSIGN CURRENT-WINDOW                = {&WINDOW-NAME} 
       THIS-PROCEDURE:CURRENT-WINDOW = {&WINDOW-NAME}.

/* The CLOSE event can be used from inside or outside the procedure to  */
/* terminate it.                                                        */
ON CLOSE OF THIS-PROCEDURE 
DO:
   IF VALID-HANDLE(tidsplandynh) THEN RUN avs_UI IN tidsplandynh.
   {BORTBRWPROC.I}   
   IF VALID-HANDLE(nyttaoapph) THEN DO:
      RUN borthandle_UI IN nyttaoapph.
      DELETE PROCEDURE nyttaoapph NO-ERROR.
      nyttaoapph = ?.
   END.  
   IF VALID-HANDLE(exdatahmth) THEN DELETE PROCEDURE exdatahmth NO-ERROR.
   IF VALID-HANDLE(tidsplandynh) THEN DO:
      RUN releaseh_UI IN tidsplandynh.
      DELETE PROCEDURE tidsplandynh NO-ERROR.  
   END.
   RUN disable_UI.
END.   

/* Best default for GUI applications is...                              */
PAUSE 0 BEFORE-HIDE.

/* Now enable the interface and wait for the exit condition.            */
/* (NOTE: handle ERROR and END-KEY so cleanup code will always fire.    */
MAIN-BLOCK:
DO ON ERROR   UNDO MAIN-BLOCK, LEAVE MAIN-BLOCK
   ON END-KEY UNDO MAIN-BLOCK, LEAVE MAIN-BLOCK:
   DEFINE VARIABLE num AS INTEGER NO-UNDO.
   
   {WIN_M_START.I}   
   {muswait.i}
   {ALLSTARTDYN.I}  
   ASSIGN
   FILL-IN_DATUM = TODAY
   FILL-IN_PROJEKT = Guru.Konstanter:globforetag
   ingenkod = FALSE.   
   RUN arbartout_UI IN nyttaoapph (OUTPUT TABLE arbarttemp).   
   FIND FIRST arbarttemp NO-LOCK NO-ERROR.
   IF NOT AVAILABLE arbarttemp THEN DO:
      MESSAGE "Du har inga " LC(Guru.Konstanter:gartk) " i systemet." VIEW-AS ALERT-BOX.
      LEAVE MAIN-BLOCK.
   END.      
   RUN kalkylstart_UI.    
   FIND FIRST tidsplantemp NO-LOCK NO-ERROR.
   IF NOT AVAILABLE tidsplantemp THEN DO:
      IF typ = "PROJEKT" THEN DO:
         MESSAGE "Du har inte valt några " LC(Guru.Konstanter:gaok) " med rätt " LC(Guru.Konstanter:gartk) VIEW-AS ALERT-BOX.
         LEAVE MAIN-BLOCK.
      END.
      ELSE IF typ = "PLAN" THEN DO:
         MESSAGE "Du har inte valt några " LC(Guru.Konstanter:gplk) " med rätt " LC(Guru.Konstanter:gartk) VIEW-AS ALERT-BOX.
         LEAVE MAIN-BLOCK.
      END.
   END.   
   /*generellt för båda här nedan*/
   FILL-IN-OCH = "och".
   FIND FIRST tidsplantemp WHERE tidsplantemp.STARTDAT NE ? USE-INDEX DATUM NO-LOCK NO-ERROR.
   IF AVAILABLE tidsplantemp THEN DO:
      FILL-IN-AVSTARTD = tidsplantemp.STARTDAT.
   END.
   ELSE DO:
      FILL-IN-AVSTARTD = TODAY.
   END.   
   FIND LAST tidsplantemp WHERE tidsplantemp.SLUTDAT NE ? USE-INDEX SDATUM NO-LOCK NO-ERROR.
   IF AVAILABLE tidsplantemp THEN DO:
      FILL-IN-AVSLUTD = tidsplantemp.SLUTDAT.
   END.
   ELSE DO:
      FILL-IN-AVSLUTD = FILL-IN-AVSTARTD + 14.
   END.
   IF FILL-IN-AVSLUTD -  FILL-IN-AVSTARTD > 365 THEN FILL-IN-AVSLUTD = FILL-IN-AVSTARTD + 365.
   RUN kalkyldel2_UI. 
   RUN enable_UI.
   IF typ = "PLAN" THEN TOG_OVRIGA:HIDDEN = TRUE.
   RUN createbrw_UI IN tidsplandynh.
   FRAME FRAME-DAY:HIDDEN = FALSE.
   ASSIGN
   CMB_PERS:HIDDEN = TRUE
   CMB_ENTRE:HIDDEN = TRUE
   CMB_PROJL:HIDDEN = TRUE.  
   {FRMSIZEF.I}   
   ASSIGN
   Guru.GlobalaVariabler:collefth = ?.
   Guru.GlobalaVariabler:colrighth = BTN_AVB:HANDLE.           
   RUN buttcolh_UI IN framesizeh (INPUT Guru.GlobalaVariabler:collefth,INPUT Guru.GlobalaVariabler:colrighth,OUTPUT OPcollefth).
   Guru.GlobalaVariabler:colrighth = BTN_OK:HANDLE.      
   RUN buttcolh_UI IN framesizeh (INPUT Guru.GlobalaVariabler:collefth,INPUT Guru.GlobalaVariabler:colrighth,OUTPUT OPcollefth).
   Guru.GlobalaVariabler:colrighth = BTN_SPARA:HANDLE.      
   RUN buttcolh_UI IN framesizeh (INPUT Guru.GlobalaVariabler:collefth,INPUT Guru.GlobalaVariabler:colrighth,OUTPUT OPcollefth).
   BTN_RENSA:HIDDEN = TRUE.   
   Guru.GlobalaVariabler:colrighth = BTN_FARG:HANDLE.      
   RUN buttcolh_UI IN framesizeh (INPUT Guru.GlobalaVariabler:collefth,INPUT Guru.GlobalaVariabler:colrighth,OUTPUT OPcollefth).
   Guru.GlobalaVariabler:colrighth = BTN_EXCEL:HANDLE.      
   RUN buttcolh_UI IN framesizeh (INPUT Guru.GlobalaVariabler:collefth,INPUT Guru.GlobalaVariabler:colrighth,OUTPUT OPcollefth).
   Guru.GlobalaVariabler:colrighth = BTN_SKRIV:HANDLE.      
   RUN buttcolh_UI IN framesizeh (INPUT Guru.GlobalaVariabler:collefth,INPUT Guru.GlobalaVariabler:colrighth,OUTPUT OPcollefth).
   RUN sistabredd_UI IN tidsplandynh.       
   {musarrow.i}
   {WIN_M_SLUT.I}
   RUN fixastorlek_UI IN tidsplandynh.
   APPLY "LEAVE" TO FILL-IN-AVSLUTD.   
   IF NOT THIS-PROCEDURE:PERSISTENT THEN WAIT-FOR CLOSE OF THIS-PROCEDURE.  
END.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME


/* **********************  Internal Procedures  *********************** */

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE allman_UI C-Win 
PROCEDURE allman_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   ASSIGN   
   forstaregdatum = regdatum.
   ASSIGN  /*LADDAR ÅR I CMB_AR*/
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum) - 3,"9999")) IN FRAME FRAME-ALMAN  
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum) - 2,"9999"))
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum) - 1,"9999"))
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum),"9999"))
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum) + 1,"9999"))
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum) + 2,"9999"))
   status-ok = CMB_AR:ADD-LAST(STRING(YEAR(regdatum) + 3,"9999")).
   ASSIGN
   status-ok = CMB_AR:DELETE("0")
   CMB_AR:SCREEN-VALUE = STRING(YEAR(regdatum),"9999")
   CMB_AR = INPUT CMB_AR.
   RUN manad_UI. /*LADDAR MÅNADER I CMB_MANAD*/
   BTN_KLAR-ALM:HIDDEN = TRUE.  
   RUN laddadag_UI. /*LADDAR DAGAR I FILL-IN-FÄLT*/ 
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE allstartbrw_UI C-Win 
PROCEDURE allstartbrw_UI :
/* -----------------------------------------------------------
  Purpose: Changing screen-value for combo-box CMB_OMR     
  Parameters:  Input = Screen-value for CMB_FOR
  Notes:       
-------------------------------------------------------------*/  
   DEFINE VARIABLE ordningnr AS INTEGER NO-UNDO.   
   EMPTY TEMP-TABLE whandltemp NO-ERROR. 
   CREATE whandltemp.
   ordningnr = 1.
   RUN whandle_UI (INPUT-OUTPUT ordningnr, RAD_VAL:HANDLE IN FRAME DEFAULT-FRAME).
   RUN whandle_UI (INPUT-OUTPUT ordningnr,FRAME FRAME-MONTH:HANDLE).
   RUN whandle_UI (INPUT-OUTPUT ordningnr,BTN_EXCEL:HANDLE IN FRAME DEFAULT-FRAME).
   RUN whandle_UI (INPUT-OUTPUT ordningnr,FRAME FRAME-DAY:HANDLE).
   RUN whandle_UI (INPUT-OUTPUT ordningnr,FRAME FRAME-WEEK:HANDLE).
   RUN whandle_UI (INPUT-OUTPUT ordningnr,THIS-PROCEDURE).
   RUN whandle_UI (INPUT-OUTPUT ordningnr,BTN_SKRIV:HANDLE IN FRAME DEFAULT-FRAME).
   RUN whandle_UI (INPUT-OUTPUT ordningnr,TOG_KALKYL:HANDLE IN FRAME DEFAULT-FRAME).
   RUN whandle_UI (INPUT-OUTPUT ordningnr,TOG_OVRIGA:HANDLE IN FRAME DEFAULT-FRAME).   
   RUN TIDSPLANDYN.P PERSISTENT SET tidsplandynh
      (INPUT FRAME DEFAULT-FRAME:HANDLE,INPUT FILL-IN-AVSTARTD:HANDLE,INPUT FILL-IN-AVSLUTD:HANDLE,typ,INPUT TABLE whandltemp).    
   IF Guru.Konstanter:appcon THEN DO:
      RUN NYTTAOAPP.P PERSISTENT SET nyttaoapph ON Guru.Konstanter:apphand TRANSACTION DISTINCT. 
      RUN EXTRADATAHMT.P PERSISTENT SET exdatahmth ON Guru.Konstanter:apphand TRANSACTION DISTINCT.                  
   END.
   ELSE DO:
      RUN NYTTAOAPP.P PERSISTENT SET nyttaoapph.
      RUN EXTRADATAHMT.P PERSISTENT SET exdatahmth.
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE disable_UI C-Win  _DEFAULT-DISABLE
PROCEDURE disable_UI :
/*------------------------------------------------------------------------------
  Purpose:     DISABLE the User Interface
  Parameters:  <none>
  Notes:       Here we clean-up the user-interface by deleting
               dynamic widgets we have created and/or hide 
               frames.  This procedure is usually called when
               we are ready to "clean-up" after running.
------------------------------------------------------------------------------*/
  /* Delete the WINDOW we created */
  IF SESSION:DISPLAY-TYPE = "GUI":U AND VALID-HANDLE(C-Win)
  THEN DELETE WIDGET C-Win.
  IF THIS-PROCEDURE:PERSISTENT THEN DELETE PROCEDURE THIS-PROCEDURE.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE enable_UI C-Win  _DEFAULT-ENABLE
PROCEDURE enable_UI :
/*------------------------------------------------------------------------------
  Purpose:     ENABLE the User Interface
  Parameters:  <none>
  Notes:       Here we display/view/enable the widgets in the
               user-interface.  In addition, OPEN all queries
               associated with each FRAME and BROWSE.
               These statements here are based on the "Other 
               Settings" section of the widget Property Sheets.
------------------------------------------------------------------------------*/
  DISPLAY FILL-IN-AVSTARTD FILL-IN-OCH FILL-IN-AVSLUTD CMB_PERS RAD_VAL 
          CMB_ENTRE CMB_PROJL TOG_KALKYL TOG_OVRIGA FILL-IN_PROJEKT 
          FILL-IN_DATUM 
      WITH FRAME DEFAULT-FRAME IN WINDOW C-Win.
  ENABLE RECT-1 FILL-IN-AVSTARTD FILL-IN-AVSLUTD CMB_PERS RAD_VAL CMB_ENTRE 
         CMB_PROJL TOG_KALKYL TOG_OVRIGA BTN_SKRIV BTN_EXCEL BTN_FARG BTN_RENSA 
         BTN_SPARA BTN_OK BTN_AVB FILL-IN_PROJEKT FILL-IN_DATUM 
      WITH FRAME DEFAULT-FRAME IN WINDOW C-Win.
  {&OPEN-BROWSERS-IN-QUERY-DEFAULT-FRAME}
  DISPLAY CMB_AR CMB_MANAD FILL-IN-V-1 FILL-IN-1 FILL-IN-2 FILL-IN-3 FILL-IN-4 
          FILL-IN-5 FILL-IN-6 FILL-IN-7 FILL-IN-V-2 FILL-IN-8 FILL-IN-9 
          FILL-IN-10 FILL-IN-11 FILL-IN-12 FILL-IN-13 FILL-IN-14 FILL-IN-V-3 
          FILL-IN-15 FILL-IN-16 FILL-IN-17 FILL-IN-18 FILL-IN-19 FILL-IN-20 
          FILL-IN-21 FILL-IN-V-4 FILL-IN-22 FILL-IN-23 FILL-IN-24 FILL-IN-25 
          FILL-IN-26 FILL-IN-27 FILL-IN-28 FILL-IN-V-5 FILL-IN-29 FILL-IN-30 
          FILL-IN-31 FILL-IN-32 FILL-IN-33 FILL-IN-34 FILL-IN-35 FILL-IN-V-6 
          FILL-IN-36 FILL-IN-37 
      WITH FRAME FRAME-ALMAN IN WINDOW C-Win.
  ENABLE CMB_AR CMB_MANAD btn_back-ALM btn_over-ALM FILL-IN-V-1 FILL-IN-1 
         FILL-IN-2 FILL-IN-3 FILL-IN-4 FILL-IN-5 FILL-IN-6 FILL-IN-7 
         FILL-IN-V-2 FILL-IN-8 FILL-IN-9 FILL-IN-10 FILL-IN-11 FILL-IN-12 
         FILL-IN-13 FILL-IN-14 FILL-IN-V-3 FILL-IN-15 FILL-IN-16 FILL-IN-17 
         FILL-IN-18 FILL-IN-19 FILL-IN-20 FILL-IN-21 FILL-IN-V-4 FILL-IN-22 
         FILL-IN-23 FILL-IN-24 FILL-IN-25 FILL-IN-26 FILL-IN-27 FILL-IN-28 
         FILL-IN-V-5 FILL-IN-29 FILL-IN-30 FILL-IN-31 FILL-IN-32 FILL-IN-33 
         FILL-IN-34 FILL-IN-35 FILL-IN-V-6 FILL-IN-36 FILL-IN-37 BTN_KLAR-alm 
         BTN_AVB-alm 
      WITH FRAME FRAME-ALMAN IN WINDOW C-Win.
  {&OPEN-BROWSERS-IN-QUERY-FRAME-ALMAN}
  {&OPEN-BROWSERS-IN-QUERY-FRAME-DAY}
  {&OPEN-BROWSERS-IN-QUERY-FRAME-MONTH}
  {&OPEN-BROWSERS-IN-QUERY-FRAME-WEEK}
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE fre_UI C-Win 
PROCEDURE fre_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
    ASSIGN
      FILL-IN-1:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-2:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-3:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-4:HIDDEN IN FRAME FRAME-ALMAN = TRUE      
      FILL-IN-5:SCREEN-VALUE IN FRAME FRAME-ALMAN= STRING((1),"9") 
      FILL-IN-6:SCREEN-VALUE = STRING((2),"9") FILL-IN-7:SCREEN-VALUE = STRING((3),"9") 
      FILL-IN-8:SCREEN-VALUE = STRING((4),"9") FILL-IN-9:SCREEN-VALUE = STRING((5),"9") 
      FILL-IN-10:SCREEN-VALUE = STRING((6),"9") FILL-IN-11:SCREEN-VALUE = STRING((7),"9") 
      FILL-IN-12:SCREEN-VALUE = STRING((8),"9") FILL-IN-13:SCREEN-VALUE = STRING((9),"9")
      FILL-IN-14:SCREEN-VALUE = STRING((10),"99") FILL-IN-15:SCREEN-VALUE = STRING((11),"99") 
      FILL-IN-16:SCREEN-VALUE = STRING((12),"99") FILL-IN-17:SCREEN-VALUE = STRING((13),"99") 
      FILL-IN-18:SCREEN-VALUE = STRING((14),"99") FILL-IN-19:SCREEN-VALUE = STRING((15),"99") 
      FILL-IN-20:SCREEN-VALUE = STRING((16),"99") FILL-IN-21:SCREEN-VALUE = STRING((17),"99") 
      FILL-IN-22:SCREEN-VALUE = STRING((18),"99") FILL-IN-23:SCREEN-VALUE = STRING((19),"99") 
      FILL-IN-24:SCREEN-VALUE = STRING((20),"99") FILL-IN-25:SCREEN-VALUE = STRING((21),"99")
      FILL-IN-26:SCREEN-VALUE = STRING((22),"99") FILL-IN-27:SCREEN-VALUE = STRING((23),"99") 
      FILL-IN-28:SCREEN-VALUE = STRING((24),"99") FILL-IN-29:SCREEN-VALUE = STRING((25),"99") 
      FILL-IN-30:SCREEN-VALUE = STRING((26),"99") FILL-IN-31:SCREEN-VALUE = STRING((27),"99")      
      FILL-IN-32:SCREEN-VALUE = STRING((28),"99") FILL-IN-33:SCREEN-VALUE = STRING((29),"99")      
      FILL-IN-34:SCREEN-VALUE = STRING((30),"99") FILL-IN-35:SCREEN-VALUE = STRING((31),"99").
      IF day = 31 THEN DO:
         ASSIGN                        
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.     
      ELSE IF day = 30 THEN DO:
         ASSIGN                               
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.    
      ELSE IF day = 28 THEN DO:
         ASSIGN                                 
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.     
      ELSE DO:
         ASSIGN                              
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.  
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE kalkyldel2_UI C-Win 
PROCEDURE kalkyldel2_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   /* nytt för rätt färgkod */
   IF Guru.Konstanter:appcon THEN DO:
      RUN ARBAPP.P PERSISTENT SET arbapph ON Guru.Konstanter:apphand TRANSACTION DISTINCT. 
   END.
   ELSE DO:
      RUN ARBAPP.P PERSISTENT SET arbapph.
   END.   
   RUN arbhmt2_UI IN arbapph (OUTPUT TABLE arbarttemp2).

   FOR EACH tidsplantemp WHERE tidsplantemp.IDTIDLAG = "TIDPLAN":
      FIND FIRST arbarttemp2 WHERE arbarttemp2.ARBARTKOD = tidsplantemp.ARBARTKOD.
      IF AVAILABLE arbarttemp2 THEN DO:
         tidsplantemp.FARGNR = arbarttemp2.FARGKOD.
      END.
   END.
   /*slut ny*/

  
   
   
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE kalkylstart_UI C-Win 
PROCEDURE kalkylstart_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   EMPTY TEMP-TABLE tidsplantemp NO-ERROR. 
   num = 1.     
   IF typ = "PROJEKT" THEN DO:
      FOR EACH arbarttemp NO-LOCK:
         FOR EACH valdaao WHERE valdaao.ARBARTKOD = arbarttemp.ARBARTKOD NO-LOCK:
            RUN laddaaotid IN nyttaoapph (INPUT valdaao.AONR,INPUT valdaao.DELNR,OUTPUT TABLE aotidslagtemp).
            FIND FIRST aotidslagtemp WHERE aotidslagtemp.AONR = valdaao.AONR AND aotidslagtemp.DELNR = valdaao.DELNR AND 
            aotidslagtemp.IDTIDLAG = "TIDPLAN" NO-LOCK NO-ERROR.           
            IF NOT AVAILABLE aotidslagtemp THEN DO:
               /*KOLLAR SÅ ATT TIDLÄGET FINNS PÅ aONR*/
               RUN tidlagenh_UI (INPUT "TIDPLAN").
               RUN tidlagenh_UI (INPUT "KMONT").
               RUN tidlagenh_UI (INPUT "KBER").
               RUN tidlagenh_UI (INPUT "KMASK").               
               RUN laddaaotid IN nyttaoapph (INPUT valdaao.AONR,INPUT valdaao.DELNR,OUTPUT TABLE aotidslagtemp).               
            END.
            ELSE DO:
               FIND FIRST aotidslagtemp WHERE aotidslagtemp.AONR = valdaao.AONR AND aotidslagtemp.DELNR = valdaao.DELNR AND 
               aotidslagtemp.IDTIDLAG = "KMONT" NO-LOCK NO-ERROR.
               IF NOT AVAILABLE aotidslagtemp THEN DO:
                  RUN tidlagenh_UI (INPUT "KMONT").
                  RUN tidlagenh_UI (INPUT "KBER").
                  RUN tidlagenh_UI (INPUT "KMASK").
                  RUN laddaaotid IN nyttaoapph (INPUT valdaao.AONR,INPUT valdaao.DELNR,OUTPUT TABLE aotidslagtemp).                           
               END. 
            END.
            /*CREATE tidsplantemp.*/
            RUN tidlagen_UI (INPUT "TIDPLAN").
            ASSIGN 
            tidsplantemp.TIDPLAN = TRUE
            tidsplantemp.KALKYL = FALSE 
            tidsplantemp.OVRIGA = FALSE. 
            RUN tidlagen_UI (INPUT "KMONT").           
            ASSIGN 
            tidsplantemp.TIDPLAN = FALSE
            tidsplantemp.KALKYL = TRUE 
            tidsplantemp.OVRIGA = FALSE. 
            RUN tidlagen_UI (INPUT "KBER").
            ASSIGN 
            tidsplantemp.TIDPLAN = FALSE
            tidsplantemp.KALKYL = TRUE 
            tidsplantemp.OVRIGA = FALSE. 
            RUN tidlagen_UI (INPUT "KMASK").
            ASSIGN 
            tidsplantemp.TIDPLAN = FALSE
            tidsplantemp.KALKYL = TRUE 
            tidsplantemp.OVRIGA = FALSE. 
            RUN kalkyl_UI.            
         END.       
      END.        
      FOR EACH tidsplantemp WHERE tidsplantemp.IDTIDLAG = "TIDPLAN" :
         CREATE inextradatatemp.          
         ASSIGN
         inextradatatemp.PROGRAM = "AOREF"                   
         inextradatatemp.HUVUDCH = tidsplantemp.AONR.                    
         inextradatatemp.HUVUDINT = tidsplantemp.DELNR.                    
         RUN etabhamt_UI IN exdatahmth (INPUT TABLE inextradatatemp, OUTPUT TABLE extradatatemp APPEND).
         EMPTY TEMP-TABLE inextradatatemp NO-ERROR.
      END.      
      FOR EACH tidsplantemp:
         FIND FIRST extradatatemp WHERE extradatatemp.HUVUDCH = tidsplantemp.AONR AND 
         extradatatemp.HUVUDINT = tidsplantemp.DELNR NO-LOCK NO-ERROR.
         IF tidsplantemp.IDTIDLAG = "TIDPLAN" THEN DO:
            tidsplantemp.ORDNING = 1.           
            IF AVAILABLE extradatatemp THEN DO:      
               ASSIGN
               tidsplantemp.PERSONAL = extradatatemp.SOKCHAR[2]
               tidsplantemp.ENTREPRENOR = extradatatemp.SOKCHAR[3]
               tidsplantemp.PROJEKTLEDARE = extradatatemp.SOKCHAR[4]
               tidsplantemp.FARGNR = extradatatemp.SOKINT[1].  
            END.   
         END.
         ELSE IF tidsplantemp.IDTIDLAG = "KMONT" THEN DO:
            tidsplantemp.ORDNING = 3.
            FIND FIRST kalksumsum WHERE kalksumsum.AONR = tidsplantemp.AONR AND kalksumsum.DELNR = tidsplantemp.DELNR                
            NO-LOCK NO-ERROR.
            ASSIGN
            tidsplantemp.PERSONAL = "Montörstid"
            tidsplantemp.FARGNR = 5. 
            IF AVAILABLE extradatatemp THEN DO:
               ASSIGN
               tidsplantemp.TIMMAR = extradatatemp.SOKDEC[1]
               tidsplantemp.ANTAL = extradatatemp.SOKDEC[2].
            END.
            IF AVAILABLE kalksumsum THEN DO:
               IF tidsplantemp.TIMMAR = 0 THEN tidsplantemp.TIMMAR = kalksumsum.MONTTIMMAR. 
            END.
         END.
         ELSE IF tidsplantemp.IDTIDLAG = "KBER" THEN DO:
            tidsplantemp.ORDNING = 2.
            FIND FIRST kalksumsum WHERE kalksumsum.AONR = tidsplantemp.AONR AND kalksumsum.DELNR = tidsplantemp.DELNR                
            NO-LOCK NO-ERROR.
            ASSIGN
            tidsplantemp.PERSONAL = "Beredartid"
            tidsplantemp.FARGNR = 6. 
            IF AVAILABLE extradatatemp THEN DO:
               ASSIGN
               tidsplantemp.TIMMAR = extradatatemp.SOKDEC[3]
               tidsplantemp.ANTAL = extradatatemp.SOKDEC[4].
            END.
            IF AVAILABLE kalksumsum THEN DO:
               IF tidsplantemp.TIMMAR = 0 THEN tidsplantemp.TIMMAR = kalksumsum.BTIMMAR.
            END.
         END.
         ELSE IF tidsplantemp.IDTIDLAG = "KMASK" THEN DO:
            tidsplantemp.ORDNING = 4.
            FIND FIRST kalksumsum WHERE kalksumsum.AONR = tidsplantemp.AONR AND kalksumsum.DELNR = tidsplantemp.DELNR                
            NO-LOCK NO-ERROR.
            ASSIGN
            tidsplantemp.PERSONAL = "Maskintid"
            tidsplantemp.FARGNR = 7. 
            IF AVAILABLE extradatatemp THEN DO:
               ASSIGN
               tidsplantemp.TIMMAR = extradatatemp.SOKDEC[5]
               tidsplantemp.ANTAL = extradatatemp.SOKDEC[6].
            END.
            IF AVAILABLE kalksumsum THEN DO:
               IF tidsplantemp.TIMMAR = 0 THEN tidsplantemp.TIMMAR = kalksumsum.MASKTIMMAR.
            END.
         END.
      END.
     
      EMPTY TEMP-TABLE inextradatatemp NO-ERROR. 
      EMPTY TEMP-TABLE extradatatemp NO-ERROR. 
   END. /*slut proj*/   
   /*plan nr*/
   ELSE IF typ = "PLAN" THEN DO:
      RUN tidlagekoll_UI IN nyttaoapph.      
      /* hämta TIDSLAGEN */
      tabellhandle = TEMP-TABLE tidslagentemp:HANDLE.
      IF Guru.Konstanter:appcon THEN DO:     
         RUN GETTABLE.P ON Guru.Konstanter:apphand TRANSACTION DISTINCT (INPUT-OUTPUT TABLE-HANDLE tabellhandle, INPUT "TIDSLAGEN").
      END.
      ELSE DO:
         RUN GETTABLE.P (INPUT-OUTPUT TABLE-HANDLE tabellhandle, INPUT "TIDSLAGEN").
      END.       
      /* fylla i tidsplantemp korrekt */
      FOR EACH arbarttemp NO-LOCK:
         FOR EACH valplantemp WHERE valplantemp.ARBARTKOD = arbarttemp.ARBARTKOD NO-LOCK:
            CREATE tidsplantemp.
            ASSIGN
            tidsplantemp.ORDNING       = 1
            tidsplantemp.IDTIDLAG           = "TIDPLAN"
            tidsplantemp.AONR          = valplantemp.PLANNR
            tidsplantemp.DELNR         = valplantemp.ARTAL
            tidsplantemp.ARBART        = arbarttemp.ARBBENAMNING /* BORT char(5)*/ 
            tidsplantemp.ARBARTKOD     = valplantemp.ARBARTKOD
            tidsplantemp.ORT           = valplantemp.ORT
            tidsplantemp.PLANNR        = valplantemp.PLANNR
            tidsplantemp.ARTAL         = valplantemp.ARTAL           
            tidsplantemp.ANDRAD        = FALSE
            tidsplantemp.STARTDAT      = TODAY
            tidsplantemp.SLUTDAT       = TODAY
            tidsplantemp.TIDPLAN = TRUE
            tidsplantemp.KALKYL = FALSE 
            tidsplantemp.OVRIGA = FALSE. 
            RUN kalkyl_UI.                 
         END.
      END.
      EMPTY TEMP-TABLE inextradatatemp NO-ERROR. 
      EMPTY TEMP-TABLE extradatatemp NO-ERROR. 
      FOR EACH tidsplantemp:        
         CREATE inextradatatemp.          
         ASSIGN
         inextradatatemp.PROGRAM = "PLREF"                   
         inextradatatemp.HUVUDCH = tidsplantemp.AONR.                    
         inextradatatemp.HUVUDINT = tidsplantemp.DELNR.                            
         RUN etabhamt_UI IN exdatahmth (INPUT TABLE inextradatatemp, OUTPUT TABLE extradatatemp APPEND). 
         EMPTY TEMP-TABLE inextradatatemp NO-ERROR.        
      END.
      FOR EACH tidsplantemp WHERE tidsplantemp.IDTIDLAG = "TIDPLAN":
         IF tidsplantemp.ANDRAD = FALSE THEN DO:
            FIND FIRST extradatatemp WHERE extradatatemp.HUVUDCH = tidsplantemp.PLANNR AND 
            extradatatemp.HUVUDINT = tidsplantemp.ARTAL NO-LOCK NO-ERROR.
            IF AVAILABLE extradatatemp THEN DO:      
               ASSIGN
               tidsplantemp.PERSONAL = extradatatemp.SOKCHAR[2]
               tidsplantemp.ENTREPRENOR = extradatatemp.SOKCHAR[3]
               tidsplantemp.PROJEKTLEDARE = extradatatemp.SOKCHAR[4]
               tidsplantemp.FARGNR = extradatatemp.SOKINT[1]                  
               tidsplantemp.STARTDAT = extradatatemp.SOKDATE[1] 
               tidsplantemp.SLUTDAT = extradatatemp.SOKDATE[2].  
               CREATE tidsplantempbuff.
               BUFFER-COPY tidsplantemp TO tidsplantempbuff .
               ASSIGN
               tidsplantempbuff.IDTIDLAG = "KMONT" 
               tidsplantempbuff.ORDNING = 3
               tidsplantempbuff.PERSONAL = "Montörstid"
               tidsplantempbuff.ENTREPRENOR = ""
               tidsplantempbuff.PROJEKTLEDARE = ""
               tidsplantempbuff.FARGNR = 5
               tidsplantempbuff.STARTDAT = extradatatemp.SOKDATE[3] 
               tidsplantempbuff.SLUTDAT = extradatatemp.SOKDATE[4]
               tidsplantempbuff.TIMMAR = extradatatemp.SOKDEC[1]
               tidsplantempbuff.ANTAL = extradatatemp.SOKDEC[2]
               tidsplantempbuff.TIDPLAN = FALSE
               tidsplantempbuff.KALKYL = TRUE  
               tidsplantempbuff.OVRIGA = FALSE. 
               CREATE tidsplantempbuff.
               BUFFER-COPY tidsplantemp TO tidsplantempbuff.
               ASSIGN
               tidsplantempbuff.IDTIDLAG = "KBER" 
               tidsplantempbuff.ORDNING = 2
               tidsplantempbuff.PERSONAL = "Beredartid"
               tidsplantempbuff.ENTREPRENOR = ""
               tidsplantempbuff.PROJEKTLEDARE = ""
               tidsplantempbuff.FARGNR = 6
               tidsplantempbuff.STARTDAT = extradatatemp.SOKDATE[5] 
               tidsplantempbuff.SLUTDAT = extradatatemp.SOKDATE[6]
               tidsplantempbuff.TIMMAR = extradatatemp.SOKDEC[3]
               tidsplantempbuff.ANTAL = extradatatemp.SOKDEC[4]
               tidsplantempbuff.TIDPLAN = FALSE
               tidsplantempbuff.KALKYL = TRUE  
               tidsplantempbuff.OVRIGA = FALSE. 
               CREATE tidsplantempbuff.
               BUFFER-COPY tidsplantemp TO tidsplantempbuff.
               ASSIGN
               tidsplantempbuff.IDTIDLAG = "KMASK" 
               tidsplantempbuff.ORDNING = 4
               tidsplantempbuff.PERSONAL = "Maskintid"
               tidsplantempbuff.ENTREPRENOR = ""
               tidsplantempbuff.PROJEKTLEDARE = ""
               tidsplantempbuff.FARGNR = 7
               tidsplantempbuff.STARTDAT = extradatatemp.SOKDATE[7] 
               tidsplantempbuff.SLUTDAT = extradatatemp.SOKDATE[8]
               tidsplantempbuff.TIMMAR = extradatatemp.SOKDEC[5]
               tidsplantempbuff.ANTAL = extradatatemp.SOKDEC[6]
               tidsplantempbuff.TIDPLAN = FALSE
               tidsplantempbuff.KALKYL = TRUE  
               tidsplantempbuff.OVRIGA = FALSE. 
                               
            END.  
         END.
         tidsplantemp.ANDRAD = TRUE.
      END.
     
      FOR EACH tidsplantemp:       
         IF tidsplantemp.STARTDAT = ? THEN tidsplantemp.STARTDAT      = TODAY.
         IF tidsplantemp.SLUTDAT  = ? THEN tidsplantemp.SLUTDAT       = TODAY. 
         IF tidsplantemp.IDTIDLAG = "TIDPLAN" THEN DO:
            
         END.
         ELSE IF tidsplantemp.IDTIDLAG = "KMONT" THEN DO:
            FIND FIRST kalksumsum WHERE kalksumsum.PLANNR = tidsplantemp.PLANNR AND kalksumsum.ARTAL = tidsplantemp.ARTAL                
            NO-LOCK NO-ERROR.
            IF AVAILABLE kalksumsum THEN DO:
               IF tidsplantemp.TIMMAR = 0 THEN tidsplantemp.TIMMAR = kalksumsum.MONTTIMMAR. 
            END.
         END.
         ELSE IF tidsplantemp.IDTIDLAG = "KBER" THEN DO:
            FIND FIRST kalksumsum WHERE kalksumsum.PLANNR = tidsplantemp.PLANNR AND kalksumsum.ARTAL = tidsplantemp.ARTAL                
            NO-LOCK NO-ERROR.
            IF AVAILABLE kalksumsum THEN DO:
               IF tidsplantemp.TIMMAR = 0 THEN tidsplantemp.TIMMAR = kalksumsum.BTIMMAR.
            END.
         END.
         ELSE IF tidsplantemp.IDTIDLAG = "KMASK" THEN DO:
            FIND FIRST kalksumsum WHERE kalksumsum.PLANNR = tidsplantemp.PLANNR AND kalksumsum.ARTAL = tidsplantemp.ARTAL  
            NO-LOCK NO-ERROR.
            IF AVAILABLE kalksumsum THEN DO:
               IF tidsplantemp.TIMMAR = 0 THEN tidsplantemp.TIMMAR = kalksumsum.MASKTIMMAR.
            END.
         END.
      END.
      EMPTY TEMP-TABLE inextradatatemp NO-ERROR. 
      EMPTY TEMP-TABLE extradatatemp NO-ERROR. 
            /*tidläge benämning*/
      FOR EACH tidsplantemp NO-LOCK:
         FIND FIRST tidslagentemp WHERE tidslagentemp.IDTIDLAG = tidsplantemp.IDTIDLAG NO-ERROR.
         IF AVAILABLE tidslagentemp THEN DO:
            ASSIGN
            tidsplantemp.TIDLAGE       = tidslagentemp.TIDLAGE.
         END.         
      END.     
      /*kontroll om start/slut -datum samt tidläge = ? */
      FOR EACH tidsplantemp NO-LOCK:
         IF tidsplantemp.IDTIDLAG = ? THEN DO:
            FIND FIRST tidslagentemp WHERE tidslagentemp.IDTIDLAG = "TIDSPLAN" NO-LOCK NO-ERROR.
            ASSIGN
            tidsplantemp.IDTIDLAG = tidslagentemp.IDTIDLAG
            tidsplantemp.STARTDAT = TODAY
            tidsplantemp.SLUTDAT = TODAY
            tidsplantemp.TIDLAGE = tidslagentemp.TIDLAGE.               
         END.
      END.             
   END. /*slut plan nr */
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE kalkyl_UI C-Win 
PROCEDURE kalkyl_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   IF typ = "PROJEKT" THEN DO:
      RUN kalkylerClass_UI IN nyttaoapph (INPUT valdaao.AONR,INPUT valdaao.DELNR,OUTPUT TABLE kalksumsum APPEND).  
      
   END.
   IF typ = "PLAN" THEN DO:
      RUN kalkylerplanClass_UI IN nyttaoapph (INPUT valplantemp.PLANNR,INPUT valplantemp.ARTAL,OUTPUT TABLE kalksumsum APPEND).      
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE laddadag_UI C-Win 
PROCEDURE laddadag_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
    ASSIGN
   nyladdning = TRUE  
   ye = CMB_AR.
   IF CMB_MANAD = STRING("januari") THEN DO:
      man = 01.
   END.
   ELSE IF CMB_MANAD = STRING("februari")THEN DO:
      man = 02.
   END.
   ELSE IF CMB_MANAD = STRING("mars")THEN DO:
      man = 03.
   END.
   ELSE IF CMB_MANAD = STRING("april")THEN DO:
      man = 04.
   END.
   ELSE IF CMB_MANAD = STRING("maj")THEN DO:
      man = 05.
   END.
   ELSE IF CMB_MANAD = STRING("juni")THEN DO:
      man = 06.
   END.
   ELSE IF CMB_MANAD = STRING("juli")THEN DO:
      man = 07.
   END.
   ELSE IF CMB_MANAD = STRING("augusti")THEN DO:
      man = 08.
   END.
   ELSE IF CMB_MANAD = STRING("september")THEN DO:
      man = 09.
   END.
   ELSE IF CMB_MANAD = STRING("oktober")THEN DO:
      man = 10.
   END.
   ELSE IF CMB_MANAD = STRING("november")THEN DO:
      man = 11.
   END.
   ELSE IF CMB_MANAD = STRING("december")THEN DO:
      man = 12.
   END.
   regdatum = DATE(man,01,ye).
   RUN REGDAG.P.
   IF CMB_MANAD = STRING("januari") OR CMB_MANAD = STRING("mars") OR 
      CMB_MANAD = STRING("maj") OR CMB_MANAD = STRING("juli") OR 
      CMB_MANAD = STRING("augusti") OR CMB_MANAD = STRING("oktober") OR 
      CMB_MANAD = STRING("december") THEN DO:
      day = 31. 
   END.   
   ELSE IF CMB_MANAD = STRING("februari") THEN DO:
      regdatum2 = regdatum + 28.
      IF (SUBSTRING(STRING(regdatum2,"999999"),3,2)) = "02" THEN DO:
         day = 29.
      END.   
      ELSE DO:
         day = 28.
      END.   
   END.           
   ELSE DO:
      day = 30.
   END.
   ASSIGN
   FILL-IN-1:HIDDEN IN FRAME FRAME-ALMAN = FALSE FILL-IN-2:HIDDEN = FALSE
   FILL-IN-3:HIDDEN = FALSE FILL-IN-4:HIDDEN = FALSE FILL-IN-5:HIDDEN = FALSE 
   FILL-IN-6:HIDDEN = FALSE FILL-IN-29:HIDDEN = FALSE FILL-IN-30:HIDDEN = FALSE
   FILL-IN-31:HIDDEN = FALSE FILL-IN-32:HIDDEN = FALSE FILL-IN-33:HIDDEN = FALSE
   FILL-IN-34:HIDDEN = FALSE FILL-IN-35:HIDDEN = FALSE FILL-IN-36:HIDDEN = FALSE
   FILL-IN-37:HIDDEN = FALSE.
     
   IF regdagnamn = "MÅN" THEN DO:
      RUN man_UI.
   END.      
   ELSE IF regdagnamn = "TIS" THEN DO:
      RUN tis_UI.
   END.      
   ELSE IF regdagnamn = "ONS" THEN DO:
      RUN ons_UI.
   END.      
   ELSE IF regdagnamn = "TOR" THEN DO:
      RUN tor_UI.
   END.      
   ELSE IF regdagnamn = "FRE" THEN DO:
      RUN fre_UI.
   END.      
   ELSE IF regdagnamn = "LÖR" THEN DO:
      RUN lor_UI.
   END.      
   ELSE DO:
      RUN son_UI.
   END. 
   indate = regdatum.
   RUN vnr_UI.
   FILL-IN-V-1 = mregvnr.
   indate = indate + 7.
   RUN vnr_UI.
   FILL-IN-V-2 = mregvnr.
   indate = indate + 7.
   RUN vnr_UI.
   FILL-IN-V-3 = mregvnr.
   indate = indate + 7.
   RUN vnr_UI.
   FILL-IN-V-4 = mregvnr.
   indate = indate + 7.
   RUN vnr_UI.
   FILL-IN-V-5 = mregvnr.
   indate = indate + 7.
   RUN vnr_UI.
   FILL-IN-V-6 = mregvnr.
   
   DISPLAY FILL-IN-V-1  
          FILL-IN-V-2 FILL-IN-V-3 
          FILL-IN-V-4 FILL-IN-V-5 FILL-IN-V-6    
      WITH FRAME FRAME-ALMAN.   
   IF FILL-IN-36:HIDDEN = TRUE THEN FILL-IN-V-6:HIDDEN = TRUE.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE lor_UI C-Win 
PROCEDURE lor_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   ASSIGN
      FILL-IN-1:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-2:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-3:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-4:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-5:HIDDEN IN FRAME FRAME-ALMAN = TRUE      
      FILL-IN-6:SCREEN-VALUE IN FRAME FRAME-ALMAN = STRING((1),"9") 
      FILL-IN-7:SCREEN-VALUE = STRING((2),"9") 
      FILL-IN-8:SCREEN-VALUE = STRING((3),"9") FILL-IN-9:SCREEN-VALUE = STRING((4),"9") 
      FILL-IN-10:SCREEN-VALUE = STRING((5),"9") FILL-IN-11:SCREEN-VALUE = STRING((6),"9") 
      FILL-IN-12:SCREEN-VALUE = STRING((7),"9") FILL-IN-13:SCREEN-VALUE = STRING((8),"9")
      FILL-IN-14:SCREEN-VALUE = STRING((9),"9") FILL-IN-15:SCREEN-VALUE = STRING((10),"99") 
      FILL-IN-16:SCREEN-VALUE = STRING((11),"99") FILL-IN-17:SCREEN-VALUE = STRING((12),"99") 
      FILL-IN-18:SCREEN-VALUE = STRING((13),"99") FILL-IN-19:SCREEN-VALUE = STRING((14),"99") 
      FILL-IN-20:SCREEN-VALUE = STRING((15),"99") FILL-IN-21:SCREEN-VALUE = STRING((16),"99") 
      FILL-IN-22:SCREEN-VALUE = STRING((17),"99") FILL-IN-23:SCREEN-VALUE = STRING((18),"99") 
      FILL-IN-24:SCREEN-VALUE = STRING((19),"99") FILL-IN-25:SCREEN-VALUE = STRING((20),"99")
      FILL-IN-26:SCREEN-VALUE = STRING((21),"99") FILL-IN-27:SCREEN-VALUE = STRING((22),"99") 
      FILL-IN-28:SCREEN-VALUE = STRING((23),"99") FILL-IN-29:SCREEN-VALUE = STRING((24),"99") 
      FILL-IN-30:SCREEN-VALUE = STRING((25),"99") FILL-IN-31:SCREEN-VALUE = STRING((26),"99")      
      FILL-IN-32:SCREEN-VALUE = STRING((27),"99") FILL-IN-33:SCREEN-VALUE = STRING((28),"99")      
      FILL-IN-34:SCREEN-VALUE = STRING((29),"99") FILL-IN-35:SCREEN-VALUE = STRING((30),"99")      
      FILL-IN-36:SCREEN-VALUE = STRING((31),"99").
      IF day = 31 THEN DO:
         ASSIGN                                 
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.     
      ELSE IF day = 30 THEN DO:
         ASSIGN                                        
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE. 
      END.    
      ELSE IF day = 28 THEN DO:
         ASSIGN                                          
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE. 
      END.     
      ELSE DO:
         ASSIGN                              
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE manad_UI C-Win 
PROCEDURE manad_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   IF MONTH(regdatum) = 01 THEN DO:
      CMB_MANAD:SCREEN-VALUE IN FRAME FRAME-ALMAN = STRING("januari").
      CMB_MANAD = INPUT CMB_MANAD.
   END.   
   ELSE IF MONTH(regdatum) = 02 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("februari").
      CMB_MANAD = INPUT CMB_MANAD.
   END.  
   ELSE IF MONTH(regdatum) = 03 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("mars").
      CMB_MANAD = INPUT CMB_MANAD.
   END.
   ELSE IF MONTH(regdatum) = 04 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("april").
      CMB_MANAD = INPUT CMB_MANAD.
   END.  
   ELSE IF MONTH(regdatum) = 05 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("maj").
      CMB_MANAD = INPUT CMB_MANAD.
   END.
   ELSE IF MONTH(regdatum) = 06 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("juni").
      CMB_MANAD = INPUT CMB_MANAD.
   END.  
   ELSE IF MONTH(regdatum) = 07 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("juli").
      CMB_MANAD = INPUT CMB_MANAD.
   END.
   ELSE IF MONTH(regdatum) = 08 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("augusti").
      CMB_MANAD = INPUT CMB_MANAD.
   END.  
   ELSE IF MONTH(regdatum) = 09 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("september").
      CMB_MANAD = INPUT CMB_MANAD.
   END.
   ELSE IF MONTH(regdatum) = 10 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("oktober").
      CMB_MANAD = INPUT CMB_MANAD.
   END.  
   ELSE IF MONTH(regdatum) = 11 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("november").
      CMB_MANAD = INPUT CMB_MANAD.
   END.
   ELSE IF MONTH(regdatum) = 12 THEN DO:
      CMB_MANAD:SCREEN-VALUE = STRING("december").
      CMB_MANAD = INPUT CMB_MANAD.
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE man_UI C-Win 
PROCEDURE man_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
    ASSIGN
      FILL-IN-1:SCREEN-VALUE IN FRAME FRAME-ALMAN = STRING((1),"9") 
      FILL-IN-2:SCREEN-VALUE = STRING((2),"9") FILL-IN-3:SCREEN-VALUE = STRING((3),"9") 
      FILL-IN-4:SCREEN-VALUE = STRING((4),"9") FILL-IN-5:SCREEN-VALUE = STRING((5),"9") 
      FILL-IN-6:SCREEN-VALUE = STRING((6),"9") FILL-IN-7:SCREEN-VALUE = STRING((7),"9") 
      FILL-IN-8:SCREEN-VALUE = STRING((8),"9") FILL-IN-9:SCREEN-VALUE = STRING((9),"9") 
      FILL-IN-10:SCREEN-VALUE = STRING((10),"99") FILL-IN-11:SCREEN-VALUE = STRING((11),"99") 
      FILL-IN-12:SCREEN-VALUE = STRING((12),"99") FILL-IN-13:SCREEN-VALUE = STRING((13),"99")
      FILL-IN-14:SCREEN-VALUE = STRING((14),"99") FILL-IN-15:SCREEN-VALUE = STRING((15),"99") 
      FILL-IN-16:SCREEN-VALUE = STRING((16),"99") FILL-IN-17:SCREEN-VALUE = STRING((17),"99") 
      FILL-IN-18:SCREEN-VALUE = STRING((18),"99") FILL-IN-19:SCREEN-VALUE = STRING((19),"99") 
      FILL-IN-20:SCREEN-VALUE = STRING((20),"99") FILL-IN-21:SCREEN-VALUE = STRING((21),"99") 
      FILL-IN-22:SCREEN-VALUE = STRING((22),"99") FILL-IN-23:SCREEN-VALUE = STRING((23),"99") 
      FILL-IN-24:SCREEN-VALUE = STRING((24),"99") FILL-IN-25:SCREEN-VALUE = STRING((25),"99")
      FILL-IN-26:SCREEN-VALUE = STRING((26),"99") FILL-IN-27:SCREEN-VALUE = STRING((27),"99") 
      FILL-IN-28:SCREEN-VALUE = STRING((28),"99") FILL-IN-29:SCREEN-VALUE = STRING((29),"99") 
      FILL-IN-30:SCREEN-VALUE = STRING((30),"99") FILL-IN-31:SCREEN-VALUE = STRING((31),"99").
      IF day = 31 THEN DO:
         ASSIGN
         FILL-IN-32:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.     
      ELSE IF day = 30 THEN DO: 
         ASSIGN     
         FILL-IN-31:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-32:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.    
      ELSE IF day = 28 THEN DO:
         ASSIGN
         FILL-IN-29:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-30:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-31:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-32:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.     
      ELSE DO:
         ASSIGN      
         FILL-IN-30:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-31:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-32:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE musa C-Win 
PROCEDURE musa :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
  {musarrow.i}   
  
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE musw C-Win 
PROCEDURE musw :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/

   {muswait.i}  
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE ons_UI C-Win 
PROCEDURE ons_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   ASSIGN
      FILL-IN-1:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-2:HIDDEN IN FRAME FRAME-ALMAN = TRUE      
      FILL-IN-3:SCREEN-VALUE IN FRAME FRAME-ALMAN = STRING((1),"9")       
      FILL-IN-4:SCREEN-VALUE = STRING((2),"9") FILL-IN-5:SCREEN-VALUE = STRING((3),"9") 
      FILL-IN-6:SCREEN-VALUE = STRING((4),"9") FILL-IN-7:SCREEN-VALUE = STRING((5),"9") 
      FILL-IN-8:SCREEN-VALUE = STRING((6),"9") FILL-IN-9:SCREEN-VALUE = STRING((7),"9") 
      FILL-IN-10:SCREEN-VALUE = STRING((8),"9") FILL-IN-11:SCREEN-VALUE = STRING((9),"9") 
      FILL-IN-12:SCREEN-VALUE = STRING((10),"99") FILL-IN-13:SCREEN-VALUE = STRING((11),"99")
      FILL-IN-14:SCREEN-VALUE = STRING((12),"99") FILL-IN-15:SCREEN-VALUE = STRING((13),"99") 
      FILL-IN-16:SCREEN-VALUE = STRING((14),"99") FILL-IN-17:SCREEN-VALUE = STRING((15),"99") 
      FILL-IN-18:SCREEN-VALUE = STRING((16),"99") FILL-IN-19:SCREEN-VALUE = STRING((17),"99") 
      FILL-IN-20:SCREEN-VALUE = STRING((18),"99") FILL-IN-21:SCREEN-VALUE = STRING((19),"99") 
      FILL-IN-22:SCREEN-VALUE = STRING((20),"99") FILL-IN-23:SCREEN-VALUE = STRING((21),"99") 
      FILL-IN-24:SCREEN-VALUE = STRING((22),"99") FILL-IN-25:SCREEN-VALUE = STRING((23),"99")
      FILL-IN-26:SCREEN-VALUE = STRING((24),"99") FILL-IN-27:SCREEN-VALUE = STRING((25),"99") 
      FILL-IN-28:SCREEN-VALUE = STRING((26),"99") FILL-IN-29:SCREEN-VALUE = STRING((27),"99") 
      FILL-IN-30:SCREEN-VALUE = STRING((28),"99") FILL-IN-31:SCREEN-VALUE = STRING((29),"99")      
      FILL-IN-32:SCREEN-VALUE = STRING((30),"99") FILL-IN-33:SCREEN-VALUE = STRING((31),"99").
      IF day = 31 THEN DO:
         ASSIGN        
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.     
      ELSE IF day = 30 THEN DO:
         ASSIGN              
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.    
      ELSE IF day = 28 THEN DO:
         ASSIGN               
         FILL-IN-31:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-32:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.     
      ELSE DO:
         ASSIGN              
         FILL-IN-32:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE ovrigastart_UI C-Win 
PROCEDURE ovrigastart_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   EMPTY TEMP-TABLE tidsplantemp NO-ERROR. 
   num = 1.   
   DEBUGGER:SET-BREAK().
   IF typ = "PROJEKT" THEN DO:
      FOR EACH arbarttemp NO-LOCK:
         FOR EACH valdaao WHERE valdaao.ARBARTKOD = arbarttemp.ARBARTKOD NO-LOCK:
            RUN laddaaotid IN nyttaoapph (INPUT valdaao.AONR,INPUT valdaao.DELNR,OUTPUT TABLE aotidslagtemp).
            FOR EACH aotidslagtemp  WHERE NO-LOCK:
               IF aotidslagtemp.IDTIDLAG = "TIDPLAN" THEN.
               ELSE IF aotidslagtemp.IDTIDLAG = "KMONT" THEN.
               ELSE IF aotidslagtemp.IDTIDLAG = "KBER" THEN.
               ELSE IF aotidslagtemp.IDTIDLAG = "KMASK" THEN.
               ELSE DO:
                  RUN tidlagen_UI (INPUT aotidslagtemp.IDTIDLAG).
                  ASSIGN 
                  tidsplantemp.TIDPLAN = FALSE
                  tidsplantemp.KALKYL = FALSE 
                  tidsplantemp.OVRIGA = TRUE. 
                  
               END.  
            END.
                        
         END.       
      END.  
      DEFINE VARIABLE ordvar AS INTEGER NO-UNDO.
      ordvar = 6.
      FOR EACH tidsplantemp WHERE tidsplantemp.OVRIGA = TRUE NO-LOCK:
         EMPTY TEMP-TABLE inextradatatemp NO-ERROR. 
         EMPTY TEMP-TABLE extradatatemp NO-ERROR. 
         CREATE inextradatatemp.          
         ASSIGN
         inextradatatemp.PROGRAM = "TIDPLANOVRIGA"                   
         inextradatatemp.HUVUDCH = tidsplantemp.AONR.                    
         inextradatatemp.HUVUDINT = tidsplantemp.DELNR.                    
         RUN etabhamt_UI IN exdatahmth (INPUT TABLE inextradatatemp, OUTPUT TABLE extradatatemp).
         EMPTY TEMP-TABLE inextradatatemp NO-ERROR.
         FIND FIRST extradatatemp WHERE extradatatemp.HUVUDCH = tidsplantemp.AONR AND 
         extradatatemp.HUVUDINT = tidsplantemp.DELNR AND 
         extradatatemp.SOKCHAR[1] = tidsplantemp.IDTIDLAG 
         NO-LOCK NO-ERROR.
         tidsplantemp.ORDNING = ordvar + 1.
         IF AVAILABLE extradatatemp THEN DO:      
            ASSIGN
            tidsplantemp.PERSONAL = extradatatemp.SOKCHAR[2]
            tidsplantemp.ENTREPRENOR = extradatatemp.SOKCHAR[3]
            tidsplantemp.PROJEKTLEDARE = extradatatemp.SOKCHAR[4]
            tidsplantemp.FARGNR = extradatatemp.SOKINT[1] 
            tidsplantemp.TIMMAR = extradatatemp.SOKDEC[1] 
            tidsplantemp.ANTAL = extradatatemp.SOKDEC[2].            
         END.
         ELSE tidsplantemp.PERSONAL = tidsplantemp.TIDLAGE.
      END. 
   END. /*slut proj*/
   EMPTY TEMP-TABLE inextradatatemp NO-ERROR. 
   EMPTY TEMP-TABLE extradatatemp NO-ERROR.
   

END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE son_UI C-Win 
PROCEDURE son_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   ASSIGN
      FILL-IN-1:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-2:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-3:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-4:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-5:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-6:HIDDEN IN FRAME FRAME-ALMAN = TRUE     
      FILL-IN-7:SCREEN-VALUE IN FRAME FRAME-ALMAN = STRING((1),"9") 
      FILL-IN-8:SCREEN-VALUE = STRING((2),"9") FILL-IN-9:SCREEN-VALUE = STRING((3),"9") 
      FILL-IN-10:SCREEN-VALUE = STRING((4),"9") FILL-IN-11:SCREEN-VALUE = STRING((5),"9") 
      FILL-IN-12:SCREEN-VALUE = STRING((6),"9") FILL-IN-13:SCREEN-VALUE = STRING((7),"9")
      FILL-IN-14:SCREEN-VALUE = STRING((8),"9") FILL-IN-15:SCREEN-VALUE = STRING((9),"9") 
      FILL-IN-16:SCREEN-VALUE = STRING((10),"99") FILL-IN-17:SCREEN-VALUE = STRING((11),"99") 
      FILL-IN-18:SCREEN-VALUE = STRING((12),"99") FILL-IN-19:SCREEN-VALUE = STRING((13),"99") 
      FILL-IN-20:SCREEN-VALUE = STRING((14),"99") FILL-IN-21:SCREEN-VALUE = STRING((15),"99") 
      FILL-IN-22:SCREEN-VALUE = STRING((16),"99") FILL-IN-23:SCREEN-VALUE = STRING((17),"99") 
      FILL-IN-24:SCREEN-VALUE = STRING((18),"99") FILL-IN-25:SCREEN-VALUE = STRING((19),"99")
      FILL-IN-26:SCREEN-VALUE = STRING((20),"99") FILL-IN-27:SCREEN-VALUE = STRING((21),"99") 
      FILL-IN-28:SCREEN-VALUE = STRING((22),"99") FILL-IN-29:SCREEN-VALUE = STRING((23),"99") 
      FILL-IN-30:SCREEN-VALUE = STRING((24),"99") FILL-IN-31:SCREEN-VALUE = STRING((25),"99")      
      FILL-IN-32:SCREEN-VALUE = STRING((26),"99") FILL-IN-33:SCREEN-VALUE = STRING((27),"99")      
      FILL-IN-34:SCREEN-VALUE = STRING((28),"99") FILL-IN-35:SCREEN-VALUE = STRING((29),"99")      
      FILL-IN-36:SCREEN-VALUE = STRING((30),"99") FILL-IN-37:SCREEN-VALUE = STRING((31),"99").
      IF day = 31 THEN DO:        
      END.     
      ELSE IF day = 30 THEN DO:
         ASSIGN                                               
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE. 
      END.    
      ELSE IF day = 28 THEN DO:
         ASSIGN                                          
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.     
      END.     
      ELSE DO:
         ASSIGN                                      
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.     
      END.    
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE sparplan_UI C-Win 
PROCEDURE sparplan_UI :
/* -----------------------------------------------------------
  Purpose: Changing screen-value for combo-box CMB_OMR     
  Parameters:
  Notes:       
-------------------------------------------------------------*/   
   DEFINE INPUT PARAMETER avsluta AS LOGICAL NO-UNDO.
   IF typ = "PROJEKT" THEN DO:
      DEBUGGER:SET-BREAK().
      IF skrivskydd = TRUE THEN RETURN NO-APPLY.
      EMPTY TEMP-TABLE extidsplantemp NO-ERROR. 
      FOR EACH tidsplantemp  NO-LOCK:
         CREATE extidsplantemp.
         tidsplantemp.ANDRAD = FALSE.
         BUFFER-COPY tidsplantemp TO extidsplantemp. 
         IF tidsplantemp.IDTIDLAG = "TIDPLAN" THEN DO:
            EMPTY TEMP-TABLE inextradatatemp NO-ERROR. 
            CREATE inextradatatemp.          
            ASSIGN
            inextradatatemp.PROGRAM = "AOREF"                   
            inextradatatemp.HUVUDCH = extidsplantemp.AONR            
            inextradatatemp.HUVUDINT = extidsplantemp.DELNR
            inextradatatemp.SOKCHAR[2] = extidsplantemp.PERSONAL
            inextradatatemp.SOKCHAR[3] = extidsplantemp.ENTREPRENOR
            inextradatatemp.SOKCHAR[4] = extidsplantemp.PROJEKTLEDARE
            inextradatatemp.SOKINT[1] = extidsplantemp.FARGNR.
            FIND FIRST tidsplantempbuff WHERE tidsplantempbuff.AONR = tidsplantemp.AONR AND 
            tidsplantempbuff.DELNR = tidsplantemp.DELNR AND tidsplantempbuff.IDTIDLAG = "KMONT"
            NO-LOCK NO-ERROR.
            ASSIGN                                         
            inextradatatemp.SOKDEC[1] = tidsplantempbuff.TIMMAR
            inextradatatemp.SOKDEC[2] = tidsplantempbuff.ANTAL.
            FIND FIRST tidsplantempbuff WHERE  tidsplantempbuff.AONR = tidsplantemp.AONR AND 
            tidsplantempbuff.DELNR = tidsplantemp.DELNR AND tidsplantempbuff.IDTIDLAG = "KBER"
            NO-LOCK NO-ERROR.
            ASSIGN                                         
            inextradatatemp.SOKDEC[3] = tidsplantempbuff.TIMMAR
            inextradatatemp.SOKDEC[4] = tidsplantempbuff.ANTAL.
            FIND FIRST tidsplantempbuff WHERE  tidsplantempbuff.AONR = tidsplantemp.AONR AND 
            tidsplantempbuff.DELNR = tidsplantemp.DELNR AND tidsplantempbuff.IDTIDLAG = "KMASK"
            NO-LOCK NO-ERROR.
            ASSIGN                                         
            inextradatatemp.SOKDEC[5] = tidsplantempbuff.TIMMAR
            inextradatatemp.SOKDEC[6] = tidsplantempbuff.ANTAL.
            RUN extraspar_UI IN exdatahmth (INPUT TABLE inextradatatemp).
         END.
         IF tidsplantemp.OVRIGA = TRUE THEN DO:
            EMPTY TEMP-TABLE inextradatatemp NO-ERROR.
            CREATE inextradatatemp.          
            ASSIGN
            inextradatatemp.PROGRAM = "TIDPLANOVRIGA"                   
            inextradatatemp.HUVUDCH = tidsplantemp.AONR                    
            inextradatatemp.HUVUDINT = tidsplantemp.DELNR
            inextradatatemp.SOKCHAR[1] = tidsplantemp.IDTIDLAG                    
            inextradatatemp.SOKCHAR[2] =    tidsplantemp.PERSONAL      
            inextradatatemp.SOKCHAR[3] =     tidsplantemp.ENTREPRENOR  
            inextradatatemp.SOKCHAR[4] =     tidsplantemp.PROJEKTLEDARE
            inextradatatemp.SOKINT[1]  =     tidsplantemp.FARGNR       
            inextradatatemp.SOKDEC[1]  =     tidsplantemp.TIMMAR       
            inextradatatemp.SOKDEC[2]  =     tidsplantemp.ANTAL.        
            RUN extraspar_UI IN exdatahmth (INPUT TABLE inextradatatemp).
         END.   
      END.
      RUN tidsplanspar_UI IN nyttaoapph (INPUT Guru.Konstanter:globanv,INPUT TABLE extidsplantemp).
      
   END.
   ELSE IF typ = "PLAN" THEN DO:
      
      IF skrivskydd = TRUE THEN RETURN NO-APPLY.
      EMPTY TEMP-TABLE extidsplantemp NO-ERROR. 
      FOR EACH tidsplantemp :
         CREATE extidsplantemp.
         tidsplantemp.ANDRAD = FALSE.
         BUFFER-COPY tidsplantemp TO extidsplantemp. 
         IF tidsplantemp.IDTIDLAG = "TIDPLAN" THEN DO:
            EMPTY TEMP-TABLE inextradatatemp NO-ERROR. 
            CREATE inextradatatemp.          
            ASSIGN
            inextradatatemp.PROGRAM = "PLREF"                   
            inextradatatemp.HUVUDCH = extidsplantemp.AONR            
            inextradatatemp.HUVUDINT = extidsplantemp.DELNR
            inextradatatemp.SOKCHAR[2] = extidsplantemp.PERSONAL
            inextradatatemp.SOKCHAR[3] = extidsplantemp.ENTREPRENOR
            inextradatatemp.SOKCHAR[4] = extidsplantemp.PROJEKTLEDARE
            inextradatatemp.SOKINT[1] = extidsplantemp.FARGNR               
            inextradatatemp.SOKDATE[1] = tidsplantemp.STARTDAT
            inextradatatemp.SOKDATE[2] = tidsplantemp.SLUTDAT.
            FIND FIRST tidsplantempbuff WHERE tidsplantempbuff.PLANNR = tidsplantemp.PLANNR AND 
            tidsplantempbuff.ARTAL = tidsplantemp.ARTAL AND tidsplantempbuff.IDTIDLAG = "KMONT"
            NO-LOCK NO-ERROR.
            ASSIGN
            inextradatatemp.SOKDEC[1] = tidsplantempbuff.TIMMAR
            inextradatatemp.SOKDEC[2] = tidsplantempbuff.ANTAL
            inextradatatemp.SOKDATE[3] = tidsplantempbuff.STARTDAT
            inextradatatemp.SOKDATE[4] = tidsplantempbuff.SLUTDAT.
            FIND FIRST tidsplantempbuff WHERE tidsplantempbuff.PLANNR = tidsplantemp.PLANNR AND 
            tidsplantempbuff.ARTAL = tidsplantemp.ARTAL AND tidsplantempbuff.IDTIDLAG = "KBER"
            NO-LOCK NO-ERROR.
            ASSIGN
            inextradatatemp.SOKDEC[3] = tidsplantempbuff.TIMMAR
            inextradatatemp.SOKDEC[4] = tidsplantempbuff.ANTAL
            inextradatatemp.SOKDATE[5] = tidsplantempbuff.STARTDAT
            inextradatatemp.SOKDATE[6] = tidsplantempbuff.SLUTDAT.
            FIND FIRST tidsplantempbuff WHERE tidsplantempbuff.PLANNR = tidsplantemp.PLANNR AND 
            tidsplantempbuff.ARTAL = tidsplantemp.ARTAL AND tidsplantempbuff.IDTIDLAG = "KMASK"
            NO-LOCK NO-ERROR.
            ASSIGN
            inextradatatemp.SOKDEC[5] = tidsplantempbuff.TIMMAR
            inextradatatemp.SOKDEC[6] = tidsplantempbuff.ANTAL
            inextradatatemp.SOKDATE[7] = tidsplantempbuff.STARTDAT
            inextradatatemp.SOKDATE[8] = tidsplantempbuff.SLUTDAT.
            RUN extraspar_UI IN exdatahmth (INPUT TABLE inextradatatemp).
         END.
      END.
      RUN tidsplansparplan_UI IN nyttaoapph (INPUT Guru.Konstanter:globanv,INPUT TABLE extidsplantemp).      
   END.
   IF avsluta = TRUE THEN DO:
      APPLY "CLOSE":U TO THIS-PROCEDURE.
   END.

END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE tidlagenh_UI C-Win 
PROCEDURE tidlagenh_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE INPUT PARAMETER idvar AS CHARACTER NO-UNDO.
   IF Guru.Konstanter:appcon THEN DO:                           
      RUN TLAGAUTO.P ON Guru.Konstanter:apphand TRANSACTION DISTINCT (INPUT Guru.Konstanter:globanv, INPUT valdaao.AONRREC, INPUT idvar).     
   END.
   ELSE DO:
      RUN TLAGAUTO.P (INPUT Guru.Konstanter:globanv, INPUT valdaao.AONRREC, INPUT idvar).       
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE tidlagen_UI C-Win 
PROCEDURE tidlagen_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE INPUT PARAMETER idvar AS CHARACTER NO-UNDO.
   FIND FIRST aotidslagtemp WHERE aotidslagtemp.AONR = valdaao.AONR AND aotidslagtemp.DELNR = valdaao.DELNR AND 
   aotidslagtemp.IDTIDLAG = idvar NO-LOCK NO-ERROR.
   IF AVAILABLE aotidslagtemp THEN DO:
      ASSIGN
      ingenkod = TRUE
      svar = FALSE.
      
      CREATE tidsplantemp.
      ASSIGN 
      tidsplantemp.AONR          = valdaao.AONR
      tidsplantemp.DELNR         = valdaao.DELNR
      tidsplantemp.ARBART        = arbarttemp.ARBBENAMNING
      tidsplantemp.ARBARTKOD     = arbarttemp.ARBARTKOD
      tidsplantemp.ORT           = valdaao.ORT
      tidsplantemp.IDTIDLAG      = aotidslagtemp.IDTIDLAG
      tidsplantemp.TIDLAGE       = aotidslagtemp.TIDLAGE
      tidsplantemp.STARTDAT      = aotidslagtemp.DAT1
      tidsplantemp.SLUTDAT       = aotidslagtemp.DAT2
      tidsplantemp.ANDRAD        = FALSE.      
      
      RUN finnsplan IN nyttaoapph (INPUT valdaao.PLANNR, INPUT valdaao.ARTAL, OUTPUT svar).
      IF svar = FALSE THEN DO:
         RUN finnsplanao IN nyttaoapph (INPUT valdaao.AONR, INPUT valdaao.DELNR, OUTPUT svar).
      END.
      IF svar = TRUE THEN DO:
         tidsplantemp.PLAN = TRUE.
      END.
      ELSE DO:
         tidsplantemp.PLAN = FALSE.
      END.
      num = num + 1.
   END.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE tis_UI C-Win 
PROCEDURE tis_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   ASSIGN
      FILL-IN-1:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-2:SCREEN-VALUE IN FRAME FRAME-ALMAN = STRING((1),"9") 
      FILL-IN-3:SCREEN-VALUE = STRING((2),"9") 
      FILL-IN-4:SCREEN-VALUE = STRING((3),"9") FILL-IN-5:SCREEN-VALUE = STRING((4),"9") 
      FILL-IN-6:SCREEN-VALUE = STRING((5),"9") FILL-IN-7:SCREEN-VALUE = STRING((6),"9") 
      FILL-IN-8:SCREEN-VALUE = STRING((7),"9") FILL-IN-9:SCREEN-VALUE = STRING((8),"9") 
      FILL-IN-10:SCREEN-VALUE = STRING((9),"9") FILL-IN-11:SCREEN-VALUE = STRING((10),"99") 
      FILL-IN-12:SCREEN-VALUE = STRING((11),"99") FILL-IN-13:SCREEN-VALUE = STRING((12),"99")
      FILL-IN-14:SCREEN-VALUE = STRING((13),"99") FILL-IN-15:SCREEN-VALUE = STRING((14),"99") 
      FILL-IN-16:SCREEN-VALUE = STRING((15),"99") FILL-IN-17:SCREEN-VALUE = STRING((16),"99") 
      FILL-IN-18:SCREEN-VALUE = STRING((17),"99") FILL-IN-19:SCREEN-VALUE = STRING((18),"99") 
      FILL-IN-20:SCREEN-VALUE = STRING((19),"99") FILL-IN-21:SCREEN-VALUE = STRING((20),"99") 
      FILL-IN-22:SCREEN-VALUE = STRING((21),"99") FILL-IN-23:SCREEN-VALUE = STRING((22),"99") 
      FILL-IN-24:SCREEN-VALUE = STRING((23),"99") FILL-IN-25:SCREEN-VALUE = STRING((24),"99")
      FILL-IN-26:SCREEN-VALUE = STRING((25),"99") FILL-IN-27:SCREEN-VALUE = STRING((26),"99") 
      FILL-IN-28:SCREEN-VALUE = STRING((27),"99") FILL-IN-29:SCREEN-VALUE = STRING((28),"99") 
      FILL-IN-30:SCREEN-VALUE = STRING((29),"99") FILL-IN-31:SCREEN-VALUE = STRING((30),"99").      
      FILL-IN-32:SCREEN-VALUE = STRING((31),"99").
      IF day = 31 THEN DO:
         ASSIGN
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.     
      ELSE IF day = 30 THEN DO:
         ASSIGN     
         FILL-IN-32:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.    
      ELSE IF day = 28 THEN DO:
         ASSIGN      
         FILL-IN-30:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-31:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-32:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.     
      ELSE DO:
         ASSIGN      
         FILL-IN-31:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-32:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END. 
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE tor_UI C-Win 
PROCEDURE tor_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   ASSIGN
      FILL-IN-1:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-2:HIDDEN IN FRAME FRAME-ALMAN = TRUE
      FILL-IN-3:HIDDEN IN FRAME FRAME-ALMAN = TRUE           
      FILL-IN-4:SCREEN-VALUE IN FRAME FRAME-ALMAN = STRING((1),"9") 
      FILL-IN-5:SCREEN-VALUE = STRING((2),"9") 
      FILL-IN-6:SCREEN-VALUE = STRING((3),"9") FILL-IN-7:SCREEN-VALUE = STRING((4),"9") 
      FILL-IN-8:SCREEN-VALUE = STRING((5),"9") FILL-IN-9:SCREEN-VALUE = STRING((6),"9") 
      FILL-IN-10:SCREEN-VALUE = STRING((7),"9") FILL-IN-11:SCREEN-VALUE = STRING((8),"9") 
      FILL-IN-12:SCREEN-VALUE = STRING((9),"9") FILL-IN-13:SCREEN-VALUE = STRING((10),"99")
      FILL-IN-14:SCREEN-VALUE = STRING((11),"99") FILL-IN-15:SCREEN-VALUE = STRING((12),"99") 
      FILL-IN-16:SCREEN-VALUE = STRING((13),"99") FILL-IN-17:SCREEN-VALUE = STRING((14),"99") 
      FILL-IN-18:SCREEN-VALUE = STRING((15),"99") FILL-IN-19:SCREEN-VALUE = STRING((16),"99") 
      FILL-IN-20:SCREEN-VALUE = STRING((17),"99") FILL-IN-21:SCREEN-VALUE = STRING((18),"99") 
      FILL-IN-22:SCREEN-VALUE = STRING((19),"99") FILL-IN-23:SCREEN-VALUE = STRING((20),"99") 
      FILL-IN-24:SCREEN-VALUE = STRING((21),"99") FILL-IN-25:SCREEN-VALUE = STRING((22),"99")
      FILL-IN-26:SCREEN-VALUE = STRING((23),"99") FILL-IN-27:SCREEN-VALUE = STRING((24),"99") 
      FILL-IN-28:SCREEN-VALUE = STRING((25),"99") FILL-IN-29:SCREEN-VALUE = STRING((26),"99") 
      FILL-IN-30:SCREEN-VALUE = STRING((27),"99") FILL-IN-31:SCREEN-VALUE = STRING((28),"99")      
      FILL-IN-32:SCREEN-VALUE = STRING((29),"99") FILL-IN-33:SCREEN-VALUE = STRING((30),"99")      
      FILL-IN-34:SCREEN-VALUE = STRING((31),"99").
      IF day = 31 THEN DO:
         ASSIGN                 
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.     
      ELSE IF day = 30 THEN DO:
         ASSIGN                       
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.    
      ELSE IF day = 28 THEN DO:
         ASSIGN                        
         FILL-IN-32:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END.     
      ELSE DO:
         ASSIGN                      
         FILL-IN-33:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-34:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-35:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-36:HIDDEN IN FRAME FRAME-ALMAN = TRUE
         FILL-IN-37:HIDDEN IN FRAME FRAME-ALMAN = TRUE.
      END. 
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE vnr_UI C-Win 
PROCEDURE vnr_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE VARIABLE yr AS INTEGER NO-UNDO.
   DEFINE VARIABLE wn AS INTEGER NO-UNDO.
   DEFINE VARIABLE d1 AS INTEGER NO-UNDO.
   DEFINE VARIABLE dat1 AS DATE NO-UNDO.
   DEFINE VARIABLE yyyyww AS INTEGER NO-UNDO FORMAT "999999".
      
      
   ASSIGN
   yr   = YEAR(indate)
   d1   = WEEKDAY(DATE( 1 , 1 , yr))
   dat1 = (IF d1 LE 5 THEN DATE(1,  3, yr) - d1 
          ELSE DATE(1, 10, yr) - d1 )
   wn   = TRUNCATE((indate - dat1 + 7) / 7 , 0)
   yyyyww = yr * 100 + wn.
   
   IF wn < 1 THEN       /* Week 52 or 53 previous year ? */
   ASSIGN
   yr     = yr - 1
   d1     = WEEKDAY(DATE( 1 , 1 , yr))
   dat1   = (IF d1 LE 5 THEN DATE(1,  3, yr) - d1 ELSE
               DATE(1, 10, yr) - d1 )
   wn     = TRUNCATE((indate - dat1 + 7) / 7 , 0)
   yyyyww = yr * 100 + wn.
   ELSE IF wn > 52 THEN  /* Week 53 this year or week 1 next year ? */
   ASSIGN
   yr     = yr + 1
   d1     = WEEKDAY(DATE( 1 , 1 , yr))
   yyyyww = IF d1 EQ 6 OR d1 EQ 7 OR d1 EQ 1
          THEN (yr - 1) * 100 + 53 ELSE yr * 100 + 1.
   mregvnr = INTEGER(SUBSTRING(STRING(yyyyww,"999999"),5,2)).
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

&ANALYZE-SUSPEND _UIB-CODE-BLOCK _PROCEDURE whandle_UI C-Win 
PROCEDURE whandle_UI :
/*------------------------------------------------------------------------------
  Purpose:     
  Parameters:  <none>
  Notes:       
------------------------------------------------------------------------------*/
   DEFINE INPUT-OUTPUT PARAMETER ordnr AS INTEGER NO-UNDO.
   DEFINE INPUT PARAMETER ordh AS HANDLE NO-UNDO.
   ASSIGN
   whandltemp.WF[ordnr] = ordh.
   ordnr = ordnr + 1.
END PROCEDURE.

/* _UIB-CODE-BLOCK-END */
&ANALYZE-RESUME

