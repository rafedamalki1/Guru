DEFINE VARIABLE totpris LIKE MTRL.NPRIS NO-UNDO.
DEFINE VARIABLE varpaslag AS DECIMAL FORMAT "->9.99" NO-UNDO.
{TEMPUT.I}

DEFINE INPUT PARAMETER vald_depa AS INTEGER.
DEFINE INPUT PARAMETER valaonr AS CHARACTER.
DEFINE INPUT PARAMETER valdelnr AS INTEGER.
DEFINE INPUT-OUTPUT PARAMETER TABLE FOR temp_ut.
   
   OPEN QUERY utq FOR EACH BESTDEP WHERE BESTDEP.DEPNR = vald_depa  AND BESTDEP.BERED = FALSE AND
   BESTDEP.LEVNAMN = valaonr + ";" + STRING(valdelnr) NO-LOCK.
   GET FIRST utq NO-LOCK.
   DO WHILE AVAILABLE(BESTDEP):      
      CREATE temp_ut.      
      ASSIGN
      temp_ut.ENR = BESTDEP.ENR
      temp_ut.BENAMNING = BESTDEP.BENAMNING
      temp_ut.ENHET = BESTDEP.ENHET
      temp_ut.PRIS = BESTDEP.PRIS
      temp_ut.ANTAL = BESTDEP.ANTAL
      temp_ut.LEVDATUM = BESTDEP.LEVDATUM
      temp_ut.BESTDATUM = BESTDEP.BESTDATUM
      temp_ut.AOBENAMNING = "I"
      temp_ut.AONR = STRING(BESTDEP.BESTNR).
      GET NEXT utq NO-LOCK.
   END.
   CLOSE QUERY utq.
