

/*EXTRADATAHMT.P*/
 
/* SÖK PÅ programmet startar här
******************************** TABELLER SOM ANVÄNDS TILL ANNAT SAMT LÅNADE FÄLT ********************
OBS! I Beredning unikt på BERNR och OMRADE men ibland använs andra fält pga historia 


BEREDNINGSHUVUD 
BEREDNING.BERNR  = BERNR    INTEGER
BEREDNING.OMRADE =  OMRADE CHARACTER 
BEREDNING.BERAONR = BERNR  CHARACTER  Används men borde ersättas av. BERNR
BEREDNING.AONR = AONR CHARACTER
BEREDNING.DELNR = DELNR INTEGER

KONSTRUKTIONER

BERVAL.AONR = BERNR    CHARACTER
BERVAL.OMRADE =  OMRADE CHARACTER 
BERVAL.DELNR = ANVÄNDS EJ INTEGER

BERVAL.KONSKOD = KONSTGRUPP.KONSKOD unikt
BERVAL.KTYPKOD = KONSTRUKTION.KTYPKOD unikt
BERVAL.F2 = KONSTVAL.KVALKOD      
BERVAL.F3 = KONSTVAL.KVALKOD
BERVAL.F4 = KONSTVAL.KVALKOD
BERVAL.F5 = KONSTVAL.KVALKOD
BERVAL.F6 = KONSTVAL.KVALKOD

Obs! 
MTRLBER.KTYPKOD
MTRLBER.F1
MTRLBER.F2
MTRLBER.F3
MTRLBER.F4
MTRLBER.F5
OCH
kon_val.GRUPP = BERVAL.KONSKOD 
kon_val.F1 = BERVAL.KTYPKOD.


MTRLBER.F1 = BERVAL.F2
BERORD.AONR = BERNR    CHARACTER
BERORD.OMRADE =  OMRADE CHARACTER 

FRIKORT.AONR = BERNR    CHARACTER
FRIKORT.OMRADE  =  OMRADE CHARACTER
FRIKORT.DELNR = ANVÄNDS EJ INTEGER

BERID.AONR  = BERNR    CHARACTER
BERID.OMRADE =  OMRADE CHARACTER
BERID.DELNR = ANVÄNDS EJ INTEGER
BERID.XKORD = 1  KOMBINERAD MED.  ANNAN KONSTRUKTION
BERID.YKORD = ANVÄNDS EJ INTEGER
BERID.FRI1 =  ANVÄNDS EJ ELLER SÄTTS TILL ? INTEGER
BERID.FRI2 = BYGGNR/FLER OLIKA NAMN INTEGER
BERID.FRI3 = FRI_ID CHARACTER

BERID2.AONR  = BERNR    CHARACTER
BERID2.OMRADE =  OMRADE CHARACTER
BERID2.STOLPNR = KARTREF  CHARACTER


BERMTRL.AONR  = BERNR    CHARACTER
BERMTRL.OMRADE =  OMRADE CHARACTER
BERMTRL.INKOP = TRUE GAMLA INKÖPET LOGICAL


BERUPP.AONR  = BERNR    CHARACTER
BERUPP.OMRADE =  OMRADE CHARACTER
 
FÖR KOORDINATER MM TILL UPPLAG
       
 UPPLAG 
 KONSTRUKTIONUPPLAG = FALSE
 BERPUNKT.AONR = BERNR    CHARACTER
 BERPUNKT.OMRADE =  OMRADE CHARACTER
 BERPUNKT.VINKEL = POSTNR
 BERPUNKT.PUNKTNAMN = ORT
 BERPUNKT.XKORD
 BERPUNKT.YKORD
 BERPUNKT.NUM  = BERUPP.UPPLAG
 BERPUNKT.ANMARK
 BERPUNKT.XKORDCH
 BERPUNKT.YKORDCH 
          ZKORDCH    
          NERGRAVDJUP 
 
 KONSTRUKTIONER
 KONSTRUKTIONUPPLAG = TRUE         
 BERPUNKT.AONR = BERNR    CHARACTER
 BERPUNKT.OMRADE =  OMRADE CHARACTER
 BERPUNKT.VINKEL 
 BERPUNKT.PUNKTNAMN = NAMN
 BERPUNKT.NUM  = berval.num 
 BERPUNKT.ANMARK
 BERPUNKT.XKORDCH
 BERPUNKT.YKORDCH 
          ZKORDCH    
          NERGRAVDJUP          

koppling mellan KALKYL och beredning
BERKALKOPPLA.AONR = BERNR    CHARACTER
BERKALKOPPLA.BERNR = BERNR INTEGER
BERKALKOPPLA.OMRADE = OMRADE CHARACTER FRÅN BEREDNING
BERKALKOPPLA.KALKNR = KALKYLNR INTEGER
BERKALKOPPLA.OMRADEKALK = OMRADE CHARACTER FRÅN KALKYL



SCHAKT_ övriga HD-tabeller gjorda på detta sätt                
HDSCHAKT.BERNR  = BERNR INTEGER
HDSCHAKT.OMRADE =  OMRADE CHARACTER



   
BETFRIA    niklas Talar om vilken huvudleverantör det skall vara för beredningen
betfria.betnr  bernr
betfria.fakttext omrade
betfria.typ     lev
BETFRIA.OANTAL = Guru.Konstanter:varforetypval[16].  SORTERING I SCHAKT
BETFRIA.OprisL = automassor.  I SCHAKT

BETPLAN används ej!
BETPLAN    niklas Översättningstabell för materiel mellan olika leverantörer
byt från enr  byt till lev    byt från lev  byt till enr
ANVÄNDARE     BESTID         NAMN          Område   
06681092        8             1             0668132     

BETPLAN    niklas Översättningstabell för materiel mellan olika leverantörer
byt från enr      byt från lev  byt till enr    byt till lev
ANVÄNDARE         NAMN          Område            BESTID 
06681092          1             0668132              8


BETAONR    niklas Lagring av vem som ändrat ett pris i depån
ANSVARIGTAB      lena   länkar Storel vsab
storel
ANSVARIGTAB.OMREGTID = 00.15 
              
 ANSVARIGTAB.PERSONALKOD = tidineln.ENR
 ANSVARIGTAB.FORNAMN = leverant
 ANSVARIGTAB.EFTERNAMN = tidineln.SELANK.
 
Kommentarer till ennummer
ANSVARIGTAB.PERSONALKOD = emtrlkomtemp.ENR
         ANSVARIGTAB.EFTERNAMN = emtrlkomtemp.KOMMENTAR
         ANSVARIGTAB.OMREGTID = 1
         ANSVARIGTAB.FORNAMN = emtrlkomtemp.LEVKOD. 

egna bilder till ennummer

ANSVARIGTAB.PERSONALKOD = emtrlkomtemp.ENR
         ANSVARIGTAB.EFTERNAMN = emtrlkomtemp.KOMMENTAR
         ANSVARIGTAB.OMREGTID = 2
         ANSVARIGTAB.FORNAMN = emtrlkomtemp.LEVKOD. 

BERID2         Kartref
offert             OMRSEK AONR 

ANVPER
 ÄNDRA KALKYL SÄTTERLÅSNING
CREATE ANVPER.
ÄNDRA TIDSEDEL SÄTTERLÅSNING
 CREATE ANVPER.

***************** TABELLER SOM EJ ANVÄNS********************

APPARATDATA         används ej
BETFAKANM  används ej
BETPLANOVR   används ej
BETPLANSLUT  används ej
BETPLANSTART   används ej
kalpers     används ej
SUMTID         används ej

BERSCHAKT      används ej
    
SCHAKTKAB       används ej 

TIDFELPERS                             används ej 
 
 
 ************************* EXTRADATA ANVÄNDS TILL ****************************
 "PROFIL"       = PROGRAM 
                 HUVUDCH = "SCHAKT"
                 HUVUDINT = ORDNING
                 SOKCHAR[1] = benämimng
                 SOKINT[1] =  BB
                 SOKINT[2] =  TB
                 SOKINT[3] =  DJP
                 SOKINT[4] =  DJM
 "MACADD"        = PROGRAM =                                 
                 HUVUDCH = ANVANDARE
                 EXTRADATA.SOKCHAR[1] = MACADRESSEN
                 EXTRADATA.SOKCHAR[2] = os-user   endast för GURUSUPPORT  
                 EXTRADATA.DATUM[1] = TODAY 
 
  "GURUSUPPORT"  = PROGRAM                                  
                   HUVUDCH = os-användare             
 
 
 
  "GURUKOLL"    = PROGRAM =                                 
                 HUVUDCH = ANVANDARE
                 EXTRADATA.SOKCHAR[1] = FORETAG.FORETAG  
                 EXTRADATA.SOKCHAR[2] = INFRAKOLL
                 EXTRADATA.SOKCHAR[3] = CERTKOLL
                 EXTRADATA.SOKDATE[1] = TODAY.
    "GURUWCVER" = = PROGRAM
                 HUVUDCH = GLOBFORETAG
                 SOKCHAR[1] = GURUVERSION.
    "BESTEPOST" = PROGRAM
                 HUVUDCH = bestkundallt.BESTID
                 SOKCHAR[1] = FILL-IN-EPOST.
                 SOKCHAR[2] = FILL-IN-AVD
                 SOKCHAR[3] = organisations nr
                 SOKCHAR[4] = kundnamn 2
     BESTEPOST = EPOST ADRESS FÖR BESTÄLLARE KUND
               HCH = BESTID 
               CH(1) = EPOST
               CH(2) = AVDELNING            
                 
                 besttem och områdetab
                 CREATE inextradatatemp.          
     "BESTEPOST2" = PROGRAM 
                  HUVUDCH = bestkundallt.BESTID 
                  SOKCHAR[1]  =  kontaktperstemp.NAMN   
                  SOKCHAR[2]  =  kontaktperstemp.EPOST  
                  SOKCHAR[3]  =  kontaktperstemp.TELEFON
                  SOKCHAR[4]  =  kontaktperstemp.MOBIL
                  SOKCHAR[5]  =  kontaktperstemp.FAX  
                 
                 
    'DOKALKYL' = PROGRAM 
                 HCH = omrade
                 HINT = kalkylnr 
                 INT[1] = åratl för ebr
                 INT[2] = årtal för sambygg
EBRNYPRIS = PROGRAM                             
                  HUVUDINT = ARTAL                  
                  SOKDEC[1] = EBRPRIS.MONT
                  SOKDEC[2] = EBRPRIS.MASK1  
                  SOKDEC[3] = EBRPRIS.MASK2
                  SOKDEC[4] = MASK3
                  SOKDEC[5] = EBRPRIS.RORLIG
                  SOKDEC[6] = bertim.                 

/*ett första försök körs ej*/                 
                 
  KALKYLKATALOG = PROGRAM 
                 HUVUDCH  = "EBR",sam,skj,skl           
                  HUVUDINT = raknare
                  SOKINT[1] = EBRPRIS.ARTAL 20100101
                  SOKDEC[1] = EBRPRIS.MONT
                  SOKDEC[2] = EBRPRIS.MASK1  
                  SOKDEC[3] = EBRPRIS.MASK2
                  SOKDEC[4] = EBRPRIS.RORLIG.
                  

                                    
  KALKYLKATALOGNR = PROGRAM = "KALKYLKATALOGNR"                   
                  HUVUDCH  = ?
                  HUVUDINT = raknare.  lagras på FASTSPEC.DELNR
                  SOKDAT[1] = DATE(12,31,inextradatatemp.SOKDEC[1]) = VISNINGS ÅR START DATUM FÖR KATALOGEN
                  SOKINT[1] = raknare   /*EBR*/  VILKEN PROGRAM= KALKYLKATALOG +  HUVUDCH = EBER + SOKINT[1]
                  SOKINT[2] = raknare   /*SAM*/
                  SOKINT[3] = raknare   /*SKJ*/
                  SOKINT[4] = raknare.   /*SKL*/  
                  
                                     SE DOC katartal.doc
                       
/*ovan ett första försök körs ej*/
     
                  
                 
   "AOPROJ" = PROJEKTÖR I AONRTAB.STARTDAG gprojl    
        "AOPROJ" AND EXTRADATA.HUVUDCH = PERSONALTAB.PERSONALKOD        
   "ARBTID"  = aVIKANDE ARBETSTIDE EN DAG I ETT VECKOSCHEMA
   
   "MARKRIT" = RITNINGSNUMMER FÖR EN MARKVÄRDERING.
   
   "FRIPRIS" = FRI PRISLISTA I FAKTURERING 
               HCH = FAKT 
               HINT = LÖPNR
               DATUM[1] = POSTENS START DATUM 
               DATUM[2] = POSTENS SLUTDATUM DATUM ALT ? 
               DATUM[3] = äNDRAD KONTO ÄNDRAD EL BORTTAGEN 
               CH[1] = KONTO.K1
               CH[2] = KONTO.K2
               CH[3] = KONTO.K3
               CH[4] = KONTO.K4
               CH[5] = KONTO.K5
               CH[6] = FRI TEXT
               CH[9] = FÖRETAG
               CH[10] = MÄRKNING
               INT[1] = KUNDFODRANID
               INT[2] = INTÄKTSID
               INT[3] = MOTPARTSID
               INT[4] = MOMSID
               INT[5] = BELOPP KR
               INT[6] = BELOPP ÖREN
               log[1] = true = borttag.
    "BLOBINFO" =  SPARAR SÖKVÄGAR
                  HINT = BLOBID 
                  CH[1] = KLIENT SÖKVÄG         
                  CH[2] = WC SÖKVÄG.
    "AOREF" =   REF.NR BESTÄLLARE I NYTTAONR
               HCH = AONR 
               HINT = DELNR
               CH(1) = REF.NR BESTÄLLARE
               CH(2) = TIDPLAN PERSONAL 
               CH(3) = TIDPLAN ENTREPRENOR
               CH(4) = TIDPLAN PROJEKTLEDARE
               CH(5) = kontakt
               CH(6) = AonrInTT.MessageType
               CH(7) = SequenceID
               
               INT(1) = TIDPLAN FÄRG
               DEC1   = MONTÖR TIMMAR 
               DEC2   = ANTALMONT
               DEC3   = BRED TIMMAR 
               DEC4   = ANTABRED
               DEC5   = MASKIN TIMMAR 
               DEC6   = ANTALMASKIN
   "PLREF" =   REF.NR BESTÄLLARE I NYTTPLAN + TIDLÄGE TIDSPLAN
               HCH = PLANR 
               HINT = ÅRTAL
               CH(1) = REF.NR BESTÄLLARE     ANVÄNDS EJ.
               CH(2) = TIDPLAN PERSONAL 
               CH(3) = TIDPLAN ENTREPRENOR
               CH(4) = TIDPLAN PROJEKTLEDARE
               CH(5) = ARBARTKOD
               CH(6) = IDTIDLAG    tidplan
               CH(7) = IDTIDLAG    KMONT
               CH(8) = IDTIDLAG    KBER
               CH(9) = IDTIDLAG    KMASK
               SOKDATE(1) = STARTDAT  tidplan
               SOKDATE(2) = SLUTDAT   tidplan
               SOKDATE(3) = STARTDAT  KMONT
               SOKDATE(4) = SLUTDAT   KMONT
               SOKDATE(5) = STARTDAT  KBER
               SOKDATE(6) = SLUTDAT   KBER
               SOKDATE(7) = STARTDAT  KMASK
               SOKDATE(8) = SLUTDAT   KMASK
               INT(1) = TIDPLAN FÄRG
                DEC1   = MONTÖR TIMMAR 
               DEC2   = ANTALMONT
               DEC3   = BRED TIMMAR 
               DEC4   = ANTABRED
               DEC5   = MASKIN TIMMAR 
               DEC6   = ANTALMASKIN          
               
    "PFAKTOR = AVIKADE FAKTORER FÖR PERSONAL
               HCH = PERSONALKOD 
               DEC(1) = KALENDERFAKTOR           
               DEC(2) = SEMESTERFAKTOR
    
    JURPERSNRSERIE = 
               HINT = IDNRP
               CH(1) = JUDID
    MTRLDEPLAS = 
               HINT = DEPNR
               CH(1) = ANVANDARE
               CH(2) = PROGRAM
    MARKAG = 
               HINT = MARKNR
               CH(1) = MOBIL
               CH(2) = EPOST
               CH(3) = MARKÄGARE MAKA
               
    BERBILD = 
               HCH = område 
               HINT = beredningsnummer
               CH[1] = namn
               CH[2] = filnamn               
               INT[1] = num               
    
    FASTLOPNR = 
               HCH = BETECKNING
               CH(1) = LOPNR
               CH(2) = ABOXEN
               CH(3) = ATELEFON
               CH(4) = ATELEFON2
               CH(5) = ATELEFONM
               CH(6) = AMAIL
               int[1] = MARKNR (Kontaktperson)
               
    "OTBEORD"  = 
               HUVUDCH = otidbeordtemp.PERSONALKOD         
               SOKCHAR[1] = otidbeordtemp.EPOST
               SOKLOG[1] = otidbeordtemp.AKTIV
               SOKINT[1] = otidbeordtemp.ANDRAD.
               
    AOTIDPERS =     används inte se extratabhmt.p.
               HCH = aonr 
               HINT = delnr
               CH[1] = personalkod
               CH[2] = anvandare               
               dat1] = datum 
               
    ANLOMR  =  FÖRDELNINGSSTATION OMRÅDE
               HCH   = BERFOR.FORNR
               CH[1] = OMRADE  
                                                   
    "RAIND"=   OM BESTÄLLNING SKICKAD TILL RAINDANCE globforetag borl
               HCH = AONR 
               HINT = DELNR
               CH[1] = BESTÄLLNINGSNUMMER
               DAT[1] = DATUM NÄR SKICKAD TILL RAINDANCE
   MARKFASTANDEL = 
               HINT = MARKNR
               HCH = BETECKNING
               INT(1) = ANDEL1
               INT(2) = ANDEL2
               CH(1) = ANDEL1/ANDEL2
               DEC(1) = PROCENT               
   FRIKALK2      = 
               HINT = KALKNR
               LOG(1) = TRUE     FÖR IHOPSLAGNAKALKYLER nya fria kalkylen
               POSTEN FIINS INTE ANNARS.
               
  ARBARTAKTIV =  ARBETSART AKTIV /INAKTIV
              HINT = ARBARTKOD                
              SOKLOG[1] = AKTIV/INAKTIV
         
 DISPENSÖ    = DISPENS FÖR ÖVERTID MER ÄN 200 TIMMAR
               HCH = PERSONALKOD 
               LOG(1) = DISPENS
DISPENSLÄ    = DISPENS LÄKARBESÖK
               HCH = PERSONALKOD 
               LOG(1) = DISPENS
                              
               
AVAFOR    = AVVIKANDE ARBETSTIDSFÖRKORTNING
               HCH = PERSONALKOD 
               INT(1) = TIMMAR 
SPFRISK    = spärr friskvårdstimmar som tas ut i pengar istället
               HCH = PERSONALKOD 
               LOG(1) = spärr
               
LONVAXLINGATK = Kalmar löneväxla ATK
                HCH = PERSONALKOD
                SOKLOG[1] = lonvaxatk.
                
                
                 
Test årsuppdatering kalmar               
SPAVAAR    = SPÄRR ARBETSTIDSFÖRKORTNING ÅR
               HCH = PERSONALKOD                
               INT(1) = ÅR
               LOG(1) = spärr
                
SPFRISKAR    = spärr friskvårdstimmar som tas ut i pengar istället ÅR
               HCH = PERSONALKOD
               INT(1) = ÅR 
               LOG(1) = spärr                                                           
               
"FIFO" = FirstInFirstOut i depå                
               HINT = depånummer
               HCH = e-nummer
               DATUM[1] = In levererat datum                              
               CH[2] = benämning
               CH[3] = enhet               
               INT[1] = antal
               INT[2] = Inlevererat klockslag
               DEC[1] = PRIS               

 

 TRUMMA    ANVÄNDS INTE   = LAGERPLATS FÖR TRUMMOR BORLÄNGE         
               HINT = lagerplats
               HCH = TRUMMA S eller  U + lopnr
               CH[5] = VISAD LAGERPLATS
               CH[1] = e-nummer               
               CH[2] = benämning
               CH[3] = enhet               
               INT[1] = stmeter -antal meter start
               INT[2] = utmeter -antal meter uttag                             
               DEC[1] = NPRIS
               DAT[1] = uppläggningsdatum
               LOG(1) = aokopp
               CH[4] = AONR
               INT[3] = DELNR
               INT[4] = lopnr uttag 
               INT[5] = lagmeter-meter kvar i lager
               
 TRUMMAUT  ANVÄNDS INTE  = UTTAG FRÅN LAGERPLATS BORLÄNGE         
               HINT = lagerplats                      
               HCH = AONR
               CH[5] = VISAD LAGERPLATS        
               INT[1] = DELNR
               CH[1] = e-nummer               
               CH[2] = benämning
               CH[3] = enhet               
               DAT[1] = UTDATUM
               DAT[2] = INDATUM
               INT[2] = STMETER
               INT[3] = UTMETER  
               
  "KALKMALL"  = KALKYLMALLAR  huvud         
               HINT = mallnr                      
               HCH = "1"
               SOKCHAR[2]  = ekalkmall.BENAMNING   
               SOKINT[3] = ekalkmall.TYP             
               SOKLOG[1] = ekalkmall.AKTIV            
           koder
               PROGRAM = "KALKMALL"                   
               HUVUDINT = eukalkmall.mallnr
               HUVUDch =  "2"
               SOKCHAR[1] = eukalkmall.ARBKOD 
               SOKINT[1]  = eukalkmall.LOPNR 
               SOKDEC[1] = eukalkmall.ANTAL
               SOKCHAR[3]  = eukalkmall.BENKOD    
               SOKCHAR[4]  = eukalkmall.ENHET    
               SOKINT[3] = eukalkmall.TYP.        
NATPROJ = 
               HCH = NÄTÄGARENS PROJEKT
               CH(1) = LEDNINGSLITTERA
               CH(2) = PROJEKTNAMN
               CH(3) = PROJEKTLEDARE   
               CH(4) = KONC   
               CH(5) = DIARIENR tidigare DOMSAGA   
               date[1] = Utfärdning
               CH(6) = Utfärdas av 
               CH(7) = Attest   
               CH(8) = Pn - nummer
               
PROJHSAND = 
               HCH = NÄTÄGARENS PROJEKT
               CH(1) = FILL-IN-GAMLED
               CH(2) = FILL-IN-DODAS
               INT(1) = FILL-IN-KRHA
               INT(2) = FILL-IN-SKADEERS
               date[1] = FILL-IN-TILLDAG
               INT(3) = FILL-IN-TKMETER
               INT(4) = FILL-IN-NSTN
                   

 VARDFAST    =          
               HINT = VARDNR               
               HCH = BETECKNING                             
               CH[1] = STAKTILL          
               CH[2] = ROJFALL
               CH[3] = AFSKICKAT              
               CH[4] = AFMOTTAGET              
               CH[5] = AFERSATT
               CH[6] = AFSKICKAT              
               CH[7] = bankkonto              
               CH[8] = banknamn                           
               CH[9] = ANM
               CH[10] = KOMMENTAR              

VARDFAST2    =          
               HINT = VARDNR               
               HCH = BETECKNING                             
               CH[1] = ERSATT SENAST          
               LG[1] = F -FÖRSÄLJ
               LG[2] = T- TILLVARATAGANDE              
               LG[3] = MOMS              
               INT[1] = F-Rotnetto
               INT[2] = T- Expl på rotnetto              
               INT[3] = Vp skog              
                             

    VARDFASTAG =              
               HINT = VARDNR               
               HCH = BETECKNING
               INT[1] = MARKNR                             
               CH[1] = STAKTILL          
               CH[2] = ROJFALL
               CH[3] = AFSKICKAT              
               CH[4] = AFMOTTAGET              
               CH[5] = AFERSATT
               CH[6] = AFSKICKAT              
               CH[7] = bankkonto              
               CH[8] = banknamn                           
               CH[9] = ANM
               CH[10] = KOMMENTAR              

VARDFASTAG2    =          
               HINT = VARDNR               
               HCH = BETECKNING
               INT[4] = MARKNR                             
               CH[1] = ERSATT SENAST          
               LG[1] = F -FÖRSÄLJ
               LG[2] = T- TILLVARATAGANDE              
               LG[3] = MOMS              
               INT[1] = F-Rotnetto
               INT[2] = T- Expl på rotnetto              
               INT[3] = Vp skog              
    
    
         
FSVOL          =
               HINT = VARDNR               
               HCH = BETECKNING
               INT[1] = BESTAND
               CHAR[1] = TALLGRAN
               INT[2] = MHOJD
               DEC[1] = SLUTENHET
               INT[3] = TABELLV
               DEC[2] = VOLUTR                                
               DEC[3] = M3                                
               
INLKAT         HCH = LEVKOD                  
               DAT[1] = INLÄST DATUM
               DAT[2] = FROM DATUM
               DAT[3] = TOM DATUM
               CHAR[1] = TID
               CHAR[2] = GLOBANV
               LOG[1] = uppdat för nattkörning
               LOG[2] = MED VID PRIS JMF
               int[1] =  ORDNING
               
               
               
KALKMALL       HINT = mallräknare
               HCH = mallrad = "1" kalkylrad = "2"                              
               CHAR[1] = ARBKOD
               INT[1] = LOPNR 
               DEC[1] = ANTAL
               CHAR[2] = BENAMNING MALL
               LOG(1) = aktiv/inaktiv
               INT[2] = ORDNING
               INT[3] = typ
               CHAR[3] = BENAMNING arbkodlopnr
               CHAR[4] = enhet
KABLAR         HCH = BENÄMNING AV KABEL               
               HINT = KABELID
               INT[1] = DIAMETER I MM    
               SOKLOG[1] = TRUE OM BORTTAG.
SUPPERS        HCH    = FORETAG               
               CHAR[1] = PERSONALKOD
               CHAR[2] = ANVANDARE
               CHAR[3] = FORNAMN
               CHAR[4] = EFTERNAMN
               CHAR[5] = TELEFON
               CHAR[6] = MOBIL
               CHAR[7] = EPOST
SUPANM         HIN  SUPPORTID   räknare
               HCH  FORETAG 
               CHAR[1] ANVANDARE 
               CHAR[2] FRAGA 
               CHAR[3] SVAR 
               DAT[1] STARTDATUM 
               DAT[2] SLUTDATUM 
               DEC[1] STARTKLOCKAN 
               DEC[2] SLUTKLOCKAN 
REVADM         1 POST 
               HINT = 1               
               HCH = "1"
               DEC[1] = FASTBELOPP               
               DEC[2] = ZON1KRPM
               DEC[3] = ZON2KRPM

               
REVAVTAL       HINT = VARDNR               
               HCH = BETECKNING   
               INT[1] = ZON
               DEC[1] = KRPM
               DEC[2] = METER
               DEC[3] = KRONOR
               CHAR[1] BENAMNING
               
               
LOGNIV         HINT = 1 logga = bortag aonr/bernr
                      2 logga av ps timer.   

LOGPOST        PROGRAM = "logpost"   
               HUVUDINT = loggnivå                   
               SOKCHAR[1] = procedurnamn                      
               SOKCHAR[2] = datornamn                    
               SOKCHAR[3] = globanv                      
               SOKCHAR[4] = typ (AONR // BERNR)                       
               SOKCHAR[5] = sök begrepp
               SOKDAT[1]  = TODAY
               SOKINT[1]  = TIME
               Beroende på loggniv så kan hinnehållet variera
      
BERFORE       PROGRAM = "BERFORE"   
               HUVUDINT = BERNR
               HUVUDCH  = OMRADE                    
               SOKCHAR[1] = GLOBFORETAG FRÅN VILKET FÖRETAG ÄR BEREDNINGEN IMPORTERRAD.
               SOKCHAR[2] = unikaGLOBFORETAG FRÅN VILKET FÖRETAG ÄR BEREDNINGEN IMPORTERRAD.
"FRIKALK2" = frikalkyl
             HUVUDINT = kalknum
             SOKLOG[1] = TRUE ??
             
ATKFRISK    = ATK OCH FRISKVÅRD Nästa år
               HCH = PERSONALKOD 
               HUVUDINT = ÅR
               SOKLOG(1) = ATK
               SOKLOG(2) = FRISKVÅRD
               SOKLOG(3) = GODKAND
               SOKLOG(4) = ÅRSUPP
               SOKDAT(1) = REGDATUM
               SOKDAT(2) = GODDATUM
               SOKDAT(3) = ÅRSUPPDATUM
               SOKCHAR(1) = ANVANDARE REG
               SOKCHAR(2) = ANVANDARE GOD
               
SISTNRPRE    = SISTA UTTAGNANR I NRSERIE
               HCH = PREFIX
               HUVUDINT = ?
               SOKCH(1) = SISTA AONR
               
TIDPLANOVRIGA   HCH = PAONR
               HUVUDINT = DELNR
               SOKCH(1) = IDTILAG            
               
CREATE inextradatatemp.          
"FAVO"        HCH = användare
               log(1) till (10) 
               inextradatatemp.SOKCHAR[1] =  FILL-IN-NUMFORM.
               IF RAD_PRISSORT = TRUE THEN inextradatatemp.SOKINT[4] = 1.
 
   ASSIGN
   inextradatatemp.PROGRAM = "FAVO"                   
   inextradatatemp.HUVUDCH = globanv              
   inextradatatemp.HUVUDINT =  ?
   inextradatatemp.SOKLOG[1] =  RAD_AONR 
   inextradatatemp.SOKLOG[2] =  RAD_BER  
   inextradatatemp.SOKLOG[3] =  RAD_KALK 
   inextradatatemp.SOKLOG[4] =  RAD_MARK 
   inextradatatemp.SOKLOG[5] =  RAD_PERS 
   inextradatatemp.SOKLOG[6] =  RAD_TID  
   inextradatatemp.SOKLOG[7] =  RAD_FAKT 
   inextradatatemp.SOKLOG[8] =  RAD_PLAN 
   inextradatatemp.SOKLOG[9] =  RAD_STOR 
   inextradatatemp.SOKLOG[10] =  RAD_ALLTIDMAX   
   inextradatatemp.SOKCHAR[1] =  STRING(FILL-IN-NUMFORM,"EUROPEAN/AMERICAN")
   inextradatatemp.SOKCHAR[2] =  STRING(FILL-IN-EXCEL,"Ja/Nej")
    
   inextradatatemp.SOKINT[1] =  FILL-IN-AUTOSPAR.
   IF RAD_UTF = TRUE THEN inextradatatemp.SOKINT[2] = 1.
   ELSE inextradatatemp.SOKINT[2] = 0.
   inextradatatemp.SOKINT[3] =   0 /* SPRÅK*/
   inextradatatemp.SOKINT[4] =   0 /*sortera på nettotpris = 1*/
   inextradatatemp.SOKINT[5] =  NORMALBREDD
   inextradatatemp.SOKINT[6] = NORMALHÖJD
   inextradatatemp.SOKINT[7] = FILL-IN-PNRSELGA
   inextradatatemp.SOKINT[8] = Arbetsplatsnästa
   inextradatatemp.SOKINT[9] = Max arbetpl"
   inextradatatemp.SOKINT[10] = GURUVERSION
   FS   ANVÄNDS INTE     PROGRAM = "FS"               
            HUVUDCH  = AONR
            HUVUDINT = DELNR            
            SOKINT[1] =  PROCENT.                    
            SOKDATE[1] = FSDATUM.       
   
   FNYCKEL  PROGRAM = "FNYCKEL"                  
            HUVUDCH  = AONR
            HUVUDINT = DELNR     
            SOKINT[1] =  MONTÖR BERED %
            SOKINT[2] =  PROJEKTLED
            SOKINT[3] =  PROJEKTÖR
            SOKINT[4] =  DUMUMENTATION
            SOKINT[1] + SOKINT[2] = KALKYLENS MONTTIMMAR
            SOKINT[3] + SOKINT[4] = KALKYLENS BEREDARTIMMAR
            
            
   PRIOOMR  PROGRAM = "PRIOOMR"               
            HUVUDCH  = OMRADE   
            HUVUDINT  = PKOD                 
            SOKLOG[1] =  AKTIV
            SOKCH(1) = BENAMNING
            
STORSKOG  PROGRAM = "STORSKOG"               
            HUVUDCH  = "1"   
            HUVUDINT  = 1                 
            SOKDEC[1] =  "Norrlands inland"
            SOKDEC[2] =  "Norrlands kustland"  utgår
            SOKDEC[3] =  "Svealand" utgår
            SOKDEC[4] =  "Götaland"  utgår
            
            nya 20140224
            SOKDEC[5] =  "Norrlands kustland ej Gävleborgs län"
            SOKDEC[6] =  "Tillväxtområde 3 (2009 års skognorm"
            SOKDEC[7] =  "Tillväxtområde 4A (2009 års skognorm"
            SOKDEC[8] =  "Tillväxtområde 4B (2009 års skognorm"
            
                  
                        
VARDNRARTAL  om en värdering med flera fastigheter går över årsskiftet skall inte de fastigheter som beräknas efter årsskiftet räknas med nytt pris. 20150305
               PROGRAM = "VARDNRARTAL"          
               HINT = VARDNR               
               HCH =  
               INT[1] = ÅRTAL               
 "AVLEVANM"    
               PROGRAM = "AVLEVANM"
               HINT = av-level
               inextradatatemp.SOKCHAR[1] =  ANMÄRK. 
               EXTRADATA.SOKLOG[1]= TRUE OM LÅST NIVÅ                          
  
PERSONALLIGGARE HUVUDCH  = pkod
                SOKCH(1) = orgnr
                SOKCH(2) = företag      

Flexavtal start slut 
               PROGRAM = "FLEXSTARTSLUT"   
               HUVUDCH  = pkod
                SOKDATE(1) = flexstart
                SOKDATE(2) = flexslut
                
DEPÅ koordinater PROGRAM = "DEPAKORD"
                HUVUDINT  = Dep-Nr
                SOKCH(1) = xkordch
                SOKCH(2) = ykordch    
                
                  
 Återför 50 tim komp     PROGRAM = "ATERFOR50"   
                         HUVUDCH  = pkod
                         SOKLOG[1] = ater50
                         SOKDATE(1) = inlagt datum
                         SOKCHAR[1] = inlagt av
                                               
Se all tid     PROGRAM = "SEALLTID"   
                         HUVUDCH  = pkod
                         SOKLOG[1] = Ja/Nej
                         SOKDATE(1) = inlagt datum
                         SOKCHAR[1] = inlagt av                                                          
               
*/


/********************************programmet startar här **********************************/
{EXTRADATA.I}  
DEFINE VARIABLE musz AS LOGICAL NO-UNDO.

{DYNHMT.I}

/*HÄMTA ALLA*/

PROCEDURE etabhamt_UI:
   DEFINE INPUT PARAMETER TABLE FOR inextradatatemp. 
   DEFINE OUTPUT PARAMETER TABLE FOR extradatatemp. 
   EMPTY TEMP-TABLE extradatatemp NO-ERROR. 
   FIND FIRST inextradatatemp NO-ERROR.
   IF NOT AVAILABLE inextradatatemp THEN RETURN.
   
   RUN kom_UI (INPUT "").
   ASSIGN
   nytab      = "extradatatemp"
   orginaltab = "EXTRADATA".    
   /*BUGG 9.1c FIX*/
   ASSIGN extratemptabh = TEMP-TABLE extradatatemp:DEFAULT-BUFFER-HANDLE.
   RUN dynquery_UI (INPUT FALSE,INPUT FALSE). 
    
   RUN egenkoll_UI (INPUT inextradatatemp.PROGRAM).
   RUN objdelete_UI.
   
END PROCEDURE.


/*TABORT POST*/
PROCEDURE exbort_UI:
   DEFINE INPUT PARAMETER TABLE FOR inextradatatemp. 
   DEFINE VARIABLE extravar AS CHARACTER NO-UNDO.
   orginaltab = "EXTRADATA".
   FIND FIRST inextradatatemp NO-LOCK NO-ERROR.
   IF NOT AVAILABLE inextradatatemp THEN RETURN.
   IF inextradatatemp.PROGRAM = "FRIPRIS" THEN DO:
      RUN EXTRADATSPECT.P (INPUT 1,INPUT-OUTPUT TABLE inextradatatemp).      
   END.
   ELSE IF inextradatatemp.PROGRAM = "AOTIDPERS" THEN DO:
      FOR EACH inextradatatemp:    
         extravar = " AND EXTRADATA.SOKCHAR[1] = '" + inextradatatemp.SOKCHAR[1] + "'". 
         RUN kom_UI (INPUT extravar).
         RUN dyndelete_UI (INPUT FALSE).
      END.
   END.
   ELSE IF inextradatatemp.PROGRAM = "FIFO" THEN DO:
      FOR EACH inextradatatemp:    
         FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
         EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
         EXTRADATA.SOKDATE[1] = inextradatatemp.SOKDATE[1] AND EXTRADATA.SOKINT[2] = inextradatatemp.SOKINT[2] 
         EXCLUSIVE-LOCK NO-ERROR.
         IF AVAILABLE EXTRADATA THEN DO:
            DELETE EXTRADATA.
            DELETE inextradatatemp.
         END.
      END.
   END.   
   ELSE IF inextradatatemp.PROGRAM = "TRUMMAUT" THEN DO:
      FOR EACH inextradatatemp:    
         FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
         EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
         EXTRADATA.SOKINT[1] = inextradatatemp.SOKINT[1] EXCLUSIVE-LOCK NO-ERROR.
         IF AVAILABLE EXTRADATA THEN DO:
            DELETE EXTRADATA.
            DELETE inextradatatemp.
         END.
      END.
   END.
   ELSE IF inextradatatemp.PROGRAM = "FSVOL" THEN DO:
      FOR EACH inextradatatemp:    
         FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
         EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
         EXTRADATA.SOKINT[1] = inextradatatemp.SOKINT[1] EXCLUSIVE-LOCK NO-ERROR.
         IF AVAILABLE EXTRADATA THEN DO:
            DELETE EXTRADATA.
            DELETE inextradatatemp.
         END.
      END.
   END.

   ELSE IF inextradatatemp.PROGRAM = "REVAVTAL" THEN DO:
      FOR EACH inextradatatemp:    
         FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
         EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
         EXTRADATA.SOKINT[1] = inextradatatemp.SOKINT[1] EXCLUSIVE-LOCK NO-ERROR.
         IF AVAILABLE EXTRADATA THEN DO:
            DELETE EXTRADATA.
            DELETE inextradatatemp.
         END.
      END.
   END.
   ELSE IF inextradatatemp.PROGRAM = "VARDFASTAG" THEN DO:
      FOR EACH inextradatatemp:    
         FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
         EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
         EXTRADATA.SOKINT[1] = inextradatatemp.SOKINT[1] EXCLUSIVE-LOCK NO-ERROR.
         IF AVAILABLE EXTRADATA THEN DO:
            DELETE EXTRADATA.
            DELETE inextradatatemp.
         END.
      END.
   END.
   ELSE IF inextradatatemp.PROGRAM = "VARDFASTAG2" THEN DO:
      FOR EACH inextradatatemp:    
         FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
         EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
         EXTRADATA.SOKINT[4] = inextradatatemp.SOKINT[4] EXCLUSIVE-LOCK NO-ERROR.
         IF AVAILABLE EXTRADATA THEN DO:
            DELETE EXTRADATA.
            DELETE inextradatatemp.
         END.
      END.
   END.
   
   ELSE IF inextradatatemp.PROGRAM = "LOGPOST" THEN DO:
      FOR EACH inextradatatemp:
         FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT
            AND EXTRADATA.SOKCHAR[1] = inextradatatemp.SOKCHAR[1] AND EXTRADATA.SOKCHAR[2] = inextradatatemp.SOKCHAR[2] AND
            EXTRADATA.SOKCHAR[3] = inextradatatemp.SOKCHAR[3] AND EXTRADATA.SOKCHAR[4] = inextradatatemp.SOKCHAR[4] AND
            EXTRADATA.SOKCHAR[5] = inextradatatemp.SOKCHAR[5] AND EXTRADATA.SOKDAT[1] = inextradatatemp.SOKDAT[1] AND
            EXTRADATA.SOKINT[1] = inextradatatemp.SOKINT[1] EXCLUSIVE-LOCK NO-ERROR.
         IF AVAILABLE EXTRADATA THEN DO:
            DELETE EXTRADATA.
            DELETE inextradatatemp.
         END.         
      END.
   END.
   ELSE IF inextradatatemp.PROGRAM = "MACADD" THEN DO:
      FOR EACH inextradatatemp:
         FOR EACH EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH 
         EXCLUSIVE-LOCK.
            DELETE EXTRADATA.
         END.
         DELETE inextradatatemp.         
      END.
   END.
   ELSE DO:
      FOR EACH inextradatatemp:    
         RUN kom_UI (INPUT "").
         RUN dyndelete_UI (INPUT FALSE).
      END.
   END.
   
   RUN objdelete_UI.
END PROCEDURE.
/*FINNS POST*/

PROCEDURE finnsextra_UI:
   DEFINE INPUT PARAMETER TABLE FOR inextradatatemp. 
   DEFINE OUTPUT PARAMETER finnsok AS LOGICAL NO-UNDO.
   EMPTY TEMP-TABLE extradatatemp NO-ERROR. 
   FIND FIRST inextradatatemp NO-ERROR.
   IF NOT AVAILABLE inextradatatemp THEN RETURN.
   RUN kom_UI (INPUT "").
   ASSIGN
   nytab      = "extradatatemp"
   orginaltab = "EXTRADATA". 
   ASSIGN extratemptabh = TEMP-TABLE extradatatemp:DEFAULT-BUFFER-HANDLE.
   RUN dynquery_UI (INPUT FALSE,INPUT FALSE).   
   RUN objdelete_UI.
   FIND FIRST extradatatemp NO-ERROR.
   IF AVAILABLE extradatatemp THEN finnsok = TRUE.
   ELSE DO:
      finnsok = FALSE.   
      RETURN.
   END.
   
END PROCEDURE.
/*SISTA POSTEN*/
PROCEDURE sista_UI:
   DEFINE INPUT PARAMETER charint AS LOGICAL  NO-UNDO.
   DEFINE INPUT-OUTPUT PARAMETER TABLE FOR inextradatatemp. 
   FIND FIRST inextradatatemp NO-LOCK NO-ERROR.
   IF charint = TRUE THEN DO:
      FIND LAST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM 
      USE-INDEX HCH NO-LOCK NO-ERROR.     
   END.
   ELSE DO:
      FIND LAST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM 
      USE-INDEX HIN NO-LOCK NO-ERROR.
   END.
   IF AVAILABLE EXTRADATA THEN DO:
      BUFFER-COPY EXTRADATA TO inextradatatemp.
   END.
   ELSE DELETE inextradatatemp.
   
END PROCEDURE.


/*SKAPA SPARA*/
PROCEDURE sparaextra_UI:
   DEFINE INPUT PARAMETER TABLE FOR inextradatatemp. 
   ASSIGN
   nytab      = "inextradatatemp"
   orginaltab = "EXTRADATA". 
   kommandoquery = "FOR EACH inextradatatemp ".
   ASSIGN extratemptabh = TEMP-TABLE inextradatatemp:DEFAULT-BUFFER-HANDLE.
   RUN dynspar_UI.      
   RELEASE EXTRADATA NO-ERROR.
   RUN objdelete_UI.
END PROCEDURE.
/*SPARA extraspar_UI BÖR ANVÄNDAS EJ sparaextra_UI*/
PROCEDURE extraspar_UI:
   DEFINE INPUT PARAMETER TABLE FOR inextradatatemp. 
   FOR EACH inextradatatemp NO-LOCK.
      DO TRANSACTION:
         IF inextradatatemp.PROGRAM = "AOTIDPERS" THEN DO:
            FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND  
            EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH  AND
            EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.SOKCHAR[1] = inextradatatemp.SOKCHAR[1]
            EXCLUSIVE-LOCK NO-ERROR.
         END.
         ELSE IF inextradatatemp.PROGRAM = "FIFO" THEN DO:
            FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
            EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
            EXTRADATA.SOKDATE[1] = inextradatatemp.SOKDATE[1] AND EXTRADATA.SOKINT[2] = inextradatatemp.SOKINT[2] 
            EXCLUSIVE-LOCK NO-ERROR.
         END.
         ELSE IF inextradatatemp.PROGRAM = "TRUMMAUT" THEN DO:
            FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
            EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
            EXTRADATA.SOKINT[1] = inextradatatemp.SOKINT[1] 
            EXCLUSIVE-LOCK NO-ERROR.
         END.        
         ELSE IF inextradatatemp.PROGRAM = "KALKMALL" AND inextradatatemp.HUVUDCH = "2" THEN DO:            
            FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
            EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
            EXTRADATA.SOKCHAR[1] = inextradatatemp.SOKCHAR[1]  AND EXTRADATA.SOKINT[1] = inextradatatemp.SOKINT[1] 
            EXCLUSIVE-LOCK NO-ERROR.
         END.        
         ELSE IF inextradatatemp.PROGRAM = "FSVOL" THEN DO:
            FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
            EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
            EXTRADATA.SOKINT[1] = inextradatatemp.SOKINT[1] 
            EXCLUSIVE-LOCK NO-ERROR.
         END.
         ELSE IF inextradatatemp.PROGRAM = "SUPPERS"  THEN DO:
            FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
            EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
            EXTRADATA.SOKCHAR[1] = inextradatatemp.SOKCHAR[1] 
            EXCLUSIVE-LOCK NO-ERROR.  
         END.
         ELSE IF inextradatatemp.PROGRAM = "REVAVTAL" THEN DO:
            FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
            EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
            EXTRADATA.SOKINT[1] = inextradatatemp.SOKINT[1] 
            EXCLUSIVE-LOCK NO-ERROR.
         END.
         ELSE IF inextradatatemp.PROGRAM = "VARDFASTAG" THEN DO:
            FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
            EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
            EXTRADATA.SOKINT[1] = inextradatatemp.SOKINT[1] 
            EXCLUSIVE-LOCK NO-ERROR.
         END.
         ELSE IF inextradatatemp.PROGRAM = "VARDFASTAG2" THEN DO:
            FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
            EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
            EXTRADATA.SOKINT[4] = inextradatatemp.SOKINT[4] 
            EXCLUSIVE-LOCK NO-ERROR.
         END.
         ELSE IF inextradatatemp.PROGRAM = "TIDPLANOVRIGA" THEN DO:
            FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND              
            EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT AND EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH AND
            EXTRADATA.SOKCHAR[1] = inextradatatemp.SOKCHAR[1] 
            EXCLUSIVE-LOCK NO-ERROR.
         END.
         ELSE DO:
            FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = inextradatatemp.PROGRAM AND  
            EXTRADATA.HUVUDCH = inextradatatemp.HUVUDCH  AND
            EXTRADATA.HUVUDINT = inextradatatemp.HUVUDINT
            EXCLUSIVE-LOCK NO-ERROR.
         END.
         IF NOT AVAILABLE EXTRADATA THEN CREATE EXTRADATA.
         BUFFER-COPY inextradatatemp TO EXTRADATA.      
      END.
      
   END.     
   RELEASE EXTRADATA NO-ERROR.
END PROCEDURE.



/*EGNA KONTROLLER*/
PROCEDURE egenkoll_UI:  
   DEFINE INPUT PARAMETER val AS CHARACTER NO-UNDO.
   /*KOLL ELLER EXTRA LADDNING*/
   IF val = "" THEN DO:
      
   END.      
END PROCEDURE. 

PROCEDURE dynstartkoll_UI:  
   musz = FALSE.
END PROCEDURE. 
PROCEDURE kom_UI:
   DEFINE INPUT PARAMETER extraval AS CHARACTER NO-UNDO.
   ASSIGN 
   kommandoquery = "FOR EACH EXTRADATA WHERE EXTRADATA.PROGRAM = '" + inextradatatemp.PROGRAM + "'".
   IF inextradatatemp.HUVUDCH NE ? THEN DO:
      RUN and_UI.
      kommandoquery = kommandoquery + " EXTRADATA.HUVUDCH = '" + inextradatatemp.HUVUDCH + "'".
   END.
   IF inextradatatemp.HUVUDINT NE ? THEN DO:
      RUN and_UI.
      kommandoquery = kommandoquery + " EXTRADATA.HUVUDINT = " + STRING(inextradatatemp.HUVUDINT). 
   END.   
   kommandoquery = kommandoquery + extraval.
   
END PROCEDURE. 
/*AO PROJ SPECIAL*/
PROCEDURE finnsextra2_UI:
   DEFINE INPUT PARAMETER TABLE FOR inextradatatemp. 
   DEFINE OUTPUT PARAMETER TABLE FOR extradatatemp. 
   DEFINE OUTPUT PARAMETER finnsok AS LOGICAL NO-UNDO.
   EMPTY TEMP-TABLE extradatatemp NO-ERROR. 
   FIND FIRST inextradatatemp NO-ERROR.
   IF NOT AVAILABLE inextradatatemp THEN RETURN.
   orginaltab = "EXTRADATA". 
   {SETUSE.I}  
   IF inextradatatemp.PROGRAM = "AOPROJ" THEN DO:
     
      RUN EXTRADATSPEC.P (INPUT 1).      
   END.  
   RUN kom_UI (INPUT "").
   ASSIGN
   nytab      = "extradatatemp"
   orginaltab = "EXTRADATA". 
   ASSIGN extratemptabh = TEMP-TABLE extradatatemp:DEFAULT-BUFFER-HANDLE.
   RUN dynquery_UI (INPUT FALSE,INPUT FALSE).   
   {UNSETUSE.I}
   RUN objdelete_UI.
   FIND FIRST extradatatemp NO-ERROR.
   IF AVAILABLE extradatatemp THEN finnsok = TRUE.
   ELSE DO:
      finnsok = FALSE.   
      RETURN.
   END.
   
END PROCEDURE.
PROCEDURE Gfragor_UI :
   DEFINE INPUT  PARAMETER vad AS CHARACTER NO-UNDO. 
   DEFINE OUTPUT PARAMETER TABLE FOR extradatatemp.
   EMPTY TEMP-TABLE extradatatemp NO-ERROR. 
   FIND FIRST EXTRADATA WHERE EXTRADATA.PROGRAM = "GFRAG" AND EXTRADATA.HUVUDCH = Guru.Konstanter:globanv NO-LOCK NO-ERROR.
   IF AVAILABLE EXTRADATA THEN RETURN.
   FOR EACH EXTRADATA WHERE EXTRADATA.PROGRAM = "GFRAG" AND EXTRADATA.HUVUDCH = "" NO-LOCK:
      CREATE extradatatemp.
      BUFFER-COPY EXTRADATA TO extradatatemp.
      
      extradatatemp.HUVUDCH = Guru.Konstanter:globanv .
      extradatatemp.SOKDATE[1] = TODAY.
   END.
   
END PROCEDURE.   
