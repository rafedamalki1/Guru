/*NORDEKO2.P*/
DEFINE SHARED VARIABLE aonummer LIKE AONRTAB.AONR NO-UNDO.
DEFINE SHARED VARIABLE musz AS LOGICAL NO-UNDO.
DEFINE SHARED VARIABLE nytid AS DECIMAL FORMAT "99.99" NO-UNDO.
DEFINE SHARED VARIABLE sekunder AS INTEGER FORMAT "-9999999" NO-UNDO. 
DEFINE SHARED VARIABLE persrec AS RECID NO-UNDO. 
DEFINE VARIABLE ekrid AS RECID EXTENT 50 NO-UNDO.
DEFINE VARIABLE aoomrade LIKE AONRTAB.OMRADE NO-UNDO.   
DEFINE VARIABLE org LIKE AONRTAB.OMRADE NO-UNDO.         
DEFINE VARIABLE timtid AS DECIMAL FORMAT "99.99" NO-UNDO. 
DEFINE VARIABLE multi AS DECIMAL FORMAT "99.99" NO-UNDO.
DEFINE VARIABLE berkostnad AS DECIMAL FORMAT "99.99" NO-UNDO.
DEFINE VARIABLE totpristim AS DECIMAL FORMAT "99.99" NO-UNDO. 
DEFINE VARIABLE intpristim AS DECIMAL FORMAT "99.99" NO-UNDO.
DEFINE VARIABLE reskod LIKE TIDREGITAB.LONTILLAGG NO-UNDO. 
DEFINE VARIABLE resantal LIKE TIDREGITAB.LONTILLANTAL NO-UNDO.
DEFINE VARIABLE resbelopp LIKE EKRAPPRESULT.ELONBELOPP NO-UNDO. 
DEFINE VARIABLE ovkod LIKE TIDREGITAB.OVERTIDTILL NO-UNDO. 
DEFINE VARIABLE ovantal LIKE TIDREGITAB.OVERANTAL NO-UNDO.
DEFINE VARIABLE ovbelopp LIKE EKRAPPRESULT.EOVERBELOPP NO-UNDO. 
DEFINE VARIABLE trakod LIKE TIDREGITAB.TRAKTKOD NO-UNDO. 
DEFINE VARIABLE traantal LIKE TIDREGITAB.TRAKTANTAL NO-UNDO.
DEFINE VARIABLE trabelopp LIKE EKRAPPRESULT.ETRAKTBELOPP NO-UNDO. 
DEFINE VARIABLE lonkod LIKE TIDREGITAB.LONTILLAGG NO-UNDO. 
DEFINE VARIABLE lonantal LIKE TIDREGITAB.LONTILLANTAL NO-UNDO.
DEFINE VARIABLE lonbelopp LIKE EKRAPPRESULT.ELONBELOPP NO-UNDO. 
DEFINE VARIABLE berkod LIKE TIDREGITAB.BEREDSKAP NO-UNDO. 
DEFINE VARIABLE bbantal LIKE TIDREGITAB.BERANTAL NO-UNDO.
DEFINE VARIABLE berbelopp LIKE EKRAPPRESULT.EBERBELOPP NO-UNDO.
DEFINE VARIABLE timantal LIKE EKRAPPRESULT.EANTAL NO-UNDO.
DEFINE VARIABLE timbelopp LIKE EKRAPPRESULT.EBELOPP NO-UNDO.
DEFINE VARIABLE kontokod LIKE EKRAPPRESULT.EKOSTNADSSLAG NO-UNDO. 
DEFINE VARIABLE kontokode LIKE EKRAPPRESULT.EKOSTNADSSLAG NO-UNDO. 
DEFINE VARIABLE pkoder LIKE PERSONALTAB.PERSONALKOD NO-UNDO.  
DEFINE VARIABLE fk1 LIKE AONRKONTKO.K1 NO-UNDO. 
DEFINE VARIABLE fk2 LIKE AONRKONTKO.K2 NO-UNDO.
DEFINE VARIABLE fk3 LIKE AONRKONTKO.K3 NO-UNDO.
DEFINE VARIABLE fk4 LIKE AONRKONTKO.K4 NO-UNDO. 
DEFINE VARIABLE fk4i AS INTEGER format "999" NO-UNDO.
DEFINE VARIABLE fk5 LIKE AONRKONTKO.K5 NO-UNDO.  
DEFINE VARIABLE kodanst LIKE ANSTFORMTAB.KOD NO-UNDO.
DEFINE SHARED TEMP-TABLE ekoforst
   FIELD ENY LIKE EKRAPPRESULT.ENY 
   FIELD EPERSONALKOD LIKE EKRAPPRESULT.EPERSONALKOD 
   FIELD EPROJEKT LIKE EKRAPPRESULT.EPROJEKT 
   FIELD EORG LIKE EKRAPPRESULT.EORG  
   FIELD EGEO LIKE EKRAPPRESULT.EGEO  
   FIELD EVERDATUM LIKE EKRAPPRESULT.EVERDATUM
   FIELD EOVERJA LIKE EKRAPPRESULT.EOVERJA
   FIELD ERESULTENH LIKE EKRAPPRESULT.ERESULTENH 
   FIELD EBELOPP LIKE  EKRAPPRESULT.EBELOPP    
   FIELD EANTAL LIKE EKRAPPRESULT.EANTAL 
   FIELD ETIMMAR LIKE EKRAPPRESULT.EANTAL 	       
   FIELD ELONTILLAGG LIKE EKRAPPRESULT.ELONTILLAGG 
   FIELD ELONTILLANTAL LIKE EKRAPPRESULT.ELONTILLANTAL    
   FIELD ELONBELOPP LIKE EKRAPPRESULT.ELONBELOPP         
   INDEX PERSORG IS PRIMARY EPERSONALKOD EORG EGEO EPROJEKT ASCENDING.
DEFINE SHARED TEMP-TABLE eko
   FIELD EDEBKRED LIKE EKRAPPRESULT.EDEBKRED
   FIELD ENY LIKE EKRAPPRESULT.ENY       
   FIELD EVERDATUM LIKE EKRAPPRESULT.EVERDATUM  
   FIELD EPROJEKT LIKE EKRAPPRESULT.EPROJEKT 
   FIELD EORG LIKE EKRAPPRESULT.EORG 
/*   FIELD EGEO LIKE EKRAPPRESULT.EGEO       */
   FIELD EKOSTNADSSLAG LIKE EKRAPPRESULT.EKOSTNADSSLAG    
   FIELD EBELOPP LIKE  EKRAPPRESULT.EBELOPP 
   FIELD EANTAL  LIKE EKRAPPRESULT.EANTAL 	       
   FIELD ELONTILLAGG LIKE EKRAPPRESULT.ELONTILLAGG 
   FIELD ELONTILLANTAL LIKE EKRAPPRESULT.ELONTILLANTAL    
   FIELD ELONBELOPP LIKE EKRAPPRESULT.ELONBELOPP         
   INDEX ORG IS PRIMARY EVERDATUM EORG EPROJEKT EKOSTNADSSLAG ASCENDING.   
DEFINE BUFFER eko2 FOR eko.
pkoder = "". 
FIND FIRST ekoforst WHERE ekoforst.ENY = FALSE USE-INDEX PERSORG NO-LOCK NO-ERROR.
IF NOT AVAILABLE ekoforst THEN RETURN.        
ekrid[1] = RECID(ekoforst).
REPEAT:
   IF pkoder NE ekoforst.EPERSONALKOD THEN DO:      
      pkoder = ekoforst.EPERSONALKOD.      
      FIND FIRST PERSONALTAB WHERE PERSONALTAB.PERSONALKOD = pkoder 
      USE-INDEX PERSONALKOD NO-LOCK NO-ERROR.        
      org = PERSONALTAB.OMRADE. 
      persrec = RECID(PERSONALTAB).
      FIND FIRST ANSTFORMTAB WHERE
      ANSTFORMTAB.ANSTALLNING = PERSONALTAB.ANSTALLNING
      USE-INDEX ANSTF NO-LOCK NO-ERROR.
      FIND FIRST TIMKOSTNADSTAB 
      WHERE TIMKOSTNADSTAB.PERSONALKOD = PERSONALTAB.PERSONALKOD AND
      TIMKOSTNADSTAB.PRISTYP = 'TOT.PRIS.' USE-INDEX PRISPERS NO-LOCK NO-ERROR.
      totpristim = TIMKOSTNADSTAB.PRISA. 
      FIND FIRST TIMKOSTNADSTAB 
      WHERE TIMKOSTNADSTAB.PERSONALKOD = PERSONALTAB.PERSONALKOD AND
      TIMKOSTNADSTAB.PRISTYP = 'INTERNPRI' USE-INDEX PRISPERS NO-LOCK NO-ERROR.       
      intpristim = TIMKOSTNADSTAB.PRISA.
      kodanst = ANSTFORMTAB.KOD.
   END.   
   ASSIGN
   fk1 = "" 
   fk2 = ""
   fk3 = ""
   fk4 = ""    
   fk5 = "".  
   FIND FIRST AONRTAB WHERE AONRTAB.AONR = ekoforst.EPROJEKT AND
   AONRTAB.DELNR = 000 USE-INDEX AONR NO-LOCK NO-ERROR.
   IF NOT AVAILABLE AONRTAB THEN DO:
      aoomrade = org. 
      IF ekoforst.EPROJEKT = "" THEN aoomrade = org. 
      ELSE DO:
         MESSAGE "AONR" ekoforst.EPROJEKT "000 FINNS EJ! KONTAKTA ELPOOL"
         VIEW-AS ALERT-BOX.
      END.
   END.   
   ELSE DO:           
      aoomrade = AONRTAB.OMRADE.   
      IF AONRTAB.OMRADE = "" THEN aoomrade = org. 
      FIND FIRST AONRKONTKOD WHERE AONRKONTKOD.AONR = AONRTAB.AONR  AND 
      AONRKONTKOD.DELNR = AONRTAB.DELNR USE-INDEX AONRKONT NO-LOCK NO-ERROR. 
      IF AVAILABLE AONRKONTKOD THEN DO:
         ASSIGN
         fk1 = AONRKONTKOD.K1 
         fk2 = AONRKONTKOD.K2
         fk3 = AONRKONTKOD.K3
         fk4 = AONRKONTKOD.K4    
         fk5 = AONRKONTKOD.K5.
     END.  
   END.     
   /*TIMMAR OCH PENNGAR*/
   IF ekoforst.EBELOPP = 0 THEN DO:
      persrec = persrec.
   END.                                   
   ELSE DO:
      IF kodanst = 'T' OR kodanst = 'T1' THEN DO:
         /*IF TRIM(fk3) = "0" THEN DO:   ÄNDRAT 960830 EJ INDEREKTA KOSTNADER
            kontokod = "9220".
         END.
         ELSE DO:
            IF ekoforst.EORG NE ekoforst.EGEO THEN DO:
               kontokod = "9401".
               kontokode = "9220".
            END.
            ELSE DO:
               kontokod = "9220".
            END.
         END.*/ 
         IF ekoforst.EORG NE ekoforst.EGEO THEN DO:
            kontokod = "9401".
            kontokode = "9220".
         END.
         ELSE DO:
            kontokod = "9220".
         END.  
      END.
      ELSE DO:
         IF ekoforst.EORG NE ekoforst.EGEO THEN DO:
            kontokod = "9401".
            kontokode = "9010".
         END.
         ELSE DO:
            kontokod = "9010".            
         END.                         
      END.    
      RUN tim_UI.      
   END.      
   IF ekoforst.ELONTILLAGG = "" THEN DO:
      persrec = persrec.
   END.                                   
   ELSE DO:
      /*ÖVERTIDTILLÄGG*/ 
      IF ekoforst.ERESULTENH = "OVE" THEN DO:            
         ovkod = ekoforst.ELONTILLAGG.
         IF kodanst = 'T' OR kodanst = 'T1'  THEN DO:
            IF ekoforst.EORG NE ekoforst.EGEO THEN DO:
               kontokod = "9402".
               kontokode = "9225".
            END.
            ELSE DO:
               kontokod = "9225".
            END.         
         END.
         ELSE DO:
            IF ekoforst.EORG NE ekoforst.EGEO THEN DO:
               kontokod = "9402". 
               kontokode = "9015". 
            END.
            ELSE DO:
               kontokod = "9015".
            END.                                 
         END.    
         RUN overtim_UI. 
      END.               
      /*MILERS*/
      IF ekoforst.ERESULTENH = "MIL" THEN DO:    
         IF kodanst = 'T' OR kodanst = 'T1' THEN DO:
            IF ekoforst.EORG NE ekoforst.EGEO THEN DO:
               kontokod = "9425".
               kontokode = "9530".
            END.
            ELSE DO:
               kontokod = "9530".
            END.            
         END.
         ELSE DO:
            IF ekoforst.EORG NE EGEO THEN DO:
               kontokod = "9425".
               kontokode = "9530".
            END.
            ELSE DO:
               kontokod = "9530".
            END.                                          
         END.
         RUN milkost_UI.   
      END.                      
      /*TRAKTAMENTE*/ 
      IF ekoforst.ERESULTENH = "TRA" THEN DO:        
         trakod = ekoforst.ELONTILLAGG.
         IF kodanst = 'T' OR kodanst = 'T1'  THEN DO:
            IF ekoforst.EORG NE ekoforst.EGEO THEN DO:
               kontokod = "9421".
               kontokode = "9520".
            END.
            ELSE DO:
               kontokod = "9520".
            END.
         END.
         ELSE DO:
            IF ekoforst.EORG NE ekoforst.EGEO THEN DO:
               kontokod = "9421".
               kontokode = "9520".
            END.
            ELSE DO:
               kontokod = "9520".
            END.                                            
         END.
         RUN trakost_UI.     
      END.
      /*BEREDSKAP*/             
      IF ekoforst.ERESULTENH = "BER" THEN DO:     
         IF ekoforst.ELONTILLAGG = "" THEN DO:
            persrec = persrec.
         END.                                   
         ELSE DO:            
            IF kodanst = 'T' OR kodanst = 'T1' THEN DO:
               kontokod = "9220".          
            END.
            ELSE DO:
               kontokod = "9010".                                    
            END.
            RUN berkost_UI.       
         END.             
      END.
      /*LONE BEROENDE LONETILL*/ 
      IF ekoforst.ERESULTENH = "REL" THEN DO:   
         ovkod = ekoforst.ELONTILLAGG.             
         IF ekoforst.ELONTILLAGG = "" THEN DO:
            persrec = persrec.
         END.   
         ELSE DO: 
            IF kodanst = 'T' OR kodanst = 'T1' THEN DO:
               IF ekoforst.EORG NE ekoforst.EGEO THEN DO:
                  kontokod = "9401".
                  kontokode = "9220".
               END.
               ELSE DO:
                  kontokod = "9220".
               END.               
            END.
            ELSE DO:
               IF ekoforst.EORG NE ekoforst.EGEO THEN DO:
                  kontokod = "9401".
                  kontokode = "9010".
               END.
               ELSE DO:
                  kontokod = "9010".
               END.                                  
            END.    
            RUN rel_UI.      
         END. 
      END.                             
      /*EJ LONE BEROENDE LONETILL*/ 
      IF ekoforst.ERESULTENH = "LON" THEN DO:                
         IF ekoforst.ELONTILLAGG = "" THEN DO:
            persrec = persrec.
         END.   
         ELSE DO:
            IF kodanst = 'T' OR kodanst = 'T1' THEN DO:
               IF ekoforst.EORG NE ekoforst.EGEO THEN DO:
                  kontokod = "9401".
                  kontokode = "9220".
               END.
               ELSE DO:
                  kontokod = "9220".
               END.  
            END.
            ELSE DO:
               IF ekoforst.EORG NE ekoforst.EGEO THEN DO:
                  kontokod = "9401".
                  kontokode = "9010".
               END.
               ELSE DO:
                  kontokod = "9010".
               END.                                       
            END.    
            RUN lonkost_UI.  
         END.
      END.       
   END.
   DO TRANSACTION: 		    
      FIND ekoforst WHERE RECID(ekoforst) = ekrid[1]
      NO-LOCK NO-ERROR. 
      DELETE ekoforst.
   END.
   FIND FIRST ekoforst WHERE ekoforst.ENY = FALSE USE-INDEX PERSORG NO-LOCK NO-ERROR.
   IF NOT AVAILABLE ekoforst THEN LEAVE.           
   ekrid[1] = RECID(ekoforst).
END.   

   FIND FIRST eko USE-INDEX ORG NO-LOCK NO-ERROR.
   IF NOT AVAILABLE eko THEN RETURN.        
   ekrid[1] = RECID(eko).
   REPEAT: 
      DO TRANSACTION:
         FIND FIRST EKRAPPRESULT WHERE EKRAPPRESULT.EDEBKRED = eko.EDEBKRED AND 
         EKRAPPRESULT.EORG = eko.EORG AND 
         EKRAPPRESULT.EVERDATUM = eko.EVERDATUM AND
         EKRAPPRESULT.EPROJEKT = eko.EPROJEKT AND
         EKRAPPRESULT.EKOSTNADSSLAG = eko.EKOSTNADSSLAG
         USE-INDEX PERSORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE EKRAPPRESULT THEN DO:
            CREATE EKRAPPRESULT.
         END.    
         ASSIGN            
         EKRAPPRESULT.EDEBKRED = eko.EDEBKRED
         EKRAPPRESULT.ENY = TRUE 
         EKRAPPRESULT.EORG = eko.EORG  
         EKRAPPRESULT.EPROJEKT = eko.EPROJEKT 
         EKRAPPRESULT.EVERDATUM = eko.EVERDATUM
         EKRAPPRESULT.EKOSTNADSSLAG = eko.EKOSTNADSSLAG
         EKRAPPRESULT.EANTAL = EKRAPPRESULT.EANTAL + eko.EANTAL  
         EKRAPPRESULT.EBELOPP = EKRAPPRESULT.EBELOPP + eko.EBELOPP + eko.ELONBELOPP       
         EKRAPPRESULT.ELONTILLANTAL = EKRAPPRESULT.ELONTILLANTAL + eko.ELONTILLANTAL  
         EKRAPPRESULT.ELONBELOPP = EKRAPPRESULT.ELONBELOPP + eko.ELONBELOPP.            
      END.
      FIND NEXT eko USE-INDEX ORG NO-LOCK NO-ERROR.
      IF NOT AVAILABLE eko THEN LEAVE.                
   END.
    
PROCEDURE tim_UI:
   DO TRANSACTION:                      
      FIND FIRST eko WHERE
      eko.ENY = TRUE AND
      /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
      eko.EORG = ekoforst.EGEO AND 
      /*eko.EGEO = ekoforst.EGEO AND      */
      eko.EVERDATUM = ekoforst.EVERDATUM AND
      eko.EPROJEKT = ekoforst.EPROJEKT AND
      eko.EKOSTNADSSLAG = kontokod
      USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
      IF NOT AVAILABLE eko THEN DO:
         CREATE eko.
      END.    
      ASSIGN         
      eko.EDEBKRED = TRUE 
      eko.ENY = TRUE 
      /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
      eko.EORG = ekoforst.EGEO  
      /*eko.EGEO = ekoforst.EGEO      */      
      eko.EVERDATUM = ekoforst.EVERDATUM
      eko.EPROJEKT = ekoforst.EPROJEKT 
      eko.EKOSTNADSSLAG = kontokod.
      IF kontokod = "9401" THEN DO:    /*EJ SAMMA ORG*/                        
         /*MELLAN*/
         ASSIGN eko.EANTAL = 0
         /*eko.EANTAL + ekoforst.EANTAL  */
         eko.EBELOPP = 
         eko.EBELOPP + (intpristim * ekoforst.ETIMMAR - ekoforst.EBELOPP).  
          /*KREDIT MELLAN*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */ 
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9461"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN            
         eko2.EDEBKRED = FALSE 
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO */ 
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9461"
         eko2.EANTAL = 0
         /*eko2.EANTAL + ekoforst.EANTAL  */
         eko2.EBELOPP = 
         eko2.EBELOPP + (intpristim * ekoforst.ETIMMAR - ekoforst.EBELOPP).   
         /*SUMMA*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EGEO AND 
         /*eko2.EGEO = ekoforst.EGEO AND */ 
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9411"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN            
         eko2.EDEBKRED = TRUE 
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EGEO  
         /*eko2.EGEO = ekoforst.EGEO  */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9411"
         eko2.EANTAL = 0
         /*eko2.EANTAL + ekoforst.EANTAL  */
         eko2.EBELOPP = eko2.EBELOPP + intpristim * ekoforst.ETIMMAR.  
         /*KREDIT SUMMA*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND*/  
         eko2.EVERDATUM = ekoforst.EVERDATUM AND  /*DENNA SAKNADES*/
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9471"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN            
         eko2.EDEBKRED = FALSE 
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9471"
         eko2.EANTAL = 0 
         /*eko2.EANTAL + ekoforst.EANTAL */ 
         eko2.EBELOPP = eko2.EBELOPP + intpristim * ekoforst.ETIMMAR.  
         /*SJÄLV KOSTNAD*/
         FIND FIRST eko WHERE
         eko.ENY = TRUE AND
         /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko.EORG = ekoforst.EGEO AND 
         /*eko.EGEO = ekoforst.EGEO AND      */      
         eko.EVERDATUM = ekoforst.EVERDATUM AND
         eko.EPROJEKT = ekoforst.EPROJEKT AND
         eko.EKOSTNADSSLAG = kontokode
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko THEN DO:
            CREATE eko.
         END.    
         ASSIGN         
         eko.EDEBKRED = TRUE 
         eko.ENY = TRUE 
         /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko.EORG = ekoforst.EGEO  
         /*eko.EGEO = ekoforst.EGEO      */      
         eko.EVERDATUM = ekoforst.EVERDATUM
         eko.EPROJEKT = ekoforst.EPROJEKT 
         eko.EKOSTNADSSLAG = kontokode.    
         ASSIGN 
         eko.EDEBKRED = TRUE 
         eko.EANTAL = eko.EANTAL + ekoforst.EANTAL  
         eko.EBELOPP = eko.EBELOPP + ekoforst.EBELOPP.     
         IF kodanst = 'T' OR kodanst = 'T1' THEN DO:
            kontokod = "9952".
         END.
         ELSE DO:
            kontokod = "9950".
         END.      
         /*KREDIT SJÄLV*/          
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND*/
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = kontokod
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN              
         eko2.EDEBKRED = FALSE 
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
        /* eko2.EGEO = ekoforst.EGEO */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = kontokod
         eko2.EANTAL = eko2.EANTAL + ekoforst.EANTAL  
         eko2.EBELOPP = eko2.EBELOPP + ekoforst.EBELOPP.          
         /*INDEREKTA KOSTNADER*/
         IF TRIM(fk3) = "0" THEN kontokod = kontokod. /*OK 960830 EJ IND*/
         ELSE DO:
            FIND FIRST eko WHERE
            eko.ENY = TRUE AND
            /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
            eko.EORG = ekoforst.EGEO AND 
            /*eko.EGEO = ekoforst.EGEO AND      */      
            eko.EVERDATUM = ekoforst.EVERDATUM AND
            eko.EPROJEKT = ekoforst.EPROJEKT AND
            eko.EKOSTNADSSLAG = "9892"
            USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
            IF NOT AVAILABLE eko THEN DO:
               CREATE eko.
            END.    
            ASSIGN         
            eko.EDEBKRED = TRUE 
            eko.ENY = TRUE 
            /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
            eko.EORG = ekoforst.EGEO  
            /*eko.EGEO = ekoforst.EGEO      */      
            eko.EVERDATUM = ekoforst.EVERDATUM
            eko.EPROJEKT = ekoforst.EPROJEKT 
            eko.EKOSTNADSSLAG = "9892".    
            ASSIGN 
            eko.EDEBKRED = TRUE 
            eko.EANTAL = 0
            /*eko.EANTAL + ekoforst.EANTAL  */
            eko.EBELOPP = eko.EBELOPP + ekoforst.EBELOPP * 0.70.              
            /*KREDIT*/          
            FIND FIRST eko2 WHERE
            eko2.ENY = TRUE AND
            /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
            eko2.EORG = ekoforst.EGEO AND 
            /*eko2.EGEO = ekoforst.EGEO AND*/
            eko2.EVERDATUM = ekoforst.EVERDATUM AND
            eko2.EPROJEKT = ekoforst.EPROJEKT AND
            eko2.EKOSTNADSSLAG = "9992"
            USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
            IF NOT AVAILABLE eko2 THEN DO:
               CREATE eko2.
            END.    
            ASSIGN              
            eko2.EDEBKRED = FALSE 
            eko2.ENY = TRUE 
           /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
            eko2.EORG = ekoforst.EGEO  
           /*eko2.EGEO = ekoforst.EGEO */
            eko2.EVERDATUM = ekoforst.EVERDATUM
            eko2.EPROJEKT = ekoforst.EPROJEKT 
            eko2.EKOSTNADSSLAG = "9992"
            eko2.EANTAL = 0
            /*eko2.EANTAL + ekoforst.EANTAL  */
            eko2.EBELOPP = eko2.EBELOPP + ekoforst.EBELOPP * 0.70.         
         END.
      END. 
      ELSE DO:   /*SAMMA ORG*/    
         ASSIGN 
         eko.EDEBKRED = TRUE 
         eko.EANTAL = eko.EANTAL + ekoforst.EANTAL  
         eko.EBELOPP = eko.EBELOPP + ekoforst.EBELOPP.     
         IF kodanst = 'T' OR kodanst = 'T1' THEN DO:
            kontokod = "9952".
         END.
         ELSE DO:
            kontokod = "9950".
         END.      
         /*KREDIT*/          
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND*/
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = kontokod
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN              
         eko2.EDEBKRED = FALSE 
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = kontokod
         eko2.EANTAL = eko2.EANTAL + ekoforst.EANTAL  
         eko2.EBELOPP = eko2.EBELOPP + ekoforst.EBELOPP.    
         /*INDEREKTA KOSTNADER*/
         IF TRIM(fk3) = "0" THEN kontokod = kontokod.
         ELSE DO:
            FIND FIRST eko WHERE
            eko.ENY = TRUE AND
            /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
            eko.EORG = ekoforst.EORG AND 
            /*eko.EGEO = ekoforst.EGEO AND      */      
            eko.EVERDATUM = ekoforst.EVERDATUM AND
            eko.EPROJEKT = ekoforst.EPROJEKT AND
            eko.EKOSTNADSSLAG = "9891"
            USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
            IF NOT AVAILABLE eko THEN DO:
               CREATE eko.
            END.    
            ASSIGN         
            eko.EDEBKRED = TRUE 
            eko.ENY = TRUE 
            /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
            eko.EORG = ekoforst.EORG  
            /*eko.EGEO = ekoforst.EGEO      */      
            eko.EVERDATUM = ekoforst.EVERDATUM
            eko.EPROJEKT = ekoforst.EPROJEKT 
            eko.EKOSTNADSSLAG = "9891".    
            ASSIGN 
            eko.EDEBKRED = TRUE 
            eko.EANTAL = 0
            /*eko.EANTAL + ekoforst.EANTAL  */
            eko.EBELOPP = eko.EBELOPP + ekoforst.EBELOPP * 0.70.              
            /*KREDIT*/          
            FIND FIRST eko2 WHERE
            eko2.ENY = TRUE AND
            /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
            eko2.EORG = ekoforst.EORG AND 
            /*eko2.EGEO = ekoforst.EGEO AND*/
            eko2.EVERDATUM = ekoforst.EVERDATUM AND
            eko2.EPROJEKT = ekoforst.EPROJEKT AND
            eko2.EKOSTNADSSLAG = "9991"
            USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
            IF NOT AVAILABLE eko2 THEN DO:
               CREATE eko2.
            END.    
            ASSIGN              
            eko2.EDEBKRED = FALSE 
            eko2.ENY = TRUE 
            /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
            eko2.EORG = ekoforst.EORG  
            /*eko2.EGEO = ekoforst.EGEO */
            eko2.EVERDATUM = ekoforst.EVERDATUM
            eko2.EPROJEKT = ekoforst.EPROJEKT 
            eko2.EKOSTNADSSLAG = "9991"
            eko2.EANTAL = 0
            /*eko2.EANTAL + ekoforst.EANTAL  */
            eko2.EBELOPP = eko2.EBELOPP + ekoforst.EBELOPP * 0.70.
         END.
      END.                                 
   END.
END PROCEDURE.
PROCEDURE overtim_UI:
   multi = 0.
   IF ovkod = "370" THEN multi = 0.       /*DESSA KODER FINNS I N2.P*/
   ELSE IF ovkod = "371" THEN multi = 0.5.
   ELSE IF ovkod = "372" THEN multi = 1.0.  
   ELSE IF ovkod = "375" THEN multi = 0.  
   ELSE IF ovkod = "376" THEN multi = 0.5.  
   ELSE IF ovkod = "377" THEN multi = 1.0.          
   ELSE IF ovkod = "380" THEN multi = 0.   
   ELSE IF ovkod = "334" THEN multi = 0.  
   ELSE IF ovkod = "381" THEN multi = 0.457.                    /*137/94*/
   ELSE IF ovkod = "382" THEN multi = 0.903.                    /*137/72*/
   ELSE IF ovkod = "385" THEN multi = 1.0. 
   ELSE IF ovkod = "386" THEN multi = 0.457.                    /*137/94*/
   ELSE IF ovkod = "387" THEN multi = 0.903.                    /*137/72*/
   ELSE IF ovkod = "320" THEN multi = 0.
   ELSE IF ovkod = "321" THEN multi = 0.5.
   ELSE IF ovkod = "322" THEN multi = 0.75.  
   ELSE IF ovkod = "323" THEN multi = 1.0.  
   ELSE IF ovkod = "324" THEN multi = 1.5.   
   ELSE IF ovkod = "325" THEN multi = 0.
   ELSE IF ovkod = "326" THEN multi = 0.5.
   ELSE IF ovkod = "327" THEN multi = 0.75.  
   ELSE IF ovkod = "328" THEN multi = 1.0.  
   ELSE IF ovkod = "329" THEN multi = 1.5.      
   ELSE IF ovkod = "330" THEN multi = 0.5. 
   ELSE IF ovkod = "331" THEN multi = 0.75. 
   ELSE IF ovkod = "332" THEN multi = 1.0. 
   ELSE IF ovkod = "333" THEN multi = 1.5. 
   ELSE IF ovkod = "335" THEN multi = 0.5. 
   ELSE IF ovkod = "336" THEN multi = 0.75. 
   ELSE IF ovkod = "337" THEN multi = 1.0. 
   ELSE IF ovkod = "338" THEN multi = 1.5.    
   ELSE IF ovkod = "435" THEN multi = 0.5.   
   ELSE IF ovkod = "436" THEN multi = 0.75.   
   ELSE IF ovkod = "437" THEN multi = 1.0.   
   ELSE IF ovkod = "438" THEN multi = 1.5.                    
   ELSE IF ovkod = "450" THEN multi = 0.254.                     /*137/540*/
   ELSE IF ovkod = "451" THEN multi = 0.457.                     /*137/300*/
   ELSE IF ovkod = "452" THEN multi = 0.913.                     /*137/150*/      
   ELSE IF ovkod = "440" THEN multi = 0.457.        /*137/94*/
   ELSE IF ovkod = "441" THEN multi = 0.903.        /*137/72*/
   ELSE IF ovkod = "445" THEN multi = 0.5.         
   ELSE IF ovkod = "446" THEN multi = 0.75.  
   ELSE IF ovkod = "447" THEN multi = 1.0. 
   ELSE IF ovkod = "448" THEN multi = 1.5.
   ELSE RETURN.       
   DO TRANSACTION:                      
      FIND FIRST eko WHERE
      eko.ENY = TRUE AND
      /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
      eko.EORG = ekoforst.EGEO AND 
      /*eko.EGEO = ekoforst.EGEO AND      */ 
      eko.EVERDATUM = ekoforst.EVERDATUM AND
      eko.EPROJEKT = ekoforst.EPROJEKT AND
      eko.EKOSTNADSSLAG = kontokod
      USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
      IF NOT AVAILABLE eko THEN DO:
         CREATE eko.
      END.                   
      ASSIGN    
      eko.EDEBKRED = TRUE 
      eko.ENY = TRUE 
      /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
      eko.EORG = ekoforst.EGEO  
      /*eko.EGEO = ekoforst.EGEO      */              
      eko.EVERDATUM = ekoforst.EVERDATUM
      eko.EPROJEKT = ekoforst.EPROJEKT 
      eko.EKOSTNADSSLAG = kontokod.
      IF kontokod = "9402" THEN DO:         /*EJ SAMMA ORG*/    
         ovbelopp = (intpristim + (intpristim * multi)) * ekoforst.ELONTILLANTAL.
         /*MELLAN*/
         ASSIGN eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL*/  
         eko.ELONBELOPP = eko.ELONBELOPP + (ovbelopp - ekoforst.ELONBELOPP).
         /* KREDIT MELLA*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9462"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN
         eko2.EDEBKRED = FALSE     
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO              */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9462"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL */ 
         eko2.ELONBELOPP = eko2.ELONBELOPP + (ovbelopp - ekoforst.ELONBELOPP).
         /* SUMMA*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EGEO AND 
         /*eko2.EGEO = ekoforst.EGEO AND  */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9412"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN
         eko2.EDEBKRED = TRUE     
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EGEO  
         /*eko2.EGEO = ekoforst.EGEO */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9412"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL*/  
         eko2.ELONBELOPP = eko2.ELONBELOPP + ovbelopp.
         /* KREDIT SUMMA*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9472"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN
         eko2.EDEBKRED = FALSE     
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG 
         /*eko2.EGEO = ekoforst.EGEO */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9472"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL */ 
         eko2.ELONBELOPP = eko2.ELONBELOPP + ovbelopp. 
         /*SJÄV KOSTNAD*/
         FIND FIRST eko WHERE
         eko.ENY = TRUE AND
         /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko.EORG = ekoforst.EGEO AND 
         /*eko.EGEO = ekoforst.EGEO AND      */ 
         eko.EVERDATUM = ekoforst.EVERDATUM AND
         eko.EPROJEKT = ekoforst.EPROJEKT AND
         eko.EKOSTNADSSLAG = kontokode
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko THEN DO:
            CREATE eko.
         END.                   
         ASSIGN    
         eko.EDEBKRED = TRUE 
         eko.ENY = TRUE 
         /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko.EORG = ekoforst.EGEO  
         /*eko.EGEO = ekoforst.EGEO      */              
         eko.EVERDATUM = ekoforst.EVERDATUM
         eko.EPROJEKT = ekoforst.EPROJEKT 
         eko.EKOSTNADSSLAG = kontokode. 
         ASSIGN 
         eko.EDEBKRED = TRUE 
         eko.ELONTILLANTAL = eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  
         eko.ELONBELOPP = eko.ELONBELOPP + ekoforst.ELONBELOPP.        
         /*KREDIT*/
         IF kodanst = 'T' OR kodanst = 'T1'THEN DO:
            kontokod = "9957".
         END.
         ELSE DO:
            kontokod = "9956".
         END.                
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = kontokod
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN           
         eko2.EDEBKRED = FALSE
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG
         /*eko2.EGEO = ekoforst.EGEO             */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = kontokod
         eko2.ELONTILLANTAL = eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.    
      END. 
      ELSE DO: /* SAMMA ORG*/    
         ASSIGN 
         eko.EDEBKRED = TRUE 
         eko.ELONTILLANTAL = eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  
         eko.ELONBELOPP = eko.ELONBELOPP + ekoforst.ELONBELOPP.        
         /*KREDIT*/
         IF kodanst = 'T' OR kodanst = 'T1'THEN DO:
            kontokod = "9957".
         END.
         ELSE DO:
            kontokod = "9956".
         END.                
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = kontokod
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN           
         eko2.EDEBKRED = FALSE
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG
         /*eko2.EGEO = ekoforst.EGEO             */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = kontokod
         eko2.ELONTILLANTAL = eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.                                                       END.
      END.                     
END PROCEDURE.
PROCEDURE rel_UI:
   IF ovkod = "080" THEN multi = 0.571.             /*137/240*/
   ELSE IF ovkod = "081" THEN multi = 0.721.        /*137/190*/
   ELSE IF ovkod = "082" THEN multi = 0.830.         /*137/165*/ 
   ELSE IF ovkod = "410" THEN multi = 0.75. 
   ELSE IF ovkod = "411" THEN multi = 0.90.   
   ELSE IF ovkod = "412" THEN multi = 0.75.  
   ELSE IF ovkod = "413" THEN multi = 0.90.  
   ELSE IF ovkod = "414" THEN multi = 0.254.          /*137/540*/   
   ELSE IF ovkod = "415" THEN multi = 0.457.          /*137/300*/  
   ELSE IF ovkod = "416" THEN multi = 0.913.        /*137/150*/   
   ELSE IF ovkod = "491" THEN multi = 0.    /*VET EJ*/   
   ELSE RETURN.   
   DO TRANSACTION:                      
      FIND FIRST eko WHERE
      eko.ENY = TRUE AND
      /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
      eko.EORG = ekoforst.EGEO AND 
      /*eko.EGEO = ekoforst.EGEO AND      */   
      eko.EVERDATUM = ekoforst.EVERDATUM AND
      eko.EPROJEKT = ekoforst.EPROJEKT AND
      eko.EKOSTNADSSLAG = kontokod
      USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
      IF NOT AVAILABLE eko THEN DO:
         CREATE eko.
      END.    
      ASSIGN         
      eko.EDEBKRED = TRUE 
      eko.ENY = TRUE 
      /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
      eko.EORG = ekoforst.EGEO  
      /*eko.EGEO = ekoforst.EGEO      */      
      eko.EVERDATUM = ekoforst.EVERDATUM
      eko.EPROJEKT = ekoforst.EPROJEKT 
      eko.EKOSTNADSSLAG = kontokod.
      IF kontokod = "9401" THEN DO:         /*EJ SAMMA ORG*/    
         ovbelopp = (intpristim + (intpristim * multi)) * ekoforst.ELONTILLANTAL.
         IF ekoforst.ELONTILLAGG = "080" OR ekoforst.ELONTILLAGG = "081" OR 
         ekoforst.ELONTILLAGG = "082" THEN ovbelopp = (intpristim * multi) * ekoforst.ELONTILLANTAL.
         /*MELLAN*/
         ASSIGN eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = eko.ELONBELOPP + (ovbelopp - ekoforst.ELONBELOPP).
         /* KREDIT MELLA*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9461"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN
         eko2.EDEBKRED = FALSE     
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO              */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9461"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL */ 
         eko2.ELONBELOPP = eko2.ELONBELOPP + (ovbelopp - ekoforst.ELONBELOPP).
         /* SUMMA*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EGEO AND 
         /*eko2.EGEO = ekoforst.EGEO AND  */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9411"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN
         eko2.EDEBKRED = TRUE     
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EGEO  
         /*eko2.EGEO = ekoforst.EGEO  */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9411"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ovbelopp.
         /* KREDIT SUMMA*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND*/
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9471"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN
         eko2.EDEBKRED = FALSE     
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG 
         /*eko2.EGEO = ekoforst.EGEO */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9471"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ovbelopp. 
         /*SJÄLV KOSTNAD*/
         FIND FIRST eko WHERE
         eko.ENY = TRUE AND
         /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko.EORG = ekoforst.EGEO AND 
         /*eko.EGEO = ekoforst.EGEO AND      */   
         eko.EVERDATUM = ekoforst.EVERDATUM AND
         eko.EPROJEKT = ekoforst.EPROJEKT AND
         eko.EKOSTNADSSLAG = kontokode
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko THEN DO:
            CREATE eko.
         END.    
         ASSIGN         
         eko.EDEBKRED = TRUE 
         eko.ENY = TRUE 
        /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko.EORG = ekoforst.EGEO  
         /*eko.EGEO = ekoforst.EGEO      */      
         eko.EVERDATUM = ekoforst.EVERDATUM
         eko.EPROJEKT = ekoforst.EPROJEKT 
         eko.EKOSTNADSSLAG = kontokode.
         ASSIGN 
         eko.EDEBKRED = TRUE 
         eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = eko.ELONBELOPP + ekoforst.ELONBELOPP.        
         /*KREDIT*/
         IF kodanst = 'T' OR kodanst = 'T1'THEN DO:
            kontokod = "9952".
         END.
         ELSE DO:
            kontokod = "9950".
         END.                
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
      /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = kontokod
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN           
         eko2.EDEBKRED = FALSE
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG
         /*eko2.EGEO = ekoforst.EGEO              */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = kontokod
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.  
      END. 
      ELSE DO: /* SAMMA ORG*/    
         ASSIGN 
         eko.EDEBKRED = TRUE 
         eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = eko.ELONBELOPP + ekoforst.ELONBELOPP.        
         /*KREDIT*/
         IF kodanst = 'T' OR kodanst = 'T1'THEN DO:
            kontokod = "9952".
         END.
         ELSE DO:
            kontokod = "9950".
         END.                
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
      /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = kontokod
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN           
         eko2.EDEBKRED = FALSE
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG
         /*eko2.EGEO = ekoforst.EGEO              */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = kontokod
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.                                                       END.
   END.                     
END PROCEDURE. 
PROCEDURE trakost_UI:
   DO TRANSACTION:                          
      FIND FIRST eko WHERE
      eko.ENY = TRUE AND
      /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
      eko.EORG = ekoforst.EGEO AND 
      /*eko.EGEO = ekoforst.EGEO AND      */ 
      eko.EVERDATUM = ekoforst.EVERDATUM AND
      eko.EPROJEKT = ekoforst.EPROJEKT AND
      eko.EKOSTNADSSLAG = kontokod
      USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
      IF NOT AVAILABLE eko THEN DO:
         CREATE eko.
      END.                   
      ASSIGN    
      eko.EDEBKRED = TRUE 
      eko.ENY = TRUE 
      /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
      eko.EORG = ekoforst.EGEO  
      /*eko.EGEO = ekoforst.EGEO      */              
      eko.EVERDATUM = ekoforst.EVERDATUM
      eko.EPROJEKT = ekoforst.EPROJEKT 
      eko.EKOSTNADSSLAG = kontokod.
      IF kontokod = "9421" THEN DO:         /*EJ SAMMA ORG*/    
         ASSIGN eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = 
         eko.ELONBELOPP + ekoforst.ELONBELOPP.   
         /*KREDIT*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND  */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9481"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN   
         eko2.EDEBKRED = FALSE  
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO             */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9481"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.
         /*SJÄLV KOSTNAD*/
         FIND FIRST eko WHERE
         eko.ENY = TRUE AND
         /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko.EORG = ekoforst.EGEO AND 
         /*eko.EGEO = ekoforst.EGEO AND      */ 
         eko.EVERDATUM = ekoforst.EVERDATUM AND
         eko.EPROJEKT = ekoforst.EPROJEKT AND
         eko.EKOSTNADSSLAG = kontokode
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko THEN DO:
            CREATE eko.
         END.                   
         ASSIGN    
         eko.EDEBKRED = TRUE 
         eko.ENY = TRUE 
         /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko.EORG = ekoforst.EGEO  
         /*eko.EGEO = ekoforst.EGEO      */              
         eko.EVERDATUM = ekoforst.EVERDATUM
         eko.EPROJEKT = ekoforst.EPROJEKT 
         eko.EKOSTNADSSLAG = kontokode.         
         ASSIGN 
         eko.EDEBKRED = TRUE 
         eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = eko.ELONBELOPP + ekoforst.ELONBELOPP.         
         /*KREDIT*/
         IF kodanst = 'T' OR kodanst = 'T1' THEN DO:
            kontokod = "9955".
         END.
         ELSE DO:
            kontokod = "9955".
         END.                
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = kontokod
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN              
         eko2.EDEBKRED = FALSE 
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO*/
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = kontokod 
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.            
      END.      
      ELSE DO: /* SAMMA ORG*/    
         ASSIGN 
         eko.EDEBKRED = TRUE 
         eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = eko.ELONBELOPP + ekoforst.ELONBELOPP.         
         /*KREDIT*/
         IF kodanst = 'T' OR kodanst = 'T1' THEN DO:
            kontokod = "9955".
         END.
         ELSE DO:
            kontokod = "9955".
         END.                
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND*/ 
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = kontokod
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN              
         eko2.EDEBKRED = FALSE 
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO*/
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = kontokod 
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.            
      END.
   END.                  
END PROCEDURE.
PROCEDURE milkost_UI:
   DO TRANSACTION:                                                
      FIND FIRST eko WHERE
      eko.ENY = TRUE AND
      /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
      eko.EORG = ekoforst.EGEO AND 
      /*eko.EGEO = ekoforst.EGEO AND      */
      eko.EVERDATUM = ekoforst.EVERDATUM AND
      eko.EPROJEKT = ekoforst.EPROJEKT AND
      eko.EKOSTNADSSLAG = kontokod
      USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
      IF NOT AVAILABLE eko THEN DO:
         CREATE eko.
      END.                   
      ASSIGN    
      eko.EDEBKRED = TRUE 
      eko.ENY = TRUE 
      /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
      eko.EORG = ekoforst.EGEO  
      /*eko.EGEO = ekoforst.EGEO      */ 
      eko.EVERDATUM = ekoforst.EVERDATUM
      eko.EPROJEKT = ekoforst.EPROJEKT 
      eko.EKOSTNADSSLAG = kontokod.
      IF kontokod = "9425" THEN DO:         /*EJ SAMMA ORG*/    
         ASSIGN eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = 
         eko.ELONBELOPP + ekoforst.ELONBELOPP.   
         /*KREDIT*/                      
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
        /*  eko2.EGEO = ekoforst.EGEO AND                */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9485"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN   
         eko2.EDEBKRED = FALSE  
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9485"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.
         /*SJÄLV KOSTNAD*/              
         FIND FIRST eko WHERE
         eko.ENY = TRUE AND
         /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko.EORG = ekoforst.EGEO AND 
         /*eko.EGEO = ekoforst.EGEO AND      */
         eko.EVERDATUM = ekoforst.EVERDATUM AND
         eko.EPROJEKT = ekoforst.EPROJEKT AND
         eko.EKOSTNADSSLAG = kontokode
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko THEN DO:
            CREATE eko.
         END.                   
         ASSIGN    
         eko.EDEBKRED = TRUE 
         eko.ENY = TRUE 
         /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko.EORG = ekoforst.EGEO  
         /*eko.EGEO = ekoforst.EGEO      */ 
         eko.EVERDATUM = ekoforst.EVERDATUM
         eko.EPROJEKT = ekoforst.EPROJEKT 
         eko.EKOSTNADSSLAG = kontokode.    
         ASSIGN 
         eko.EDEBKRED = TRUE 
         eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = eko.ELONBELOPP + ekoforst.ELONBELOPP.           
         /*KREDIT*/
         IF kodanst = 'T' OR kodanst = 'T1' THEN DO:
            kontokod = "9953".
         END.
         ELSE DO:
            kontokod = "9953".
         END.                
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = kontokod
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN              
         eko2.EDEBKRED = FALSE 
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO*/ 
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = kontokod 
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.  
      END. 
      ELSE DO: /* SAMMA ORG*/    
         ASSIGN 
         eko.EDEBKRED = TRUE 
         eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = eko.ELONBELOPP + ekoforst.ELONBELOPP.           
         /*KREDIT*/
         IF kodanst = 'T' OR kodanst = 'T1' THEN DO:
            kontokod = "9953".
         END.
         ELSE DO:
            kontokod = "9953".
         END.                
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = kontokod
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN              
         eko2.EDEBKRED = FALSE 
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = kontokod 
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.              
      END.
   END.                  
END PROCEDURE.		      
PROCEDURE lonkost_UI:
   DO TRANSACTION:                      
      FIND FIRST eko WHERE
      eko.ENY = TRUE AND
      /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
      eko.EORG = ekoforst.EGEO AND 
      /*eko.EGEO = ekoforst.EGEO AND      */
      eko.EVERDATUM = ekoforst.EVERDATUM AND
      eko.EPROJEKT = ekoforst.EPROJEKT AND
      eko.EKOSTNADSSLAG = kontokod
      USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
      IF NOT AVAILABLE eko THEN DO:
         CREATE eko.
      END.                   
      ASSIGN    
      eko.EDEBKRED = TRUE 
      eko.ENY = TRUE 
      /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
      eko.EORG = ekoforst.EGEO 
      /*eko.EGEO = ekoforst.EGEO      */              
      eko.EVERDATUM = ekoforst.EVERDATUM
      eko.EPROJEKT = ekoforst.EPROJEKT 
      eko.EKOSTNADSSLAG = kontokod.
      IF kontokod = "9401" THEN DO:         /*EJ SAMMA ORG*/    
         /*MELLAN*/
         ASSIGN eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = eko.ELONBELOPP.  /*MELLAN SKILNAD = 0*/
         /* KREDIT MELLA*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND  */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9461"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN
         eko2.EDEBKRED = FALSE     
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO */             
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9461"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP.
         /* SUMMA*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EGEO AND 
         /*eko2.EGEO = ekoforst.EGEO AND  */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9411"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN
         eko2.EDEBKRED = TRUE     
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EGEO  
         /*eko2.EGEO = ekoforst.EGEO */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9411"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.
         /* KREDIT SUMMA*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND*/
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = "9471"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN
         eko2.EDEBKRED = FALSE     
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG 
         /*eko2.EGEO = ekoforst.EGEO */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = "9471"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.
         /*SJÄLV KOSTNAD*/
         FIND FIRST eko WHERE
         eko.ENY = TRUE AND
         /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko.EORG = ekoforst.EGEO AND 
         /*eko.EGEO = ekoforst.EGEO AND      */
         eko.EVERDATUM = ekoforst.EVERDATUM AND
         eko.EPROJEKT = ekoforst.EPROJEKT AND
         eko.EKOSTNADSSLAG = kontokode
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko THEN DO:
            CREATE eko.
         END.                   
         ASSIGN    
         eko.EDEBKRED = TRUE 
         eko.ENY = TRUE 
         /* eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko.EORG = ekoforst.EGEO 
         /*eko.EGEO = ekoforst.EGEO      */              
         eko.EVERDATUM = ekoforst.EVERDATUM
         eko.EPROJEKT = ekoforst.EPROJEKT 
         eko.EKOSTNADSSLAG = kontokode.  
         ASSIGN 
         eko.EDEBKRED = TRUE 
         eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = eko.ELONBELOPP + ekoforst.ELONBELOPP.   
         /*KREDIT*/
         IF kodanst = 'T' OR kodanst = 'T1'THEN DO:
            kontokod = "9952".
         END.
         ELSE DO:
            kontokod = "9950".
         END.                
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
      /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = kontokod
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN           
         eko2.EDEBKRED = FALSE
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG
         /*eko2.EGEO = ekoforst.EGEO */             
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = kontokod
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.  
      END. 
      ELSE DO: /* SAMMA ORG*/    
         ASSIGN 
         eko.EDEBKRED = TRUE 
         eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = eko.ELONBELOPP + ekoforst.ELONBELOPP.   
         /*KREDIT*/
         IF kodanst = 'T' OR kodanst = 'T1'THEN DO:
            kontokod = "9952".
         END.
         ELSE DO:
            kontokod = "9950".
         END.                
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
      /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EVERDATUM = ekoforst.EVERDATUM AND
         eko2.EPROJEKT = ekoforst.EPROJEKT AND
         eko2.EKOSTNADSSLAG = kontokod
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN           
         eko2.EDEBKRED = FALSE
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG
         /*eko2.EGEO = ekoforst.EGEO              */
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = ekoforst.EPROJEKT 
         eko2.EKOSTNADSSLAG = kontokod
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.                                                       END.                       
   END.                  
END PROCEDURE.
PROCEDURE berkost_UI:
   DO TRANSACTION:                      
      FIND FIRST eko WHERE
      eko.ENY = TRUE AND
                      /*   eko.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
      eko.EPROJEKT = "800900" AND
      eko.EORG = ekoforst.EORG AND 
      /*eko.EGEO = ekoforst.EGEO AND      */ 
      eko.EVERDATUM = ekoforst.EVERDATUM AND
      eko.EKOSTNADSSLAG = kontokod
      USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
      IF NOT AVAILABLE eko THEN DO:
         CREATE eko.
      END.                   
      ASSIGN    
      eko.EDEBKRED = TRUE 
      eko.ENY = TRUE                              
      eko.EPROJEKT = "800900"
                      /*    eko.EPERSONALKOD = ekoforst.EPERSONALKOD */
      eko.EORG = ekoforst.EORG  
      /*eko.EGEO = ekoforst.EGEO      */              
      eko.EVERDATUM = ekoforst.EVERDATUM
      eko.EKOSTNADSSLAG = kontokod.
      IF kontokod = "9220" THEN DO:         /*TJÄNSTEMÄN*/    
         ASSIGN eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = eko.ELONBELOPP + ekoforst.ELONBELOPP.   
         /*KREDIT*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
            /*        eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EPROJEKT = "800900" AND 
         eko2.EVERDATUM = ekoforst.EVERDATUM AND         
         eko2.EKOSTNADSSLAG = "9952"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN   
         eko2.EDEBKRED = FALSE  
         eko2.ENY = TRUE 
             /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO  */
         eko2.EPROJEKT = "800900"
         eko2.EVERDATUM = ekoforst.EVERDATUM         
         eko2.EKOSTNADSSLAG = "9952"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.  
      END.                    
      ELSE DO: /* KOLLEKTIV*/    
         ASSIGN eko.ELONTILLANTAL = 0
         /*eko.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko.ELONBELOPP = eko.ELONBELOPP + ekoforst.ELONBELOPP.  
         /*KREDIT*/
         FIND FIRST eko2 WHERE
         eko2.ENY = TRUE AND
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD AND*/
         eko2.EORG = ekoforst.EORG AND 
         /*eko2.EGEO = ekoforst.EGEO AND */
         eko2.EPROJEKT = "800900" AND
         eko2.EVERDATUM = ekoforst.EVERDATUM AND         
         eko2.EKOSTNADSSLAG = "9950"
         USE-INDEX ORG EXCLUSIVE-LOCK NO-ERROR.  
         IF NOT AVAILABLE eko2 THEN DO:
            CREATE eko2.
         END.    
         ASSIGN   
         eko2.EDEBKRED = FALSE  
         eko2.ENY = TRUE 
         /* eko2.EPERSONALKOD = ekoforst.EPERSONALKOD */
         eko2.EORG = ekoforst.EORG  
         /*eko2.EGEO = ekoforst.EGEO*/
         eko2.EVERDATUM = ekoforst.EVERDATUM
         eko2.EPROJEKT = "800900"
         eko2.EKOSTNADSSLAG = "9950"
         eko2.ELONTILLANTAL = 0
         /*eko2.ELONTILLANTAL + ekoforst.ELONTILLANTAL  */
         eko2.ELONBELOPP = eko2.ELONBELOPP + ekoforst.ELONBELOPP.       
      END.
   END.                  
END PROCEDURE.	     
	     
