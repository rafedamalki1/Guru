
DEF BUFFER fb FOR FAKTTID.
DEF VAR aa AS DEC.
DEF TEMP-TABLE eftab
   FIELD AONR AS CHAR
   FIELD BEFATTNING AS CHAR
   FIELD TIMMAR AS DEC
   FIELD OTIMMAR AS DEC
   FIELD VFAKTNR AS INTEGER
   INDEX FV IS PRIMARY VFAKTNR AONR BEFATTNING
   INDEX AONR AONR BEFATTNING.

FOR EACH FAKTTID WHERE FAKTTID.VECKOKORD = "W20020507" AND FAKTTID.vfaktnr NE 0 NO-LOCK.
   FIND FIRST fb WHERE fb.personalkod = fakttid.personalkod AND 
   fb.AONR = FAKTTID.AONR AND fb.datum = FAKTTID.DATUM AND 
   fb.start = fakttid.START AND 
   fb.slut  = fakttid.slut AND fb.VECKOKORD = "W20020606" and
   fb.vfaktnr NE 0
   NO-LOCK NO-ERROR.
   IF AVAILABLE fb THEN DO:
      FIND FIRST eftab WHERE eftab.AONR = fb.AONR AND
      eftab.BEFATTNING = fb.BEFATTNING
      NO-ERROR.
      IF NOT AVAILABLE eftab THEN CREATE eftab.
      ASSIGN
      eftab.AONR    = fb.AONR
      eftab.BEFATTNING = fb.BEFATTNING
      eftab.TIMMAR  = eftab.TIMMAR  + fb.TIMMAR 
      eftab.OTIMMAR = eftab.OTIMMAR + fb.OTIMMAR
      eftab.VFAKTNR = fb.VFAKTNR.
   END.
END.
OUTPUT TO EFTABE.TXT.
FOR EACH eftab:
   DISP EFTAB.
END.
OUTPUT TO d:\delad\SERVER\pro9s\wrk\EFTAB.TXT.
FOR EACH eftab:
   DISP EFTAB.
END.
