         /*STARTEKOFAK.P*/
DEFINE VARIABLE fnr AS INTEGER NO-UNDO.
DEFINE VARIABLE utfil AS CHARACTER NO-UNDO.
DEFINE TEMP-TABLE felmeddtemp 
  FIELD FELMEDD AS CHARACTER
  FIELD VAL AS INTEGER.
  {AMERICANEUROPEAN.I}
FIND FIRST FORETAG USE-INDEX FORETAG NO-LOCK NO-ERROR.
Guru.Konstanter:globforetag = FORETAG.FORETAG.
{CONAPP.I}
fnr = 19.
   FIND LAST FAKTURERAD WHERE FAKTURERAD.FAKTNR = fnr NO-LOCK NO-ERROR.

         IF Guru.Konstanter:appcon THEN DO:
            RUN FAKKOAPP.P ON Guru.Konstanter:apphand TRANSACTION DISTINCT
            (INPUT FALSE, INPUT  FAKTURERAD.FAKTNR, INPUT FAKTURERAD.FDELNR, INPUT FAKTURERAD.VFAKTNR,OUTPUT TABLE felmeddtemp).
         END.
         ELSE DO:
            RUN FAKKOAPP.P  
            (INPUT FALSE, INPUT  FAKTURERAD.FAKTNR, INPUT FAKTURERAD.FDELNR, INPUT FAKTURERAD.VFAKTNR,OUTPUT TABLE felmeddtemp).
         END.
         FIND FIRST felmeddtemp NO-LOCK NO-ERROR.
         IF AVAILABLE felmeddtemp THEN DO:
            utfil =  SESSION:TEMP-DIR + "faktfel.txt".
            OUTPUT TO VALUE(utfil).
            PUT UNFORMATTED "KONTAKTA ELPOOL 090-184540 DU FICK NÅGRA FEL VID ÖVERLÄSNINGEN TILL EKONOMISYSTEMET. INGET ÄR ÖVERLÄST TILL EKONOMI" SKIP.
            FOR EACH felmeddtemp:
               PUT UNFORMATTED felmeddtemp.FELMEDD SKIP.
            END.
            OUTPUT CLOSE.
            RUN OPENDOC.P (utfil,"","",FALSE).            
         END.
{EUROPEANAMERICAN.I}