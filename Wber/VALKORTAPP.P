/*VALKORTAPP.P*/
{STARTFORAPP.I}
{BEREDNINGTEMP.I}


PROCEDURE berhmt_UI :
   DEFINE INPUT PARAMETER valaonr AS CHARACTER NO-UNDO.
   DEFINE INPUT PARAMETER valomrade AS CHARACTER NO-UNDO.
   DEFINE OUTPUT PARAMETER datvar2 AS DATE NO-UNDO.
   DEFINE OUTPUT PARAMETER TABLE FOR beredningtemp.
   EMPTY TEMP-TABLE beredningtemp NO-ERROR. 
   FIND FIRST BEREDNING WHERE BEREDNING.BERNR = INTEGER(valaonr) AND
   BEREDNING.OMRADE = valomrade USE-INDEX BERNR NO-LOCK NO-ERROR.
   IF AVAILABLE BEREDNING THEN DO:
      CREATE beredningtemp.
      BUFFER-COPY BEREDNING TO beredningtemp.
   END.
   FIND LAST BERMTRL WHERE BERMTRL.AONR = valaonr AND 
   BERMTRL.OMRADE = valomrade AND BERMTRL.INKOP = FALSE 
   USE-INDEX DATUM NO-LOCK NO-ERROR.
   IF AVAILABLE BERMTRL THEN DO:
      datvar2 = BERMTRL.DATUM.
   END.
   ELSE DO:
      datvar2 = TODAY.
   END.

END PROCEDURE.
