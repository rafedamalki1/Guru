
OPEN QUERY QQ FOR EACH MOTPART NO-LOCK.
DO TRANSACTION:
GET FIRST QQ exclusive-lock.
DO WHILE AVAILABLE(MOTPART):

   DELETE MOTPART. 
    
GET NEXT QQ exclusive-lock.
END.
END.
DO TRANSACTION:

FIND FIRST MOTPART WHERE MOTPART.MOTPART = STRING(999) NO-LOCK NO-ERROR.
         IF NOT AVAILABLE MOTPART THEN DO:
            IF SETUSERID(CHR(69) + CHR(76) + CHR(80) + CHR(65) + CHR(79),"KAGGEN","DICTDB") THEN DO:
               CREATE MOTPART.
               ASSIGN
               MOTPART.MOTPARTID = NEXT-VALUE(PRISLISTSEQ)
               MOTPART.MOTPART = STRING(999)
               MOTPART.BORT = FALSE. 
            END.
         END.
END.
OPEN QUERY CC FOR EACH KUNDREGLER NO-LOCK.
    DO TRANSACTION:
       GET FIRST CC EXCLUSIVE-LOCK.
       KUNDREGLER.MOTPARTID = MOTPART.MOTPARTID.
    END.
    REPEAT:
       DO TRANSACTION:
          GET NEXT CC EXCLUSIVE-LOCK.
          IF NOT AVAILABLE KUNDREGLER THEN LEAVE. 
          KUNDREGLER.MOTPARTID = MOTPART.MOTPARTID.
          MESSAGE KUNDREGLER.BESTID.
          pause 0.
       END.
    END.
    OPEN QUERY CC2 FOR EACH FAKTREGLER NO-LOCK.
    DO TRANSACTION:
       GET FIRST CC2 EXCLUSIVE-LOCK.
       if available FAKTREGLER then
       FAKTREGLER.MOTPARTID = MOTPART.MOTPARTID.
    END.
    REPEAT:
       DO TRANSACTION:
          GET NEXT CC2 EXCLUSIVE-LOCK.
          IF NOT AVAILABLE FAKTREGLER THEN LEAVE. 
          FAKTREGLER.MOTPARTID = MOTPART.MOTPARTID.
          MESSAGE FAKTREGLER.BESTID "FA".
          pause 0.
       END.
    END.
